parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"Qsy+":[function(require,module,exports) {
function Util(){}!function(){var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");Math.uuid=function(e,o){var n,r,i=t,a=[];if(o=o||i.length,e)for(n=0;n<e;n++)a[n]=i[0|Math.random()*o];else for(a[8]=a[13]=a[18]=a[23]="-",a[14]="4",n=0;n<36;n++)a[n]||(r=0|16*Math.random(),a[n]=i[19==n?3&r|8:r]);return a.join("")},Math.uuidFast=function(){for(var e,o=t,n=new Array(36),r=0,i=0;i<36;i++)8==i||13==i||18==i||23==i?n[i]="-":14==i?n[i]="4":(r<=2&&(r=33554432+16777216*Math.random()|0),e=15&r,r>>=4,n[i]=o[19==i?3&e|8:e]);return n.join("")},Math.uuidCompact=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})}}(),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=e||0,this.indexOf(t,e)===e});var Logger=function(t){var e=this,o=0,n=1,r=2,i=3,a=4,l=5,c=["TRACE","DEBUG","INFO","WARN","ERROR","FATAL"];function u(o,n){try{!function(o,n){if(emedia&&emedia.LOG_LEVEL&&o<emedia.LOG_LEVEL)return;var r=[];r.push(o),t&&r.push(t);for(var i=0;i<n.length;i++)r.push(n[i]&&n[i]._toString?n[i]._toString.call(n[i]):n[i]);e._log.apply(e,r)}(o,n)}catch(r){if(console){if(console.error)return void console.error(r);if(console.log)return void console.log(r)}throw r}}this._log=function(){var t=arguments[0];t=arguments[0]=c[t],emedia._logContext&&function(){try{(function(){if(emedia._logContextIndex<0)return;if(!(emedia._logContext&&emedia._logContext instanceof Array))return;var t=emedia._logContextIndex%emedia._logContext.length,e=emedia._logContext[t];e&&e instanceof Array||(e=emedia._logContext[t]=[]);var o=[];o.push(emedia._logContextIndex);var n,r=new Date;"function"==typeof r.toLocaleString?o.push(r.toLocaleString()):r.toJSON?o.push(r.toJSON()):r.toISOString?o.push(r.toISOString()):o.push(r+"");for(var i=0;i<arguments.length;i++){var a=arguments[i];"string"!=typeof a?a?"string"!=typeof a.message?"function"!=typeof a.message?"string"!=typeof a.stack?a.event&&"function"==typeof a.event.toString?o.push(a.event.toString()):a.event&&"function"==typeof a.event.toString?o.push(a.event.toString()):"string"!=typeof a.candidate?"string"!=typeof a.sdp?isPlainObject(a)?o.push(JSON.stringify(a)):o.push(String(a)):o.push(a.sdp):o.push(a.candidate):o.push(a.stack):o.push(a.message()):o.push(a.message):o.push(a):o.push(a)}emedia.config.loglastStoreArray&&e.push(n=o.join(" "));if("function"==typeof emedia.config.onSdkLog)try{n||(n=o.join(" ")),emedia.config.onSdkLog(n)}catch(l){console.error(l)}}).apply(null,arguments)}catch(t){console.warn(t)}}.apply(null,arguments),!0===emedia.config.consoleLogger&&(emedia&&emedia.isElectron?console.log.apply(console,arguments):console&&t&&(console[t.toLowerCase()]||console.warn).apply(console,arguments))},this.log=function(){this._log&&u(r,arguments)},this.trace=function(){this._log&&u(o,arguments)},this.debug=function(){this._log&&u(n,arguments)},this.info=function(){this._log&&u(r,arguments)},this.warn=function(){this._log&&u(i,arguments)},this.error=function(){this._log&&u(a,arguments)},this.fatal=function(){this._log&&u(l,arguments)}};Logger.prototype.count=function(){if(emedia._logContext){emedia._logContextIndex++;var t=emedia._logContextIndex%emedia._logContext.length;0===t&&0!==emedia._logContextIndex&&(emedia._logContext.loadlogs=emedia._logContext[t]),emedia._logContext[t]=[]}},Util.prototype.logger=new Logger,Util.prototype.tagLogger=function(t){return new Logger(t)},Util.prototype.parseJSON=function(t){return JSON.parse(t)};var stringifyJSON=Util.prototype.stringifyJSON=function(t){return JSON.stringify(t)},class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,fnToString=hasOwn.toString,ObjectFunctionString=fnToString.call(Object),isPlainObject=Util.prototype.isPlainObject=function(t){var e,o;return!(!t||"[object Object]"!==toString.call(t)||"<JSAPI-Auto Javascript Object>"===t.toString()||"[object IFBComJavascriptObject]"===t.toString())&&(!(e=Object.getPrototypeOf(t))||"function"==typeof(o=hasOwn.call(e,"constructor")&&e.constructor)&&fnToString.call(o)===ObjectFunctionString)};Util.prototype.isArray=Array.isArray,Util.prototype.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},Util.prototype.type=function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?class2type[toString.call(t)]||"object":typeof t},Util.prototype.extend=function(){var t,e,o,n,r,i,a=arguments[0]||{},l=1,c=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[l]||{},l++),"object"==typeof a||this.isFunction(a)||(a={}),l===c&&(a=this,l--);l<c;l++)if(null!=(t=arguments[l]))for(e in t)o=a[e],a!==(n=t[e])&&(u&&n&&(this.isPlainObject(n)||(r=this.isArray(n)))?(r?(r=!1,i=o&&this.isArray(o)?o:[]):i=o&&this.isPlainObject(o)?o:{},a[e]=this.extend(u,i,n)):void 0!==n&&(a[e]=n));return a},Util.prototype.removeAttribute=function(t,e){if(null!=t){var o=t[e];return delete t[e],o}},Util.prototype.prototypeExtend_000=Util.prototype.classExtend=function(){var t,e=this;function o(){for(var t=0;t<arguments.length;t++){var o=arguments[t]||{};e.extend(!0,this,o)}this.__init__&&this.__init__.apply(this,arguments)}for(var n=0;n<arguments.length;n++){var r=arguments[n]||{};"function"==typeof r?t?(r.constructor=t,r.__proto__=t.prototype):t=r:e.extend(!0,o.prototype,r)}return t&&(o.prototype.__proto__=t.prototype),t&&(o.prototype.constructor=t),o.extend||(o.extend=function(t){return e.prototypeExtend(o,t)}),o},Util.prototype.prototypeExtend=Util.prototype.classExtend=function(){var t=this;function e(){for(var e=0;e<arguments.length;e++){var o=arguments[e]||{};t.extend(!0,this,o)}this.__init__&&this.__init__.apply(this,arguments)}for(var o=0;o<arguments.length;o++){var n=arguments[o]||{};"function"==typeof n&&(n=n.prototype),t.extend(!0,e.prototype,n)}return e.extend||(e.extend=function(o){return t.prototypeExtend(e,o)}),e},Util.prototype.hasLocalStorage=function(t){return null!=localStorage.getItem(t)&&"{}"!=localStorage.getItem(t)},Util.prototype.toggleClass=function(t,e){t.hasClass(e)?t.removeClass(e):t.addClass(e)},Util.prototype.setCookie=function(t,e,o){var n=new Date;n.setTime(n.getTime()+60*o*60*1e3),document.cookie=t+"="+escape(e)+";expires="+n.toGMTString()},Util.prototype.getCookie=function(t){var e=document.cookie.match(new RegExp("(^| )"+t+"=([^;]*)(;|$)"));return null!=e?unescape(e[2]):null},Util.prototype.parseURL=function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),o=window.location.search.substr(1).match(e);return null!=o?unescape(o[2]):null},Util.prototype.forEach=function(t,e){if(t&&!(this.isArray(t)&&0===t.length||void 0!==t.length&&0===t.length))if(t.length)for(var o=0;o<t.length;o++)e(o,t[o]);else if(t&&!this.isEmptyObject(t)){t=t||{};var n=this.extend(!1,{},t);for(var r in n)e(r,t[r])}},Util.prototype.isInt=function(t){return Number(t)===t&&t%1==0},Util.prototype.isFloat=function(t){return Number(t)===t&&t%1!=0},Util.prototype.list=function(){return 1===arguments.length?[arguments[0]]:Array.apply(null,arguments)},Util.prototype.addEvent=function(t,e,o){if(t.attachEvent)return t.attachEvent("on"+e,o);if(t.addEventListener)return t.addEventListener(e,o,!1);throw"Handler could not be attached"},Util.prototype.removeEvent=function(t,e,o){if(t.detachEvent)return t.detachEvent("on"+e,o);if(t.removeEventListener)return t.removeEventListener(e,o,!1);throw"Handler could not be removed"},Util.prototype.stopEvent=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1},Util.prototype.getDomPageRect=function(t){var e=t.getBoundingClientRect();return{x:e.left+(window.pageXOffset||window.document.documentElement.scrollLeft),y:e.top+(window.pageYOffset||window.document.documentElement.scrollTop),width:e.width||t.offsetWidth,height:e.height||t.offsetHeight}},Util.prototype.getEventElementXY=function(t,e,o){var n,r,i=(t=t||window.event).changedTouches?t.changedTouches[0]:t.touches?t.touches[0]:t;null!=i.pageX&&null!=i.pageY?(n=i.pageX,r=i.pageY):null!=i.clientX&&null!=i.clientY&&(n=i.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,r=i.clientY+document.body.scrollTop+document.documentElement.scrollTop);var a=this.getDomPageRect(e),l=n-a.x,c=r-a.y;return(0===o||null==o)&&(o=1),{x:Math.round(Math.max(Math.min(l,a.width-1),0)/o),y:Math.round(Math.max(Math.min(c,a.height-1),0)/o),width:Math.round(a.width/o),height:Math.round(a.height/o),realX:l,realY:c}},Util.prototype.layoutEngine=function(){var t,e,o={presto:!!window.opera,trident:!!window.ActiveXObject&&(window.XMLHttpRequest?document.querySelectorAll?6:5:4),webkit:function(){try{return!navigator.taintEnabled&&(i.Features.xpath?i.Features.query?525:420:419)}catch(t){return!1}}(),gecko:!(!document.getBoxObjectFor&&null==window.mozInnerScreenX)&&(document.getElementsByClassName?19:18)};return o.webkit&&(o.webkit=(t=o,e=(navigator.userAgent.match(/WebKit\/([0-9\.]*) /)||["",t])[1],parseFloat(e,10))),o}(),Util.prototype.targetDOM="object"==typeof HTMLElement?function(t){return t instanceof HTMLElement}:function(t){return t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName},Util.prototype.cloneCSS=function(t,e){var o=window.getComputedStyle&&window.getComputedStyle(t,null)||t.currentStyle;for(var n in o){var r=o[n];/^[a-z]/i.test(n)&&[null,"",void 0].indexOf(r)<0&&(e.style[n]=r)}},Util.prototype.canYield=function(){try{return eval("!!Function('yield true;')().next()")}catch(e){return!1}}(),module.exports=new Util;
},{}],"75TC":[function(require,module,exports) {
var define;
var global = arguments[3];
var t,e=arguments[3];!function(e,n){"function"==typeof t&&t.amd?t(function(){return n()}):n()}(0,function(){var t,e=function(){var t,e,n,r,i,o,a=[],s=a.concat,u=a.filter,c=a.slice,l=window.document,f={},h={},p={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},d=/^\s*<(\w+|!)[^>]*>/,m=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,v=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,g=/^(?:body|html)$/i,y=/([A-Z])/g,x=["val","css","html","text","data","width","height","offset"],b=l.createElement("table"),w=l.createElement("tr"),E={tr:l.createElement("tbody"),tbody:b,thead:b,tfoot:b,td:w,th:w,"*":l.createElement("div")},j=/complete|loaded|interactive/,T=/^[\w-]*$/,S={},C=S.toString,N={},O=l.createElement("div"),P={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},A=Array.isArray||function(t){return t instanceof Array};function D(t){return null==t?String(t):S[C.call(t)]||"object"}function L(t){return"function"==D(t)}function $(t){return null!=t&&t==t.window}function F(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function k(t){return"object"==D(t)}function M(t){return k(t)&&!$(t)&&Object.getPrototypeOf(t)==Object.prototype}function R(t){var e=!!t&&"length"in t&&t.length,r=n.type(t);return"function"!=r&&!$(t)&&("array"==r||0===e||"number"==typeof e&&e>0&&e-1 in t)}function Z(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function z(t){return t in h?h[t]:h[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function q(t,e){return"number"!=typeof e||p[Z(t)]?e:e+"px"}function H(t){return"children"in t?c.call(t.children):n.map(t.childNodes,function(t){if(1==t.nodeType)return t})}function I(t,e){var n,r=t?t.length:0;for(n=0;n<r;n++)this[n]=t[n];this.length=r,this.selector=e||""}function V(t,e){return null==e?n(t):n(t).filter(e)}function _(t,e,n,r){return L(e)?e.call(t,n,r):e}function B(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function U(e,n){var r=e.className||"",i=r&&r.baseVal!==t;if(n===t)return i?r.baseVal:r;i?r.baseVal=n:e.className=n}function X(t){try{return t?"true"==t||"false"!=t&&("null"==t?null:+t+""==t?+t:/^[\[\{]/.test(t)?n.parseJSON(t):t):t}catch(e){return t}}return N.matches=function(t,e){if(!e||!t||1!==t.nodeType)return!1;var n=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(n)return n.call(t,e);var r,i=t.parentNode,o=!i;return o&&(i=O).appendChild(t),r=~N.qsa(i,e).indexOf(t),o&&O.removeChild(t),r},i=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},o=function(t){return u.call(t,function(e,n){return t.indexOf(e)==n})},N.fragment=function(e,r,i){var o,a,s;return m.test(e)&&(o=n(l.createElement(RegExp.$1))),o||(e.replace&&(e=e.replace(v,"<$1></$2>")),r===t&&(r=d.test(e)&&RegExp.$1),r in E||(r="*"),(s=E[r]).innerHTML=""+e,o=n.each(c.call(s.childNodes),function(){s.removeChild(this)})),M(i)&&(a=n(o),n.each(i,function(t,e){x.indexOf(t)>-1?a[t](e):a.attr(t,e)})),o},N.Z=function(t,e){return new I(t,e)},N.isZ=function(t){return t instanceof N.Z},N.init=function(e,r){var i,o;if(!e)return N.Z();if("string"==typeof e)if("<"==(e=e.trim())[0]&&d.test(e))i=N.fragment(e,RegExp.$1,r),e=null;else{if(r!==t)return n(r).find(e);i=N.qsa(l,e)}else{if(L(e))return n(l).ready(e);if(N.isZ(e))return e;if(A(e))o=e,i=u.call(o,function(t){return null!=t});else if(k(e))i=[e],e=null;else if(d.test(e))i=N.fragment(e.trim(),RegExp.$1,r),e=null;else{if(r!==t)return n(r).find(e);i=N.qsa(l,e)}}return N.Z(i,e)},(n=function(t,e){return N.init(t,e)}).extend=function(n){var r,i=c.call(arguments,1);return"boolean"==typeof n&&(r=n,n=i.shift()),i.forEach(function(i){!function n(r,i,o){for(e in i)o&&(M(i[e])||A(i[e]))?(M(i[e])&&!M(r[e])&&(r[e]={}),A(i[e])&&!A(r[e])&&(r[e]=[]),n(r[e],i[e],o)):i[e]!==t&&(r[e]=i[e])}(n,i,r)}),n},N.qsa=function(t,e){var n,r="#"==e[0],i=!r&&"."==e[0],o=r||i?e.slice(1):e,a=T.test(o);return t.getElementById&&a&&r?(n=t.getElementById(o))?[n]:[]:1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType?[]:c.call(a&&!r&&t.getElementsByClassName?i?t.getElementsByClassName(o):t.getElementsByTagName(e):t.querySelectorAll(e))},n.contains=l.documentElement.contains?function(t,e){return t!==e&&t.contains(e)}:function(t,e){for(;e&&(e=e.parentNode);)if(e===t)return!0;return!1},n.type=D,n.isFunction=L,n.isWindow=$,n.isArray=A,n.isPlainObject=M,n.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},n.isNumeric=function(t){var e=Number(t),n=typeof t;return null!=t&&"boolean"!=n&&("string"!=n||t.length)&&!isNaN(e)&&isFinite(e)||!1},n.inArray=function(t,e,n){return a.indexOf.call(e,t,n)},n.camelCase=i,n.trim=function(t){return null==t?"":String.prototype.trim.call(t)},n.uuid=0,n.support={},n.expr={},n.noop=function(){},n.map=function(t,e){var r,i,o,a,s=[];if(R(t))for(i=0;i<t.length;i++)null!=(r=e(t[i],i))&&s.push(r);else for(o in t)null!=(r=e(t[o],o))&&s.push(r);return(a=s).length>0?n.fn.concat.apply([],a):a},n.each=function(t,e){var n,r;if(R(t)){for(n=0;n<t.length;n++)if(!1===e.call(t[n],n,t[n]))return t}else for(r in t)if(!1===e.call(t[r],r,t[r]))return t;return t},n.grep=function(t,e){return u.call(t,e)},window.JSON&&(n.parseJSON=JSON.parse),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){S["[object "+e+"]"]=e.toLowerCase()}),n.fn={constructor:N.Z,length:0,forEach:a.forEach,reduce:a.reduce,push:a.push,sort:a.sort,splice:a.splice,indexOf:a.indexOf,concat:function(){var t,e,n=[];for(t=0;t<arguments.length;t++)e=arguments[t],n[t]=N.isZ(e)?e.toArray():e;return s.apply(N.isZ(this)?this.toArray():this,n)},map:function(t){return n(n.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return n(c.apply(this,arguments))},ready:function(t){return j.test(l.readyState)&&l.body?t(n):l.addEventListener("DOMContentLoaded",function(){t(n)},!1),this},get:function(e){return e===t?c.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(t){return a.every.call(this,function(e,n){return!1!==t.call(e,n,e)}),this},filter:function(t){return L(t)?this.not(this.not(t)):n(u.call(this,function(e){return N.matches(e,t)}))},add:function(t,e){return n(o(this.concat(n(t,e))))},is:function(t){return this.length>0&&N.matches(this[0],t)},not:function(e){var r=[];if(L(e)&&e.call!==t)this.each(function(t){e.call(this,t)||r.push(this)});else{var i="string"==typeof e?this.filter(e):R(e)&&L(e.item)?c.call(e):n(e);this.forEach(function(t){i.indexOf(t)<0&&r.push(t)})}return n(r)},has:function(t){return this.filter(function(){return k(t)?n.contains(this,t):n(this).find(t).size()})},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!k(t)?t:n(t)},last:function(){var t=this[this.length-1];return t&&!k(t)?t:n(t)},find:function(t){var e=this;return t?"object"==typeof t?n(t).filter(function(){var t=this;return a.some.call(e,function(e){return n.contains(e,t)})}):1==this.length?n(N.qsa(this[0],t)):this.map(function(){return N.qsa(this,t)}):n()},closest:function(t,e){var r=[],i="object"==typeof t&&n(t);return this.each(function(n,o){for(;o&&!(i?i.indexOf(o)>=0:N.matches(o,t));)o=o!==e&&!F(o)&&o.parentNode;o&&r.indexOf(o)<0&&r.push(o)}),n(r)},parents:function(t){for(var e=[],r=this;r.length>0;)r=n.map(r,function(t){if((t=t.parentNode)&&!F(t)&&e.indexOf(t)<0)return e.push(t),t});return V(e,t)},parent:function(t){return V(o(this.pluck("parentNode")),t)},children:function(t){return V(this.map(function(){return H(this)}),t)},contents:function(){return this.map(function(){return this.contentDocument||c.call(this.childNodes)})},siblings:function(t){return V(this.map(function(t,e){return u.call(H(e.parentNode),function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return n.map(this,function(e){return e[t]})},show:function(){return this.each(function(){var t,e,n;"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=(t=this.nodeName,f[t]||(e=l.createElement(t),l.body.appendChild(e),n=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==n&&(n="block"),f[t]=n),f[t]))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){var e=L(t);if(this[0]&&!e)var r=n(t).get(0),i=r.parentNode||this.length>1;return this.each(function(o){n(this).wrapAll(e?t.call(this,o):i?r.cloneNode(!0):r)})},wrapAll:function(t){if(this[0]){var e;for(n(this[0]).before(t=n(t));(e=t.children()).length;)t=e.first();n(t).append(this)}return this},wrapInner:function(t){var e=L(t);return this.each(function(r){var i=n(this),o=i.contents(),a=e?t.call(this,r):t;o.length?o.wrapAll(a):i.append(a)})},unwrap:function(){return this.parent().each(function(){n(this).replaceWith(n(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(e){return this.each(function(){var r=n(this);(e===t?"none"==r.css("display"):e)?r.show():r.hide()})},prev:function(t){return n(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return n(this.pluck("nextElementSibling")).filter(t||"*")},html:function(t){return 0 in arguments?this.each(function(e){var r=this.innerHTML;n(this).empty().append(_(this,t,e,r))}):0 in this?this[0].innerHTML:null},text:function(t){return 0 in arguments?this.each(function(e){var n=_(this,t,e,this.textContent);this.textContent=null==n?"":""+n}):0 in this?this.pluck("textContent").join(""):null},attr:function(n,r){var i;return"string"!=typeof n||1 in arguments?this.each(function(t){if(1===this.nodeType)if(k(n))for(e in n)B(this,e,n[e]);else B(this,n,_(this,r,t,this.getAttribute(n)))}):0 in this&&1==this[0].nodeType&&null!=(i=this[0].getAttribute(n))?i:t},removeAttr:function(t){return this.each(function(){1===this.nodeType&&t.split(" ").forEach(function(t){B(this,t)},this)})},prop:function(t,e){return t=P[t]||t,1 in arguments?this.each(function(n){this[t]=_(this,e,n,this[t])}):this[0]&&this[0][t]},removeProp:function(t){return t=P[t]||t,this.each(function(){delete this[t]})},data:function(e,n){var r="data-"+e.replace(y,"-$1").toLowerCase(),i=1 in arguments?this.attr(r,n):this.attr(r);return null!==i?X(i):t},val:function(t){return 0 in arguments?(null==t&&(t=""),this.each(function(e){this.value=_(this,t,e,this.value)})):this[0]&&(this[0].multiple?n(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(t){if(t)return this.each(function(e){var r=n(this),i=_(this,t,e,r.offset()),o=r.offsetParent().offset(),a={top:i.top-o.top,left:i.left-o.left};"static"==r.css("position")&&(a.position="relative"),r.css(a)});if(!this.length)return null;if(l.documentElement!==this[0]&&!n.contains(l.documentElement,this[0]))return{top:0,left:0};var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(t,r){if(arguments.length<2){var o=this[0];if("string"==typeof t){if(!o)return;return o.style[i(t)]||getComputedStyle(o,"").getPropertyValue(t)}if(A(t)){if(!o)return;var a={},s=getComputedStyle(o,"");return n.each(t,function(t,e){a[e]=o.style[i(e)]||s.getPropertyValue(e)}),a}}var u="";if("string"==D(t))r||0===r?u=Z(t)+":"+q(t,r):this.each(function(){this.style.removeProperty(Z(t))});else for(e in t)t[e]||0===t[e]?u+=Z(e)+":"+q(e,t[e])+";":this.each(function(){this.style.removeProperty(Z(e))});return this.each(function(){this.style.cssText+=";"+u})},index:function(t){return t?this.indexOf(n(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return!!t&&a.some.call(this,function(t){return this.test(U(t))},z(t))},addClass:function(t){return t?this.each(function(e){if("className"in this){r=[];var i=U(this);_(this,t,e,i).split(/\s+/g).forEach(function(t){n(this).hasClass(t)||r.push(t)},this),r.length&&U(this,i+(i?" ":"")+r.join(" "))}}):this},removeClass:function(e){return this.each(function(n){if("className"in this){if(e===t)return U(this,"");r=U(this),_(this,e,n,r).split(/\s+/g).forEach(function(t){r=r.replace(z(t)," ")}),U(this,r.trim())}})},toggleClass:function(e,r){return e?this.each(function(i){var o=n(this);_(this,e,i,U(this)).split(/\s+/g).forEach(function(e){(r===t?!o.hasClass(e):r)?o.addClass(e):o.removeClass(e)})}):this},scrollTop:function(e){if(this.length){var n="scrollTop"in this[0];return e===t?n?this[0].scrollTop:this[0].pageYOffset:this.each(n?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})}},scrollLeft:function(e){if(this.length){var n="scrollLeft"in this[0];return e===t?n?this[0].scrollLeft:this[0].pageXOffset:this.each(n?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})}},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),r=this.offset(),i=g.test(e[0].nodeName)?{top:0,left:0}:e.offset();return r.top-=parseFloat(n(t).css("margin-top"))||0,r.left-=parseFloat(n(t).css("margin-left"))||0,i.top+=parseFloat(n(e[0]).css("border-top-width"))||0,i.left+=parseFloat(n(e[0]).css("border-left-width"))||0,{top:r.top-i.top,left:r.left-i.left}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||l.body;t&&!g.test(t.nodeName)&&"static"==n(t).css("position");)t=t.offsetParent;return t})}},n.fn.detach=n.fn.remove,["width","height"].forEach(function(e){var r=e.replace(/./,function(t){return t[0].toUpperCase()});n.fn[e]=function(i){var o,a=this[0];return i===t?$(a)?a["inner"+r]:F(a)?a.documentElement["scroll"+r]:(o=this.offset())&&o[e]:this.each(function(t){(a=n(this)).css(e,_(this,i,t,a[e]()))})}}),["after","prepend","before","append"].forEach(function(e,r){var i=r%2;n.fn[e]=function(){var e,o,a=n.map(arguments,function(r){var i=[];return"array"==(e=D(r))?(r.forEach(function(e){return e.nodeType!==t?i.push(e):n.zepto.isZ(e)?i=i.concat(e.get()):void(i=i.concat(N.fragment(e)))}),i):"object"==e||null==r?r:N.fragment(r)}),s=this.length>1;return a.length<1?this:this.each(function(t,e){o=i?e:e.parentNode,e=0==r?e.nextSibling:1==r?e.firstChild:2==r?e:null;var u=n.contains(l.documentElement,o);a.forEach(function(t){if(s)t=t.cloneNode(!0);else if(!o)return n(t).remove();o.insertBefore(t,e),u&&function t(e,n){n(e);for(var r=0,i=e.childNodes.length;r<i;r++)t(e.childNodes[r],n)}(t,function(t){if(!(null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src)){var e=t.ownerDocument?t.ownerDocument.defaultView:window;e.eval.call(e,t.innerHTML)}})})})},n.fn[i?e+"To":"insert"+(r?"Before":"After")]=function(t){return n(t)[e](this),this}}),N.Z.prototype=I.prototype=n.fn,N.uniq=o,N.deserializeValue=X,n.zepto=N,n}();return window.Zepto=e,void 0===window.$&&(window.$=e),module.exports=e,function(t){var e,n=1,r=Array.prototype.slice,i=t.isFunction,o=function(t){return"string"==typeof t},a={},s={},u="onfocusin"in window,c={focus:"focusin",blur:"focusout"},l={mouseenter:"mouseover",mouseleave:"mouseout"};function f(t){return t._zid||(t._zid=n++)}function h(t,e,n,r){if((e=p(e)).ns)var i=(o=e.ns,new RegExp("(?:^| )"+o.replace(" "," .* ?")+"(?: |$)"));var o;return(a[f(t)]||[]).filter(function(t){return t&&(!e.e||t.e==e.e)&&(!e.ns||i.test(t.ns))&&(!n||f(t.fn)===f(n))&&(!r||t.sel==r)})}function p(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function d(t,e){return t.del&&!u&&t.e in c||!!e}function m(t){return l[t]||u&&c[t]||t}function v(n,r,i,o,s,u,c){var h=f(n),v=a[h]||(a[h]=[]);r.split(/\s/).forEach(function(r){if("ready"==r)return t(document).ready(i);var a=p(r);a.fn=i,a.sel=s,a.e in l&&(i=function(e){var n=e.relatedTarget;if(!n||n!==this&&!t.contains(this,n))return a.fn.apply(this,arguments)}),a.del=u;var f=u||i;a.proxy=function(t){if(!(t=E(t)).isImmediatePropagationStopped()){t.data=o;var r=f.apply(n,t._args==e?[t]:[t].concat(t._args));return!1===r&&(t.preventDefault(),t.stopPropagation()),r}},a.i=v.length,v.push(a),"addEventListener"in n&&n.addEventListener(m(a.e),a.proxy,d(a,c))})}function g(t,e,n,r,i){var o=f(t);(e||"").split(/\s/).forEach(function(e){h(t,e,n,r).forEach(function(e){delete a[o][e.i],"removeEventListener"in t&&t.removeEventListener(m(e.e),e.proxy,d(e,i))})})}s.click=s.mousedown=s.mouseup=s.mousemove="MouseEvents",t.event={add:v,remove:g},t.proxy=function(e,n){var a=2 in arguments&&r.call(arguments,2);if(i(e)){var s=function(){return e.apply(n,a?a.concat(r.call(arguments)):arguments)};return s._zid=f(e),s}if(o(n))return a?(a.unshift(e[n],e),t.proxy.apply(null,a)):t.proxy(e[n],e);throw new TypeError("expected function")},t.fn.bind=function(t,e,n){return this.on(t,e,n)},t.fn.unbind=function(t,e){return this.off(t,e)},t.fn.one=function(t,e,n,r){return this.on(t,e,n,r,1)};var y=function(){return!0},x=function(){return!1},b=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,w={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function E(n,r){return!r&&n.isDefaultPrevented||(r||(r=n),t.each(w,function(t,e){var i=r[t];n[t]=function(){return this[e]=y,i&&i.apply(r,arguments)},n[e]=x}),n.timeStamp||(n.timeStamp=Date.now()),(r.defaultPrevented!==e?r.defaultPrevented:"returnValue"in r?!1===r.returnValue:r.getPreventDefault&&r.getPreventDefault())&&(n.isDefaultPrevented=y)),n}function j(t){var n,r={originalEvent:t};for(n in t)b.test(n)||t[n]===e||(r[n]=t[n]);return E(r,t)}t.fn.delegate=function(t,e,n){return this.on(e,t,n)},t.fn.undelegate=function(t,e,n){return this.off(e,t,n)},t.fn.live=function(e,n){return t(document.body).delegate(this.selector,e,n),this},t.fn.die=function(e,n){return t(document.body).undelegate(this.selector,e,n),this},t.fn.on=function(n,a,s,u,c){var l,f,h=this;return n&&!o(n)?(t.each(n,function(t,e){h.on(t,a,s,e,c)}),h):(o(a)||i(u)||!1===u||(u=s,s=a,a=e),u!==e&&!1!==s||(u=s,s=e),!1===u&&(u=x),h.each(function(e,i){c&&(l=function(t){return g(i,t.type,u),u.apply(this,arguments)}),a&&(f=function(e){var n,o=t(e.target).closest(a,i).get(0);if(o&&o!==i)return n=t.extend(j(e),{currentTarget:o,liveFired:i}),(l||u).apply(o,[n].concat(r.call(arguments,1)))}),v(i,n,u,s,a,f||l)}))},t.fn.off=function(n,r,a){var s=this;return n&&!o(n)?(t.each(n,function(t,e){s.off(t,r,e)}),s):(o(r)||i(a)||!1===a||(a=r,r=e),!1===a&&(a=x),s.each(function(){g(this,n,a,r)}))},t.fn.trigger=function(e,n){return(e=o(e)||t.isPlainObject(e)?t.Event(e):E(e))._args=n,this.each(function(){e.type in c&&"function"==typeof this[e.type]?this[e.type]():"dispatchEvent"in this?this.dispatchEvent(e):t(this).triggerHandler(e,n)})},t.fn.triggerHandler=function(e,n){var r,i;return this.each(function(a,s){(r=j(o(e)?t.Event(e):e))._args=n,r.target=s,t.each(h(s,e.type||e),function(t,e){if(i=e.proxy(r),r.isImmediatePropagationStopped())return!1})}),i},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){t.fn[e]=function(t){return 0 in arguments?this.bind(e,t):this.trigger(e)}}),t.Event=function(t,e){o(t)||(t=(e=t).type);var n=document.createEvent(s[t]||"Events"),r=!0;if(e)for(var i in e)"bubbles"==i?r=!!e[i]:n[i]=e[i];return n.initEvent(t,r,!0),E(n)}}(e),function(t){var e,n,r=+new Date,i=window.document,o=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,a=/^(?:text|application)\/javascript/i,s=/^(?:text|application)\/xml/i,u="application/json",c="text/html",l=/^\s*$/,f=i.createElement("a");function h(e,n,r,o){if(e.global)return function(e,n,r){var i=t.Event(n);return t(e).trigger(i,r),!i.isDefaultPrevented()}(n||i,r,o)}function p(t,e){var n=e.context;if(!1===e.beforeSend.call(n,t,e)||!1===h(e,n,"ajaxBeforeSend",[t,e]))return!1;h(e,n,"ajaxSend",[t,e])}function d(t,e,n,r){var i=n.context;n.success.call(i,t,"success",e),r&&r.resolveWith(i,[t,"success",e]),h(n,i,"ajaxSuccess",[e,n,t]),v("success",e,n)}function m(t,e,n,r,i){var o=r.context;r.error.call(o,n,e,t),i&&i.rejectWith(o,[n,e,t]),h(r,o,"ajaxError",[n,r,t||e]),v(e,n,r)}function v(e,n,r){var i=r.context;r.complete.call(i,n,e),h(r,i,"ajaxComplete",[n,r]),function(e){e.global&&!--t.active&&h(e,null,"ajaxStop")}(r)}function g(){}function y(t,e){return""==e?t:(t+"&"+e).replace(/[&?]{1,2}/,"?")}function x(e,n,r,i){return t.isFunction(n)&&(i=r,r=n,n=void 0),t.isFunction(r)||(i=r,r=void 0),{url:e,data:n,success:r,dataType:i}}f.href=window.location.href,t.active=0,t.ajaxJSONP=function(e,n){if(!("type"in e))return t.ajax(e);var o,a,s=e.jsonpCallback,u=(t.isFunction(s)?s():s)||"Zepto"+r++,c=i.createElement("script"),l=window[u],f=function(e){t(c).triggerHandler("error",e||"abort")},h={abort:f};return n&&n.promise(h),t(c).on("load error",function(r,i){clearTimeout(a),t(c).off().remove(),"error"!=r.type&&o?d(o[0],h,e,n):m(null,i||"error",h,e,n),window[u]=l,o&&t.isFunction(l)&&l(o[0]),l=o=void 0}),!1===p(h,e)?(f("abort"),h):(window[u]=function(){o=arguments},c.src=e.url.replace(/\?(.+)=\?/,"?$1="+u),i.head.appendChild(c),e.timeout>0&&(a=setTimeout(function(){f("timeout")},e.timeout)),h)},t.ajaxSettings={type:"GET",beforeSend:g,success:g,error:g,complete:g,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:u,xml:"application/xml, text/xml",html:c,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0,dataFilter:g},t.ajax=function(r){var o,v,x=t.extend({},r||{}),b=t.Deferred&&t.Deferred();for(e in t.ajaxSettings)void 0===x[e]&&(x[e]=t.ajaxSettings[e]);!function(e){e.global&&0==t.active++&&h(e,null,"ajaxStart")}(x),x.crossDomain||((o=i.createElement("a")).href=x.url,o.href=o.href,x.crossDomain=f.protocol+"//"+f.host!=o.protocol+"//"+o.host),x.url||(x.url=window.location.toString()),(v=x.url.indexOf("#"))>-1&&(x.url=x.url.slice(0,v)),function(e){e.processData&&e.data&&"string"!=t.type(e.data)&&(e.data=t.param(e.data,e.traditional)),!e.data||e.type&&"GET"!=e.type.toUpperCase()&&"jsonp"!=e.dataType||(e.url=y(e.url,e.data),e.data=void 0)}(x);var w=x.dataType,E=/\?.+=\?/.test(x.url);if(E&&(w="jsonp"),!1!==x.cache&&(r&&!0===r.cache||"script"!=w&&"jsonp"!=w)||(x.url=y(x.url,"_="+Date.now())),"jsonp"==w)return E||(x.url=y(x.url,x.jsonp?x.jsonp+"=?":!1===x.jsonp?"":"callback=?")),t.ajaxJSONP(x,b);var j,T=x.accepts[w],S={},C=function(t,e){S[t.toLowerCase()]=[t,e]},N=/^([\w-]+:)\/\//.test(x.url)?RegExp.$1:window.location.protocol,O=x.xhr(),P=O.setRequestHeader;if(b&&b.promise(O),x.crossDomain||C("X-Requested-With","XMLHttpRequest"),C("Accept",T||"*/*"),(T=x.mimeType||T)&&(T.indexOf(",")>-1&&(T=T.split(",",2)[0]),O.overrideMimeType&&O.overrideMimeType(T)),(x.contentType||!1!==x.contentType&&x.data&&"GET"!=x.type.toUpperCase())&&C("Content-Type",x.contentType||"application/x-www-form-urlencoded"),x.headers)for(n in x.headers)C(n,x.headers[n]);if(O.setRequestHeader=C,O.onreadystatechange=function(){if(4==O.readyState){O.onreadystatechange=g,clearTimeout(j);var e,n=!1;if(O.status>=200&&O.status<300||304==O.status||0==O.status&&"file:"==N){if(w=w||((r=x.mimeType||O.getResponseHeader("content-type"))&&(r=r.split(";",2)[0]),r&&(r==c?"html":r==u?"json":a.test(r)?"script":s.test(r)&&"xml")||"text"),"arraybuffer"==O.responseType||"blob"==O.responseType)e=O.response;else{e=O.responseText;try{e=function(t,e,n){if(n.dataFilter==g)return t;var r=n.context;return n.dataFilter.call(r,t,e)}(e,w,x),"script"==w?(0,eval)(e):"xml"==w?e=O.responseXML:"json"==w&&(e=l.test(e)?null:t.parseJSON(e))}catch(i){n=i}if(n)return m(n,"parsererror",O,x,b)}d(e,O,x,b)}else m(O.statusText||null,O.status?"error":"abort",O,x,b)}var r},!1===p(O,x))return O.abort(),m(null,"abort",O,x,b),O;var A=!("async"in x)||x.async;if(O.open(x.type,x.url,A,x.username,x.password),x.xhrFields)for(n in x.xhrFields)O[n]=x.xhrFields[n];for(n in S)P.apply(O,S[n]);return x.timeout>0&&(j=setTimeout(function(){O.onreadystatechange=g,O.abort(),m(null,"timeout",O,x,b)},x.timeout)),O.send(x.data?x.data:null),O},t.get=function(){return t.ajax(x.apply(null,arguments))},t.post=function(){var e=x.apply(null,arguments);return e.type="POST",t.ajax(e)},t.getJSON=function(){var e=x.apply(null,arguments);return e.dataType="json",t.ajax(e)},t.fn.load=function(e,n,r){if(!this.length)return this;var i,a=this,s=e.split(/\s/),u=x(e,n,r),c=u.success;return s.length>1&&(u.url=s[0],i=s[1]),u.success=function(e){a.html(i?t("<div>").html(e.replace(o,"")).find(i):e),c&&c.apply(a,arguments)},t.ajax(u),this};var b=encodeURIComponent;t.param=function(e,n){var r=[];return r.add=function(e,n){t.isFunction(n)&&(n=n()),null==n&&(n=""),this.push(b(e)+"="+b(n))},function e(n,r,i,o){var a,s=t.isArray(r),u=t.isPlainObject(r);t.each(r,function(r,c){a=t.type(c),o&&(r=i?o:o+"["+(u||"object"==a||"array"==a?r:"")+"]"),!o&&s?n.add(c.name,c.value):"array"==a||!i&&"object"==a?e(n,c,i,r):n.add(r,c)})}(r,e,n),r.join("&").replace(/%20/g,"+")}}(e),(t=e).fn.serializeArray=function(){var e,n,r=[],i=function(t){if(t.forEach)return t.forEach(i);r.push({name:e,value:t})};return this[0]&&t.each(this[0].elements,function(r,o){n=o.type,(e=o.name)&&"fieldset"!=o.nodeName.toLowerCase()&&!o.disabled&&"submit"!=n&&"reset"!=n&&"button"!=n&&"file"!=n&&("radio"!=n&&"checkbox"!=n||o.checked)&&i(t(o).val())}),r},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(0 in arguments)this.bind("submit",e);else if(this.length){var n=t.Event("submit");this.eq(0).trigger(n),n.isDefaultPrevented()||this.get(0).submit()}return this},function(){try{getComputedStyle(void 0)}catch(e){var t=getComputedStyle;window.getComputedStyle=function(n,r){try{return t(n,r)}catch(e){return null}}}}(),e});
},{}],"E0Kg":[function(require,module,exports) {
var define;
var global = arguments[3];
var e,t=arguments[3];!function(r){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=r();else if("function"==typeof e&&e.amd)e([],r);else{("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:this).adapter=r()}}(function(){return function(){return function e(t,r,n){function i(o,s){if(!r[o]){if(!t[o]){var c="function"==typeof require&&require;if(!s&&c)return c(o,!0);if(a)return a(o,!0);var d=new Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var p=r[o]={exports:{}};t[o][0].call(p.exports,function(e){return i(t[o][1][e]||e)},p,p.exports,e,t,r,n)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}}()({1:[function(e,t,r){"use strict";var n=(0,e("./adapter_factory.js").adapterFactory)({window:window});t.exports=n},{"./adapter_factory.js":2}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.adapterFactory=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).window,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},r=n.log,d=n.detectBrowser(e),p={browserDetails:d,commonShim:c,extractVersion:n.extractVersion,disableLog:n.disableLog,disableWarnings:n.disableWarnings};switch(d.browser){case"chrome":if(!i||!i.shimPeerConnection||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),p;r("adapter.js shimming chrome."),p.browserShim=i,i.shimGetUserMedia(e),i.shimMediaStream(e),i.shimPeerConnection(e),i.shimOnTrack(e),i.shimAddTrackRemoveTrack(e),i.shimGetSendersWithDtmf(e),i.shimGetStats(e),i.shimSenderReceiverGetStats(e),i.fixNegotiationNeeded(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;case"firefox":if(!o||!o.shimPeerConnection||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),p;r("adapter.js shimming firefox."),p.browserShim=o,o.shimGetUserMedia(e),o.shimPeerConnection(e),o.shimOnTrack(e),o.shimRemoveStream(e),o.shimSenderGetStats(e),o.shimReceiverGetStats(e),o.shimRTCDataChannel(e),o.shimAddTransceiver(e),o.shimCreateOffer(e),o.shimCreateAnswer(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"edge":if(!a||!a.shimPeerConnection||!t.shimEdge)return r("MS edge shim is not included in this adapter release."),p;r("adapter.js shimming edge."),p.browserShim=a,a.shimGetUserMedia(e),a.shimGetDisplayMedia(e),a.shimPeerConnection(e),a.shimReplaceTrack(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"safari":if(!s||!t.shimSafari)return r("Safari shim is not included in this adapter release."),p;r("adapter.js shimming safari."),p.browserShim=s,s.shimRTCIceServerUrls(e),s.shimCreateOfferLegacy(e),s.shimCallbacksAPI(e),s.shimLocalStreamsAPI(e),s.shimRemoteStreamsAPI(e),s.shimTrackEventTransceiver(e),s.shimGetUserMedia(e),c.shimRTCIceCandidate(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;default:r("Unsupported browser!")}return p};var n=d(e("./utils")),i=d(e("./chrome/chrome_shim")),a=d(e("./edge/edge_shim")),o=d(e("./firefox/firefox_shim")),s=d(e("./safari/safari_shim")),c=d(e("./common_shim"));function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}});var a=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}}),r.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},r.shimOnTrack=function(e){if("object"!==(void 0===e?"undefined":n(e))||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)o.wrapPeerConnectionEvent(e,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e});else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",function(n){var i=void 0;i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find(function(e){return e.track&&e.track.id===n.track.id}):{track:n.track};var a=new Event("track");a.track=n.track,a.receiver=i,a.transceiver={receiver:i},a.streams=[t.stream],r.dispatchEvent(a)}),t.stream.getTracks().forEach(function(n){var i=void 0;i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find(function(e){return e.track&&e.track.id===n.id}):{track:n};var a=new Event("track");a.track=n,a.receiver=i,a.transceiver={receiver:i},a.streams=[t.stream],r.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}},r.shimGetSendersWithDtmf=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var i=r.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var a=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._senders=this._senders||[],a.apply(this,[e]),e.getTracks().forEach(function(e){r._senders.push(t(r,e))})};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach(function(e){var r=t._senders.find(function(t){return t.track===e});r&&t._senders.splice(t._senders.indexOf(r),1)})}}else if("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var s=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=s.apply(this,[]);return t.forEach(function(t){return t._pc=e}),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},r.shimGetStats=function(e){if(!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,r=Array.prototype.slice.call(arguments),n=r[0],i=r[1],a=r[2];if(arguments.length>0&&"function"==typeof n)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof n))return t.apply(this,[]);var o=function(e){var t={},r=e.result();return r.forEach(function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){r[t]=e.stat(t)}),t[r.id]=r}),t},s=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};if(arguments.length>=2){return t.apply(this,[function(e){i(s(o(e)))},n])}return new Promise(function(r,n){t.apply(e,[function(e){r(s(o(e)))},n])}).then(i,a)}},r.shimSenderReceiverGetStats=function(e){if(!("object"===(void 0===e?"undefined":n(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach(function(t){return t._pc=e}),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return o.filterStats(t,e.track,!0)})}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var i=e.RTCPeerConnection.prototype.getReceivers;i&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=i.apply(this,[]);return t.forEach(function(t){return t._pc=e}),t}),o.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return o.filterStats(t,e.track,!1)})}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype))return;var a=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],r=void 0,n=void 0,i=void 0;return this.getSenders().forEach(function(e){e.track===t&&(r?i=!0:r=e)}),this.getReceivers().forEach(function(e){return e.track===t&&(n?i=!0:n=e),e.track===t}),i||r&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return a.apply(this,arguments)}},r.shimAddTrackRemoveTrackWithNative=c,r.shimAddTrackRemoveTrack=function(e){if(!e.RTCPeerConnection)return;var t=o.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return c(e);var r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=r.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map(function(t){return e._reverseStreams[t.id]})};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach(function(e){var t=r.getSenders().find(function(t){return t.track===e});if(t)throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){var i=new e.MediaStream(t.getTracks());this._streams[t.id]=i,this._reverseStreams[i.id]=t,t=i}n.apply(this,[t])};var i=e.RTCPeerConnection.prototype.removeStream;function a(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(i.id,"g"),n.id)}),new RTCSessionDescription({type:t.type,sdp:r})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var a=this.getSenders().find(function(e){return e.track===t});if(a)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var o=this._streams[r.id];if(o)o.addTrack(t),Promise.resolve().then(function(){n.dispatchEvent(new Event("negotiationneeded"))});else{var s=new e.MediaStream([t]);this._streams[r.id]=s,this._reverseStreams[s.id]=r,this.addStream(s)}return this.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t],n=s({},t,function(){var e=this,t=arguments,n=arguments.length&&"function"==typeof arguments[0];return n?r.apply(this,[function(r){var n=a(e,r);t[0].apply(null,[n])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):r.apply(this,arguments).then(function(t){return a(e,t)})});e.RTCPeerConnection.prototype[t]=n[t]});var d=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,t=arguments[0],r=t.sdp,Object.keys(e._reverseStreams||[]).forEach(function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(n.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:r})),d.apply(this,arguments)):d.apply(this,arguments);var e,t,r};var p=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=p.get.apply(this);return""===e.type?e:a(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");var r=e._pc===this;if(!r)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var n=void 0;Object.keys(this._streams).forEach(function(r){var i=t._streams[r].getTracks().find(function(t){return e.track===t});i&&(n=t._streams[r])}),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}},r.shimPeerConnection=function(e){var t=o.detectBrowser(e);!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection);if(!e.RTCPeerConnection)return;t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t],n=s({},t,function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)});e.RTCPeerConnection.prototype[t]=n[t]});var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}},r.fixNegotiationNeeded=function(e){o.wrapPeerConnectionEvent(e,"negotiationneeded",function(e){var t=e.target;if("stable"===t.signalingState)return e})};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils.js"));function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(t){return e._shimmedLocalStreams[t][0]})};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(e){if(t.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")});var n=this.getSenders();r.apply(this,arguments);var i=this.getSenders().filter(function(e){return-1===n.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(i)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(function(r){var n=t._shimmedLocalStreams[r].indexOf(e);-1!==n&&t._shimmedLocalStreams[r].splice(n,1),1===t._shimmedLocalStreams[r].length&&delete t._shimmedLocalStreams[r]}),i.apply(this,arguments)}}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e,t){if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;if(!e.navigator.mediaDevices)return;if("function"!=typeof t)return void console.error("shimGetDisplayMedia: getSourceId argument is not a function");e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then(function(t){var n=r.video&&r.video.width,i=r.video&&r.video.height,a=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:a||3}},n&&(r.video.mandatory.maxWidth=n),i&&(r.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(r)})}}},{}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var t=e&&e.navigator;if(!t.mediaDevices)return;var r=i.detectBrowser(e),o=function(e){if("object"!==(void 0===e?"undefined":n(e))||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var i="object"===n(e[r])?e[r]:{ideal:e[r]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);var a=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];var o={};"number"==typeof i.ideal?(o[a("min",r)]=i.ideal,t.optional.push(o),(o={})[a("max",r)]=i.ideal,t.optional.push(o)):(o[a("",r)]=i.ideal,t.optional.push(o))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[a("",r)]=i.exact):["min","max"].forEach(function(e){void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[a(e,r)]=i[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,i){if(r.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===n(e.audio)){var s=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};e=JSON.parse(JSON.stringify(e)),s(e.audio,"autoGainControl","googAutoGainControl"),s(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=o(e.audio)}if(e&&"object"===n(e.video)){var c=e.video.facingMode;c=c&&("object"===(void 0===c?"undefined":n(c))?c:{ideal:c});var d=r.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||d)){delete e.video.facingMode;var p=void 0;if("environment"===c.exact||"environment"===c.ideal?p=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(p=["front"]),p)return t.mediaDevices.enumerateDevices().then(function(t){var r=(t=t.filter(function(e){return"videoinput"===e.kind})).find(function(e){return p.some(function(t){return e.label.toLowerCase().includes(t)})});return!r&&t.length&&p.includes("back")&&(r=t[t.length-1]),r&&(e.video.deviceId=c.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=o(e.video),a("chrome: "+JSON.stringify(e)),i(e)})}e.video=o(e.video)}return a("chrome: "+JSON.stringify(e)),i(e)},c=function(e){return r.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,r,n){s(e,function(e){t.webkitGetUserMedia(e,r,function(e){n&&n(c(e))})})}.bind(t),t.mediaDevices.getUserMedia){var d=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return s(e,function(e){return d(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return t},function(e){return Promise.reject(c(e))})})}}};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils.js"));var a=i.log},{"../utils.js":15}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimRTCIceCandidate=function(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===(void 0===e?"undefined":n(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var r=new t(e),i=o.default.parseCandidate(e.candidate),a=Object.assign(r,i);return a.toJSON=function(){return{candidate:a.candidate,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex,usernameFragment:a.usernameFragment}},a}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,s.wrapPeerConnectionEvent(e,"icecandidate",function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t})},r.shimMaxMessageSize=function(e){if(!e.RTCPeerConnection)return;var t=s.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var e=this.getConfiguration(),n=e.sdpSemantics;"plan-b"===n&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;var t=o.default.splitSections(e.sdp);return t.shift(),t.some(function(e){var t=o.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})}(arguments[0])){var i=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r}(arguments[0]),a=function(e){var r=65536;"firefox"===t.browser&&(r=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637);return r}(i),s=function(e,r){var n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);var i=o.default.matchPrefix(e.sdp,"a=max-message-size:");i.length>0?n=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(n=2147483637);return n}(arguments[0],i),c=void 0;c=0===a&&0===s?Number.POSITIVE_INFINITY:0===a||0===s?Math.max(a,s):Math.min(a,s);var d={};Object.defineProperty(d,"maxMessageSize",{get:function(){return c}}),this._sctp=d}return r.apply(this,arguments)}},r.shimSendThrowTypeError=function(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){var r=e.send;e.send=function(){var n=arguments[0],i=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}var r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=r.apply(this,arguments);return t(e,this),e},s.wrapPeerConnectionEvent(e,"datachannel",function(e){return t(e.channel,e.target),e})},r.shimConnectionState=function(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(e){var r=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})},r.removeAllowExtmapMixed=function(e){if(!e.RTCPeerConnection)return;var t=s.detectBrowser(e);if("chrome"===t.browser&&t.version>=71)return;var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n")),r.apply(this,arguments)}};var i,a=e("sdp"),o=(i=a)&&i.__esModule?i:{default:i},s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("./utils"))},{"./utils":15,sdp:17}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var n=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var i=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),r.shimPeerConnection=function(e){var t=o.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var r=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){r.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}});e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var n=(0,d.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,s.filterIceServers)(e.iceServers,t.version),o.log("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype},r.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};var a,o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils")),s=e("./filtericeservers"),c=e("rtcpeerconnection-shim"),d=(a=c)&&a.__esModule?a:{default:a}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.filterIceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&n.deprecated("RTCIceServer.url","RTCIceServer.urls");var i="string"==typeof t;return i&&(t=[t]),t=t.filter(function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!r?(r=!0,!0):t&&!r}),delete e.url,e.urls=i?t[0]:t,!!t.length}})};var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"))},{"../utils":15}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e){if(!("getDisplayMedia"in e.navigator))return;if(!e.navigator.mediaDevices)return;if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)}},{}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetUserMedia=function(e){var t=e&&e.navigator,r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e).catch(function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))})}}},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}});var a=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}}),r.shimOnTrack=function(e){"object"===(void 0===e?"undefined":n(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimPeerConnection=function(e){var t=o.detectBrowser(e);if("object"!==(void 0===e?"undefined":n(e))||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection);t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t],n=function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r;return e}({},t,function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)});e.RTCPeerConnection.prototype[t]=n[t]});if(t.version<68){var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},a=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),r=e[0],n=e[1],o=e[2];return a.apply(this,[r||null]).then(function(e){if(t.version<53&&!n)try{e.forEach(function(e){e.type=i[e.type]||e.type})}catch(r){if("TypeError"!==r.name)throw r;e.forEach(function(t,r){e.set(r,Object.assign({},t,{type:i[t.type]||t.type}))})}return e}).then(n,o)}},r.shimSenderGetStats=function(e){if("object"!==(void 0===e?"undefined":n(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach(function(t){return t._pc=e}),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e});e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}},r.shimReceiverGetStats=function(e){if("object"!==(void 0===e?"undefined":n(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,r=t.apply(this,[]);return r.forEach(function(t){return t._pc=e}),r});o.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}},r.shimRemoveStream=function(e){if(!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype)return;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;o.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(r){r.track&&e.getTracks().includes(r.track)&&t.removeTrack(r)})}},r.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},r.shimAddTransceiver=function(e){if("object"!==(void 0===e?"undefined":n(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],r=e&&"sendEncodings"in e;r&&e.sendEncodings.forEach(function(e){if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});var n=t.apply(this,arguments);if(r){var i=n.sender,a=i.getParameters();"encodings"in a||(a.encodings=e.sendEncodings,this.setParametersPromises.push(i.setParameters(a).catch(function(){})))}return n})},r.shimCreateOffer=function(e){if("object"!==(void 0===e?"undefined":n(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=this,r=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return t.apply(e,r)}).finally(function(){e.setParametersPromises=[]}):t.apply(this,arguments)}},r.shimCreateAnswer=function(e){if("object"!==(void 0===e?"undefined":n(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=this,r=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return t.apply(e,r)}).finally(function(){e.setParametersPromises=[]}):t.apply(this,arguments)}};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e,t){if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;if(!e.navigator.mediaDevices)return;e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){var n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)}}},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var t=i.detectBrowser(e),r=e&&e.navigator,a=e&&e.MediaStreamTrack;if(r.getUserMedia=function(e,t,n){i.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,n)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var o=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},s=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":n(e))&&"object"===n(e.audio)&&(e=JSON.parse(JSON.stringify(e)),o(e.audio,"autoGainControl","mozAutoGainControl"),o(e.audio,"noiseSuppression","mozNoiseSuppression")),s(e)},a&&a.prototype.getSettings){var c=a.prototype.getSettings;a.prototype.getSettings=function(){var e=c.apply(this,arguments);return o(e,"mozAutoGainControl","autoGainControl"),o(e,"mozNoiseSuppression","noiseSuppression"),e}}if(a&&a.prototype.applyConstraints){var d=a.prototype.applyConstraints;a.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":n(e))&&(e=JSON.parse(JSON.stringify(e)),o(e,"autoGainControl","mozAutoGainControl"),o(e,"noiseSuppression","mozNoiseSuppression")),d.apply(this,[e])}}}};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"))},{"../utils":15}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimLocalStreamsAPI=function(e){if("object"!==(void 0===e?"undefined":n(e))||!e.RTCPeerConnection)return;"getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams});if(!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach(function(n){return t.call(r,n,e)}),e.getVideoTracks().forEach(function(n){return t.call(r,n,e)})},e.RTCPeerConnection.prototype.addTrack=function(e){var r=arguments[1];return r&&(this._localStreams?this._localStreams.includes(r)||this._localStreams.push(r):this._localStreams=[r]),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e);if(-1!==r){this._localStreams.splice(r,1);var n=e.getTracks();this.getSenders().forEach(function(e){n.includes(e.track)&&t.removeTrack(e)})}})},r.shimRemoteStreamsAPI=function(e){if("object"!==(void 0===e?"undefined":n(e))||!e.RTCPeerConnection)return;"getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]});if(!("onaddstream"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e,t.dispatchEvent(r)}})})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}})}),t.apply(e,arguments)}}},r.shimCallbacksAPI=function(e){if("object"!==(void 0===e?"undefined":n(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype,r=t.createOffer,i=t.createAnswer,a=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],n=i.apply(this,[r]);return t?(n.then(e,t),Promise.resolve()):n};var c=function(e,t,r){var n=a.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=c,c=function(e,t,r){var n=o.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.setRemoteDescription=c,c=function(e,t,r){var n=s.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=c},r.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r=t.mediaDevices,n=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=function(e){return n(a(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,n){t.mediaDevices.getUserMedia(e).then(r,n)}.bind(t))},r.shimConstraints=a,r.shimRTCIceServerUrls=function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var n=[],a=0;a<e.iceServers.length;a++){var o=e.iceServers[a];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(i.deprecated("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,delete o.url,n.push(o)):n.push(e.iceServers[a])}e.iceServers=n}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},r.shimTrackEventTransceiver=function(e){"object"===(void 0===e?"undefined":n(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind});!1===e.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveAudio||r||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var n=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind});!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"));function a(e){return e&&void 0!==e.video?Object.assign({},e,{video:i.compactObject(e.video)}):e}},{"../utils":15}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.extractVersion=o,r.wrapPeerConnectionEvent=function(e,t,r){if(!e.RTCPeerConnection)return;var n=e.RTCPeerConnection.prototype,i=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return i.apply(this,arguments);var a=function(e){var t=r(e);t&&n(t)};return this._eventMap=this._eventMap||{},this._eventMap[n]=a,i.apply(this,[e,a])};var a=n.removeEventListener;n.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[r])return a.apply(this,arguments);var n=this._eventMap[r];return delete this._eventMap[r],a.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})},r.disableLog=function(e){if("boolean"!=typeof e)return new Error("Argument type: "+(void 0===e?"undefined":n(e))+". Please use a boolean.");return i=e,e?"adapter.js logging disabled":"adapter.js logging enabled"},r.disableWarnings=function(e){if("boolean"!=typeof e)return new Error("Argument type: "+(void 0===e?"undefined":n(e))+". Please use a boolean.");return a=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled")},r.log=function(){if("object"===("undefined"==typeof window?"undefined":n(window))){if(i)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},r.deprecated=function(e,t){if(!a)return;console.warn(e+" is deprecated, please use "+t+" instead.")},r.detectBrowser=function(e){var t=e.navigator,r={browser:null,version:null};if(void 0===e||!e.navigator)return r.browser="Not a browser.",r;if(t.mozGetUserMedia)r.browser="firefox",r.version=o(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)r.browser="chrome",r.version=o(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))r.browser="edge",r.version=o(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return r.browser="Not a supported browser.",r;r.browser="safari",r.version=o(t.userAgent,/AppleWebKit\/(\d+)\./,1),r.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return r},r.compactObject=function e(t){if(!s(t))return t;return Object.keys(t).reduce(function(r,n){var i=s(t[n]),a=i?e(t[n]):t[n],o=i&&!Object.keys(a).length;return void 0===a||o?r:Object.assign(r,function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r;return e}({},n,a))},{})},r.walkStats=c,r.filterStats=function(e,t,r){var n=r?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var a=[];return e.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)}),a.forEach(function(t){e.forEach(function(r){r.type===n&&r.trackId===t.id&&c(e,r,i)})}),i};var i=!0,a=!0;function o(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function s(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach(function(n){n.endsWith("Id")?c(e,e.get(t[n]),r):n.endsWith("Ids")&&t[n].forEach(function(t){c(e,e.get(t),r)})}))}},{}],16:[function(e,t,r){"use strict";var n=e("sdp");function i(e,t,r,i,a){var o=n.writeRtpDescription(e.kind,t);if(o+=n.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=n.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":a||"active"),o+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var c="msid:"+(i?i.id:"-")+" "+s+"\r\n";o+="a="+c,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+n.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+n.localCName+"\r\n"),o}function a(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},n=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]},i=function(e,t,r,i){var a=n(e.parameters.apt,r),o=n(t.parameters.apt,i);return a&&o&&a.name.toLowerCase()===o.name.toLowerCase()};return e.codecs.forEach(function(n){for(var a=0;a<t.codecs.length;a++){var o=t.codecs[a];if(n.name.toLowerCase()===o.name.toLowerCase()&&n.clockRate===o.clockRate){if("rtx"===n.name.toLowerCase()&&n.parameters&&o.parameters.apt&&!i(n,o,e.codecs,t.codecs))continue;(o=JSON.parse(JSON.stringify(o))).numChannels=Math.min(n.numChannels,o.numChannels),r.codecs.push(o),o.rtcpFeedback=o.rtcpFeedback.filter(function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var n=0;n<t.headerExtensions.length;n++){var i=t.headerExtensions[n];if(e.uri===i.uri){r.headerExtensions.push(i);break}}}),r}function o(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function s(e,t){var r=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return r||e.addRemoteCandidate(t),!r}function c(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}t.exports=function(e,t){function r(t,r){r.addTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function d(t,r,n,i){var a=new Event("track");a.track=r,a.receiver=n,a.transceiver={receiver:n},a.streams=i,e.setTimeout(function(){t._dispatchEvent("track",a)})}var p=function(r){var i=this,a=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){i[e]=a[e].bind(a)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",r=JSON.parse(JSON.stringify(r||{})),this.usingBundle="max-bundle"===r.bundlePolicy,"negotiate"===r.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(r.rtcpMuxPolicy||(r.rtcpMuxPolicy="require"),r.iceTransportPolicy){case"all":case"relay":break;default:r.iceTransportPolicy="all"}switch(r.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:r.bundlePolicy="balanced"}if(r.iceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var n=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof n;return i&&(n=[n]),n=n.filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||r?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(r=!0,!0)}),delete e.url,e.urls=i?n[0]:n,!!n.length}})}(r.iceServers||[],t),this._iceGatherers=[],r.iceCandidatePoolSize)for(var o=r.iceCandidatePoolSize;o>0;o--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:r.iceServers,gatherPolicy:r.iceTransportPolicy}));else r.iceCandidatePoolSize=0;this._config=r,this.transceivers=[],this._sdpSessionId=n.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(p.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(p.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),p.prototype.onicecandidate=null,p.prototype.onaddstream=null,p.prototype.ontrack=null,p.prototype.onremovestream=null,p.prototype.onsignalingstatechange=null,p.prototype.oniceconnectionstatechange=null,p.prototype.onconnectionstatechange=null,p.prototype.onicegatheringstatechange=null,p.prototype.onnegotiationneeded=null,p.prototype.ondatachannel=null,p.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},p.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},p.prototype.getConfiguration=function(){return this._config},p.prototype.getLocalStreams=function(){return this.localStreams},p.prototype.getRemoteStreams=function(){return this.remoteStreams},p.prototype._createTransceiver=function(e,t){var r=this.transceivers.length>0,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();n.iceTransport=i.iceTransport,n.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(n),n},p.prototype.addTrack=function(t,r){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var n;if(this.transceivers.find(function(e){return e.track===t}))throw c("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(n=this.transceivers[i]);return n||(n=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(r)&&this.localStreams.push(r),n.track=t,n.stream=r,n.rtpSender=new e.RTCRtpSender(t,n.dtlsTransport),n.rtpSender},p.prototype.addStream=function(e){var r=this;if(t>=15025)e.getTracks().forEach(function(t){r.addTrack(t,e)});else{var n=e.clone();e.getTracks().forEach(function(e,t){var r=n.getTracks()[t];e.addEventListener("enabled",function(e){r.enabled=e.enabled})}),n.getTracks().forEach(function(e){r.addTrack(e,n)})}},p.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var r=this.transceivers.find(function(e){return e.rtpSender===t});if(!r)throw c("InvalidAccessError","Sender was not created by this connection.");var n=r.stream;r.rtpSender.stop(),r.rtpSender=null,r.track=null,r.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(n)&&this.localStreams.indexOf(n)>-1&&this.localStreams.splice(this.localStreams.indexOf(n),1),this._maybeFireNegotiationNeeded()},p.prototype.removeStream=function(e){var t=this;e.getTracks().forEach(function(e){var r=t.getSenders().find(function(t){return t.track===e});r&&t.removeTrack(r)})},p.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},p.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},p.prototype._createIceGatherer=function(t,r){var n=this;if(r&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var r=!e.candidate||0===Object.keys(e.candidate).length;i.state=r?"completed":"gathering",null!==n.transceivers[t].bufferedCandidateEvents&&n.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},p.prototype._gather=function(t,r){var i=this,a=this.transceivers[r].iceGatherer;if(!a.onlocalcandidate){var o=this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null,a.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates),a.onlocalcandidate=function(e){if(!(i.usingBundle&&r>0)){var o=new Event("icecandidate");o.candidate={sdpMid:t,sdpMLineIndex:r};var s=e.candidate,c=!s||0===Object.keys(s).length;if(c)"new"!==a.state&&"gathering"!==a.state||(a.state="completed");else{"new"===a.state&&(a.state="gathering"),s.component=1,s.ufrag=a.getLocalParameters().usernameFragment;var d=n.writeCandidate(s);o.candidate=Object.assign(o.candidate,n.parseCandidate(d)),o.candidate.candidate=d,o.candidate.toJSON=function(){return{candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex,usernameFragment:o.candidate.usernameFragment}}}var p=n.getMediaSections(i._localDescription.sdp);p[o.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+o.candidate.candidate+"\r\n",i._localDescription.sdp=n.getDescription(i._localDescription.sdp)+p.join("");var u=i.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),c||i._dispatchEvent("icecandidate",o),u&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout(function(){o.forEach(function(e){a.onlocalcandidate(e)})},0)}},p.prototype._createIceAndDtlsTransports=function(){var t=this,r=new e.RTCIceTransport(null);r.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var n=new e.RTCDtlsTransport(r);return n.ondtlsstatechange=function(){t._updateConnectionState()},n.onerror=function(){Object.defineProperty(n,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:r,dtlsTransport:n}},p.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var n=this.transceivers[e].dtlsTransport;n&&(delete n.ondtlsstatechange,delete n.onerror,delete this.transceivers[e].dtlsTransport)},p.prototype._transceive=function(e,r,i){var o=a(e.localCapabilities,e.remoteCapabilities);r&&e.rtpSender&&(o.encodings=e.sendEncodingParameters,o.rtcp={cname:n.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(o.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(o)),i&&e.rtpReceiver&&o.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),e.recvEncodingParameters.length?o.encodings=e.recvEncodingParameters:o.encodings=[{}],o.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(o.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(o.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(o))},p.prototype.setLocalDescription=function(e){var t,r,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!o("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=n.splitSections(e.sdp),r=t.shift(),t.forEach(function(e,t){var r=n.parseRtpParameters(e);i.transceivers[t].localCapabilities=r}),i.transceivers.forEach(function(e,t){i._gather(e.mid,t)});else if("answer"===e.type){t=n.splitSections(i._remoteDescription.sdp),r=t.shift();var s=n.matchPrefix(r,"a=ice-lite").length>0;t.forEach(function(e,t){var o=i.transceivers[t],c=o.iceGatherer,d=o.iceTransport,p=o.dtlsTransport,u=o.localCapabilities,f=o.remoteCapabilities;if(!(n.isRejected(e)&&0===n.matchPrefix(e,"a=bundle-only").length)&&!o.rejected){var l=n.getIceParameters(e,r),m=n.getDtlsParameters(e,r);s&&(m.role="server"),i.usingBundle&&0!==t||(i._gather(o.mid,t),"new"===d.state&&d.start(c,l,s?"controlling":"controlled"),"new"===p.state&&p.start(m));var h=a(u,f);i._transceive(o,h.codecs.length>0,!1)}})}return i._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},p.prototype.setRemoteDescription=function(i){var p=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(c("TypeError",'Unsupported type "'+i.type+'"'));if(!o("setRemoteDescription",i.type,p.signalingState)||p._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+i.type+" in state "+p.signalingState));var u={};p.remoteStreams.forEach(function(e){u[e.id]=e});var f=[],l=n.splitSections(i.sdp),m=l.shift(),h=n.matchPrefix(m,"a=ice-lite").length>0,v=n.matchPrefix(m,"a=group:BUNDLE ").length>0;p.usingBundle=v;var y=n.matchPrefix(m,"a=ice-options:")[0];return p.canTrickleIceCandidates=!!y&&y.substr(14).split(" ").indexOf("trickle")>=0,l.forEach(function(o,c){var d=n.splitLines(o),l=n.getKind(o),y=n.isRejected(o)&&0===n.matchPrefix(o,"a=bundle-only").length,g=d[0].substr(2).split(" ")[2],C=n.getDirection(o,m),S=n.parseMsid(o),T=n.getMid(o)||n.generateIdentifier();if(y||"application"===l&&("DTLS/SCTP"===g||"UDP/DTLS/SCTP"===g))p.transceivers[c]={mid:T,kind:l,protocol:g,rejected:!0};else{var P,R,b,E,_,w,k,x,M;!y&&p.transceivers[c]&&p.transceivers[c].rejected&&(p.transceivers[c]=p._createTransceiver(l,!0));var D,O,I=n.parseRtpParameters(o);y||(D=n.getIceParameters(o,m),(O=n.getDtlsParameters(o,m)).role="client"),k=n.parseRtpEncodingParameters(o);var j=n.parseRtcpParameters(o),L=n.matchPrefix(o,"a=end-of-candidates",m).length>0,G=n.matchPrefix(o,"a=candidate:").map(function(e){return n.parseCandidate(e)}).filter(function(e){return 1===e.component});if(("offer"===i.type||"answer"===i.type)&&!y&&v&&c>0&&p.transceivers[c]&&(p._disposeIceAndDtlsTransports(c),p.transceivers[c].iceGatherer=p.transceivers[0].iceGatherer,p.transceivers[c].iceTransport=p.transceivers[0].iceTransport,p.transceivers[c].dtlsTransport=p.transceivers[0].dtlsTransport,p.transceivers[c].rtpSender&&p.transceivers[c].rtpSender.setTransport(p.transceivers[0].dtlsTransport),p.transceivers[c].rtpReceiver&&p.transceivers[c].rtpReceiver.setTransport(p.transceivers[0].dtlsTransport)),"offer"!==i.type||y){if("answer"===i.type&&!y){R=(P=p.transceivers[c]).iceGatherer,b=P.iceTransport,E=P.dtlsTransport,_=P.rtpReceiver,w=P.sendEncodingParameters,x=P.localCapabilities,p.transceivers[c].recvEncodingParameters=k,p.transceivers[c].remoteCapabilities=I,p.transceivers[c].rtcpParameters=j,G.length&&"new"===b.state&&(!h&&!L||v&&0!==c?G.forEach(function(e){s(P.iceTransport,e)}):b.setRemoteCandidates(G)),v&&0!==c||("new"===b.state&&b.start(R,D,"controlling"),"new"===E.state&&E.start(O)),!a(P.localCapabilities,P.remoteCapabilities).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&P.sendEncodingParameters[0].rtx&&delete P.sendEncodingParameters[0].rtx,p._transceive(P,"sendrecv"===C||"recvonly"===C,"sendrecv"===C||"sendonly"===C),!_||"sendrecv"!==C&&"sendonly"!==C?delete P.rtpReceiver:(M=_.track,S?(u[S.stream]||(u[S.stream]=new e.MediaStream),r(M,u[S.stream]),f.push([M,_,u[S.stream]])):(u.default||(u.default=new e.MediaStream),r(M,u.default),f.push([M,_,u.default])))}}else{(P=p.transceivers[c]||p._createTransceiver(l)).mid=T,P.iceGatherer||(P.iceGatherer=p._createIceGatherer(c,v)),G.length&&"new"===P.iceTransport.state&&(!L||v&&0!==c?G.forEach(function(e){s(P.iceTransport,e)}):P.iceTransport.setRemoteCandidates(G)),x=e.RTCRtpReceiver.getCapabilities(l),t<15019&&(x.codecs=x.codecs.filter(function(e){return"rtx"!==e.name})),w=P.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var A,N=!1;if("sendrecv"===C||"sendonly"===C){if(N=!P.rtpReceiver,_=P.rtpReceiver||new e.RTCRtpReceiver(P.dtlsTransport,l),N)M=_.track,S&&"-"===S.stream||(S?(u[S.stream]||(u[S.stream]=new e.MediaStream,Object.defineProperty(u[S.stream],"id",{get:function(){return S.stream}})),Object.defineProperty(M,"id",{get:function(){return S.track}}),A=u[S.stream]):(u.default||(u.default=new e.MediaStream),A=u.default)),A&&(r(M,A),P.associatedRemoteMediaStreams.push(A)),f.push([M,_,A])}else P.rtpReceiver&&P.rtpReceiver.track&&(P.associatedRemoteMediaStreams.forEach(function(t){var r,n,i=t.getTracks().find(function(e){return e.id===P.rtpReceiver.track.id});i&&(r=i,(n=t).removeTrack(r),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:r})))}),P.associatedRemoteMediaStreams=[]);P.localCapabilities=x,P.remoteCapabilities=I,P.rtpReceiver=_,P.rtcpParameters=j,P.sendEncodingParameters=w,P.recvEncodingParameters=k,p._transceive(p.transceivers[c],!1,N)}}}),void 0===p._dtlsRole&&(p._dtlsRole="offer"===i.type?"active":"passive"),p._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?p._updateSignalingState("have-remote-offer"):p._updateSignalingState("stable"),Object.keys(u).forEach(function(t){var r=u[t];if(r.getTracks().length){if(-1===p.remoteStreams.indexOf(r)){p.remoteStreams.push(r);var n=new Event("addstream");n.stream=r,e.setTimeout(function(){p._dispatchEvent("addstream",n)})}f.forEach(function(e){var t=e[0],n=e[1];r.id===e[2].id&&d(p,t,n,[r])})}}),f.forEach(function(e){e[2]||d(p,e[0],e[1],[])}),e.setTimeout(function(){p&&p.transceivers&&p.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},p.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},p.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},p.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0))},p.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++}),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},p.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)}),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},p.prototype.createOffer=function(){var r=this;if(r._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var a=r.transceivers.filter(function(e){return"audio"===e.kind}).length,o=r.transceivers.filter(function(e){return"video"===e.kind}).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==s.offerToReceiveAudio&&(a=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(o=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}for(r.transceivers.forEach(function(e){"audio"===e.kind?--a<0&&(e.wantReceive=!1):"video"===e.kind&&--o<0&&(e.wantReceive=!1)});a>0||o>0;)a>0&&(r._createTransceiver("audio"),a--),o>0&&(r._createTransceiver("video"),o--);var d=n.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.transceivers.forEach(function(i,a){var o=i.track,s=i.kind,c=i.mid||n.generateIdentifier();i.mid=c,i.iceGatherer||(i.iceGatherer=r._createIceGatherer(a,r.usingBundle));var d=e.RTCRtpSender.getCapabilities(s);t<15019&&(d.codecs=d.codecs.filter(function(e){return"rtx"!==e.name})),d.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach(function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)})}),d.headerExtensions.forEach(function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach(function(t){e.uri===t.uri&&(e.id=t.id)})});var p=i.sendEncodingParameters||[{ssrc:1001*(2*a+1)}];o&&t>=15019&&"video"===s&&!p[0].rtx&&(p[0].rtx={ssrc:p[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,s)),i.localCapabilities=d,i.sendEncodingParameters=p}),"max-compat"!==r._config.bundlePolicy&&(d+="a=group:BUNDLE "+r.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),d+="a=ice-options:trickle\r\n",r.transceivers.forEach(function(e,t){d+=i(e,e.localCapabilities,"offer",e.stream,r._dtlsRole),d+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===r.iceGatheringState||0!==t&&r.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,d+="a="+n.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(d+="a=end-of-candidates\r\n"))});var p=new e.RTCSessionDescription({type:"offer",sdp:d});return Promise.resolve(p)},p.prototype.createAnswer=function(){var r=this;if(r._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==r.signalingState&&"have-local-pranswer"!==r.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+r.signalingState));var o=n.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.usingBundle&&(o+="a=group:BUNDLE "+r.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),o+="a=ice-options:trickle\r\n";var s=n.getMediaSections(r._remoteDescription.sdp).length;r.transceivers.forEach(function(e,n){if(!(n+1>s)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?o+="m=application 0 DTLS/SCTP 5000\r\n":o+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?o+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(o+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(o+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;if(e.stream)"audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var d=a(e.localCapabilities,e.remoteCapabilities);!d.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,o+=i(e,d,"answer",e.stream,r._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(o+="a=rtcp-rsize\r\n")}});var d=new e.RTCSessionDescription({type:"answer",sdp:o});return Promise.resolve(d)},p.prototype.addIceCandidate=function(e){var t,r=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(i,a){if(!r._remoteDescription)return a(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var o=e.sdpMLineIndex;if(e.sdpMid)for(var d=0;d<r.transceivers.length;d++)if(r.transceivers[d].mid===e.sdpMid){o=d;break}var p=r.transceivers[o];if(!p)return a(c("OperationError","Can not add ICE candidate"));if(p.rejected)return i();var u=Object.keys(e.candidate).length>0?n.parseCandidate(e.candidate):{};if("tcp"===u.protocol&&(0===u.port||9===u.port))return i();if(u.component&&1!==u.component)return i();if((0===o||o>0&&p.iceTransport!==r.transceivers[0].iceTransport)&&!s(p.iceTransport,u))return a(c("OperationError","Can not add ICE candidate"));var f=e.candidate.trim();0===f.indexOf("a=")&&(f=f.substr(2)),(t=n.getMediaSections(r._remoteDescription.sdp))[o]+="a="+(u.type?f:"end-of-candidates")+"\r\n",r._remoteDescription.sdp=n.getDescription(r._remoteDescription.sdp)+t.join("")}else for(var l=0;l<r.transceivers.length&&(r.transceivers[l].rejected||(r.transceivers[l].iceTransport.addRemoteCandidate({}),(t=n.getMediaSections(r._remoteDescription.sdp))[l]+="a=end-of-candidates\r\n",r._remoteDescription.sdp=n.getDescription(r._remoteDescription.sdp)+t.join(""),!r.usingBundle));l++);i()})},p.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var r=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(r=e.rtpReceiver)}),!r)throw c("InvalidAccessError","Invalid selector.");return r.getStats()}var n=[];return this.transceivers.forEach(function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(t){e[t]&&n.push(e[t].getStats())})}),Promise.all(n).then(function(e){var t=new Map;return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(t){var r=e[t];if(r&&r.prototype&&r.prototype.getStats){var n=r.prototype.getStats;r.prototype.getStats=function(){return n.apply(this).then(function(e){var t=new Map;return Object.keys(e).forEach(function(r){var n;e[r].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(n=e[r]).type]||n.type,t.set(r,e[r])}),t})}}});var u=["createOffer","createAnswer"];return u.forEach(function(e){var t=p.prototype[e];p.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then(function(t){"function"==typeof e[0]&&e[0].apply(null,[t])},function(t){"function"==typeof e[1]&&e[1].apply(null,[t])}):t.apply(this,arguments)}}),(u=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e){var t=p.prototype[e];p.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)},function(t){"function"==typeof e[2]&&e[2].apply(null,[t])}):t.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=p.prototype[e];p.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),p}},{sdp:17}],17:[function(e,t,r){"use strict";var n={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};n.localCName=n.generateIdentifier(),n.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},n.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},n.getDescription=function(e){var t=n.splitSections(e);return t&&t[0]},n.getMediaSections=function(e){var t=n.splitSections(e);return t.shift(),t},n.matchPrefix=function(e,t){return n.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},n.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:r[t[n]]=t[n+1]}return r},n.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},n.parseIceOptions=function(e){return e.substr(14).split(" ")},n.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},n.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},n.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},n.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},n.parseFmtp=function(e){for(var t,r={},n=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<n.length;i++)r[(t=n[i].trim().split("="))[0].trim()]=t[1];return r},n.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach(function(t){e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)}),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},n.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},n.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},n.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return n>-1?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},n.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(function(e){return parseInt(e,10)})}},n.getMid=function(e){var t=n.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},n.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},n.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:n.matchPrefix(e+t,"a=fingerprint:").map(n.parseFingerprint)}},n.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),r},n.getIceParameters=function(e,t){var r=n.splitLines(e);return{usernameFragment:(r=r.concat(n.splitLines(t))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:r.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},n.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},n.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=n.splitLines(e)[0].split(" "),i=3;i<r.length;i++){var a=r[i],o=n.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(o){var s=n.parseRtpMap(o),c=n.matchPrefix(e,"a=fmtp:"+a+" ");switch(s.parameters=c.length?n.parseFmtp(c[0]):{},s.rtcpFeedback=n.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(n.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return n.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(n.parseExtmap(e))}),t},n.writeRtpDescription=function(e,t){var r="";r+="m="+e+" ",r+=t.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){r+=n.writeRtpMap(e),r+=n.writeFmtp(e),r+=n.writeRtcpFb(e)});var i=0;return t.codecs.forEach(function(e){e.maxptime>i&&(i=e.maxptime)}),i>0&&(r+="a=maxptime:"+i+"\r\n"),r+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){r+=n.writeExtmap(e)}),r},n.parseRtpEncodingParameters=function(e){var t,r=[],i=n.parseRtpParameters(e),a=-1!==i.fecMechanisms.indexOf("RED"),o=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=n.matchPrefix(e,"a=ssrc:").map(function(e){return n.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),c=s.length>0&&s[0].ssrc,d=n.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})});d.length>0&&d[0].length>1&&d[0][0]===c&&(t=d[0][1]),i.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var n={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(n.rtx={ssrc:t}),r.push(n),a&&((n=JSON.parse(JSON.stringify(n))).fec={ssrc:c,mechanism:o?"red+ulpfec":"red"},r.push(n))}}),0===r.length&&c&&r.push({ssrc:c});var p=n.matchPrefix(e,"b=");return p.length&&(p=0===p[0].indexOf("b=TIAS:")?parseInt(p[0].substr(7),10):0===p[0].indexOf("b=AS:")?1e3*parseInt(p[0].substr(5),10)*.95-16e3:void 0,r.forEach(function(e){e.maxBitrate=p})),r},n.parseRtcpParameters=function(e){var t={},r=n.matchPrefix(e,"a=ssrc:").map(function(e){return n.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];r&&(t.cname=r.value,t.ssrc=r.ssrc);var i=n.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var a=n.matchPrefix(e,"a=rtcp-mux");return t.mux=a.length>0,t},n.parseMsid=function(e){var t,r=n.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(t=r[0].substr(7).split(" "))[0],track:t[1]};var i=n.matchPrefix(e,"a=ssrc:").map(function(e){return n.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return i.length>0?{stream:(t=i[0].value.split(" "))[0],track:t[1]}:void 0},n.parseSctpDescription=function(e){var t,r=n.parseMLine(e),i=n.matchPrefix(e,"a=max-message-size:");i.length>0&&(t=parseInt(i[0].substr(19),10)),isNaN(t)&&(t=65536);var a=n.matchPrefix(e,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substr(12),10),protocol:r.fmt,maxMessageSize:t};if(n.matchPrefix(e,"a=sctpmap:").length>0){var o=n.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(o[0],10),protocol:o[1],maxMessageSize:t}}},n.writeSctpDescription=function(e,t){var r=[];return r="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&r.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),r.join("")},n.generateSessionId=function(){return Math.random().toString().substr(2,21)},n.writeSessionBoilerplate=function(e,t,r){var i=void 0!==t?t:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||n.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},n.writeMediaSection=function(e,t,r,i){var a=n.writeRtpDescription(e.kind,t);if(a+=n.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=n.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),a+="a=mid:"+e.mid+"\r\n",e.direction?a+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var o="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";a+="a="+o,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+o,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+o,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+n.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+n.localCName+"\r\n"),a},n.getDirection=function(e,t){for(var r=n.splitLines(e),i=0;i<r.length;i++)switch(r[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[i].substr(2)}return t?n.getDirection(t):"sendrecv"},n.getKind=function(e){return n.splitLines(e)[0].split(" ")[0].substr(2)},n.isRejected=function(e){return"0"===e.split(" ",2)[1]},n.parseMLine=function(e){var t=n.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},n.parseOLine=function(e){var t=n.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},n.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=n.splitLines(e),r=0;r<t.length;r++)if(t[r].length<2||"="!==t[r].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=n)},{}]},{},[1])(1)});
},{}],"bg1w":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=emedia.singleWebrtcAdapter;function t(){emedia.util.logger.warn("webrtc-adapter must load once. if more, safari may initC sdp error(too many audio video, easemob server dont work)")}function a(){if(document.documentMode){var t=/\brv[ :]+(\d+)/g.exec(navigator.userAgent)||[],a=parseInt(t[1],10);a||(t=/\bMSIE[ :]+(\d+)/g.exec(navigator.userAgent)||[],a=parseInt(t[1]||"0",10)),emedia.util.logger.error("adapter.ie not required"),e.__browser="IE",e.__browserVersion=a}else e=require("./adapter-7.3.0"),emedia.util.logger.info("webrtc-adapter load first"),o();emedia.singleWebrtcAdapter=e}t(),e?emedia.util.logger.error("webrtc-adapter repeated load, safari may dont work"):a(),e.__browser=e.__browser||e.browserDetails.browser,e.__browserVersion=e.__browserVersion||e.browserDetails.version,emedia.util.logger.info("Current browser",e.__browser,e.__browserVersion),"Not a supported browser."===e.__browser&&emedia.util.logger.error("Not a supported browser");var r=e;function o(){window.attachMediaStream&&!0!==window.attachMediaStream._wrapped&&(window.__attachMediaStream=window.attachMediaStream),window.attachMediaStream=function(e,t,a,r){function o(){a=!!(void 0===a?t._located:a),e.muted=!1,a!==e.muted&&(e.muted=!0)}if(r||(r=window.__attachMediaStream)||(r=function(e,t){e.srcObject=t;var a=emedia.util.logger||window.console||console;if(a){if(t&&a.info("stream attach videoTag.",t.id,t._located,">>",e.id,e.muted,e.volume,e),t||a.info("stream(null) attach videoTag.",e.id,e.muted,e.volume,e),!e.hxSetOnvolumechange){var r=e.onvolumechange;e.onvolumechange=function(){a.debug("stream attach detail: video tag volume chanage",e.volume,t?t.id:t),r&&r.apply(e,arguments)},e.hxSetOnvolumechange=!0}if(!e.hxSetOnstalled){var o=e.onstalled;e.onstalled=function(){a.debug("stream attach detail: video tag onstalled",t?t.id:t),o&&o.apply(e,arguments)},e.hxSetOnstalled=!0}if(!e.hxSetOnabort){var i=e.onabort;e.onabort=function(){a.debug("stream attach detail: video tag onabort",t?t.id:t),i&&i.apply(e,arguments)},e.hxSetOnabort=!0}if(!e.hxSetOncanplay){var n=e.oncanplay;e.oncanplay=function(){t&&t.getTracks().forEach(function(e){"function"==typeof e.getSettings&&a.debug("stream attach detail",t.id," track setting =",e.enabled,e.id,e.kind,e.label,e.getSettings())}),a.debug("stream attach detail: video tag",e.videoWidth,"x",e.videoHeight,t?t.id:t),n&&n.apply(e,arguments)},e.hxSetOncanplay=!0}}}.bind(this)),e){if(t)return e.srcObject&&e.srcObject._located&&t._located&&e.srcObject.id===t.id?e.srcObject:(o(),r(e,t),e);r(e,t)}},window.attachMediaStream._wrapped=!0,console&&"function"==typeof console.info&&console.info("Wrap the attachMediaStream ",e.__browser,e.__browserVersion)}exports.default=r;
},{"./adapter-7.3.0":"E0Kg"}],"sd4Q":[function(require,module,exports) {
var global = arguments[3];
var define;
var n,r=arguments[3];!function(){var t="object"==typeof self&&self.self===self&&self||"object"==typeof r&&r.global===r&&r||this||{},e=t._,u=Array.prototype,i=Object.prototype,o="undefined"!=typeof Symbol?Symbol.prototype:null,a=u.push,c=u.slice,l=i.toString,f=i.hasOwnProperty,s=Array.isArray,p=Object.keys,v=Object.create,h=function(){},y=function(n){return n instanceof y?n:this instanceof y?void(this._wrapped=n):new y(n)};"undefined"==typeof exports||exports.nodeType?t._=y:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=y),exports._=y),y.VERSION="1.9.1";var d,g=function(n,r,t){if(void 0===r)return n;switch(null==t?3:t){case 1:return function(t){return n.call(r,t)};case 3:return function(t,e,u){return n.call(r,t,e,u)};case 4:return function(t,e,u,i){return n.call(r,t,e,u,i)}}return function(){return n.apply(r,arguments)}},m=function(n,r,t){return y.iteratee!==d?y.iteratee(n,r):null==n?y.identity:y.isFunction(n)?g(n,r,t):y.isObject(n)&&!y.isArray(n)?y.matcher(n):y.property(n)};y.iteratee=d=function(n,r){return m(n,r,1/0)};var b=function(n,r){return r=null==r?n.length-1:+r,function(){for(var t=Math.max(arguments.length-r,0),e=Array(t),u=0;u<t;u++)e[u]=arguments[u+r];switch(r){case 0:return n.call(this,e);case 1:return n.call(this,arguments[0],e);case 2:return n.call(this,arguments[0],arguments[1],e)}var i=Array(r+1);for(u=0;u<r;u++)i[u]=arguments[u];return i[r]=e,n.apply(this,i)}},j=function(n){if(!y.isObject(n))return{};if(v)return v(n);h.prototype=n;var r=new h;return h.prototype=null,r},x=function(n){return function(r){return null==r?void 0:r[n]}},_=function(n,r){return null!=n&&f.call(n,r)},A=function(n,r){for(var t=r.length,e=0;e<t;e++){if(null==n)return;n=n[r[e]]}return t?n:void 0},w=Math.pow(2,53)-1,O=x("length"),k=function(n){var r=O(n);return"number"==typeof r&&r>=0&&r<=w};y.each=y.forEach=function(n,r,t){var e,u;if(r=g(r,t),k(n))for(e=0,u=n.length;e<u;e++)r(n[e],e,n);else{var i=y.keys(n);for(e=0,u=i.length;e<u;e++)r(n[i[e]],i[e],n)}return n},y.map=y.collect=function(n,r,t){r=m(r,t);for(var e=!k(n)&&y.keys(n),u=(e||n).length,i=Array(u),o=0;o<u;o++){var a=e?e[o]:o;i[o]=r(n[a],a,n)}return i};var S=function(n){return function(r,t,e,u){var i=arguments.length>=3;return function(r,t,e,u){var i=!k(r)&&y.keys(r),o=(i||r).length,a=n>0?0:o-1;for(u||(e=r[i?i[a]:a],a+=n);a>=0&&a<o;a+=n){var c=i?i[a]:a;e=t(e,r[c],c,r)}return e}(r,g(t,u,4),e,i)}};y.reduce=y.foldl=y.inject=S(1),y.reduceRight=y.foldr=S(-1),y.find=y.detect=function(n,r,t){var e=(k(n)?y.findIndex:y.findKey)(n,r,t);if(void 0!==e&&-1!==e)return n[e]},y.filter=y.select=function(n,r,t){var e=[];return r=m(r,t),y.each(n,function(n,t,u){r(n,t,u)&&e.push(n)}),e},y.reject=function(n,r,t){return y.filter(n,y.negate(m(r)),t)},y.every=y.all=function(n,r,t){r=m(r,t);for(var e=!k(n)&&y.keys(n),u=(e||n).length,i=0;i<u;i++){var o=e?e[i]:i;if(!r(n[o],o,n))return!1}return!0},y.some=y.any=function(n,r,t){r=m(r,t);for(var e=!k(n)&&y.keys(n),u=(e||n).length,i=0;i<u;i++){var o=e?e[i]:i;if(r(n[o],o,n))return!0}return!1},y.contains=y.includes=y.include=function(n,r,t,e){return k(n)||(n=y.values(n)),("number"!=typeof t||e)&&(t=0),y.indexOf(n,r,t)>=0},y.invoke=b(function(n,r,t){var e,u;return y.isFunction(r)?u=r:y.isArray(r)&&(e=r.slice(0,-1),r=r[r.length-1]),y.map(n,function(n){var i=u;if(!i){if(e&&e.length&&(n=A(n,e)),null==n)return;i=n[r]}return null==i?i:i.apply(n,t)})}),y.pluck=function(n,r){return y.map(n,y.property(r))},y.where=function(n,r){return y.filter(n,y.matcher(r))},y.findWhere=function(n,r){return y.find(n,y.matcher(r))},y.max=function(n,r,t){var e,u,i=-1/0,o=-1/0;if(null==r||"number"==typeof r&&"object"!=typeof n[0]&&null!=n)for(var a=0,c=(n=k(n)?n:y.values(n)).length;a<c;a++)null!=(e=n[a])&&e>i&&(i=e);else r=m(r,t),y.each(n,function(n,t,e){((u=r(n,t,e))>o||u===-1/0&&i===-1/0)&&(i=n,o=u)});return i},y.min=function(n,r,t){var e,u,i=1/0,o=1/0;if(null==r||"number"==typeof r&&"object"!=typeof n[0]&&null!=n)for(var a=0,c=(n=k(n)?n:y.values(n)).length;a<c;a++)null!=(e=n[a])&&e<i&&(i=e);else r=m(r,t),y.each(n,function(n,t,e){((u=r(n,t,e))<o||u===1/0&&i===1/0)&&(i=n,o=u)});return i},y.shuffle=function(n){return y.sample(n,1/0)},y.sample=function(n,r,t){if(null==r||t)return k(n)||(n=y.values(n)),n[y.random(n.length-1)];var e=k(n)?y.clone(n):y.values(n),u=O(e);r=Math.max(Math.min(r,u),0);for(var i=u-1,o=0;o<r;o++){var a=y.random(o,i),c=e[o];e[o]=e[a],e[a]=c}return e.slice(0,r)},y.sortBy=function(n,r,t){var e=0;return r=m(r,t),y.pluck(y.map(n,function(n,t,u){return{value:n,index:e++,criteria:r(n,t,u)}}).sort(function(n,r){var t=n.criteria,e=r.criteria;if(t!==e){if(t>e||void 0===t)return 1;if(t<e||void 0===e)return-1}return n.index-r.index}),"value")};var M=function(n,r){return function(t,e,u){var i=r?[[],[]]:{};return e=m(e,u),y.each(t,function(r,u){var o=e(r,u,t);n(i,r,o)}),i}};y.groupBy=M(function(n,r,t){_(n,t)?n[t].push(r):n[t]=[r]}),y.indexBy=M(function(n,r,t){n[t]=r}),y.countBy=M(function(n,r,t){_(n,t)?n[t]++:n[t]=1});var F=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;y.toArray=function(n){return n?y.isArray(n)?c.call(n):y.isString(n)?n.match(F):k(n)?y.map(n,y.identity):y.values(n):[]},y.size=function(n){return null==n?0:k(n)?n.length:y.keys(n).length},y.partition=M(function(n,r,t){n[t?0:1].push(r)},!0),y.first=y.head=y.take=function(n,r,t){return null==n||n.length<1?null==r?void 0:[]:null==r||t?n[0]:y.initial(n,n.length-r)},y.initial=function(n,r,t){return c.call(n,0,Math.max(0,n.length-(null==r||t?1:r)))},y.last=function(n,r,t){return null==n||n.length<1?null==r?void 0:[]:null==r||t?n[n.length-1]:y.rest(n,Math.max(0,n.length-r))},y.rest=y.tail=y.drop=function(n,r,t){return c.call(n,null==r||t?1:r)},y.compact=function(n){return y.filter(n,Boolean)};var E=function(n,r,t,e){for(var u=(e=e||[]).length,i=0,o=O(n);i<o;i++){var a=n[i];if(k(a)&&(y.isArray(a)||y.isArguments(a)))if(r)for(var c=0,l=a.length;c<l;)e[u++]=a[c++];else E(a,r,t,e),u=e.length;else t||(e[u++]=a)}return e};y.flatten=function(n,r){return E(n,r,!1)},y.without=b(function(n,r){return y.difference(n,r)}),y.uniq=y.unique=function(n,r,t,e){y.isBoolean(r)||(e=t,t=r,r=!1),null!=t&&(t=m(t,e));for(var u=[],i=[],o=0,a=O(n);o<a;o++){var c=n[o],l=t?t(c,o,n):c;r&&!t?(o&&i===l||u.push(c),i=l):t?y.contains(i,l)||(i.push(l),u.push(c)):y.contains(u,c)||u.push(c)}return u},y.union=b(function(n){return y.uniq(E(n,!0,!0))}),y.intersection=function(n){for(var r=[],t=arguments.length,e=0,u=O(n);e<u;e++){var i=n[e];if(!y.contains(r,i)){var o;for(o=1;o<t&&y.contains(arguments[o],i);o++);o===t&&r.push(i)}}return r},y.difference=b(function(n,r){return r=E(r,!0,!0),y.filter(n,function(n){return!y.contains(r,n)})}),y.unzip=function(n){for(var r=n&&y.max(n,O).length||0,t=Array(r),e=0;e<r;e++)t[e]=y.pluck(n,e);return t},y.zip=b(y.unzip),y.object=function(n,r){for(var t={},e=0,u=O(n);e<u;e++)r?t[n[e]]=r[e]:t[n[e][0]]=n[e][1];return t};var N=function(n){return function(r,t,e){t=m(t,e);for(var u=O(r),i=n>0?0:u-1;i>=0&&i<u;i+=n)if(t(r[i],i,r))return i;return-1}};y.findIndex=N(1),y.findLastIndex=N(-1),y.sortedIndex=function(n,r,t,e){for(var u=(t=m(t,e,1))(r),i=0,o=O(n);i<o;){var a=Math.floor((i+o)/2);t(n[a])<u?i=a+1:o=a}return i};var I=function(n,r,t){return function(e,u,i){var o=0,a=O(e);if("number"==typeof i)n>0?o=i>=0?i:Math.max(i+a,o):a=i>=0?Math.min(i+1,a):i+a+1;else if(t&&i&&a)return e[i=t(e,u)]===u?i:-1;if(u!=u)return(i=r(c.call(e,o,a),y.isNaN))>=0?i+o:-1;for(i=n>0?o:a-1;i>=0&&i<a;i+=n)if(e[i]===u)return i;return-1}};y.indexOf=I(1,y.findIndex,y.sortedIndex),y.lastIndexOf=I(-1,y.findLastIndex),y.range=function(n,r,t){null==r&&(r=n||0,n=0),t||(t=r<n?-1:1);for(var e=Math.max(Math.ceil((r-n)/t),0),u=Array(e),i=0;i<e;i++,n+=t)u[i]=n;return u},y.chunk=function(n,r){if(null==r||r<1)return[];for(var t=[],e=0,u=n.length;e<u;)t.push(c.call(n,e,e+=r));return t};var T=function(n,r,t,e,u){if(!(e instanceof r))return n.apply(t,u);var i=j(n.prototype),o=n.apply(i,u);return y.isObject(o)?o:i};y.bind=b(function(n,r,t){if(!y.isFunction(n))throw new TypeError("Bind must be called on a function");var e=b(function(u){return T(n,e,r,this,t.concat(u))});return e}),y.partial=b(function(n,r){var t=y.partial.placeholder,e=function(){for(var u=0,i=r.length,o=Array(i),a=0;a<i;a++)o[a]=r[a]===t?arguments[u++]:r[a];for(;u<arguments.length;)o.push(arguments[u++]);return T(n,e,this,this,o)};return e}),y.partial.placeholder=y,y.bindAll=b(function(n,r){var t=(r=E(r,!1,!1)).length;if(t<1)throw new Error("bindAll must be passed function names");for(;t--;){var e=r[t];n[e]=y.bind(n[e],n)}}),y.memoize=function(n,r){var t=function(e){var u=t.cache,i=""+(r?r.apply(this,arguments):e);return _(u,i)||(u[i]=n.apply(this,arguments)),u[i]};return t.cache={},t},y.delay=b(function(n,r,t){return setTimeout(function(){return n.apply(null,t)},r)}),y.defer=y.partial(y.delay,y,1),y.throttle=function(n,r,t){var e,u,i,o,a=0;t||(t={});var c=function(){a=!1===t.leading?0:y.now(),e=null,o=n.apply(u,i),e||(u=i=null)},l=function(){var l=y.now();a||!1!==t.leading||(a=l);var f=r-(l-a);return u=this,i=arguments,f<=0||f>r?(e&&(clearTimeout(e),e=null),a=l,o=n.apply(u,i),e||(u=i=null)):e||!1===t.trailing||(e=setTimeout(c,f)),o};return l.cancel=function(){clearTimeout(e),a=0,e=u=i=null},l},y.debounce=function(n,r,t){var e,u,i=function(r,t){e=null,t&&(u=n.apply(r,t))},o=b(function(o){if(e&&clearTimeout(e),t){var a=!e;e=setTimeout(i,r),a&&(u=n.apply(this,o))}else e=y.delay(i,r,this,o);return u});return o.cancel=function(){clearTimeout(e),e=null},o},y.wrap=function(n,r){return y.partial(r,n)},y.negate=function(n){return function(){return!n.apply(this,arguments)}},y.compose=function(){var n=arguments,r=n.length-1;return function(){for(var t=r,e=n[r].apply(this,arguments);t--;)e=n[t].call(this,e);return e}},y.after=function(n,r){return function(){if(--n<1)return r.apply(this,arguments)}},y.before=function(n,r){var t;return function(){return--n>0&&(t=r.apply(this,arguments)),n<=1&&(r=null),t}},y.once=y.partial(y.before,2),y.restArguments=b;var B=!{toString:null}.propertyIsEnumerable("toString"),R=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],q=function(n,r){var t=R.length,e=n.constructor,u=y.isFunction(e)&&e.prototype||i,o="constructor";for(_(n,o)&&!y.contains(r,o)&&r.push(o);t--;)(o=R[t])in n&&n[o]!==u[o]&&!y.contains(r,o)&&r.push(o)};y.keys=function(n){if(!y.isObject(n))return[];if(p)return p(n);var r=[];for(var t in n)_(n,t)&&r.push(t);return B&&q(n,r),r},y.allKeys=function(n){if(!y.isObject(n))return[];var r=[];for(var t in n)r.push(t);return B&&q(n,r),r},y.values=function(n){for(var r=y.keys(n),t=r.length,e=Array(t),u=0;u<t;u++)e[u]=n[r[u]];return e},y.mapObject=function(n,r,t){r=m(r,t);for(var e=y.keys(n),u=e.length,i={},o=0;o<u;o++){var a=e[o];i[a]=r(n[a],a,n)}return i},y.pairs=function(n){for(var r=y.keys(n),t=r.length,e=Array(t),u=0;u<t;u++)e[u]=[r[u],n[r[u]]];return e},y.invert=function(n){for(var r={},t=y.keys(n),e=0,u=t.length;e<u;e++)r[n[t[e]]]=t[e];return r},y.functions=y.methods=function(n){var r=[];for(var t in n)y.isFunction(n[t])&&r.push(t);return r.sort()};var K=function(n,r){return function(t){var e=arguments.length;if(r&&(t=Object(t)),e<2||null==t)return t;for(var u=1;u<e;u++)for(var i=arguments[u],o=n(i),a=o.length,c=0;c<a;c++){var l=o[c];r&&void 0!==t[l]||(t[l]=i[l])}return t}};y.extend=K(y.allKeys),y.extendOwn=y.assign=K(y.keys),y.findKey=function(n,r,t){r=m(r,t);for(var e,u=y.keys(n),i=0,o=u.length;i<o;i++)if(r(n[e=u[i]],e,n))return e};var z,D,L=function(n,r,t){return r in t};y.pick=b(function(n,r){var t={},e=r[0];if(null==n)return t;y.isFunction(e)?(r.length>1&&(e=g(e,r[1])),r=y.allKeys(n)):(e=L,r=E(r,!1,!1),n=Object(n));for(var u=0,i=r.length;u<i;u++){var o=r[u],a=n[o];e(a,o,n)&&(t[o]=a)}return t}),y.omit=b(function(n,r){var t,e=r[0];return y.isFunction(e)?(e=y.negate(e),r.length>1&&(t=r[1])):(r=y.map(E(r,!1,!1),String),e=function(n,t){return!y.contains(r,t)}),y.pick(n,e,t)}),y.defaults=K(y.allKeys,!0),y.create=function(n,r){var t=j(n);return r&&y.extendOwn(t,r),t},y.clone=function(n){return y.isObject(n)?y.isArray(n)?n.slice():y.extend({},n):n},y.tap=function(n,r){return r(n),n},y.isMatch=function(n,r){var t=y.keys(r),e=t.length;if(null==n)return!e;for(var u=Object(n),i=0;i<e;i++){var o=t[i];if(r[o]!==u[o]||!(o in u))return!1}return!0},z=function(n,r,t,e){if(n===r)return 0!==n||1/n==1/r;if(null==n||null==r)return!1;if(n!=n)return r!=r;var u=typeof n;return("function"===u||"object"===u||"object"==typeof r)&&D(n,r,t,e)},D=function(n,r,t,e){n instanceof y&&(n=n._wrapped),r instanceof y&&(r=r._wrapped);var u=l.call(n);if(u!==l.call(r))return!1;switch(u){case"[object RegExp]":case"[object String]":return""+n==""+r;case"[object Number]":return+n!=+n?+r!=+r:0==+n?1/+n==1/r:+n==+r;case"[object Date]":case"[object Boolean]":return+n==+r;case"[object Symbol]":return o.valueOf.call(n)===o.valueOf.call(r)}var i="[object Array]"===u;if(!i){if("object"!=typeof n||"object"!=typeof r)return!1;var a=n.constructor,c=r.constructor;if(a!==c&&!(y.isFunction(a)&&a instanceof a&&y.isFunction(c)&&c instanceof c)&&"constructor"in n&&"constructor"in r)return!1}e=e||[];for(var f=(t=t||[]).length;f--;)if(t[f]===n)return e[f]===r;if(t.push(n),e.push(r),i){if((f=n.length)!==r.length)return!1;for(;f--;)if(!z(n[f],r[f],t,e))return!1}else{var s,p=y.keys(n);if(f=p.length,y.keys(r).length!==f)return!1;for(;f--;)if(s=p[f],!_(r,s)||!z(n[s],r[s],t,e))return!1}return t.pop(),e.pop(),!0},y.isEqual=function(n,r){return z(n,r)},y.isEmpty=function(n){return null==n||(k(n)&&(y.isArray(n)||y.isString(n)||y.isArguments(n))?0===n.length:0===y.keys(n).length)},y.isElement=function(n){return!(!n||1!==n.nodeType)},y.isArray=s||function(n){return"[object Array]"===l.call(n)},y.isObject=function(n){var r=typeof n;return"function"===r||"object"===r&&!!n},y.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(n){y["is"+n]=function(r){return l.call(r)==="[object "+n+"]"}}),y.isArguments(arguments)||(y.isArguments=function(n){return _(n,"callee")});var P=t.document&&t.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof P&&(y.isFunction=function(n){return"function"==typeof n||!1}),y.isFinite=function(n){return!y.isSymbol(n)&&isFinite(n)&&!isNaN(parseFloat(n))},y.isNaN=function(n){return y.isNumber(n)&&isNaN(n)},y.isBoolean=function(n){return!0===n||!1===n||"[object Boolean]"===l.call(n)},y.isNull=function(n){return null===n},y.isUndefined=function(n){return void 0===n},y.has=function(n,r){if(!y.isArray(r))return _(n,r);for(var t=r.length,e=0;e<t;e++){var u=r[e];if(null==n||!f.call(n,u))return!1;n=n[u]}return!!t},y.noConflict=function(){return t._=e,this},y.identity=function(n){return n},y.constant=function(n){return function(){return n}},y.noop=function(){},y.property=function(n){return y.isArray(n)?function(r){return A(r,n)}:x(n)},y.propertyOf=function(n){return null==n?function(){}:function(r){return y.isArray(r)?A(n,r):n[r]}},y.matcher=y.matches=function(n){return n=y.extendOwn({},n),function(r){return y.isMatch(r,n)}},y.times=function(n,r,t){var e=Array(Math.max(0,n));r=g(r,t,1);for(var u=0;u<n;u++)e[u]=r(u);return e},y.random=function(n,r){return null==r&&(r=n,n=0),n+Math.floor(Math.random()*(r-n+1))},y.now=Date.now||function(){return(new Date).getTime()};var W={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},C=y.invert(W),J=function(n){var r=function(r){return n[r]},t="(?:"+y.keys(n).join("|")+")",e=RegExp(t),u=RegExp(t,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(u,r):n}};y.escape=J(W),y.unescape=J(C),y.result=function(n,r,t){y.isArray(r)||(r=[r]);var e=r.length;if(!e)return y.isFunction(t)?t.call(n):t;for(var u=0;u<e;u++){var i=null==n?void 0:n[r[u]];void 0===i&&(i=t,u=e),n=y.isFunction(i)?i.call(n):i}return n};var U=0;y.uniqueId=function(n){var r=++U+"";return n?n+r:r},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var V=/(.)^/,$={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},G=/\\|'|\r|\n|\u2028|\u2029/g,H=function(n){return"\\"+$[n]};y.template=function(n,r,t){!r&&t&&(r=t),r=y.defaults({},r,y.templateSettings);var e,u=RegExp([(r.escape||V).source,(r.interpolate||V).source,(r.evaluate||V).source].join("|")+"|$","g"),i=0,o="__p+='";n.replace(u,function(r,t,e,u,a){return o+=n.slice(i,a).replace(G,H),i=a+r.length,t?o+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":e?o+="'+\n((__t=("+e+"))==null?'':__t)+\n'":u&&(o+="';\n"+u+"\n__p+='"),r}),o+="';\n",r.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{e=new Function(r.variable||"obj","_",o)}catch(l){throw l.source=o,l}var a=function(n){return e.call(this,n,y)},c=r.variable||"obj";return a.source="function("+c+"){\n"+o+"}",a},y.chain=function(n){var r=y(n);return r._chain=!0,r};var Q=function(n,r){return n._chain?y(r).chain():r};y.mixin=function(n){return y.each(y.functions(n),function(r){var t=y[r]=n[r];y.prototype[r]=function(){var n=[this._wrapped];return a.apply(n,arguments),Q(this,t.apply(y,n))}}),y},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var r=u[n];y.prototype[n]=function(){var t=this._wrapped;return r.apply(t,arguments),"shift"!==n&&"splice"!==n||0!==t.length||delete t[0],Q(this,t)}}),y.each(["concat","join","slice"],function(n){var r=u[n];y.prototype[n]=function(){return Q(this,r.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return String(this._wrapped)},"function"==typeof n&&n.amd&&n("underscore",[],function(){return y})}();
},{}],"zP2G":[function(require,module,exports) {
var e=require("./Util"),s=e.logger,t=e.prototypeExtend({msg:"",__init__:function(){this.day=new Date},execTime:function(){var e=this.day.getHours();e<10&&(e="0"+e);var s=this.day.getMinutes();s<10&&(s="0"+s);var t=this.day.getSeconds();return t<10&&(t="0"+t),e+":"+s+":"+t}}),i=t.extend({_webrtcDesc:function(){this.webrtc;return this.webrtc.getRtcId()}});module.exports={Exception:t.extend(),NetworkChanaged:t.extend({message:function(){return this.execTime()+" : Network chanage ("+this.preIp+" -> "+this.nowIp+")."}}),WSClose:t.extend({message:function(){var e=this.execTime()+" WSClose: Websocket close ("+(this.retry||0)+").";return this.online||(e+=" offline."),this.event&&(e+=" wscode: "+this.event.code),this.cause&&(e+=" cause: "+this.cause.message),this.url&&(e+=" url: "+this.url),e+=" retry: "+(this.retry||0),this.session&&this.session.getSessionId()&&(e=e+", sess = "+this.session.getSessionId()),e}}),WSError:t.extend({message:function(){var e=this.execTime()+" WSError: Websocket error. ready state:"+(this.event.srcElement&&this.event.srcElement.readyState||this.event.currentTarget.readyState)+". online = "+this.online;return this.session&&this.session.getSessionId()&&(e=e+", sess = "+this.session.getSessionId()),this.url&&(e+=" url: "+this.url),e}}),WSConnected:t.extend({message:function(){var e=this.execTime()+" WSConnected: Websocket success. ready state:"+(this.event.srcElement&&this.event.srcElement.readyState||this.event.currentTarget.readyState);return this.session&&this.session.getSessionId()&&(e=e+", sess = "+this.session.getSessionId()),e}}),ICEChanage:i.extend({message:function(){return this.execTime()+" ICEChanage: "+this._webrtcDesc()+" state: "+this.state}}),AddIceCandError:i.extend({message:function(){return this.execTime()+" AddIceCandError: "+this._webrtcDesc()+", add cand error"}}),ICEConnectFail:i.extend({message:function(){return this.execTime()+" ICEConnectFail: "+this._webrtcDesc()+" failed"}}),ICEConnected:i.extend({message:function(){return this.execTime()+" ICEConnected: "+this._webrtcDesc()+" connected"}}),ICEDisconnected:i.extend({message:function(){return this.execTime()+" ICEDisconnected: "+this._webrtcDesc()+" disconnected"}}),ICEClosed:i.extend({message:function(){return this.execTime()+" ICEClosed: "+this._webrtcDesc()+" closed"}}),ICERemoteMediaStream:i.extend({message:function(){return this.execTime()+" ICERemoteMediaStream: "+this._webrtcDesc()+" got remote stream"}}),StreamState:t.extend({message:function(){return this.execTime()+" StreamState:  stream "+this.stream.id+" state: "+this.state+" "+this.msg},iceFail:function(){this.state=1,this.msg="network anomaly. media lost"}}),OpenMediaError:t.extend({message:function(){return this.execTime()+" OpenMediaError:  open media error. caused by "+(this.event.name?this.event.name:this.event.message?this.event.message:this.event.toString())}}),Hangup:t.extend({message:function(){return this.self?"hangup id = "+(this.self.id||"--")+" reason："+(this.reason||0):this.execTime()+" Hangup: "+(this.parnter&&(this.parnter.name||this.parnter.id||" ")||"")+" hangup, reason："+(this.reason||0)}}),ServerRefuseEnter:t.extend({message:function(){return this.execTime()+" ServerRefuseEnter: server refuse, cause："+this.failed+", msg:"+(this.msg||"")}}),RspFail:t.extend({__init__:function(){this.day=new Date,this.failed=this.response.result,this.msg=this.response.msg||this.response.message||"--"},message:function(){return this.execTime()+" RspFail: "+this.request.tsxId+", "+(this.response.sessId||"--")+" op: "+this.request.op+", cause: "+this.failed+" "+this.msg}}),RecvResponse:t.extend({__init__:function(){this.day=new Date,this.failed=this.response.result,this.msg=this.response.msg},message:function(){return this.request?this.execTime()+" RecvResponse: "+(this.request&&this.request.tsxId)+", "+(this.response.sessId||"--")+" op: "+(this.request&&this.request.op)+", cause: "+this.failed+" "+this.msg:this.execTime()+" RecvMessage: "+(this.response&&this.response.tsxId)+", "+(this.response.sessId||"--")+" op: "+(this.response&&this.response.op)+" "+this.msg}}),EnterFail:t.extend({message:function(){return this.execTime()+" EnterFail: enter fail："+(this.cause?this.cause.message():"unkown")}}),EnterSuccess:t.extend({message:function(){return this.execTime()+" EnterSuccess: enter success "+(this.ip?", ip = "+this.ip:"")}}),PushSuccess:t.extend({message:function(){return this.execTime()+" PushSuccess: push success, streamId = "+this.stream.id+", "+this.stream.optimalVideoCodecs+", webrtc = "+this.stream.rtcId}}),PushFail:t.extend({message:function(){return this.execTime()+" PushFail: push fail, streamId = "+this.stream.id+", "+this.stream.optimalVideoCodecs+", webrtc = "+this.stream.rtcId+" cause："+(this.cause?this.cause.message?this.cause.message():this.cause:"unkown")}}),RemoteControlFail:t.extend({message:function(){return this.execTime()+" RemoteControlFail: "+(this.type||"remote control")+" fail, "+(this.stream?this.stream.id:"")+" failed = "+this.failed+" cause："+(this.cause?this.cause.message?this.cause.message():this.cause:"unkown")}}),SubSuccess:t.extend({message:function(){return this.execTime()+" SubSuccess: sub success, streamId = "+this.stream.id+", "+this.stream.vcodes+", webrtc = "+this.stream.rtcId}}),SubFail:t.extend({message:function(){return this.execTime()+" SubFail: sub fail, streamId = "+this.stream.id+", "+this.stream.vcodes+", webrtc = "+this.stream.rtcId+" cause："+(this.cause?this.cause.message?this.cause.message():this.cause:"unkown")}}),SubFailNotSupportVCodes:t.extend({message:function(){return this.execTime()+" SubFailNotSupportVCodes: sub fail, streamId = "+this.stream.id+" cause："+(this.cause?this.cause.message?this.cause.message():this.cause:"unkown")}}),SubFailSafariNotAllowSubBeforePub:t.extend({message:function(){return this.execTime()+" SubFailSafariNotAllowSubBeforePub: sub fail, streamId = "+this.stream.id+" cause：Safari without access to capture devices, WebKit only exposes Server Reflexive and TURN ICE candidates, which expose IPs that could already be gathered by websites."}}),SwitchVCodes:t.extend({message:function(){return this.execTime()+" SwitchVCodes: pub streamId = "+this.stream.id}}),CurrentCalling:t.extend({message:function(){return this.execTime()+" CurrentCalling: warn! current calling..."}}),OpenDesktopMedia:t.extend({message:function(){return this.execTime()+" OpenDesktopMedia: shared desktop, desktopStreamId = "+desktopStreamId}}),OpenDesktopMediaAccessDenied:t.extend({message:function(){return this.execTime()+" OpenDesktopMediaAccessDenied: shared desktop not allow"}}),ShareDesktopExtensionNotFound:t.extend({message:function(){return this.execTime()+" ShareDesktopExtensionNotFound: shared desktop plugin required"}}),OtherDeviceAnswer:t.extend({message:function(){return this.execTime()+" other device answer, webrtc = "+this.rtcId}}),AudioMixerStreamNotAllowSub:t.extend({message:function(){return this.execTime()+" audio mixer stream not allow sub, webrtc = "+this.rtcId+", streamId = "+this.stream.id}}),AudioMixerStreamNotAllowOnlySubVideo:t.extend({message:function(){return this.execTime()+" audio mixer stream not allow only sub video, webrtc = "+this.rtcId+", streamId = "+this.stream.id}}),AudioMixerStreamRepeatPublish:t.extend({message:function(){return this.execTime()+" audio mixer stream repeat publish"}})};
},{"./Util":"Qsy+"}],"VjWY":[function(require,module,exports) {
var e=require("./Util"),s=e.tagLogger("Sess"),t=require("./event"),n=0,r=e.prototypeExtend({setSessId:function(e){return e&&(this.sessId=e),this},setOp:function(e){return e&&(this.op=e),200===e&&(this.res={type:emedia.config.clientType,ver:window._emediaVersion||emedia.config.version,agent:emedia.config.userAgent,ops:emedia.config.acptOps}),this},setTsxId:function(e){return e&&(this.tsxId=e),this},setTicket:function(e){return e&&(this.tkt=e),this},setSdp:function(e){return e&&(this.sdp=e),this},setCands:function(e){return e&&(this.cands=e),this},setSubSId:function(e){return e&&(this.subSId=e),this},setMemId:function(e){return e&&(this.memId=e),this},setPubS:function(s){s&&(this.pubS=e.extend(!1,{},s));var t=this.pubS;return t.ext&&e.isPlainObject(t.ext)&&(t.ext=JSON.stringify(t.ext)),t&&e.forEach(t,function(s,n){(e.isPlainObject(n)||"function"==typeof n)&&e.removeAttribute(t,s)}),t&&e.removeAttribute(t,"localStream"),t&&e.removeAttribute(t,"_localMediaStream"),t&&e.removeAttribute(t,"_webrtc"),this},setRtcId:function(e){return e&&(this.rtcId=e),this},setCver:function(e){return e&&(this.cver=e),this},setEndReason:function(e){return e&&(this.endReason=e),this},setNickName:function(e){return e&&(this.nickName=e),this},setResource:function(e){return e&&(this.resource=e),this},setReason:function(e){return e&&(this.reason=e),this},setConfrId:function(e){return e&&(this.confrId=e),this},setVoff:function(e){return void 0===e||(this.voff=e?1:0),this},setAoff:function(e){return void 0===e||(this.aoff=e?1:0),this},setFlag:function(e){return 0===e&&(this.flag=0),1===e&&(this.flag=1),this},setExt:function(s){return s&&e.isPlainObject(s)&&(s=JSON.stringify(s)),s&&(this.ext=s),this}}),o=emedia.__session_globalCount=0;function i(n,o,i){var c=this;function a(e,s){try{c.onWebsocketEvent(new t.WSClose({url:c.thisWsUri,retry:i,online:c.online,cause:e,event:s,session:c}))}finally{o&&o(new t.WSClose({url:c.thisWsUri,retry:i,online:c.online,cause:e,event:s,session:c}))}}function d(t){if(c.connected(c.thisWsUri)){if(e.isPlainObject(t)&&!(t instanceof r))throw s.error("message not a Messages"),"message not a Messages";if(c.sessId&&t.sessId!=c.sessId)s.warn("self.sessId && message.sessId != self.sessId",t);else{var n=JSON.stringify(t);c.thisWsUri===c._websocket.url&&c._websocket.send(n),c.thisWsUri===c._websocket.url&&s.debug("Done send req:",n,c._websocket.url),c.thisWsUri===c._websocket.url||s.debug("Donot send(url not equal): req:",n,c._websocket.url)}}else s.debug("current dont connect. the message = ",t)}if(c.connected(c.thisWsUri))return n&&n(c),s.info("Session connected. dont continue connect"),void(c.notifyNewMessage&&c.notifyNewMessage());if(c.online){c.notifyNewMessage=function(){if(c.connected(c.thisWsUri)){if(0===c._bufferedMessages.length)return;for(var t,n=[];t=c._bufferedMessages.shift();)if(t.sessId||c.sessId||200==t.op){if(200===t.op){d(t);break}c.sessId&&!t.sessId&&(t.sessId=c.sessId);var r=d(t);r&&n.push(r)}else n.push(t),s.warn("tmp store message, util enter success!",t);n.length>0&&Array.prototype.push.apply(c._bufferedMessages,n)}else if(0!==i&&c.online)c.connected();else{var o=e.extend(!1,{},c._callbacks),a=[];for(var u in o){var l=o[u];i>0&&!c.online?a.push(l):c.onMessage({op:1001,tsxId:u,result:-9527,msg:"sdk rsp fail. retry fail or online = "+c.online})}c._bufferedMessages=c._bufferedMessages||[],a.length>0&&Array.prototype.push.apply(c._bufferedMessages,a)}},s.info("Session begin connect.");var u=c._websocket;u&&(s.warn("will close. websocket state",u.readyState,u.url,c.thisWsUri),u.close(1e3));try{s.info("Connecting",c.thisWsUri,i),u=c._websocket=new WebSocket(c.thisWsUri)}catch(l){return s.warn(l),void a(l)}u.onopen=function(e){var r=this.url;if(r===c.thisWsUri)try{s.info("websocket connected:",r),o&&(o=null),n&&n(c),c.onWebsocketEvent(new t.WSConnected({event:e,session:c}))}finally{}else s.warn("ignore the onopen. caused by websocket url not ",c.thisWsUri,r)},u.onmessage=function(e){var t=this.url;if(t===c.thisWsUri){s.debug("recv data",e.data);var n=JSON.parse(e.data);n&&1001==n.op&&s.debug("recv message: rsp:",n),n&&1001!=n.op&&s.debug("recv message: evt:",n),c.onMessage(n)}else s.warn("ignore recv data. caused by websocket url not ",c.thisWsUri,t,e.data)},u.onclose=function(e){var t=this.url;s.info("Disconnected:",t,c.thisWsUri,e),t===c.thisWsUri?(c.notifyNewMessage(),1e3!==e.code&&a(void 0,e)):s.warn("ignore onclose. caused by websocket url not ",c.thisWsUri,t)},u.onerror=function(e){s.info("On error:",e),c.onWebsocketEvent(new t.WSError({event:e,online:c.online,session:c,url:this.url}))}}else a()}module.exports=e.prototypeExtend({_events:{0:"onReqP2P",1:"onNewCfr",2:"onDelCfr",3:"onReqTkt",100:"onPing",101:"onPong",102:"onInitC",103:"onReqC",104:"onAcptC",105:"onTcklC",106:"onAnsC",107:"onTermC",300:"onEnter",301:"onExit",302:"onPub",303:"onUnpub",304:"onMems",204:"onClose",400:"onStreamControl",401:"onJoin",412:"onRoleUpdate",1002:"onRemoteControl",1003:"onRecvRemoteMessage"},__init__:function(){var e=this;e._bufferedMessages=[],e._callbacks={},navigator.onLine?e.online=!0:e.online=!1,window.addEventListener("online",function(t){e.online=!0,s.warn("online online online"),e.closed||e._reconnect(emedia.config.reconnect)},!0),window.addEventListener("offline",function(t){e.online=!1,s.warn("offline offline offline"),e.__checkConnectIntervalId&&clearTimeout(e.__checkConnectIntervalId),e.__retryConnectIntervalId&&clearTimeout(e.__retryConnectIntervalId),e.__retryConnectIntervalId&&delete e.__retryConnectIntervalId,e._websocket&&e._websocket.close(1e3)},!0),s.info("online status = ",e.online)},_nextWsUri:function(){var e=this.ticket.url,t=emedia.config&&emedia.config.convertWebsocketURLOfTicket||emedia.convertWebsocketURLOfTicket;if("function"==typeof t){var r=e;e=t(e),s.warn(r,"--\x3e",e)}if(e.startsWith("/")){if(emedia.config.wsorigin)e=emedia.config.wsorigin+e;else{var o=window.location.href,i=o.startsWith("https")?"wss://":"ws://",c=o.indexOf("://")+3,a=o.indexOf("/",c);e=i+o.substring(c,a)+e}s.warn("websocket url. update. {} -> {}",this.ticket.url,e)}else emedia.config.wsorigin&&s.warn("emedia.config.wsorigin invalidate. causeby server url {}",e);return e.indexOf("?")>=0?e+="&"+n++:e+="?"+n++,e},_reconnect:function(e){var n=this;function r(){s.warn("Reconnected. at ",e,n._websocket.url),n.__retryConnectIntervalId&&clearTimeout(n.__retryConnectIntervalId),n.__retryConnectIntervalId&&delete n.__retryConnectIntervalId;var r=n.newMessage().setOp(200).setSessId(n._sessionId).setTicket(n.ticket).setNickName(n.nickName||n.ticket.memName).setResource(n.resource).setExt(n.owner.ext);n.postMessage(r,function(e){if(0==e.result)n.onEvent(new t.EnterSuccess({ip:n.owner.ip})),n.owner.onMembers(e.cver,e.mems),n.owner.onStreams(e.cver,e.streams),n.notifyNewMessage();else try{n.onEvent(new t.EnterFail({me:n.owner,cause:new t.RspFail({request:r,response:e})}))}finally{-9527!==e.result&&n.onEvent(new t.ServerRefuseEnter({failed:e.result,msg:e.msg}))}})}n.connect(r,function t(o){if(e<=0)return s.warn("Reconnect end. but fail.",o.url,e),void(n.__retryConnectIntervalId&&delete n.__retryConnectIntervalId);e&&(n.__retryConnectIntervalId=setTimeout(function(){n.connect(r,t,--e)},emedia.config.reconnectDelay))},--e)},__checkConnect:function(){var e=this;e.__checkConnectIntervalId&&clearTimeout(e.__checkConnectIntervalId),emedia.config.checkConnectIntervalMillis&&(e.__checkConnectIntervalId=setTimeout(function(){try{e.online&&!e.connected()&&(e.__retryConnectIntervalId&&s.debug("online, reconnecting..."),e.__retryConnectIntervalId||s.debug("online, but disconnect. will reconnect"),e.__retryConnectIntervalId||e._reconnect(emedia.config.reconnect))}finally{e.__checkConnect()}},emedia.config.checkConnectIntervalMillis))},connect:function(e,n,r){var o=this,c=o.thisWsUri=o._nextWsUri();void 0!==r&&s.warn("begin connect... at retry = ",r,c),i.call(o,function(){try{e.apply(o,arguments)}finally{o.__checkConnect()}},function(e){try{n.apply(o,arguments)}finally{r||e.url!==c||o.onEvent(new t.ServerRefuseEnter({failed:-95270,msg:"sdk reconnect fail. "+c+"|"+e.url}))}},r)},connected:function(e){return this.online&&this._websocket&&(!e||e===this._websocket.url)&&this._websocket.readyState==WebSocket.OPEN},onWebsocketEvent:function(e){this.onEvent(e)},register:function(e){if("object"==typeof e)for(var s in e)this.bind(s,e[s])},bind:function(e,t){var n;if(!(n=this._events[e]))throw s.error("Not supported event = ",e),"Not supported event = "+e;this[n]=t},getSessionId:function(){return this._sessionId},newMessage:function(e){return new r(e)},__modifyMessage:function(t){if(t&&t.sdp&&("string"==typeof t.sdp&&(t.sdp=e.parseJSON(t.sdp)),t.sdp.type&&(t.sdp.type=t.sdp.type.toLowerCase()),t.cctx&&(t.sdp.cctx=t.cctx)),t&&t.cands){"string"==typeof t.cands&&(t.cands=e.parseJSON(t.cands));for(var n=0;n<t.cands.length;n++)"string"==typeof t.cands[n]&&(t.cands[n]=e.parseJSON(t.cands[n])),t.cands[n].sdpMLineIndex=t.cands[n].mlineindex,t.cands[n].sdpMid=t.cands[n].mid,delete t.cands[n].mlineindex,delete t.cands[n].mid,t.cctx&&(t.cands[n].cctx=t.cctx)}if(t&&t.mems){if(!e.isArray(t.mems))return;var r=t.mems;t.mems={},e.forEach(r,function(n,r){r.name&&(r.memName=r.name),t.mems[r.id]=r;var o=r.acptOps={};if(e.forEach(emedia.config.baseAcptOps,function(e,s){o[s]=!0}),r.res&&e.forEach(r.res.ops,function(e,s){o[s]=!0}),r&&r.ext)try{t.mems[r.id].ext=JSON.parse(r.ext)}catch(i){s.debug(i)}})}if(t&&t.mem){t.mem.name&&(t.mem.memName=t.mem.name);var o=t.mem.acptOps={};if(e.forEach(emedia.config.baseAcptOps,function(e,s){o[s]=!0}),t.mem.res&&e.forEach(t.mem.res.ops,function(e,s){o[s]=!0}),t.mem&&t.mem.ext)try{t.mem.ext=JSON.parse(t.mem.ext)}catch(c){s.debug(c)}}if(t&&t.streams){if(!e.isArray(t.streams))return;var i=t.streams;t.streams={},e.forEach(i,function(e,n){if(t.streams[n.id]=n,n&&n.ext)try{t.streams[n.id].ext=JSON.parse(n.ext)}catch(c){s.debug(c)}})}if(t&&t.pubS&&t.pubS&&t.pubS.ext)try{t.pubS.ext=JSON.parse(t.pubS.ext)}catch(c){s.debug(c)}if(t&&t.ext)try{t.ext=JSON.parse(t.ext)}catch(c){s.debug(c)}return t},onMessage:function(n){var r=this;function o(e){var t,n=e.op;(t=r._events[n])&&(t=r[t])?t.call(r,e):s.warn("Not supported event = ",e)}if(1001!=n.op&&!n.sessId)throw s.error("message sessId error. server evt data error"),"message sessId error. server evt data error";if(1001!=n.op&&r._sessionId&&r._sessionId!=n.sessId)throw s.error("message sessId error. server and local not equal"),"message sessId error. server and local not equal";if(1004!==n.op){var i;n=r.__modifyMessage(n);var c=e.removeAttribute(r._callbacks,n.tsxId);if(c&&200===c.op){r._sessionId=n.sessId;var a="string"==typeof n.yourIp?n.yourIp:void 0;if("string"==typeof r._session_ip&&a!=r._session_ip&&(i=r._session_ip),s.info(r._sessionId,"ip is",a,i),r._session_ip=a,r.owner.ip=a,0===n.result){for(var d in r._bufferedMessages){var u=r._bufferedMessages[d];u.sessId||200===u.op||(u.sessId=n.sessId)}setTimeout(function(){r.notifyNewMessage()},100)}else for(var l;l=r._bufferedMessages.shift();)200!==l.op&&r.onMessage({op:1001,tsxId:l.tsxId,result:-9527,msg:"sdk enter fail. sdk callback. enter result = "+n.result})}if(r.owner&&r.owner.closed)s.warn("self closed. me is "+r.owner.getMemberId()+", session_id = "+r.getSessionId()+". drop message",n);else{if(r.onEvent(new t.RecvResponse({request:c,response:n})),c&&c.__callback__&&1004!==n.op)return c.__callback__(n),void(i&&r.onWebsocketEvent(new t.NetworkChanaged({preIp:i,nowIp:r._session_ip})));n.op&&1001!=n.op?(o(n),i&&r.onWebsocketEvent(new t.NetworkChanaged({preIp:i,nowIp:r._session_ip}))):s.debug("Igron message. caused by op not found.",n)}}else o(n)},__modifyMessageForPost:function(s){if(s.cands){for(var t=[],n=s.cands,r=0;r<n.length;r++){var o;0==r&&n[r].cctx&&(s.cctx=n[r].cctx),o="string"==typeof n[r]?{type:"candidate",candidate:n[r],mlineindex:0,mid:"audio"}:{type:"candidate",candidate:n[r].candidate,mlineindex:n[r].sdpMLineIndex,mid:n[r].sdpMid},t.push(JSON.stringify(o))}s.cands=t}if(s.sdp&&"string"!=typeof s.sdp){var i={type:s.sdp.type,sdp:s.sdp.sdp};s.sdp.cctx&&(s.cctx=s.sdp.cctx),s.sdp=i,s.sdp.type=s.sdp.type.toUpperCase(),s.sdp=e.stringifyJSON(s.sdp)}return s.pubS&&e.removeAttribute(s.pubS,"_located"),s.pubS&&e.removeAttribute(s.pubS,"mutedMuted"),s.pubS&&e.removeAttribute(s.pubS,"mediaStream"),s.pubS&&e.removeAttribute(s.pubS,"isRepublished"),s.pubS&&e.removeAttribute(s.pubS,"optimalVideoCodecs"),"function"==typeof s.post&&e.removeAttribute(s,"post"),s},postMessage:function(t,n,r){var i=this;if(t.tsxId||(t.tsxId="MSG"+Date.now()+"-"+o++),t.memId){var c=i.owner._cacheMembers[t.memId];if(!c)return s.warn("Member not found at local. memberId = "+t.memId,t),void(n&&n({op:1001,tsxId:t.tsxId,result:-507,msg:" member not found at local. memberId = "+t.memId}));var a=t._reqOps;for(var d in a||(a=[]).push(t.op),a){var u=a[d];if(!c.acptOps[u])return s.warn("Member not accept op "+u+", "+t.memId,t),void(n&&n({op:1001,tsxId:t.tsxId,result:-507,msg:" member not accept op "+u+", "+t.memId}))}}if(e.removeAttribute(t,"_reqOps"),i._sessionId&&i._sessionId!=t.sessId)return s.warn("sessionId not excepted. self._sessionId = "+i._sessionId,t),void(n&&n({op:1001,tsxId:t.tsxId,result:-9527,msg:"sessionId not excepted."}));if(i.closed)return s.warn("session closed.",t),void(n&&n({op:1001,tsxId:t.tsxId,result:-9527,msg:"session closed"}));var l=e.extend({},t);if(!(t=i.__modifyMessageForPost(t)))return s.warn("Message drop. callback success.",t),void(n&&n({op:1001,tsxId:l.tsxId,result:0,msg:"Message drop. callback success."}));200===t.op?(i._bufferedMessages.unshift(t),n&&setTimeout(function(){i._callbacks[t.tsxId]&&(s.error("Enter timeout. fail."),i.onMessage({op:1001,tsxId:t.tsxId,result:-9527,msg:"enter timeout. millis = "+emedia.config.enterTimeout}))},emedia.config.enterTimeout)):i._bufferedMessages.push(t),n&&(i._callbacks[t.tsxId]=e.extend(t,{__callback__:n.bind(i.owner)})),i.notifyNewMessage&&i.notifyNewMessage(),r&&n&&setTimeout(function(){var s=i._callbacks[s.tsxId];s&&s.__callback__&&s.__callback__({op:1001,tsxId:l.tsxId,result:-408,msg:"Message request timeout."}),e.removeAttribute(i._callbacks,s.tsxId)},r)},close:function(e){s.warn("sessiong closing, reason = ",e);this.notifyNewMessage&&this.notifyNewMessage(),this.closed=!0,this.seqno=0,this._websocket&&(0==e||100==e?this._websocket.close(1e3):this._websocket.close()),this.__retryConnectIntervalId&&clearTimeout(this.__retryConnectIntervalId),this.__retryConnectIntervalId&&delete this.__retryConnectIntervalId,this.__checkConnectIntervalId&&clearTimeout(this.__checkConnectIntervalId),this.__checkConnectIntervalId&&delete this.__checkConnectIntervalId,this.owner=null,this._bufferedMessages=[],this._callbacks={},s.warn("session closed")}});
},{"./Util":"Qsy+","./event":"zP2G"}],"Dn8O":[function(require,module,exports) {
"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(r){return r.trim().split("\n").map(function(r){return r.trim()})},r.splitSections=function(r){return r.split("\nm=").map(function(r,e){return(e>0?"m="+r:r).trim()+"\r\n"})},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter(function(r){return 0===r.indexOf(t)})},r.parseCandidate=function(r){for(var e,t={foundation:(e=0===r.indexOf("a=candidate:")?r.substring(12).split(" "):r.substring(10).split(" "))[0],component:parseInt(e[1],10),protocol:e[2].toLowerCase(),priority:parseInt(e[3],10),ip:e[4],address:e[4],port:parseInt(e[5],10),type:e[7]},n=8;n<e.length;n+=2)switch(e[n]){case"raddr":t.relatedAddress=e[n+1];break;case"rport":t.relatedPort=parseInt(e[n+1],10);break;case"tcptype":t.tcpType=e[n+1];break;case"ufrag":t.ufrag=e[n+1],t.usernameFragment=e[n+1];break;default:t[e[n]]=e[n+1]}return t},r.writeCandidate=function(r){var e=[];e.push(r.foundation),e.push(r.component),e.push(r.protocol.toUpperCase()),e.push(r.priority),e.push(r.address||r.ip),e.push(r.port);var t=r.type;return e.push("typ"),e.push(t),"host"!==t&&r.relatedAddress&&r.relatedPort&&(e.push("raddr"),e.push(r.relatedAddress),e.push("rport"),e.push(r.relatedPort)),r.tcpType&&"tcp"===r.protocol.toLowerCase()&&(e.push("tcptype"),e.push(r.tcpType)),(r.usernameFragment||r.ufrag)&&(e.push("ufrag"),e.push(r.usernameFragment||r.ufrag)),"candidate:"+e.join(" ")},r.parseIceOptions=function(r){return r.substr(14).split(" ")},r.parseRtpMap=function(r){var e=r.substr(9).split(" "),t={payloadType:parseInt(e.shift(),10)};return e=e[0].split("/"),t.name=e[0],t.clockRate=parseInt(e[1],10),t.channels=3===e.length?parseInt(e[2],10):1,t.numChannels=t.channels,t},r.writeRtpMap=function(r){var e=r.payloadType;void 0!==r.preferredPayloadType&&(e=r.preferredPayloadType);var t=r.channels||r.numChannels||1;return"a=rtpmap:"+e+" "+r.name+"/"+r.clockRate+(1!==t?"/"+t:"")+"\r\n"},r.parseExtmap=function(r){var e=r.substr(9).split(" ");return{id:parseInt(e[0],10),direction:e[0].indexOf("/")>0?e[0].split("/")[1]:"sendrecv",uri:e[1]}},r.writeExtmap=function(r){return"a=extmap:"+(r.id||r.preferredId)+(r.direction&&"sendrecv"!==r.direction?"/"+r.direction:"")+" "+r.uri+"\r\n"},r.parseFmtp=function(r){for(var e,t={},n=r.substr(r.indexOf(" ")+1).split(";"),a=0;a<n.length;a++)t[(e=n[a].trim().split("="))[0].trim()]=e[1];return t},r.writeFmtp=function(r){var e="",t=r.payloadType;if(void 0!==r.preferredPayloadType&&(t=r.preferredPayloadType),r.parameters&&Object.keys(r.parameters).length){var n=[];Object.keys(r.parameters).forEach(function(e){r.parameters[e]?n.push(e+"="+r.parameters[e]):n.push(e)}),e+="a=fmtp:"+t+" "+n.join(";")+"\r\n"}return e},r.parseRtcpFb=function(r){var e=r.substr(r.indexOf(" ")+1).split(" ");return{type:e.shift(),parameter:e.join(" ")}},r.writeRtcpFb=function(r){var e="",t=r.payloadType;return void 0!==r.preferredPayloadType&&(t=r.preferredPayloadType),r.rtcpFeedback&&r.rtcpFeedback.length&&r.rtcpFeedback.forEach(function(r){e+="a=rtcp-fb:"+t+" "+r.type+(r.parameter&&r.parameter.length?" "+r.parameter:"")+"\r\n"}),e},r.parseSsrcMedia=function(r){var e=r.indexOf(" "),t={ssrc:parseInt(r.substr(7,e-7),10)},n=r.indexOf(":",e);return n>-1?(t.attribute=r.substr(e+1,n-e-1),t.value=r.substr(n+1)):t.attribute=r.substr(e+1),t},r.parseSsrcGroup=function(r){var e=r.substr(13).split(" ");return{semantics:e.shift(),ssrcs:e.map(function(r){return parseInt(r,10)})}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(r){var e=r.substr(14).split(" ");return{algorithm:e[0].toLowerCase(),value:e[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(r,e){var t="a=setup:"+e+"\r\n";return r.fingerprints.forEach(function(r){t+="a=fingerprint:"+r.algorithm+" "+r.value+"\r\n"}),t},r.getIceParameters=function(e,t){var n=r.splitLines(e);return{usernameFragment:(n=n.concat(r.splitLines(t))).filter(function(r){return 0===r.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(r){return 0===r.indexOf("a=ice-pwd:")})[0].substr(10)}},r.writeIceParameters=function(r){return"a=ice-ufrag:"+r.usernameFragment+"\r\na=ice-pwd:"+r.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(" "),a=3;a<n.length;a++){var s=n[a],i=r.matchPrefix(e,"a=rtpmap:"+s+" ")[0];if(i){var p=r.parseRtpMap(i),c=r.matchPrefix(e,"a=fmtp:"+s+" ");switch(p.parameters=c.length?r.parseFmtp(c[0]):{},p.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+s+" ").map(r.parseRtcpFb),t.codecs.push(p),p.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(p.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(r.parseExtmap(e))}),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(r){return void 0!==r.preferredPayloadType?r.preferredPayloadType:r.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)});var a=0;return t.codecs.forEach(function(r){r.maxptime>a&&(a=r.maxptime)}),a>0&&(n+="a=maxptime:"+a+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){n+=r.writeExtmap(e)}),n},r.parseRtpEncodingParameters=function(e){var t,n=[],a=r.parseRtpParameters(e),s=-1!==a.fecMechanisms.indexOf("RED"),i=-1!==a.fecMechanisms.indexOf("ULPFEC"),p=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(r){return"cname"===r.attribute}),c=p.length>0&&p[0].ssrc,o=r.matchPrefix(e,"a=ssrc-group:FID").map(function(r){return r.substr(17).split(" ").map(function(r){return parseInt(r,10)})});o.length>0&&o[0].length>1&&o[0][0]===c&&(t=o[0][1]),a.codecs.forEach(function(r){if("RTX"===r.name.toUpperCase()&&r.parameters.apt){var e={ssrc:c,codecPayloadType:parseInt(r.parameters.apt,10)};c&&t&&(e.rtx={ssrc:t}),n.push(e),s&&((e=JSON.parse(JSON.stringify(e))).fec={ssrc:c,mechanism:i?"red+ulpfec":"red"},n.push(e))}}),0===n.length&&c&&n.push({ssrc:c});var u=r.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substr(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(r){r.maxBitrate=u})),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(r){return"cname"===r.attribute})[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var a=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=a.length>0,t.compound=0===a.length;var s=r.matchPrefix(e,"a=rtcp-mux");return t.mux=s.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var a=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(r){return"msid"===r.attribute});return a.length>0?{stream:(t=a[0].value.split(" "))[0],track:t[1]}:void 0},r.parseSctpDescription=function(e){var t,n=r.parseMLine(e),a=r.matchPrefix(e,"a=max-message-size:");a.length>0&&(t=parseInt(a[0].substr(19),10)),isNaN(t)&&(t=65536);var s=r.matchPrefix(e,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(r.matchPrefix(e,"a=sctpmap:").length>0){var i=r.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(i[0],10),protocol:i[1],maxMessageSize:t}}},r.writeSctpDescription=function(r,e){var t=[];return t="DTLS/SCTP"!==r.protocol?["m="+r.kind+" 9 "+r.protocol+" "+e.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+e.port+"\r\n"]:["m="+r.kind+" 9 "+r.protocol+" "+e.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+e.port+" "+e.protocol+" 65535\r\n"],void 0!==e.maxMessageSize&&t.push("a=max-message-size:"+e.maxMessageSize+"\r\n"),t.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){var a=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||r.generateSessionId())+" "+a+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,a){var s=r.writeRtpDescription(e.kind,t);if(s+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),s+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),s+="a=mid:"+e.mid+"\r\n",e.direction?s+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?s+="a=sendrecv\r\n":e.rtpSender?s+="a=sendonly\r\n":e.rtpReceiver?s+="a=recvonly\r\n":s+="a=inactive\r\n",e.rtpSender){var i="msid:"+a.id+" "+e.rtpSender.track.id+"\r\n";s+="a="+i,s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+i,e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+i,s+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return s+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(s+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),s},r.getDirection=function(e,t){for(var n=r.splitLines(e),a=0;a<n.length;a++)switch(n[a]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[a].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(r){return"0"===r.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=r.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"==typeof module&&(module.exports=r);
},{}],"BwOA":[function(require,module,exports) {
var e=require("./Util"),t=e.tagLogger("Webrtc"),i=require("sdp"),o={headerSection:null,audioSection:null,videoSection:null,_parseHeaderSection:function(e,t,i){var o=t;return-1===i||(o=-1===t?i:Math.min(t,i)),o>=0?e.slice(0,o):e},_parseAudioSection:function(e,t,i){var o=t;if(o>=0)return e.slice(o,i<o?e.length:i)},_parseVideoSection:function(e,t,i){var o=i;if(o>=0)return e.slice(o,t<o?e.length:t)},spiltSection:function(e){this._preSDP=e;var t=this._preAudioIndex=e.indexOf("m=audio"),i=this._preVideoIndex=e.indexOf("m=video");this.headerSection=this._parseHeaderSection(e,t,i),this.audioSection=this._parseAudioSection(e,t,i),this.videoSection=this._parseVideoSection(e,t,i)},setVideoBitrate:function(e){e&&this.videoSection&&(this.videoSection=this.setBitrate(this.videoSection,e))},setVideoMinBitrate:function(e){this.setAllFmtpBitrate({"x-google-min-bitrate":e})},setVideoMaxBitrate:function(e){this.setAllFmtpBitrate({"x-google-max-bitrate":e})},setVideoStartBitrate:function(e){this.setAllFmtpBitrate({"x-google-start-bitrate":e})},setAllFmtpBitrate:function(e){if(this.videoSection){var t={};Object.keys(e).forEach(function(i){var o=i+"="+e[i],n=new RegExp("(a=fmtp\\:\\d+\\s\\S*;?)("+i+"=\\d+)(;?\\S*)","g");t[i]={field:o,regex:n}}),this.videoSection=this.videoSection.replace(/(a=fmtp\:\d+[^\r\n]+)([\r\n]+)/g,function(e,i,o){return i.indexOf("apt=")>=0?e:(Object.keys(t).forEach(function(e){var o=t[e],n=o.regex,r=o.field,c=i.replace(n,function(e,t,i,o){return t+r+o});c.indexOf(e)<0?(c.endsWith(";")||(c+=";"),i=c+r):i=c}),i+o)})}},setFmtpBitrate:function(e,t){if(t&&this.videoSection){var i=e+"="+t,o=new RegExp("(a=fmtp\\:\\d+\\s\\S*;?)("+e+"=\\d+)(;?\\S*)","g");this.videoSection=this.videoSection.replace(/(a=fmtp\:\d+[^\r\n]+)([\r\n]+)/g,function(t,n,r){var c=n.replace(o,function(e,t,o,n){return t+i+n});return c.indexOf(e)<0&&(c.endsWith(";")||(c+=";"),c+=i),c+r})}},setAudioBitrate:function(e){e&&this.audioSection&&(this.audioSection=this.setBitrate(this.audioSection,e))},setBitrate0:function(e,t){return(e=e.replace(/(b=)(?:AS|TIAS)(\:)\d+/g,"$1AS$2"+t)).indexOf("b=AS")<0&&(e=e.replace(/(m=(?:audio|video)[^\r\n]+)([\r\n]+)/g,"$1$2b=AS:"+t+"$2")),e},setBitrate:function(e,t){let i="AS";return emedia.isFirefox&&(t=1e3*(t>>>0),i="TIAS"),(e=e.replace(/(b=)(?:AS|TIAS)(\:)\d+/g,"$1"+i+"$2"+t)).indexOf("b="+i+":")<0&&(e=e.indexOf("c=IN ")<0?e.replace(/(m=(?:audio|video)[^\r\n]+)([\r\n]+)/g,"$1$2b="+i+":"+t+"$2"):e.replace(/c=IN ([^\r\n]+)([\r\n]+)/,"c=IN $1$2b="+i+":"+t+"$2")),e},updateVideoSection:function(e,t){this.videoSection&&(this.videoSection=this.videoSection.replace(e,t))},updateAudioSection:function(e,t){this.audioSection&&(this.audioSection=this.audioSection.replace(e,t))},updateVideoSendonly:function(){this.videoSection&&(this.videoSection=this.videoSection.replace(/sendrecv/g,"sendonly"))},updateVideoRecvonly:function(){this.videoSection&&(this.videoSection=this.videoSection.replace(/sendrecv/g,"recvonly"))},updateAudioSendonly:function(){this.audioSection&&(this.audioSection=this.audioSection.replace(/sendrecv/g,"sendonly"))},updateAudioRecvonly:function(){this.audioSection&&(this.audioSection=this.audioSection.replace(/sendrecv/g,"recvonly"))},updateACodes:function(i){if(i&&this.audioSection){if("string"==typeof i)(n=[]).push(i),i=n;for(var o={},n=this._parseLine(this.audioSection,/a=rtpmap:(\d+) ([A-Za-z0-9]+)\/.*/gi),r=0;r<n.length;r++){var c=n[++r];o[n[++r]]=c}var d=[];for(r=0;r<i.length;r++){var s=o[i[r]];s&&d.push(s)}0==d.length&&(this._webrtc?t.warn("Not found acodes map",i,this._webrtc._rtcId,this._webrtc.__id):t.warn("Not found acodes map",i));var a=this.audioSection.indexOf("\r"),_=this.audioSection.substring(0,a),u=_.split(" ");Array.prototype.push.apply(d,u.slice(3));var f=[],h={};e.forEach(d,function(e,t){0==f.length?(f.push(t),h[t]=!0):h[t]||(f.push(t),h[t]=!0)}),u.splice(3,u.length-3,f.join(" ")),_=u.join(" "),this._webrtc&&t.warn(_,this._webrtc._rtcId,this._webrtc.__id),this.audioSection=_+this.audioSection.substring(a)}},updateVCodes:function(i){if(i&&this.videoSection){if("string"==typeof i)(n=[]).push(i),i=n;for(var o={},n=this._parseLine(this.videoSection,/a=rtpmap:(\d+) ([A-Za-z0-9]+)\/.*/gi),r=0;r<n.length;r++){var c=n[++r];o[n[++r]]=c}var d=this._parseLine(this.videoSection,/a=fmtp:(\d+) .*profile-level-id=42e01f;?.*/gi);d&&d.length>=2&&(o.H264=d[1]);var s=[];for(r=0;r<i.length;r++){var a=o[i[r]];a&&s.push(a)}0==s.length&&(this._webrtc?t.warn("Not found vcodes map",i,this._webrtc._rtcId,this._webrtc.__id):t.warn("Not found vcodes map",i));var _=this.videoSection.indexOf("\r"),u=this.videoSection.substring(0,_),f=u.split(" ");Array.prototype.push.apply(s,f.slice(3));var h=[],p={};e.forEach(s,function(e,t){0==h.length?(h.push(t),p[t]=!0):p[t]||(h.push(t),p[t]=!0)}),f.splice(3,f.length-3,h.join(" ")),u=f.join(" "),this._webrtc&&t.warn(u,this._webrtc._rtcId,this._webrtc.__id),this.videoSection=u+this.videoSection.substring(_)}},removeSSRC:function(e){for(var t=[],i=e.split(/a=ssrc:[^\n]+/g),o=0;o<i.length;o++)"\n"!=i[o]&&t.push(i[o]);return t.join("\n")},removeField_msid:function(e){for(var t=[],i=e.split(/a=msid:[^\n]+/g),o=0;o<i.length;o++)"\n"!=i[o]&&t.push(i[o]);e=t.join("\n"),t=[],i=e.split(/[\n]+/g);for(o=0;o<i.length;o++)"\n"!=i[o]&&t.push(i[o]);return t.join("\n")},updateHeaderMsidSemantic:function(e){var t="a=msid-semantic: WMS "+e,i=this.headerSection.split(/a=msid\-semantic: WMS.*/g),o=[];switch(i.length){case 1:o.push(i[0]);break;case 2:o.push(i[0]),o.push(t),o.push("\n");break;case 3:o.push(i[0]),o.push(t),o.push("\n"),o.push(i[2]),o.push("\n")}return this.headerSection=o.join("")},updateAudioSSRCSection:function(e,t,i,o){this.audioSection&&(this.audioSection=this.removeSSRC(this.audioSection)),this.audioSection&&(this.audioSection=this.removeField_msid(this.audioSection)),this.audioSection&&(this.audioSection=this.audioSection+this.ssrcSection(e,t,i,o))},updateVideoSSRCSection:function(e,t,i,o){this.videoSection&&(this.videoSection=this.removeSSRC(this.videoSection)),this.videoSection&&(this.videoSection=this.removeField_msid(this.videoSection)),this.videoSection&&(this.videoSection=this.videoSection+this.ssrcSection(e,t,i,o))},getUpdatedSDP:function(e){var t,i,o;if(void 0!==e&&null!=e||(e=this._preAudioIndex<this._preVideoIndex),this.videoSection&&this.videoSection.replace(/a=mid:([^\r\n]+)/,function(e,i){return t=i,e}),this.audioSection&&this.audioSection.replace(/a=mid:([^\r\n]+)/,function(e,t){return i=t,e}),e){var n=["a=group:BUNDLE"];this.audioSection&&n.push(i),this.videoSection&&n.push(t),o=this.headerSection.replace(/a=group:BUNDLE [^\r\n]+/,n.join(" ")),this.audioSection&&(o+=this.audioSection),this.videoSection&&(o+=this.videoSection)}else{n=["a=group:BUNDLE"];this.videoSection&&n.push(t),this.audioSection&&n.push(i),o=this.headerSection.replace(/a=group:BUNDLE [^\r\n]+/,n.join(" ")),this.videoSection&&(o+=this.videoSection),this.audioSection&&(o+=this.audioSection)}return o},parseMsidSemantic:function(e){var t=this._parseLine(e,/a=msid\-semantic:\s*WMS (\S+)/gi);return t&&2==t.length&&(this.msidSemantic={line:t[0],WMS:t[1]}),this.msidSemantic},ssrcSection:function(e,t,i,o){return["a=ssrc:"+e+" cname:"+t,"a=ssrc:"+e+" msid:"+i+" "+o,"a=ssrc:"+e+" mslabel:"+i,"a=ssrc:"+e+" label:"+o,""].join("\n")},parseSSRC:function(e){var t=new RegExp("a=(ssrc):(\\d+) (\\S+):(\\S+)","ig"),i=this._parseLine(e,t);if(i){for(var o={lines:[],updateSSRCSection:this.ssrcSection},n=0;n<i.length;n++){var r=i[n];if(r.indexOf("a=ssrc")>=0)o.lines.push(r);else switch(r){case"ssrc":case"cname":case"msid":case"mslabel":case"label":o[r]=i[++n]}}return o}},_parseLine:function(e,t){for(var i,o=[];null!=(i=t.exec(e));)for(var n=0;n<i.length;n++)o.push(i[n]);if(o.length>0)return o}},n=function(t,i){e.extend(this,o),this._webrtc=i,this.spiltSection(t)};n.isAudioVideo=function(e){return e.indexOf("m=audio")<e.indexOf("m=video")},n.isVideoPreAudio=function(e){var t=e.indexOf("m=audio"),i=e.indexOf("m=video");return t>=0&&i>=0&&i<t};var r=emedia.__rtc_globalCount=0,c=e.prototypeExtend({closed:!1,sdpConstraints:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},offerOptions:{offerToReceiveAudio:!0,offerToReceiveVideo:!0},optimalVideoCodecs:null,optimalAudioCodecs:null,__init__:function(){this._rtcId||(this._rtcId="RTC"+r++),this.__id="_i_"+r++,this.__setRemoteSDP=!1,this.__tmpRemoteCands=[],this.__tmpLocalCands=[],this._rtcPeerConnection=null,this.cctx=this.__id,emedia&&emedia.config&&emedia.config.forceUseVideoCodecs&&emedia.config.forceUseVideoCodecs.length>0&&(this.optimalVideoCodecs=emedia.config.forceUseVideoCodecs),emedia&&emedia.config&&emedia.config.forceUseAudioCodecs&&emedia.config.forceUseAudioCodecs.length>0&&(this.optimalAudioCodecs=emedia.config.forceUseAudioCodecs),emedia&&emedia.config&&"number"==typeof emedia.config.forceVideoBitrate&&(this.vbitrate=emedia.config.forceVideoBitrate),emedia&&emedia.config&&"number"==typeof emedia.config.forceMinVideoBitrate&&(this.vminBitrate=emedia.config.forceMinVideoBitrate),emedia&&emedia.config&&"number"==typeof emedia.config.forceAudioBitrate&&(this.abitrate=emedia.config.forceAudioBitrate),t.info("Webrtc created. optimal video codecs:",this.optimalVideoCodecs,"audio codecs:",this.optimalAudioCodecs,"vbitrate:",this.vbitrate,"vminBitrate:",this.vminBitrate,"abitrate:",this.abitrate,this._rtcId,this.__id)},getRtcId:function(){return this._rtcId},iceState:function(){return this._rtcPeerConnection.iceConnectionState},setSubArgs:function(e){this.subArgs=e},getReceiversOfPeerConnection:function(){if(this._rtcPeerConnection&&"closed"!=this._rtcPeerConnection.iceConnectionState)return this._rtcPeerConnection.getReceivers()},updateRemoteBySubArgs:function(){this.subArgs&&this._remoteStream&&(emedia.enableVideoTracks(this._remoteStream,!(this.subArgs&&!1===this.subArgs.subSVideo)),emedia.enableAudioTracks(this._remoteStream,!(this.subArgs&&!1===this.subArgs.subSAudio)),t.info("enable tracks remote stream",this._remoteStream,this.subArgs,this._rtcId,this.__id,this.closed))},createRtcPeerConnection:function(e){var i=this;t.debug("begin create peer connection ......",i._rtcId,i.__id,i.closed),e||(e=i.iceServerConfig),e||emedia.isEdge?(e||(e={}),!e.iceServers&&(e.iceServers=[]),e.rtcpMuxPolicy="require",e.bundlePolicy="max-bundle",e.relayOnly&&(e.iceTransportPolicy="relay")):e=null,emedia&&emedia.config&&"function"==typeof emedia.config.reconfigRTCConfiguration&&(e=emedia.config.reconfigRTCConfiguration(e)),t.info("create pc, set config:",e,i._rtcId,i.__id,i.closed);var o=i._rtcPeerConnection=new RTCPeerConnection(e);function n(e){t.info("states: connectionState",o.connectionState,", iceConnectionState",o.iceConnectionState,"@",i._rtcId,i.__id,i.closed);try{var n=o.iceConnectionState||o.connectionState;"failed"!=o.connectionState&&"failed"!=o.iceConnectionState||(n="failed"),i.lastIceConnectionState!==n&&(i.lastIceConnectionState=n,i.onIceStateChange(n))}finally{}}o.__peerId=i._rtcId,t.debug("created local peer connection object",o,i._rtcId),o.onicecandidate=function(e){var o=e.candidate;if("icecandidate"!=e.type||o&&("string"!=typeof o.protocol||"tcp"!==o.protocol.toLowerCase())&&!/ TCP /.test(o.candidate)){if(!o.candidate)throw t.error("Not found candidate. candidate is error"),"Not found candidate. candidate is error,";if(o.cctx=i.cctx,!i.__setRemoteSDP)return(i.__tmpLocalCands||(i.__tmpLocalCands={})).push(o),void t.debug("On ICE candidate ok: but tmp buffer caused by not set remote sdp: ",o,i._rtcId,i.__id,i.closed);t.debug("On ICE candidate ok: ",o,i._rtcId,i.__id,i.closed),i._onIceCandidate(o)}else t.debug("On ICE candidate: drop",o,i._rtcId,i.__id,i.closed)},i.lastIceConnectionState="",o.onconnectionstatechange=n.bind(i),o.onicestatechange=n.bind(i),o.oniceconnectionstatechange=n.bind(i),o.onsignalingstatechange=function(e){t.info("states: signaling",o.signalingState,"@",i._rtcId,i.__id,i.closed)},null===o.ontrack&&i._onTrack&&(o.ontrack=function(e){i._onTrack(e)}),o.onaddstream=function(e){i._onGotRemoteStream(e)}},addTrack:function(e,i){var o=this;e.forEach(function(e){o._rtcPeerConnection.addTrack(e,i),t.debug("Added track(",e.id,e.kind,e.label,") of stream(",i.id,") to RtcPeerConnection",o._rtcId,o.__id,o.closed)})},setLocalStream:function(e){var i=this;if(i._localStream=e,i._rtcPeerConnection.addTrack)e.getTracks().forEach(function(o){i._rtcPeerConnection.addTrack(o,e),t.debug("Added track(",o.enabled,o.id,o.kind,o.label,") of localStream(",e.id,") to RtcPeerConnection",i._rtcId,i.__id,i.closed)});else{i._rtcPeerConnection.addStream(e);var o=e.getVideoTracks(),n=e.getAudioTracks();o&&o.length>0&&t.debug("RtcPeerConnection video: ",o[0].enabled,o[0].id,o[0].kind,o[0].label,i._rtcId,i.__id,i.closed),n&&n.length>0&&t.debug("RtcPeerConnection audio: ",n[0].enabled,n[0].id,n[0].kind,n[0].label,i._rtcId,i.__id,i.closed)}t.debug("Added local stream to RtcPeerConnection",e.id,e.active,i._rtcId,i.__id,this.closed)},removeStream:function(e){this._rtcPeerConnection.removeStream(e),t.debug("Remove stream from RtcPeerConnection",e,self._rtcId,self.__id,this.closed)},getLocalStream:function(){return this._localStream},getRemoteStream:function(){return this._remoteStream},createOffer:function(i,o){var r=this;t.debug("createOffer start...",r.offerOptions,r._rtcId,r.__id);var c=e.extend({},r.offerOptions);return r.subArgs&&(c={offerToReceiveAudio:!0,offerToReceiveVideo:!0}),r._rtcPeerConnection.createOffer(c).then(function(e){if(r.offerDescription=e,emedia.isEdge&&(e.sdp=e.sdp.replace(/profile-level-id=[^;]+/,"profile-level-id=42e01f")),emedia.isFirefox?r.fireFoxOfferVideoPreAudio=r.__offerVideoPreAudio=n.isVideoPreAudio(e.sdp):r.__offerVideoPreAudio=n.isVideoPreAudio(e.sdp),e.sdp=e.sdp.replace(/m=video 0/g,"m=video 9"),t.warn("setLocalDescription. modify offer. if 'm=video 0' -> 'm=video 9'; if H264, 'profile-level-id=42e01f'",r._rtcId,r.__id),r.optimalVideoCodecs&&r.optimalVideoCodecs.length>0||r.optimalAudioCodecs&&r.optimalAudioCodecs.length>0||r.offerOptions&&(!1===r.offerOptions.offerToReceiveVideo||!1===r.offerOptions.offerToReceiveAudio)){var o=new n(e.sdp,r);r.optimalVideoCodecs&&o.updateVCodes(r.optimalVideoCodecs),r.optimalAudioCodecs&&o.updateACodes(r.optimalAudioCodecs),r.offerOptions&&!1===r.offerOptions.offerToReceiveVideo&&o.updateVideoSection(/a=sendrecv|a=recvonly/g,"a=sendonly"),r.offerOptions&&!1===r.offerOptions.offerToReceiveAudio&&o.updateAudioSection(/a=sendrecv|a=recvonly/g,"a=sendonly"),e.sdp=o.getUpdatedSDP()}t.debug("setLocalDescription start",r._rtcId,r.__id,r.closed,r.optimalVideoCodecs,r.optimalAudioCodecs),r._rtcPeerConnection.setLocalDescription(e).then(r._onSetLocalSessionDescriptionSuccess.bind(r),r._onSetSessionDescriptionError.bind(r,e)).then(function(){e.cctx=r.cctx,(i||r.onCreateOfferSuccess.bind(r))(e)})},o||r._onCreateSessionDescriptionError.bind(r,c))},createPRAnswer:function(e,i){var o=this;return t.info(" createPRAnswer start",o.closed,o.sdpConstraints),o._rtcPeerConnection.createAnswer(o.sdpConstraints).then(function(i){t.debug("_____________PRAnswer ",i.sdp,o._rtcId,o.__id,o.closed),i.type="pranswer",i.sdp=i.sdp.replace(/a=recvonly/g,"a=inactive");var r=new n(i.sdp,o);o.optimalVideoCodecs&&r.updateVCodes(o.optimalVideoCodecs),o.optimalAudioCodecs&&r.updateACodes(o.optimalAudioCodecs),i.sdp=r.getUpdatedSDP(),o.__prAnswerDescription=i,t.debug("inactive PRAnswer ",i.sdp,o._rtcId,o.__id,o.closed),t.debug("setLocalDescription start",i,o._rtcId,o.__id,o.closed),o._rtcPeerConnection.setLocalDescription(i).then(o._onSetLocalSessionDescriptionSuccess.bind(o),o._onSetSessionDescriptionError.bind(o,i)).then(function(){r.updateHeaderMsidSemantic("MS_0000"),r.updateAudioSSRCSection(1e3,"CHROME0000","MS_0000","LABEL_AUDIO_1000"),r.updateVideoSSRCSection(2e3,"CHROME0000","MS_0000","LABEL_VIDEO_2000"),i.sdp=r.getUpdatedSDP(),t.debug("Send PRAnswer ",i.sdp,o._rtcId,o.__id,o.closed),o.cctx&&(i.cctx=o.cctx),(e||o.onCreatePRAnswerSuccess.bind(o))(i)})},i||o._onCreateSessionDescriptionError.bind(o,o.sdpConstraints))},createAnswer:function(e,i){var o=this;return t.info("createAnswer start",o.closed,o.sdpConstraints),o._rtcPeerConnection.createAnswer(o.sdpConstraints).then(function(i){t.debug("_____________________Answer ",o._rtcId,o.__id,o.closed),i.type="answer";var r=new n(i.sdp,o);o.optimalVideoCodecs&&r.updateVCodes(o.optimalVideoCodecs),o.optimalAudioCodecs&&r.updateACodes(o.optimalAudioCodecs),emedia.supportPRAnswer?function(e){var t=e.parseMsidSemantic(e.headerSection);if(t){"*"==t.WMS&&e.updateHeaderMsidSemantic(t.WMS="MS_0000");var o=e.parseSSRC(e.audioSection),n=e.parseSSRC(e.videoSection);o&&e.updateAudioSSRCSection(1e3,"CHROME0000",t.WMS,o.label||"LABEL_AUDIO_1000"),n&&e.updateVideoSSRCSection(2e3,"CHROME0000",t.WMS,n.label||"LABEL_VIDEO_2000"),i.sdp=e.getUpdatedSDP()}}(r):i.sdp=r.getUpdatedSDP(),o.__answerDescription=i,t.debug("Answer ",o._rtcId,o.__id,o.closed),t.debug("setLocalDescription start",i,o._rtcId,o.__id,o.closed),o._rtcPeerConnection.setLocalDescription(i).then(o._onSetLocalSessionDescriptionSuccess.bind(o),o._onSetSessionDescriptionError.bind(o,i)).then(function(){emedia.supportPRAnswer&&(r.updateHeaderMsidSemantic("MS_0000"),r.updateAudioSSRCSection(1e3,"CHROME0000","MS_0000","LABEL_AUDIO_1000"),r.updateVideoSSRCSection(2e3,"CHROME0000","MS_0000","LABEL_VIDEO_2000"),i.sdp=r.getUpdatedSDP()),t.debug("Send Answer ",o._rtcId,o.__id,o.closed),o.cctx&&(i.cctx=o.cctx),(e||o.onCreateAnswerSuccess.bind(o))(i)})},i||o._onCreateSessionDescriptionError.bind(o,o.sdpConstraints))},_printStats:function(e){var t=this;t.confrAttendee&&emedia.config.remainLastStatsCount&&e&&e.getTracks().forEach(function(e){t._printTrackStats(e)})},_printTrackStats:function(i){if(this.confrAttendee&&emedia.config.remainLastStatsCount){var o=this.confrAttendee._trackStats&&this.confrAttendee._trackStats[i.id];if(o){for(var n in o){var r=o[n];for(var c in r){var d=r[c];if(d)for(var s=d.curIndex,a=0;a<emedia.config.remainLastStatsCount;a++){var _=d[s=(s-1)%emedia.config.remainLastStatsCount];if(!_||void 0===_.data)break;t.info("[track]",this._rtcId,this.__id,i.kind,i.id,n,c,_.data,_.timestamp.toLocaleString())}}}e.removeAttribute(this.confrAttendee._trackStats,i.id)}}},close:function(e,i,o){var n=this;if(t.warn("webrtc closing",n._rtcId,n.__id,n.closed),n.__iceWaitIntervalId&&clearTimeout(n.__iceWaitIntervalId),!n.closed){i=!0===i,n.closed=!0;try{var r=n._localStream,c=n._remoteStream;function d(){if(n._rtcPeerConnection&&n._rtcPeerConnection.close(),t.info("peer connection close. it is",n._rtcPeerConnection&&n._rtcPeerConnection.__peerId),!o&&emedia.isSafari){n._rtcPeerConnection.iceConnectionState||n._rtcPeerConnection.connectionState;setTimeout(function(){n._rtcPeerConnection.iceConnectionState||n._rtcPeerConnection.connectionState;n.onIceStateChange&&n.onIceStateChange("closed")},200)}}emedia.config.printStatsWhenPCClose?n.getStats(()=>{d(),r&&n._printStats(r),c&&n._printStats(c)}):d()}catch(s){t.warn(s)}finally{n._localStream&&!1===e&&emedia.stopTracks(n._localStream),n._remoteStream&&emedia.stopTracks(n._remoteStream),n._remoteStream=null,i||n.onClose&&n.onClose(),!0===o&&(t.info("Webrtc close. but retry build. will onIceStateChange(failed). eg. emedia.config iceWaitBuildMillis",n._rtcId,n.__id),n.onIceStateChange&&n.onIceStateChange("failed")),t.warn("webrtc closed. closed:",n._rtcId,n.__id,n.closed)}}},addIceCandidate:function(i){var o=e.isArray(i)?i:[i];if(emedia&&emedia.config&&"function"==typeof emedia.config.reChanageCandidate){for(var n=[],r=0;r<o.length;r++){i=o[r];var c=emedia.config.reChanageCandidate(i);c&&(t.info("Candidate rechanage. addons. it =",i,"->",c),e.isArray(c)?Array.prototype.push.apply(n,c):n.push(c))}o=n}this._addIceCandidate(o)},_addIceCandidate:function(i){if(this._rtcPeerConnection){t.debug("Add ICE candidate: ",i,this._rtcId,this.__id,this.closed);var o=e.isArray(i)?i:[i];if(!this.__setRemoteSDP)return Array.prototype.push.apply(this.__tmpRemoteCands||(this.__tmpRemoteCands={}),o),void t.debug("Add ICE candidate but tmp buffer caused by not set remote sdp: ",i,this._rtcId,this.__id,this.closed);for(var n=0;n<o.length;n++)if((i=o[n]).cctx&&i.cctx!=this.cctx)t.warn("addIceCandidate fail drop. cctx not equal. ",i,this._rtcId,this.__id,this.closed);else{if(!0===this.fireFoxOfferVideoPreAudio){var r=i.sdpMLineIndex;i.sdpMLineIndex=parseInt(i.sdpMid.replace(/[^0-9]*/,"")),t.warn("Firefox sdp section video pre audio, sdp mline index update ",r,"->",i.sdpMLineIndex)}i.candidate&&""!==i.candidate?this._rtcPeerConnection.addIceCandidate(new RTCIceCandidate(i)).then(this.onAddIceCandidateSuccess.bind(this),this._onAddIceCandidateError.bind(this,i)):t.warn("Add ICE candidate fail. drop it ",i,this._rtcId,this.__id,this.closed)}}},setRemoteDescription:function(e){return this._setRemoteDescription(e)},_setRemoteDescription:function(e){var i=this;if(i.__iceWaitIntervalId&&(clearTimeout(i.__iceWaitIntervalId),i.__iceWaitIntervalId=null,t.info("emedia.config iceWaitBuildMillis, clear ice wait interval id",i._rtcId,i.__id)),t.debug("setRemoteDescription start. ",i._rtcId,i.__id,i.closed),i.offerDescription){if(e.cctx&&e.cctx!=i.cctx)return void t.warn("setRemoteDescription fail drop. cctx not equal. ",e,i._rtcId,i.__id,i.closed);if(!0===i.fireFoxOfferVideoPreAudio||!0===i.__offerVideoPreAudio){var o=new n(e.sdp,i);e.sdp=o.getUpdatedSDP(!1),t.info("Remote sdp.2. switch audio video",e.sdp)}}else e.cctx&&(i.cctx=e.cctx);if(e.sdp=e.sdp.replace(/UDP\/TLS\/RTP\/SAVPF/g,"RTP/SAVPF"),t.warn("setRemoteDescription. UDP/TLS/RTP/SAVPF -> RTP/SAVPF; if firefox: switch audio video;",i._rtcId,i.__id),i.vbitrate||i.abitrate||i.vminBitrate){o=new n(e.sdp,i);i.vbitrate&&o.setVideoBitrate(i.vbitrate),i.vminBitrate&&o.setVideoMinBitrate(i.vminBitrate),i.abitrate&&o.setAudioBitrate(i.abitrate),t.warn("vbitrate = ",i.vbitrate,"vminBitrate = ",this.vminBitrate,", abitrate = ",i.abitrate,i._rtcId,i.__id),e.sdp=o.getUpdatedSDP(void 0===i.__offerVideoPreAudio||null===i.__offerVideoPreAudio?void 0:!i.__offerVideoPreAudio)}return t.debug("final remote sdp =",e.sdp,i._rtcId,i.__id),e=i.__remoteDescription=new RTCSessionDescription(e),i._rtcPeerConnection.setRemoteDescription(e).then(function(){i.__setRemoteSDP=!0,i._onSetRemoteSuccess.apply(i,arguments),i.__tmpLocalCands&&i.__tmpLocalCands.length>0&&(t.debug("After setRemoteDescription. send cands",i._rtcId,i.__id,i.closed),i._onIceCandidate(i.__tmpLocalCands),i.__tmpLocalCands=[]),i.__tmpRemoteCands&&i.__tmpRemoteCands.length>0&&(t.debug("After setRemoteDescription. add tmp cands",i._rtcId,i.__id,i.closed),i._addIceCandidate(i.__tmpRemoteCands),i.__tmpRemoteCands=[])},i._onSetSessionDescriptionError.bind(i,e))},iceConnectionState:function(){return this._rtcPeerConnection.iceConnectionState},isConnected:function(){var e=this.lastIceConnectionState;return"connected"===e||"completed"===e},_onGotRemoteStream:function(e){var i=this;i._remoteStream=e.stream||e.streams[0],i._remoteStream._rtcId=i._rtcId,i._remoteStream.__rtc_c_id=i.__id,t.debug("On got remote stream",i._remoteStream?i._remoteStream.id+"_"+i._remoteStream.active:"null",i._rtcId,i.__id),i._remoteStream&&i._remoteStream.getTracks().forEach(function(e){t.debug("remote stream",i._remoteStream.id," track =",e.enabled,e.id,e.kind,e.label,i._rtcId,i.__id)}),i.updateRemoteBySubArgs(),this.onGotRemoteStream(this._remoteStream,e),t.debug("received remote stream, you will see the other.",i._rtcId,i.__id,this.closed)},_onSetRemoteSuccess:function(){t.info("onSetRemoteSuccess success",this._rtcId,this.__id),this.onSetRemoteSuccess.apply(this,arguments),this.offerDescription&&this.__remoteDescription&&this.__remoteDescription.sdp&&this._onAnswerCodes(this.__remoteDescription.sdp)},_onAnswerCodes:function(o){var r=new n(o,this);if(r.videoSection){var c=i.parseRtpParameters(r.videoSection);if(!c.codecs||0===c.codecs.length)return void t.info("not found any video codes. @ ",this._rtcId,this.__id);var d=[];e.forEach(c.codecs,function(e,t){d.push(t.name)}),this.finalVCodeChoices=d,this.onVCodeChoices&&this.onVCodeChoices(d)}},onSetRemoteSuccess:function(){},onAddIceCandidateSuccess:function(){t.debug("addIceCandidate success",this._rtcId,this.__id)},_onAddIceCandidateError:function(e,i){t.error("failed to add ICE Candidate: "+i.toString(),", error candidate:",e,this._rtcId,this.__id),this.onAddIceCandidateError(i)},onAddIceCandidateError:function(e){},_onIceCandidate:function(e){t.debug("onIceCandidate:",e,this._rtcId,this.__id),this.onIceCandidate(e)},onIceCandidate:function(e){},onIceStateChange:function(e){t.debug("onIceStateChange : ICE state ",e)},_onCreateSessionDescriptionError:function(e,i){t.error("Failed to create session description: "+i.toString()," offerOptionsOrSDPConstraints:",e,this._rtcId,this.__id),this.onCreateSessionDescriptionError(i)},onCreateSessionDescriptionError:function(e){},onCreateOfferSuccess:function(e){t.debug("create offer success",this._rtcId,this.__id)},onCreatePRAnswerSuccess:function(e){t.debug("create answer success",this._rtcId,this.__id)},onCreateAnswerSuccess:function(e){t.debug("create answer success",this._rtcId,this.__id)},_onSetSessionDescriptionError:function(e,i){t.error("onSetSessionDescriptionError : Failed to set session description: ",i.toString(),this._rtcId,this.__id),e&&e.type&&e.sdp&&t.error("error sdp: type=",e.type,"sdp=",e.sdp,this._rtcId,this.__id),this.onSetSessionDescriptionError(i)},onSetSessionDescriptionError:function(e){},_onSetLocalSessionDescriptionSuccess:function(){var e=this;t.debug("onSetLocalSessionDescriptionSuccess : setLocalDescription complete",this._rtcId,this.__id),emedia.config.iceWaitBuildMillis&&(this.__iceWaitIntervalId&&clearTimeout(this.__iceWaitIntervalId),this.__iceWaitIntervalId=setTimeout(function(){t.info("emedia.config iceWaitBuildMillis, timeout, will close webrtc, will retry build by onIceStateChange(failed)",e._rtcId,e.__id),e.onIceStateChange&&e.onIceStateChange("failed")},emedia.config.iceWaitBuildMillis),t.info("emedia.config iceWaitBuildMillis, start timeout",e._rtcId,e.__id)),this.onSetLocalSessionDescriptionSuccess(),this.__answerDescription&&this.__answerDescription.sdp&&this._onAnswerCodes(this.__answerDescription.sdp)},onSetLocalSessionDescriptionSuccess:function(){},onGotRemoteStream:function(e){t.debug("Got remote stream. ",e,this._rtcId,this.__id)},getStats:function(e){var i=this;return i._rtcPeerConnection?"function"!=typeof emedia.config.rtcStatsTypeMath?(t.warn("Get stats, but config rtcStatsTypeMather, ",this._rtcId,this.__id),void(e&&e())):void i._rtcPeerConnection.getStats(null).then(function(o){o.forEach(function(e,o){emedia.config.rtcStatsTypeMath(e,o)&&t.info("Rtc stats",e,i._rtcId,i.__id)}),e&&e(o)}):(t.warn("Get stats, but peer connection not exsits, ",this._rtcId,this.__id),void(e&&e()))}});module.exports=c;
},{"./Util":"Qsy+","sdp":"Dn8O"}],"kfQi":[function(require,module,exports) {
var e=require("./Util"),t=e.tagLogger("Member"),n=require("./event"),s=require("./_Webrtc");module.exports=e.prototypeExtend({__init__:function(){if(!this._session)throw t.error("Require session"),"Require session";this.closed=!1,this._ices={},this.supportVCodes={},this.audioMixers={}},reflushSupportVCodes:function(n){var s=this;s.supportVCodes={},s._orderVCodes=n,n&&0!=n.length?e.forEach(n,function(e,t){s.supportVCodes[t]=1}):t.warn("Not config support vcodes")},getOptimalVideoCodecs:function(){if(!this._orderVCodes||0==this._orderVCodes.length)return/Chrome/.test(navigator.userAgent)?"VP8":/Safari/.test(navigator.userAgent)?"H264":"VP8";var t=0;e.forEach(this._cacheMembers,function(){t++});for(var n,s=0,r=0;r<this._orderVCodes.length;r++){var o=this._orderVCodes[r];if(0==s&&(s=this.supportVCodes[o]),this.supportVCodes[o]>t)return o;this.supportVCodes[o]>s&&(s=this.supportVCodes[o],n=o)}return n},setMemberId:function(e){this._memberId=e},getMemberId:function(){return this._memberId||this.id},createWebrtc:function(r,o){var i=this;r||(r={}),e.extend(r,{_rebuildCount:o||0}),!0===i._service.useRTCCfg&&i.__rtc_cfg?r.iceServerConfig=e.extend(!0,{},i.__rtc_cfg):e.isPlainObject(i._service.useRTCCfg)&&(r.iceServerConfig=e.extend(!0,{},i._service.useRTCCfg));var c=new s({confrAttendee:i,useIp:i.ip,onIceStateChange:function(e){var s=e;t.debug("evt.target ice state",s);try{if("failed"==s)return i.onEvent(new n.ICEConnectFail({webrtc:c})),void(c.onEvent&&c.onEvent(new n.ICEConnectFail({webrtc:c})));if("connected"==s)return i.onEvent(new n.ICEConnected({webrtc:c})),void(c.onEvent=null);if("closed"==s)return i.onEvent(new n.ICEClosed({webrtc:c})),void(c.onEvent&&c.onEvent(new n.ICEClosed({webrtc:c})));if("disconnected"==s)return i.onEvent(new n.ICEDisconnected({webrtc:c})),void(c.onEvent&&c.onEvent(new n.ICEDisconnected({webrtc:c})))}finally{i._onIceStateChange&&i._onIceStateChange(c,e)}},onIceCandidate:function(e){i._onIceCandidate&&e&&i._onIceCandidate(c,e)},onGotRemoteStream:function(e){t.info("got stream.",c._rtcId,c.__id,e),c.onGotMediaStream&&c.onGotMediaStream(e),i.onEvent(new n.ICERemoteMediaStream({webrtc:c}))},onAddIceCandidateError:function(e){i.onEvent(new n.AddIceCandError({webrtc:c,event:e}))},onSetSessionDescriptionError:function(e){t.warn("onSetSessionDescriptionError : Failed to set session description: "+e.toString()),i.onEvent&&i.onEvent(new n.ICEConnectFail({webrtc:c,event:e}))},onCreateSessionDescriptionError:function(e){t.warn("Failed to create session description: "+e.toString()),i.onEvent&&i.onEvent(new n.ICEConnectFail({webrtc:c,event:e}))}},r);return i._ices||(i._ices={}),i._ices[c.getRtcId()]&&i._howDoWebrtcWhenCrtExsitsWebrtc(c),i._ices[c.getRtcId()]=c,i._ices[c.__id]=c,i._iceCreateRtcPeerConnection(c.getRtcId()),t.debug("create rtc ",c),c},_howDoWebrtcWhenCrtExsitsWebrtc:function(e){this.closeWebrtc(e.getRtcId(),!0,!1)},connect:function(e,t){this._session.connect(e,t)},connected:function(){return this._session.connected()},newMessage:function(e){var t=this,n=t._session.newMessage(e);return n.post=function(e,n){t.postMessage(this,e,n)},n},message:function(e){var t=this,n=t._session.newMessage(e);return n.post=function(e,n){t.postMessage(this,e,n)},n},postMessage:function(e,n,s){try{e.sessId||(e.sessId=this._session._sessionId),this._session.postMessage(e,n,s)}catch(r){n&&n({op:1001,tsxId:e.tsxId,result:-9527,msg:"post message. exception"}),t.warn(r)}},onEvent:function(e){},_onIceStateChange:function(e,s){t.info(e.getRtcId(),s),this.onEvent(new n.ICEChanage({webrtc:e,state:s}))},_onIceCandidate:function(t,s){var r,o=this;e.isArray(s)?r=s:(r=[]).push(s);var i=o.newMessage().setOp(105).setRtcId(t.getRtcId()).setCands(r);o.postMessage(i,function(e){0==e.result||o.onEvent(new n.RspFail({request:i,response:e}))})},_initC:function(s,r,o,i,c,a){var d=this;if(r&&r.rtcId!==s.getRtcId())throw t.error("stream and webrtc rtcId not equal."),"stream and webrtc rtcId not equal.";var u=d.newMessage().setOp(102).setRtcId(s.getRtcId()).setSdp(o).setSubSId(i);s.subArgs&&e.extend(u,s.subArgs),r&&r.located()&&u.setPubS(r),d.postMessage(u,function(e){if(0!=e.result)return d.onEvent(new n.RspFail({request:u,response:e})),void(c&&c(new n.RspFail({request:u,response:e,hidden:!0===e.retrying})));r&&!r.id&&e.streamId&&r.updateAttributes({id:e.streamId});try{a&&a()}catch(o){t.warn(o)}e.sdp&&d.ansC(s.getRtcId(),e.sdp,e.cands),e.mems&&d.onMembers&&d.onMembers(e.cver,e.mems),e.streams&&d.onStreams&&d.onStreams(e.cver,e.streams)})},_acptC:function(e,t,s){var r=this,o=r.newMessage().setOp(104).setRtcId(e.getRtcId()).setSdp(t);r.postMessage(o,function(e){if(0!=e.result)return r.onEvent(new n.RspFail({request:o,response:e})),void(s&&s(new n.RspFail({request:o,response:e})))})},_ansCAndPubstream:function(s,r,o,i,c){var a=this,d=a.newMessage().setOp(106).setRtcId(s.getRtcId()).setSdp(o);s.subArgs&&e.extend(d,s.subArgs),r&&r.located()&&(r=e.extend({},r),e.removeAttribute(r,"mutedMuted"),e.removeAttribute(r,"_located"),d.setPubS(r)),a.postMessage(d,function(e){if(0!=e.result)return a.onEvent(new n.RspFail({request:d,response:e})),void(i&&i(new n.RspFail({request:d,response:e,hidden:!0===e.retrying})));r&&!r.id&&e.streamId&&r.updateAttributes({id:e.streamId});try{c&&c()}catch(s){t.warn(s)}})},_ansC:function(e,t,s){var r=this,o=r.newMessage().setOp(106).setRtcId(e.getRtcId()).setSdp(t);r.postMessage(o,function(e){if(0!=e.result)return r.onEvent(new n.RspFail({request:o,response:e})),void(s&&s(new n.RspFail({request:o,response:e})))})},_termC:function(e,t,s){var r=this,o="string"==typeof e?e:e.getRtcId(),i=r.newMessage().setOp(107).setRtcId(o).setEndReason(t);r.postMessage(i,function(e){if(0!=e.result)return r.onEvent(new n.RspFail({request:i,response:e})),void(s&&s(new n.RspFail({request:i,response:e})))})},_iceCreateRtcPeerConnection:function(e){this._ices[e].createRtcPeerConnection(),t.debug("create rtc peer connection",e)},doOffer:function(e,t,n){this._ices[e].createOffer(function(e){t(e)})},offerCall:function(e,t,n,s,r){var o=this,i=o._ices[e];i.createOffer(function(e){o._initC&&o._initC(i,t,e,n,s,r)})},accept:function(e,t){var n=this,s=n._ices[e];s.createPRAnswer(function(e){n._acptC&&n._acptC(s,e,t)})},answerCall:function(e,t,n,s){var r=this,o=r._ices[e];o.createAnswer(function(e){r._ansCAndPubstream&&r._ansCAndPubstream(o,t,e,n,s)})},answer:function(e,t){var n=this,s=n._ices[e];s.createAnswer(function(e){n._ansC&&n._ansC(s,e,t)})},onTcklC:function(e,t){this._addIceCandidate(t,e)},onAcptC:function(e,t,n){this._iceSetRemoteSDP(t,e),n&&this._addIceCandidate(n,e)},onAnsC:function(e,t,n){this._iceSetRemoteSDP(t,e),n&&this._addIceCandidate(n,e)},_addIceCandidate:function(e,n){if(e&&0!=e.length){var s=this._ices[n];s&&s.addIceCandidate(e)}else t.warn("drop cands",e)},closeWebrtc:function(n,s,r){var o=this,i=o._ices[n];if(e.forEach(o._cacheStreams,function(s,r){if(r.rtcId===n&&!r.located())try{var i=e.removeAttribute(o._mediaMeters,s);i&&i._finally()}catch(c){t.warn(c)}r.rtcId===n&&2===r.type&&e.removeAttribute(o.audioMixers,r.id)}),!i||i.closed)return t.warn("Webrtc not exsits or closed",i&&i.closed),r&&i&&e.forEach(o._cacheStreams,function(s,r){r.rtcId===n&&(e.removeAttribute(o._linkedStreams,s),t.warn("Webrtc close, remvoe from _linkedStreams",s))}),void(r||o._termC(n,0));if(o._records){e.forEach(o._records,function(s,r){r.rtcId===n&&function(n){try{o.stopRecord(n)}catch(s){t.warn(s)}finally{e.removeAttribute(o._records,n.id)}}(r)})}try{r||i&&o._termC(i,s&&i._localStream?-10:0)}finally{i&&i.close(s),i&&o.onWebrtcTermC&&o.onWebrtcTermC(i),s||i&&e.forEach(o._cacheStreams,function(s,i){i.rtcId===n&&(i.located()&&(emedia.stopTracks(i._localMediaStream),i&&!i.closeReason&&i.updateAttributes({closeReason:"WebrtcClose"}),o._cacheStreams[s]&&o._linkedStreams[s]&&o.onRemoveStream(i),e.removeAttribute(o._cacheStreams,s),o._streamAutomators&&e.removeAttribute(o._streamAutomators,s),o._monitSoundChanagedStreams&&e.removeAttribute(o._monitSoundChanagedStreams,s),t.info("Webrtc close. Remove stream",s,". from cache")),r&&(e.removeAttribute(o._linkedStreams,s),t.info("Webrtc close. Remove stream",s,". from _linkedStreams")))})}return i},__close:function(e){t.warn("closing, reason = ",e);if(!this.closed){if(this.closed=!0,this.__getCopyInterval&&(clearInterval(this.__getCopyInterval),t.warn("Stop interval get copy")),this._ices)for(var n in this._ices)this.closeWebrtc(n,!1);var s=this.newMessage().setOp(201).setReason(e||0);this.postMessage(s)}},exit:function(e){var t=this;e?(e&&t._closeMyConfr(11),setTimeout(function(){t.close(0)},100)):t.close(0)},_closeMyConfr:function(e){var n=this.newMessage().setOp(204).setReason(e||0);this.postMessage(n,function(e){t.warn("Close confr ",e.result,e.msg)})},close:function(s,r){var o=this;if(!o.closed)try{e.forEach(o._cacheStreams||{},function(e,t){t.located()&&t._localMediaStream&&emedia.stopTracks(t._localMediaStream)}),o.__close(s),e.forEach(o._cacheStreams,function(e,t){o.onRemoveStream(t)}),e.forEach(o._cacheMembers,function(e,t){o.onRemoveMember(t)})}finally{try{setTimeout(function(){o._session&&o._session.close(s)},500),o.onEvent(new n.Hangup({reason:s,failed:r,self:{id:o._memberId}})),o.onMeExit&&o.onMeExit(s,r)}catch(i){t.error(i)}finally{o._onFinally&&o._onFinally()}}},webrtcState:function(e){return this._ices[e].iceConnectionState()},_iceSetRemoteSDP:function(e,t){this._ices[t].setRemoteDescription(e)},setLocalStream:function(e,t){this._ices[t].setLocalStream(e)},onWebrtcTermC:function(e){}});
},{"./Util":"Qsy+","./event":"zP2G","./_Webrtc":"BwOA"}],"Mpnw":[function(require,module,exports) {
"use strict";function t(t){this.context=t,this.instant=0,this.slow=0,this.clip=0,this.script=t.createScriptProcessor(2048,1,1);var i=this;this.script.onaudioprocess=function(t){var n,o=t.inputBuffer.getChannelData(0),c=0,s=0;for(n=0;n<o.length;++n)c+=o[n]*o[n],Math.abs(o[n])>.99&&(s+=1);i.instant=Math.sqrt(c/o.length),i.slow=.95*i.slow+.05*i.instant,i.clip=s/o.length}}t.prototype.connectToSource=function(t,i){console.log("SoundMeter connecting");try{this.mic=this.context.createMediaStreamSource(t),this.mic.connect(this.script),this.script.connect(this.context.destination),void 0!==i&&i(null)}catch(n){console.error(n),void 0!==i&&i(n)}},t.prototype.stop=function(){this.mic.disconnect(),this.script.disconnect()},module.exports=t;
},{}],"/mhd":[function(require,module,exports) {
var t=require("./Util"),e=require("../_adapter/SoundMeter");emedia.subscribed=function(t){return!!t._located||(2===t.type?!(t._located||!t._webrtc):void 0!==t._webrtc)};var i=t.prototypeExtend({voff:0,aoff:0,__init__:function(){var t=this;if(!t._mediaStream)throw _logger.error("_mediaStream empty"),"_mediaStream empty";if(t.hasEnabledTracks(t._mediaStream)){if(!t.__audioContext)throw _logger.error("require audioContext"),"require audioContext";t.__soundMeter=new e(t.__audioContext),t.__soundMeter.connectToSource(t._mediaStream,function(e){if(e)throw e;t.__worked=t.__soundMeter.__worked=!0})}},hasEnabledTracks:function(t){return emedia.hasEnabledTracks(t)},getSoundMeters:function(){if(this.__soundMeter&&this.__worked)if(this._mediaStream.active){if(this.hasEnabledTracks(this._mediaStream))return{instant:this.__soundMeter.instant,slow:this.__soundMeter.slow,clip:this.__soundMeter.clip}}else this.__worked&&this._finally()},_finally:function(){this.__soundMeter&&(this.__soundMeter.stop(),this.__worked=this.__soundMeter.__worked=!1)}});module.exports=t.prototypeExtend({__undefinedEQDelete:!0,Update:t.prototypeExtend({ifAoff:function(t){this.if("aoff",t)},ifVoff:function(t){this.if("voff",t)},ifMediaStream:function(t){this.if("mediaStream",t)},if:function(t,e){void 0!==this[t]&&e(this[t])}}),located:function(){return this._located||!1},webrtc:function(t){return t&&(this._webrtc=t),this},getMediaStream:function(){return void 0!==this.mediaStream?this.mediaStream:this._located?this._localMediaStream:this._webrtc&&(this._webrtc.getRemoteStream()||this._webrtc.getLocalStream())},requestFrame:function(){this._localMediaStream&&this._localMediaStream.getVideoTracks().forEach(function(t){"function"==typeof t.requestFrame&&t.requestFrame()})},getLocalMediaStream:function(){return this._localMediaStream},getRemoteMediaStream:function(){if(this._webrtc&&void 0!==this._webrtc.getRemoteStream())return this._webrtc.getRemoteStream()},mutedNeed:function(){return this.mutedMuted||!1},ifMediaStream:function(t){void 0===this.mediaStream?this._located&&void 0!==this._localMediaStream?t(this._localMediaStream):this._located||!this._webrtc||void 0===this._webrtc.getRemoteStream()||t(this._webrtc.getRemoteStream()):t(this.mediaStream)},subscribed:function(){return emedia.subscribed(this)},updateAttributes:function(){for(var e=0;e<arguments.length;e++){var i=arguments[e];if(t.isPlainObject(i))for(var r in i){var a=i[r];this[r]=a}}},getHtmlDOMID:function(){return"_m_"+this.owner.id+"_s_"+this.id},MediaSoundMeter:i,StreamSoundMeter:t.prototypeExtend({__init__:function(){if(!this._stream||"function"!=typeof this._stream.getMediaStream)throw _logger.error("_stream empty or not found method getMediaStream"),"_stream empty or not found method getMediaStream";if(this._streamId=this._stream.id,this._streamCreateId=this._stream.__create_id,this._mediaStream=this._mediaStream,2===this._stream.type&&!this._stream.located()&&!this._webrtc)throw _logger.error("require webrtc. when type = 2 and not located"),"require webrtc. when type = 2 and not located";this.__mediaSoundMeter=this.__mediaSoundMeter||new i({__audioContext:this.__audioContext,_mediaStream:this._mediaStream}),this.__mediaSoundMeter.useCount=(this.__mediaSoundMeter.useCount||0)+1},onSoundMeters:function(e){var i={instant:0,slow:0,clip:0};if(this._stream.aoff)return this._finally(),e(i),i;if(2!==this._stream.type&&this._stream.subArgs&&void 0!==this._stream.subArgs.subSAudio&&!this._stream.subArgs.subSAudio)return this._finally(),e(i),i;if(0==this._stream.id||2===this._stream.type&&!this._stream.located()&&(!this._stream.subArgs||!this._stream.subArgs.subSAudio)){var r,a=this._webrtc.getReceiversOfPeerConnection();if(!a||0===a.length)return e(i),i;for(var o in a)"audio"===a[o].track.kind&&(r=a[o]);if(!r)return e(i),i;if("function"==typeof r.getContributingSources){var s,n=r.getContributingSources();if(emedia.config._printSoundData&&t.logger.debug(this._stream.id,this._stream.csrc,"rtpContributingSources ",n),!n||0===n.length)return e(i),i;for(var o in n)n[o].source==this._stream.csrc&&(s=this._stream.csrc);if(emedia.config._printSoundData&&t.logger.debug(this._stream.id,this._stream.csrc,"source ",s),void 0===s)return e(i),i}}var d=this.__mediaSoundMeter.getSoundMeters()||i,_=2===this._stream.type?this._webrtc:this._stream._webrtc;(emedia.meterWithTrackAudioLevel||0===d.instant)&&_&&!_.closed&&_._rtcPeerConnection&&_._rtcPeerConnection.getStats().then(function(t){t.size>0&&t.forEach(function(t){"track"!==t.type||"audio"!==t.kind&&"audio"!==t.trackIdentifier||(d.trackAudioLevel=t.audioLevel,d.trackTotalAudioEnergy=t.totalAudioEnergy,e(d))})}),e(d)},_finally:function(){2===this._stream.type&&this._stream.located()&&this._remoteMediaSoundMeters&&this._remoteMediaSoundMeters._finally(),this.__mediaSoundMeter.useCount--,0===this.__mediaSoundMeter.useCount&&this.__mediaSoundMeter._finally()}})});
},{"./Util":"Qsy+","../_adapter/SoundMeter":"Mpnw"}],"yuX1":[function(require,module,exports) {
var e=require("./Util"),t=e.tagLogger("Me"),r=require("./_Member"),i=require("./event"),s=require("./_Stream"),n=r.extend({__init__:function(){if(this._session||this.sessionFactory&&(this._session=this.sessionFactory()),!this._session)throw t.error("Require session"),"Require session";this._cver=0,this._cacheMembers={},this._cacheStreams={},this._streamAutomators={},this._mediaMeters={},this._openedRtcMediaStreams={},this._linkedStreams={},this._maybeNotExistStreams={},this._records={},this._ices={},this.audioMixers={},this.closed=!1,this._nextStreamSeqno=0,this.getMediaMeterIntervalMillis=this.getMediaMeterIntervalMillis||emedia.config.getMediaMeterIntervalMillis},getCurrentMembers:function(){var t=[];return e.forEach(this._cacheMembers,function(r,i){var s=e.extend(!0,{},i);t.push(s)}),t},newStream:function(r){var i=this;return new s(r,{__init__:function(){if(this.rtcId||this._webrtc&&(this.rtcId=this._webrtc.getRtcId()),this._webrtc||this.rtcId&&(this._webrtc=i._ices[this.rtcId]),this.__create_id=i._nextStreamSeqno++,this.memId&&!this.owner&&(this.owner=e.extend({},i._cacheMembers[this.memId]),!this.owner&&!this.located()))throw t.error("Remote stream, not owner. it = ",this.id),"Remote stream, not owner. it = "+this.id}})},getConfrId:function(){return this.ticket.confrId},isCaller:function(){return this.isP2P()&&this.ticket.caller==this.ticket.memName},isCallee:function(){return this.isP2P()&&this.ticket.callee==this.ticket.memName},isP2P:function(){return this.ticket&&("P2P"==this.ticket.type||"p2p"==this.ticket.type)},isConfr:function(){return this.ticket&&("CONFR"==this.ticket.type||"confr"==this.ticket.type)},onEvent:function(e){},join:function(e,t){var r=this;emedia.requireTrustBeforeJoin()?r.someBrowsersRequireGetUserMedia(function(){r._join(e,t)},t):r._join(e,t)},_join:function(e,r){t.debug("begin join ...");var s,n=this;if(n._memberId)return t.warn("Had joined. igrone it"),void(e&&e(n.memId));function o(e){try{if(e instanceof i.WSClose&&e.retry)return;e instanceof i.EnterFail||(e=new i.EnterFail({attendee:n,cause:e})),n.onEvent(e),r&&r(e)}finally{}}function a(t){if(0==t.result){n.reflushSupportVCodes(t.vcodes),n.setMemberId(t.memId),n.role=t.role,n.onEvent(new i.EnterSuccess({ip:n.ip})),e&&e(t.memId);try{n.__rtc_cfg=t.rtcCfg,"string"==typeof t.rtcCfg&&(n.__rtc_cfg=JSON.parse(t.rtcCfg))}finally{n.onMembers(t.cver,t.mems),n.onStreams(t.cver,t.streams)}}else try{o(new i.RspFail({request:s,response:t}))}finally{-9527!==t.result&&n.onEvent(new i.ServerRefuseEnter({failed:t.result,msg:t.msg}))}}n.connect(function(){s=n.newMessage().setOp(200).setTicket(n.ticket).setNickName(n.nickName||n.ticket.memName).setResource(n.resource).setExt(n.ext),n.postMessage(s,a)},o),t.debug("join",n.ticket.url)},withpublish:function(e){var r,s=this;if(!e||!e.localStream)throw t.error("pubS null or stream not open"),"pubS null or stream not open";var n,o=e&&e.localStream;return{join:function(a,c){if(1===arguments.length&&(c=a,a=void 0),s._memberId)return t.warn("Had joined. igrone it"),void(a&&a(s.memId));function d(e){try{if(e instanceof i.WSClose&&e.retry)return;e instanceof i.EnterFail||(e=new i.EnterFail({attendee:s,cause:e})),s.onEvent(e),c&&c(e)}finally{emedia.stopTracks(o),n&&s.closeWebrtc(n.getRtcId())}}var u=s.getOptimalVideoCodecs();function m(o){if(0==o.result){s.reflushSupportVCodes(o.vcodes),s.setMemberId(o.memId),s.role=o.role,s.onEvent(new i.EnterSuccess({ip:s.ip}));var c=s.newStream(e);c.updateAttributes({_localMediaStream:e.localStream,rtcId:n.getRtcId(),_webrtc:n,id:o.streamId,csrc:o.csrc,owner:{id:o.memId,nickName:s.nickName,name:s.sysUserId,ext:s.extObj},optimalVideoCodecs:u}),a&&a(o.memId,c),n.useIp=s.ip,s.onEvent(new i.PushSuccess({stream:c,hidden:!0})),o.sdp&&s.ansC(n.getRtcId(),o.sdp),o.cands&&s.tcklC(n.getRtcId(),o.cands);try{s.__rtc_cfg=o.rtcCfg,"string"==typeof o.rtcCfg&&(s.__rtc_cfg=JSON.parse(o.rtcCfg)),s.__rtc_cfg&&s.__rtc_cfg.iceServers&&s.__rtc_cfg.iceServers.length>0&&(t.warn("Server rsp one rtc cfg. publish will republish"),s._service&&setTimeout(function(){s._service._republish(c)},200))}finally{s.onMembers(o.cver,o.mems),s.onStreams(o.cver,o.streams)}}else try{d(new i.RspFail({request:r,response:o}))}finally{-9527!==o.result&&s.onEvent(new i.ServerRefuseEnter({failed:o.result,msg:o.msg}))}}s.connect(function(){t.debug("enter and pubs");var i,o,a=e.localStream;2===e.type&&(i={offerToReceiveAudio:!0,offerToReceiveVideo:!1},o={subSVideo:!1,subSAudio:!0}),n=s.createWebrtc({_rtcId:e.rtcId,optimalVideoCodecs:u,offerOptions:i,subArgs:o,vbitrate:e.vbitrate||e.constaints&&e.constaints.video&&e.constaints.video.bitrate,abitrate:e.abitrate||e.constaints&&e.constaints.audio&&e.constaints.audio.bitrate},e.iceRebuildCount),s.setLocalStream(a,n.getRtcId()),s.doOffer(n.getRtcId(),function(t){r=s.newMessage().setOp(200).setTicket(s.ticket).setNickName(s.nickName||s.ticket.memName).setResource(s.resource).setSdp(t).setRtcId(n.getRtcId()).setPubS(e).setExt(s.ext),s.postMessage(r,m)})},d),t.debug("join",s.ticket.url)}}},push:function(e,r,s,n){t.debug("begin push ...");var o,a=this;if(2===arguments.length&&(s=r,r=void 0),!e||!e.localStream)throw t.error("pubS or stream open"),"pubS or stream open";var c,d=e.localStream;function u(t){try{var r=a.newStream(e);r.updateAttributes({_localMediaStream:e.localStream,_webrtc:c,rtcId:c&&c.getRtcId(),owner:{id:a.getMemberId(),nickName:a.nickName,name:a.sysUserId,ext:a.extObj}});t=new i.PushFail({stream:r,cause:t,hidden:n&&!0===t.hidden});a.onEvent(t),t.hidden||s&&s(t)}finally{d&&!0!==t.hidden&&emedia.stopTracks(d),c&&a.closeWebrtc(c.getRtcId(),!0===t.hidden)}}if(e.rtcId||2!==e.type||emedia.config.allowRepeatAudioMixerPublish||!a._service.hasAudioMixers()){var m=e.optimalVideoCodecs||a.getOptimalVideoCodecs();!function(e){t.debug("pubs");var r,i,s=e.localStream;2===e.type&&(r={offerToReceiveAudio:!0,offerToReceiveVideo:!1},i={subSVideo:!1,subSAudio:!0}),c=a.createWebrtc({_rtcId:e.rtcId,optimalVideoCodecs:m,offerOptions:r,subArgs:i,vbitrate:e.vbitrate||e.constaints&&e.constaints.video&&e.constaints.video.bitrate,abitrate:e.abitrate||e.constaints&&e.constaints.audio&&e.constaints.audio.bitrate},e.iceRebuildCount),a.setLocalStream(s,c.getRtcId()),a.doOffer(c.getRtcId(),function(t){o=a.newMessage().setOp(102).setRtcId(c.getRtcId()).setSdp(t).setPubS(e),a.postMessage(o,function(e){f(c,e)})})}(e),t.debug("push",a.ticket.url)}else u(new i.AudioMixerStreamRepeatPublish);function f(t,s){if(0==s.result){var n=a.newStream(e);n.updateAttributes({_localMediaStream:e.localStream,_webrtc:t,rtcId:t.getRtcId(),id:s.streamId,csrc:s.csrc,owner:{id:a.getMemberId(),nickName:a.nickName,name:a.sysUserId,ext:a.extObj},optimalVideoCodecs:m}),n.id&&2===n.type&&(a.audioMixers[n.id]=n);try{a.onEvent(new i.PushSuccess({stream:n,hidden:!0}))}finally{s.sdp&&a.ansC(t.getRtcId(),s.sdp),s.cands&&a.tcklC(t.getRtcId(),s.cands),r&&r(n)}}else u(new i.RspFail({request:o,response:s,hidden:!0===s.retrying}))}},isSafari:function(){return emedia.isSafari},someBrowsersRequireGetUserMedia:function(r,i){var s=this;if(emedia.youInSomeBrowsers()&&!emedia._yetGetUserMedia){if(!0===s.__tryingOpenMedia)s.__tryingOpenMediaWaitSuceess=s.__tryingOpenMediaWaitSuceess||[],s.__tryingOpenMediaWaitFail=s.__tryingOpenMediaWaitFail||[],"function"==typeof r&&s.__tryingOpenMediaWaitSuceess.push(r),"function"==typeof i&&s.__tryingOpenMediaWaitFail.push(i);else{function n(t,i){emedia._yetGetUserMedia=!0,emedia.stopTracks(i),setTimeout(function(){s.__tryingOpenMedia=!1,r&&r.apply(s),s.__tryingOpenMediaWaitSuceess&&e.forEach(s.__tryingOpenMediaWaitSuceess,function(e,t){t.apply(s)}),s.__tryingOpenMediaWaitSuceess=[],s.__tryingOpenMediaWaitFail=[]},300)}function o(r){s.__tryingOpenMedia=!1,t.error("Some browsers must getUserMedia, gather cands. now try get audio. fail. subfail"),i&&i.call(s,r),s.__tryingOpenMediaWaitFail&&e.forEach(s.__tryingOpenMediaWaitFail,function(e,t){t.call(s,r)}),s.__tryingOpenMediaWaitSuceess=[],s.__tryingOpenMediaWaitFail=[]}s.__tryingOpenMedia=!0,s._service.__getUserMedia({audio:!0},n,function(e){s._service.__getUserMedia({video:!0},n,o)})}return!0}return!1},createWebrtcAndSubscribeStream:function(r,s,n,o){var a=this;s||(s={});var c=a._cacheStreams[r],d=a._cacheMembers[c.memId],u=c;function m(e){t.warn("sub stream error",r,e),p&&u._webrtc&&u._webrtc.setSubArgs(p),p&&u.updateAttributes({subArgs:p}),e=new i.SubFail({stream:u,hidden:!0===e.hidden,cause:e}),s&&s.onEvent&&s.onEvent(e),a.onEvent&&a.onEvent(e)}function f(){u.updateAttributes(u.subArgs)}o=o||u.subArgs||{subSVideo:!0,subSAudio:2!==c.type};var h=c.vcodes||[],l=d&&d.vcodes||[],b=a.supportVCodes,_=a._getOptimalVideoCodecsSubset(h,l,b);o=o||u.subArgs;var p=u.subArgs,v=!(u.vcodes&&u.vcodes.length>0);emedia.isSafari&&(v=v||!!u.voff);var g={offerToReceiveAudio:!0,offerToReceiveVideo:o.subSVideo&&!v};function S(){var i=a.createWebrtc({iceServerConfig:n,optimalVideoCodecs:_,offerOptions:g,onGotMediaStream:function(e){s.onGotRemote&&s.onGotRemote(u)}},u.iceRebuildCount),c=i.getRtcId();t.warn(c," sub stream ",r,_),u.updateAttributes({_webrtc:i,rtcId:c,owner:e.extend({},d)}),o&&u._webrtc&&u._webrtc.setSubArgs(o),o&&u.updateAttributes({subArgs:o})}g.offerToReceiveAudio||g.offerToReceiveVideo||t.warn("offerToReceiveAudio == false and offerToReceiveVideo == false"),a.someBrowsersRequireGetUserMedia(function(){S(),a.offerCall(u.rtcId,null,r,m,f)},function(e){t.error("Some browsers must getUserMedia, gather cands. now try get audio. fail. subfail",r),m(e)})||(S(),a.offerCall(u.rtcId,null,r,m,f))},_getOptimalVideoCodecsSubset:function(t,r,i){var s=this,n=[];if(t&&t.length>0&&i[t[0]]&&n.push(t[0]),0==n.length)for(var o=0;o<s._orderVCodes.length;o++)e.forEach(r,function(e,t){t==s._orderVCodes[o]&&n.push(t)});return n},subscribeStream:function(t,r,s,n,o){var a=this,c=a._ices[t],d=a._cacheStreams[r],u=a._cacheMembers[d.memId],m=d;m.updateAttributes({_webrtc:c,rtcId:t,owner:e.extend({},u)});var f=m.subArgs;if(n=n||{subSVideo:!0,subSAudio:!0},m.updateAttributes({subArgs:m.subArgs||{subSVideo:!0,subSAudio:!0}}),m._webrtc&&m._webrtc.setSubArgs(m._webrtc.subArgs||{subSVideo:!0,subSAudio:!0}),!m.subArgs.subSVideo&&n.subSVideo&&!m.voff){var h=d.vcodes,l=u.vcodes,b=a.supportVCodes;a._getOptimalVideoCodecsSubset(h,l,b)}n&&m._webrtc&&m._webrtc.setSubArgs(n),n&&m.updateAttributes({subArgs:n});var _=a.newMessage().setOp(205).setRtcId(t).setSubSId(r);n&&e.extend(_,n),a.postMessage(_,function(e){if(0!=e.result){f&&m._webrtc&&m._webrtc.setSubArgs(f),f&&m.updateAttributes({subArgs:f});var t=new i.SubFail({stream:m,cause:new i.RspFail({request:_,response:e})});return s&&s(t),void a.onEvent(t)}m.updateAttributes(m.subArgs);t=new i.SubSuccess({stream:m,hidden:!0});a._updateRemoteStream(m,m._webrtc.getRemoteStream()),a.onEvent(t),"function"==typeof o&&o()})},unsubscribeStream:function(e){var t=this._cacheStreams[e],r=t._webrtc&&t._webrtc.getRtcId();if(r){try{var i=this.newMessage().setOp(206).setRtcId(r).setSubSId(e);this.postMessage(i)}finally{this.closeWebrtc(r)}return r}},onEnter:function(t,r){var i=this;if(t&&(i._cver=t),r&&!i._cacheMembers[r.id]){i._cacheMembers[r.id]=r;var s={};r.res&&r.res.vcodes&&r.res.vcodes.length>0&&e.forEach(r.res.vcodes,function(e,t){s[t]||(s[t]=!0,i.supportVCodes[t]&&i.supportVCodes[t]++)}),i.onAddMember(e.extend({},r))}},_onFinally:function(){this._cacheMembers={},this._cacheStreams={},this._linkedStreams={},this._ices={},this._maybeNotExistStreams={};var r=[];if(e.forEach(this._openedRtcMediaStreams,function(e,t){!1!==t.active&&r.push(t)}),r.length>0)for(var i=0;i<r.length;i++)try{var s=r[i];t.info("exit, close stream = ",s.id),emedia.stopTracks(s)}catch(n){t.error(n)}t.warn("finally. all clean.")},_onRoleUpdate:function(e,r){t.info("Role ",e," <-",this.role),t.info(r),this.role=e,this.roleToken=r,this.onRoleUpdate&&this.onRoleUpdate(e,r)},onExit:function(r,s,n){var o=this;if(r&&(o._cver=r),s!=o.getMemberId()){var a=o._cacheMembers[s];a&&(a.res&&a.res.vcodes&&a.res.vcodes.length>0&&e.forEach(a.res.vcodes,function(e,t){o.supportVCodes[t]--}),o._onRemoveMember(a,n),o.onEvent(new i.Hangup({reason:n,parnter:a})))}else{t.warn("Me exit. ",n,s);try{o.closed||o.close(n)}catch(c){o.onEvent(new i.Hangup({reason:n,self:{id:o._memberId}})),o.onMeExit&&o.onMeExit(n),t.warn(c)}}},onPub:function(r,i,s){if(!this._cacheMembers[i])throw t.error("No found member. when pub"),"No found member. when pub";var n=this.newStream(s),o=this._cacheStreams[s.id];if(r&&(this._cver=r),o&&n.sver!==o.sver)return t.info("Onpub. the steam ",o.id," republish. sver ",o.sver,n.sver),!n||n.aoff===o.aoff&&n.voff==o.voff||this.onStreamControl(void 0,s.id,n.voff,n.aoff),e.extend(o,n),void this._onRepublishStream(o);var a=n;return a.updateAttributes({owner:this._cacheMembers[i]}),this._cacheStreams[s.id]=a,this._onAddStream(this.newStream(a)),this.autoSub&&this.createWebrtcAndSubscribeStream(s.id,{onGotRemote:function(e){}}),a},onUnpub:function(e,t,r){var i=this._cacheStreams[r];this._onRemovePubstream(this._cacheMembers[t],i),e&&(this._cver=e)},onClose:function(e,t,r){try{this.close(r||0)}finally{this.onConfrClose&&this.onConfrClose(t,r)}},__getWebrtcFor:function(e){var t=this._cacheStreams[e]&&this._cacheStreams[e]._webrtc;return t&&t.getRtcId()},_getWebrtc:function(e){return this._cacheStreams[e]&&this._cacheStreams[e]._webrtc},_updateRemoteStream:function(e,t){e.located()&&2===e.type?emedia.enableAudioTracks(t,!0):emedia.enableAudioTracks(t,!(e.aoff||e.subArgs&&!1===e.subArgs.subSAudio)),emedia.enableVideoTracks(t,!(e.voff||e.subArgs&&!1===e.subArgs.subSVideo))},onStreamControl:function(e,t,r,i,s){var n=this._cacheStreams[t];n.updateAttributes({voff:r,aoff:i});var o=n._webrtc;o&&o._remoteStream&&this._updateRemoteStream(n,o._remoteStream);var a=this.newStream(n);this.onUpdateStream&&this.onUpdateStream(a,new a.Update({voff:r,aoff:i})),e&&(this._cver=e),s&&n.updateAttributes({sver:s})},aoff:function(e,r,i){var s=this.__getWebrtcFor(e.id);if(!s)throw t.error("pubS not publish",e.id),"pubS not publish"+e.id;this._linkedStreams[e.id].updateAttributes({aoff:r}),e.updateAttributes({aoff:r});var n=this.newMessage().setOp(400).setRtcId(s).setVoff(e.voff).setAoff(r);this.postMessage(n,i),this.onUpdateStream&&this.onUpdateStream(e,new e.Update({aoff:r}))},voff:function(e,r,i){var s=this.__getWebrtcFor(e.id);if(!s)throw t.error("pubS not publish",e.id),"pubS not publish"+e.id;this._linkedStreams[e.id].updateAttributes({voff:r}),e.updateAttributes({voff:r});var n=this.newMessage().setOp(400).setRtcId(s).setVoff(r).setAoff(e.aoff);this.postMessage(n,i),this.onUpdateStream&&this.onUpdateStream(e,new e.Update({voff:r}))},startRecord:function(r,i){var s=this,n=r.rtcId,o=s.newMessage().setOp(500).setRtcId(n).setFlag(1);s.postMessage(o,function(o){t.warn("record ",n,o.result,o.msg),i&&i(0===o.result),0===o.result&&(s._records[r.id]=e.extend(!1,{},r))})},stopRecord:function(r,i){var s=r.rtcId,n=this.newMessage().setOp(500).setRtcId(s).setFlag(0);this.postMessage(n,function(e){t.warn("stop record ",s,e.result,e.msg),i&&i(0===e.result)}),this._records[r.id]&&e.removeAttribute(this._records,r.id)},onMembers:function(t,r){var i=this,s=[];e.forEach(i._cacheMembers,function(e,t){r[e]||s.push(t)}),e.forEach(s,function(e,t){i.onExit(void 0,t.id)});var n=[];e.forEach(r,function(t,r){(r.name&&r.name!=i.memName||!r.name&&t!=i.getMemberId())&&(i._cacheMembers[t]||n.push(r),i._cacheMembers[t]&&e.extend(i._cacheMembers[t],r))}),e.forEach(n,function(e,t){i.onEnter(void 0,t)}),t&&(i._cver=t)},onStreams:function(t,r){var i=this,s=[];e.forEach(i._cacheStreams,function(e,t){t.located()||r[e]||s.push(t)}),e.forEach(s,function(e,t){i.onUnpub(void 0,t.memId,t.id)});var n=[];e.forEach(r,function(t,r){(r.memName&&r.memName!=i.memName||!r.memName&&r.memId!=i.getMemberId())&&(i._cacheStreams[t]||n.push(r),i._cacheStreams[t]&&e.extend(i._cacheStreams[t],r))}),e.forEach(n,function(e,t){i.onPub(void 0,t.memId,t)}),e.forEach(i._cacheStreams,function(t,s){var n;s.located()||(n=r[t]),!n||n.aoff===s.aoff&&n.voff==s.voff||i.onStreamControl(void 0,t,n.voff,n.aoff),n&&n.sver!==s.sver&&(e.extend(s,n),i._onRepublishStream(s))}),t&&(i._cver=t)},_onRemoveMember:function(r,i){var s=this;t.info("remove",r,i);var n=[];e.forEach(s._cacheStreams,function(e,t){(t.memId||t.owner&&t.owner.id)===r.id&&n.push(t)}),e.forEach(n,function(e,t){s._onRemovePubstream(t.owner,t,i)}),e.removeAttribute(s._cacheMembers,r.id),s.onRemoveMember&&s.onRemoveMember(r,i)},_onAddStream:function(e){t.info("add stream ",e.id),t.debug("add stream ",e);this.onAddStream(e)},_onRemovePubstream:function(t,r,i){var s=this;if(r&&0!=r.id)try{var n=e.removeAttribute(s._mediaMeters,r.id);n&&n._finally()}finally{!function(t){2===t.type&&(e.removeAttribute(s.audioMixers,t.id),t.remotePlayAudioObject&&document.body.removeChild(t.remotePlayAudioObject)),i||(i="Unpub"),t&&!t.closeReason&&t.updateAttributes({closeReason:i}),s.unsubscribeStream(t.id),e.removeAttribute(s._cacheStreams,t.id),s._streamAutomators&&e.removeAttribute(s._streamAutomators,t.id),s._monitSoundChanagedStreams&&e.removeAttribute(s._monitSoundChanagedStreams,t.id),s.onRemoveStream&&(t=s.newStream(t),s.onRemoveStream(t))}(r)}},_onRepublishStream:function(e){if(!this._ices[e.rtcId]&&!emedia.subscribed(e)||this._maybeNotExistStreams[e.id])this.onUpdateStream(e);else{this.unsubscribeStream(e.id);this.createWebrtcAndSubscribeStream(e.id,{onGotRemote:function(e){}})}},_onRecvRemoteMessage:function(e,r,i){t.debug("Recv remote message",e,r);var s,n=this._cacheMembers[e];try{s=JSON.parse(r)}catch(o){}this.onRecvRemoteMessage&&this.onRecvRemoteMessage(n||e,s||r,i)},_onSoundChanage:function(e,r,i){emedia.config._printSoundData&&t.info("Stream id "+r.id+", meter "+(i&&i.instant.toFixed(2)+" "+i.slow.toFixed(2)+" "+i.clip.toFixed(2)+" "+(i.trackAudioLevel||"--")+" "+(i.trackTotalAudioEnergy||"--"))),i||(i={instant:0,slow:0,clip:0}),emedia.config.logVolumeWhenInstantGE&&emedia.config.logVolumeWhenInstantGE>0&&i.instant>=emedia.config.logVolumeWhenInstantGE&&i.instant<3*emedia.config.logVolumeWhenInstantGE&&t.info("Stream id "+r.id+", webrtc = "+(r._webrtc?r._webrtc.getRtcId():"null")+", media streamId = "+(r.getMediaStream()?r.getMediaStream().id:"null")+", instant >= "+emedia.config.logVolumeWhenInstantGE+", meter instant="+i.instant+", slow="+i.slow+", clip="+i.clip);0===i.instant&&(i.instant=i.trackAudioLevel||i.trackTotalAudioEnergy||0),this.onSoundChanage(e,r,i),this._service._judgeTalking(i)&&this.onTalking(e,r,i)},onAddMember:function(e){},onRemoveMember:function(e,t){},onAddStream:function(e){},onRemoveStream:function(e){},onUpdateStream:function(e,t){},onRecvRemoteMessage:function(e,t){},onSoundChanage:function(e,t,r){},onTalking:function(e,t,r){}});module.exports=n;
},{"./Util":"Qsy+","./_Member":"kfQi","./event":"zP2G","./_Stream":"/mhd"}],"1jqB":[function(require,module,exports) {
var e=require("./Util"),t=e.tagLogger("Handler"),i=require("./event"),r=e.prototypeExtend({onEvent:function(e){var r=this;function a(){try{r.handleEvent(e)}catch(i){t.warn(i)}}if(e&&t.info("[EVT]",e.message(),e.hidden||""),e instanceof i.ServerRefuseEnter&&e.failed&&-95270===e.failed&&(e.failed=-9527),e instanceof emedia.event.StreamState&&e.stream&&e.stream.located())a();else try{e.hidden||r.onNotifyEvent&&r.onNotifyEvent(e)}finally{a()}},handleEvent:function(r){var a=this;if(r instanceof i.RecvResponse)a._onRecvResponse(r);else if(r instanceof i.ServerRefuseEnter)t.warn("Server refuse, ",r.failed,r.msg),a.onServerRefuseEnter(r);else if(r instanceof i.NetworkChanaged)t.warn("Network chanaged, ",r.preIp,r.nowIp),a.onNetworkChanaged(r);else if(r instanceof i.EnterFail)t.warn("Enter fail, result = ",r.failed),a.onEnterFail();else if(r instanceof i.WSClose)a.onWSClose();else if(r instanceof i.WSConnected)t.warn("Websocket connected");else if(r instanceof i.ICEConnected){var n=r.webrtc;a.onICEConnected(n)}else if(r instanceof i.ICEConnectFail){n=r.webrtc;a.onICEConnectFail(n)}else if(r instanceof i.ICEDisconnected){n=r.webrtc;a.onICEDisconnected(n)}else if(r instanceof i.ICEClosed){n=r.webrtc;a.onICEClosed(n)}else if(r instanceof i.ICERemoteMediaStream)a.onICERemoteMediaStream(r.webrtc);else if(r instanceof i.PushSuccess){a._cacheStreams[r.stream.id]=a._linkedStreams[r.stream.id]=r.stream;var o=a.newStream(r.stream);if(r.hidden&&!a._maybeNotExistStreams[r.stream.id]&&!o.isRepublished)return void a._onAddStream(o);emedia._yetGetUserMedia=!0;try{!0!==r.hidden&&o&&a.onUpdateStream(o,new o.Update({voff:o.voff,aoff:o.aoff,mediaStream:o.getMediaStream()}))}finally{emedia.isSafari&&e.forEach(a._cacheStreams,function(t,i){!0===i._autoSubWhenPushStream&&(e.removeAttribute(i,"_autoSubWhenPushStream"),a.createWebrtcAndSubscribeStream(i.id))})}}else if(r instanceof i.SubSuccess)a._linkedStreams[r.stream.id]=r.stream,r.stream.updateAttributes({_zoom:1});else if(r instanceof i.PushFail){if(!0!==r.hidden){var s=e.removeAttribute(a._linkedStreams,r.stream.id);if(t.warn("PushFail remove from _linkedStreams",r.stream.id,s),s){o=a.newStream(r.stream);a.onRemoveStream(o)}}}else if(r instanceof i.SubFail){if(!0!==r.hidden)e.removeAttribute(a._linkedStreams,r.stream.id),t.warn("SubFail remove from _linkedStreams",r.stream.id),(o=a.newStream(r.stream)).updateAttributes({rtcId:void 0,_webrtc:void 0,mediaStream:void 0}),a.onUpdateStream(o,new o.Update(o))}else if(r instanceof i.SubFailNotSupportVCodes){var d=r.stream;t.warn("Rtc donot support pub VCodes. close. sub fail.",d.rtcId," -> ",d.id);try{a.onNotSupportPublishVideoCodecs&&a.onNotSupportPublishVideoCodecs(d)}catch(u){t.warn(u)}}else if(r instanceof i.EnterSuccess)a.onEnterSuccess();else if(r instanceof i.SwitchVCodes){d=r.stream;var c,l=r.useVCodes;n=d._webrtc;if(t.warn("Rtc switch VCodes. ",d.id,l),l&&0!=l.length||t.warn("Rtc switch VCodes. error! useVCodes is empty ",d.id,l),emedia.config&&emedia.config.forceUseVideoCodecs&&emedia.config.forceUseVideoCodecs.length>0&&(c=emedia.config.forceUseVideoCodecs,e.isArray(c)||(c=[]).push(emedia.config.forceUseVideoCodecs)),c){if("string"==typeof c&&c!==l[0])return void t.warn("Rtc switch VCodes. igrone . useVCodes !== forceUseVideoCodecs ",d.id,n._rtcId,l,c);if(e.isArray(c)&&c[0]!==l[0])return void t.warn("Rtc switch VCodes. igrone ddd . useVCodes == forceUseVideoCodecs ",d.id,n._rtcId,l,c)}if(n&&n.optimalVideoCodecs){if("string"==typeof n.optimalVideoCodecs&&n.optimalVideoCodecs==l[0])return void t.warn("Rtc switch VCodes. igrone . useVCodes == optimalVideoCodecs ",d.id,n._rtcId,l);if(e.isArray(n.optimalVideoCodecs)&&n.optimalVideoCodecs.length>0&&n.optimalVideoCodecs[0]==l[0])return void t.warn("Rtc switch VCodes. igrone ddd . useVCodes == optimalVideoCodecs ",d.id,n._rtcId,l)}d.updateAttributes({optimalVideoCodecs:l}),n&&a.closeWebrtc(n.getRtcId(),!0),setTimeout(function(){d.updateAttributes({iceRebuildCount:1}),a.iceRebuild(d),t.warn("Rtc switch VCodes. iceRebuild end.",d.id,l)},300)}},_onRecvResponse:function(e){var i=e.request,r=e.response;if(i&&r&&200!==i.op&&1002!==i.op&&0!==r.result){t.warn("Server refuse. when request = ",i);var a=e.failed;switch(a){case-9527:case-95270:break;case-500:case-502:case-504:case-508:case-510:this.close(4,a);break;case-506:this.close(11,a);break;case-501:this.close(11,a)}}},onServerRefuseEnter:function(e){var t=e.failed;switch(t){case-9527:case-95270:this.close(4,-9527);break;case-500:case-502:case-504:case-508:case-510:this.close(4,t);break;case-506:this.close(11,t);break;default:this.close(2)}},onEnterFail:function(){this.__getCopyInterval&&clearInterval(this.__getCopyInterval)},onNetworkChanaged:function(i){var r=this,a=i.nowIp;emedia.config.rebuildPeerConnectionWhenNetworkChanaged&&setTimeout(function(){var i={};e.forEach(r._cacheStreams,function(e,n){if(!r._maybeNotExistStreams[e]&&n._webrtc){var o=n._webrtc;i[n.rtcId]||(o.closed||"string"!=typeof o.useIp||o.useIp===a||(t.warn("network chanage. webrtc will rebuild.",o._rtcId,o.__id),r.onICEClosed(o)),i[n.rtcId]=!0)}})},100)},onEnterSuccess:function(){var e=this;setTimeout(function(){e._failIcesRebuild()},50),e.getCopyIntervalMillis&&e.getCopyIntervalMillis>0&&(t.warn("Run interval get copy. interval = ",e.getCopyIntervalMillis),e.__getCopyInterval&&clearInterval(e.__getCopyInterval),e.__getCopyInterval=setInterval(function(){e._session.connected()?e._sysCopy.apply(e):(t.warn("Warn! cannot get copy. cause offline."),e.__getCopyInterval&&clearInterval(e.__getCopyInterval))},e.getCopyIntervalMillis)),e.getMediaMeterIntervalMillis&&e.getMediaMeterIntervalMillis>0&&e._intervalGetMediaMeters()},_intervalGetMediaMeters:function(){var e=this;!function i(){e.__getMediaMetersIntervalFlag&&emedia.cancelAnimationFrame(e.__getMediaMetersIntervalFlag),e.getMediaMeterIntervalMillis?e.__getMediaMetersIntervalFlag=emedia.requestAnimationFrame(function(t){"function"==typeof emedia.AudioContext&&e._flushMediaMetersByAudioContext.apply(e),!1===e.closed&&i()},e.getMediaMeterIntervalMillis):t.warn("Ontalking closed. please use getMediaMeterIntervalMillis")}()},_flushMediaMetersByAudioContext:function(){var t=this;e.forEach(t._cacheStreams,function(e,i){t._monitSoundChanagedStreams&&!t._monitSoundChanagedStreams[e]||"0"!=i.id&&t._updateMetersOrNewOne.call(t,e,i)});var i=[];e.forEach(t._mediaMeters,function(e,r){var a=t._cacheStreams[e];a&&t._updateMetersOrNewOne.call(t,e,a),a||i.push(e)}),e.forEach(i,function(i,r){e.removeAttribute(t._mediaMeters,r)})},_updateMetersOrNewOne:function(t,i){var r=this,a=r._mediaMeters[t];if(!(2!==i.type||i.located()||i.subArgs&&i.subArgs.subSAudio)){var n=r._oneAudioMixers();if(!n||a&&a._webrtc&&n._webrtc.__id!=a._webrtc.__id)return a&&a._finally(),e.removeAttribute(r._mediaMeters,t),void r._onSoundChanage.call(r,i.owner,i)}return a&&a._streamCreateId===i.__create_id&&a.__mediaSoundMeter.__worked?(a.onSoundMeters(function(e){r._onSoundChanage.call(r,i.owner,i,e)}),a):(a&&(a._streamCreateId!==i.__create_id||a.__mediaSoundMeter.__worked)&&(a&&a._finally(),e.removeAttribute(r._mediaMeters,t),r._onSoundChanage.call(r,i.owner,i)),i.aoff?void 0:((a=r._newMediaMeters(i))&&(r._mediaMeters[t]&&r._mediaMeters[t]._finally(),r._mediaMeters[t]=a),a))},_newAudioContext:function(){if(emedia.__usingWebAudio)return emedia.__audioContext},_newMediaMeters:function(e){var t;if(2===e.type&&e.subArgs&&e.subArgs.subSAudio&&e._webrtc&&e._webrtc.getRemoteStream())return new e.StreamSoundMeter({_stream:e,_mediaStream:e._webrtc.getRemoteStream(),_webrtc:e._webrtc,__audioContext:this._newAudioContext()});if(2===e.type&&e.located())return new e.StreamSoundMeter({_stream:e,_mediaStream:e._localMediaStream,__audioContext:this._newAudioContext()});if(2===e.type&&!e.located()){var i=this._oneAudioMixers();if(!i||!i._webrtc||i._webrtc.closed)return;if(i&&(void 0===i._remoteMediaSoundMeters||!i._remoteMediaSoundMeters.__worked)&&i._webrtc&&i._webrtc.getRemoteStream()&&(i._remoteMediaSoundMeters=new i.MediaSoundMeter({_mediaStream:i._webrtc.getRemoteStream(),__audioContext:this._newAudioContext()})),!i._remoteMediaSoundMeters)return;return new e.StreamSoundMeter({_stream:e,_webrtc:i._webrtc,__mediaSoundMeter:i._remoteMediaSoundMeters})}return!e.aoff&&(t=e.getMediaStream())?new e.StreamSoundMeter({_stream:e,_mediaStream:t,__audioContext:this._newAudioContext()}):void 0},_oneAudioMixers:function(){var e=this._cacheStreams[0];if(e&&e._webrtc&&!e._webrtc.closed)return e;for(var t in this.audioMixers){var i=this.audioMixers[t];if(i.located())return i}},onWSClose:function(){this.__getCopyInterval&&clearInterval(this.__getCopyInterval),t.info("Websocket closed.")},onICEDisconnected:function(i){var r=this;r.__networkWeakInterval&&clearTimeout(r.__networkWeakInterval),r.__networkWeakInterval=setTimeout(function(){r.onNetworkWeak&&r.onNetworkWeak()},1e3),e.forEach(r._linkedStreams,function(a,n){n.rtcId==i.getRtcId()&&(r._maybeNotExistStreams[a]||(r._maybeNotExistStreams[a]=e.extend({},n)).updateAttributes({iceRebuildCount:1}),t.info("Stream maybe not exist. caused by disconnected",n.id))})},onICEConnectFail:function(r){var a=this;for(var n in a._linkedStreams){var o=a._linkedStreams[n];if(o.rtcId==r.getRtcId()){if(o._webrtc&&o._webrtc.__id!==r.__id){t.warn("Stream use other webrtc rtcId = ",o.rtcId,", id: ",o._webrtc.__id,r.__id);continue}var s;if((s=a._maybeNotExistStreams[n])||(s=a._maybeNotExistStreams[n]=e.extend({},o)).updateAttributes({iceRebuildCount:1}),s){var d=new i.StreamState({stream:s});d.iceFail(),a.onEvent(d)}if(t.info("ice fail. webrtc = ",r.getRtcId()," problem stream is ",s.iceRebuildCount,s.id),s.iceRebuildCount>emedia.config.iceRebuildCount)t.info("ice fail. webrtc = ",r.getRtcId()," rebuild fail. problem stream is ",s.id),s.located()?a.onEvent(new i.PushFail({stream:o,cause:"pub ice rebuild failed."})):a.onEvent(new i.SubFail({stream:o,cause:"sub ice rebuild failed."})),a.closeWebrtc(r.getRtcId(),!1);else{var c=a._records[s.id];s._localMediaStream?t.info("ice fail. webrtc = ",r.getRtcId()," will rebuild. remain local stream. ",s.id):t.info("ice fail. webrtc = ",r.getRtcId()," will rebuild.",s.id),a.closeWebrtc(r.getRtcId(),!0),c&&(a._records[s.id]=c),function(e){setTimeout(function(){a.iceRebuild(e)},emedia.config.iceRebuildIntervalMillis)}(s),t.info("ice fail. webrtc = ",r.getRtcId()," will rebuilding. problem stream is ",s.id)}2===o.type&&e.removeAttribute(a.audioMixers,o.id)}}},onICEClosed:function(i){if(i.closed){t.warn("Webrtc will be removed. by __id = ",i.__id,", rtcId = ",i.getRtcId());var r=e.removeAttribute(this._ices,i.__id);r?t.warn("Webrtc removed. by id = ",r.__id,", rtcId = ",r.getRtcId()):t.warn("Webrtc removed. by id = ",i.__id,", rtcId = ",i.getRtcId());var a=this._ices[i.getRtcId()];a&&a.__id===r.__id&&(r=e.removeAttribute(this._ices,i.getRtcId()),t.warn("Webrtc removed. by rtcId = ",r.getRtcId(),", __id = ",r.__id))}else t.info("ICE self closed. not allow. will rebuild",i.getRtcId()),this.onICEConnectFail(i)},onICEConnected:function(r){var a=this;e.forEach(a._cacheStreams,function(n,o){if(o.rtcId==r.getRtcId()){if(o.updateAttributes({finalVCodeChoices:r.finalVCodeChoices}),a._maybeNotExistStreams[n]){e.removeAttribute(a._maybeNotExistStreams,o.id),a._linkedStreams[n]=o,t.info("ice reconnected. webrtc = ",r.getRtcId(),"will update stream = ",o.id);var s=a._records[o.id];s&&s.rtcId!==o.rtcId&&(a.startRecord(o),t.warn("Re record. for ",o.id,", after rebuild ice.",s.rtcId,"->",o.rtcId))}else t.info("ice connected. webrtc = ",r.getRtcId(),o.id),o.located()&&a.onEvent(new i.PushSuccess({stream:o})),o.located()||a.onEvent(new i.SubSuccess({stream:o}));2===o.type&&(a.audioMixers[o.id]=o)}})},onICERemoteMediaStream:function(t){var i=this;e.forEach(i._cacheStreams,function(e,r){if(r.rtcId==t.getRtcId()&&(!r.located()||2===r.type)){var a=t.getRemoteStream();if(i._updateRemoteStream(r,a),r.onGotRemoteMediaStream)r.onGotRemoteMediaStream.call(r,a);else(r=i.newStream(r)).updateAttributes({mediaStream:t.getRemoteStream()}),i.onUpdateStream(r,new r.Update({mediaStream:r.mediaStream}))}})},_failIcesRebuild:function(){var t=this;e.forEach(t._maybeNotExistStreams,function(e,i){setTimeout(function(){t.iceRebuild(i)},100)})},iceRebuild:function(r){return this.connected()?this._linkedStreams[r.id]&&this._cacheStreams[r.id]?void(r.iceRebuildCount>emedia.config.iceRebuildCount?(t.info("ice rebuild fail. count too many. stream is ",r.id),r.located()?this.onEvent(new i.PushFail({stream:r,cause:"pub ice rebuild failed."})):this.onEvent(new i.SubFail({stream:r,cause:"sub ice rebuild failed."}))):this.connected()?(t.info("ice try rebuild. count",r.iceRebuildCount,". stream is ",r.id),this.rebuildIce(r),r.iceRebuildCount++):t.warn("ice rebuild. stop. cause by not websocket disconnect",r.id)):(t.info("ice rebuild fail. it yet closed. stream is ",r.id,r.rtcId),e.removeAttribute(this._maybeNotExistStreams,r.id),e.removeAttribute(this._linkedStreams,r.id),void t.warn("iceRebuild, remvoe from _linkedStreams",r.id)):(r.updateAttributes({iceRebuildCount:1}),void t.warn("Websocket disconnect. waiting. rebuild count reset",r.iceRebuildCount,r.id))},rebuildIce:function(e){this._cacheStreams[e.id]?(t.warn("Begin rebuild ice ",e.iceRebuildCount,e.id),e.located()?(e.updateAttributes({isRepublished:!0}),this.push(e,void 0,void 0,!0)):this.createWebrtcAndSubscribeStream(e.id),t.warn("Finish rebuild ice ",e.iceRebuildCount,e.id,this._cacheStreams[e.id].rtcId)):t.warn("Begin rebuild ice. not found stream at local",e.iceRebuildCount,e.id)},_sysCopy:function(){var e=this,i=e.newMessage().setOp(1e3).setCver(e._cver||0);e.postMessage(i,function(i){0==i.result?(e._cver||0)<i.cver&&(e._cver=i.cver,e.onMembers(i.cver,i.mems||{}),e.onStreams(i.cver,i.streams||{}),t.info("Got copy success.")):t.warn("Get copy fail. result = ",i.result)})}});module.exports=r;
},{"./Util":"Qsy+","./event":"zP2G"}],"4PaW":[function(require,module,exports) {
var e=require("./Util"),t=e.tagLogger("Desktop"),o=require("./event");window.__shareDesktopMessageCount__=0,module.exports=e.prototypeExtend({__RTC_PAGE_MSG_TYPE__:"RTC-SD-PAGE",__RTC_EXT_MSG_TYPE__:"RTC-SD-EXT",__init__:function(){var e=this;e.__extLoaded=e.rsdExtLoaded(),e.__extLoaded&&e.__onRsdExtLoad(),window.addEventListener("load",function(t){if(!e.__extLoaded){var o=e.rsdExtLoaded();e.__extLoaded=o}}),window.addEventListener("message",function(o){if(o.data){var n=o.data;n.type&&n.type===e.__RTC_EXT_MSG_TYPE__&&n.evname&&(t.info("got ext-msg: ",n),"extLoaded"!==n.evname?e.__onMessage(n):e.__extLoaded||(e.__extLoaded=!0,setTimeout(e.__onRsdExtLoad(),50)))}})},rsdExtLoaded:function(){var e=document.getElementById("RTC-Share-Deskto-installed-ele-rat1abrr");return!(!emedia.isElectron&&!e)},__sendMessage:function(o,n){var s=this,d="tsx_"+__shareDesktopMessageCount__+++"_"+Math.random().toString(36).substr(2,4);if(!s.__extLoaded)throw t.error("Rtc share desktop not loaded"),"Rtc share desktop not loaded";o.tsxId=d,s["on_"+d]=function(){n&&n.apply(s,arguments),e.removeAttribute(s,"on_"+d)},window.postMessage&&window.postMessage(o,"*")},__onMessage:function(e){var t=e.tsxId;this["on_"+t]&&this["on_"+t](e)},__onRsdExtLoad:function(){this.onExtLoaded&&this.onExtLoaded()},openDesktopMedia:function(e,t){if(emedia.isElectron)this.openDesktopMediaInElectron(e,t);else if(this.__extLoaded&&this.rsdExtLoaded()){var n={type:this.__RTC_PAGE_MSG_TYPE__,evname:"chooseDesktopMedia",screenOptions:e};this.__sendMessage(n,function(e){"onAccessApproved"===e.evname&&e.streamId?t(new o.OpenDesktopMedia({desktopStreamId:e.streamId})):t(new o.OpenDesktopMediaAccessDenied)})}else t(new o.ShareDesktopExtensionNotFound)},openDesktopMediaInElectron:function(e,n){e||(e=["screen","window"]),emedia.electron.desktopCapturer.getSources({types:e},function(e,s){if(e)n(new o.OpenDesktopMediaAccessDenied({error:e}));else if("function"==typeof emedia.chooseElectronDesktopMedia){for(var d=0;d<s.length;d++){t.debug("desktop capturer. ",s[d]);var a=s[d];a.hxThumbDataURL=a.thumbnail.toDataURL()}emedia.chooseElectronDesktopMedia(s,function(e){var t;t=e&&e.id?e.id:e,n(new o.OpenDesktopMedia({desktopStreamId:t}))},function(){n(new o.OpenDesktopMediaAccessDenied({message:"User denied access"}))})}else n(new o.OpenDesktopMedia({desktopStreamId:s[0].id}))})}});
},{"./Util":"Qsy+","./event":"zP2G"}],"gqHj":[function(require,module,exports) {
var t,e=require("./Util"),a=e.tagLogger("PCStats");module.exports=t=e.prototypeExtend({__init__:function(){this._webrtc||this._stream&&(this._webrtc=this._stream._webrtc),this.samplesDatas={},this.gatherResults={},this._bysamples={},!1!==this._inbound_&&(this._bysamples["inbound-rtp"]=["bytesRateReceived","packageLossRate","bytesReceived","packetsLost","packetsReceived","pliCount","framesDecoded"]),!1!==this._outbound_&&(this._bysamples["outbound-rtp"]=["bytesRateSent","bytesSent","packetsSent","qpSum","pliCount"])},_onGatherResult:function(t,e,a,r){if(this._service&&this._service.current&&emedia.config.remainLastStatsCount){var i=this._service.current._trackStats;i||(i=this._service.current._trackStats={});var n=(i[t]||(i[t]={}))[e];n||(n=i[t][e]={});var s=n[a];s||(s=n[a]=new Array(emedia.config.remainLastStatsCount)),void 0===s.curIndex&&(s.curIndex=0),s[s.curIndex]={data:r,timestamp:new Date},s.curIndex=(s.curIndex+1)%emedia.config.remainLastStatsCount}"function"==typeof this.onGatherResult&&this.onGatherResult(t,e,a,r)},stats:function(t){if(this._webrtc&&this._webrtc._rtcPeerConnection)return this._webrtc._rtcPeerConnection.getStats(t);a.warn("not found webrtc or peer connection")},statsOfTrack:function(t){if(!t instanceof window.MediaStreamTrack)throw a.error("selector not a MediaStreamTrack"),"selector not a MediaStreamTrack";return this.stats(t)},audioTrack:function(t){var e=t&&t.getAudioTracks();return e&&e.length?e[0]:void 0},videoTrack:function(t){var e=t&&t.getVideoTracks();return e&&e.length?e[0]:void 0},gatherTrack:function(t,e){var r=this;e=(e=t.kind||e)&&e.toLowerCase();var i=t.id;this.statsOfTrack(t).then(function(n){r.samplesDatas[i]||(r.samplesDatas[i]={});var s=r.samplesDatas[i];n.forEach(function(i,n){var c=r._bysamples[i.type],o=i.mediaType||n.indexOf("ideo")>=0&&"video"||n.indexOf("udio")>=0&&"audio"||void 0;if(c&&c.length&&(!0===emedia.config._printDebugStats&&a.debug(n,i,t,o,e),!o||o===e)){var d=s[i.type]||(s[i.type]={});c.forEach(function(a){var r=d[a]||(d[a]=[]),n={timestamp:i.timestamp,kind:i.mediaType||t.kind||e};n[a]="packageLossRate"===a?{packetsLost:i.packetsLost,packetsReceived:i.packetsReceived}:"bytesRateReceived"===a?i.bytesReceived:"bytesRateSent"===a?i.bytesSent:i[a],r.push(n)})}})})},gatherWebrtcMediaStream:function(t,e){var a=this;e?"audio"!==e.toLowerCase()?"video"!==e.toLowerCase()||t.getVideoTracks().forEach(function(t){a.gatherTrack(t,t.kind||e.toLowerCase())}):t.getAudioTracks().forEach(function(t){a.gatherTrack(t,t.kind||e.toLowerCase())}):t.getTracks().forEach(function(t){a.gatherTrack(t)})},gatherWebrtc:function(){this._webrtc._localStream&&this.gatherWebrtcMediaStream(this._webrtc._localStream),this._webrtc._remoteStream&&this.gatherWebrtcMediaStream(this._webrtc._remoteStream)},_gather_inbound_rtp_packageLossRate:function(t){if(!t||0===t.length)return 0;var e=0,a=0;if(t.length>1)for(var r=1;r<t.length;r++){var i=t[r],n=t[r-1];i.packageLossRate.packetsReceived!=n.packageLossRate.packetsReceived?(e+=(i.packageLossRate.packetsLost-n.packageLossRate.packetsLost)/(i.packageLossRate.packetsReceived-n.packageLossRate.packetsReceived),a++):(e=0,a=0)}return t.length>=emedia.config.statsSeconds&&t.shift(),0==a?0:e/a},_gatherBytesRate:function(t,e,a){if(!a||0===a.length)return 0;var r=a[a.length-1][e]-a[0][e],i=a[a.length-1].timestamp-a[0].timestamp;return a.length>=emedia.config.statsSeconds&&a.shift(),0===i?0:parseFloat(1e3*r/i).toFixed(2)},_gather:function(t,a,r){t=t.replace(/[^\w]/g,"_"),a=a.replace(/[^\w]/g,"_");var i=e.list("_gather",t,a).join("_");if("function"==typeof this[i])return this[i](r);if(a.startsWith("bytesRate"))return this._gatherBytesRate(t,a,r);var n=r.shift();return n&&n[a]||0},_statsCount:function(){var t=this;e.forEach(t.samplesDatas,function(a,r){!function(a,r,i){e.forEach(i,function(i,n){var s=r[i]||(r[i]={});!function(a,r,i,n){e.forEach(n,function(e,n){var s=r[e]=t._gather(i,e,n);t._onGatherResult(a,i,e,s)})}(a,s,i,n)})}(a,t.gatherResults[a]=t.gatherResults[a]||{},r)})},gather:function(){this.gatherWebrtc(),this._statsCount()},intervalGather:function(t){this._intervalId&&clearInterval(this._intervalId),this._intervalId=setInterval(this.gather.bind(this),t||1e3)},stopIntervalGather:function(){this._intervalId&&clearInterval(this._intervalId)}});var r={},i=t.echo=function(a){e.forEach(a,function(a,i){var n;!r[i.id]&&i._webrtc&&!i._webrtc.closed&&i.getMediaStream()?(r[i.id]=n=new t({_webrtc:i._webrtc}),n._mediaStream=i.getMediaStream()):!r[i.id]||i._webrtc&&!i._webrtc.closed&&i.getMediaStream()||e.removeAttribute(r,i.id)});var i=[];e.forEach(r,function(t,e){a&&a[t]?(e.gatherWebrtcMediaStream(e._mediaStream),e._statsCount()):i.push(t)}),e.forEach(i,function(t,a){e.removeAttribute(r,a)})};t.intervalEcho=function(t,e){return setInterval(function(){i(t)},e)},e.forEach(["inbound","outbound"],function(a,r){e.forEach(["Audio","Video"],function(a,i){!function(a,r){var i;t[a+r]=i=function(n,s,c){var o;i.__intervalIds||(i.__intervalIds={}),o=this instanceof emedia.XService?this:emedia.useCurrentXService;var d=n.id+"___"+o.namespace,u=i.__intervalIds&&i.__intervalIds[d];return u&&clearInterval(u),u=setInterval(function(){var c,h=i[d];(!h&&n&&n._webrtc&&!n._webrtc.closed&&n.getMediaStream()?(i[d]=h=new t({_webrtc:n._webrtc,_inbound_:"inbound"===a,_outbound_:"outbound"===a}),h._service=o,s&&(h.onGatherResult=s),h._mediaStream=n.getMediaStream()):!h||n&&n._webrtc&&!n._webrtc.closed&&n._webrtc.__id===h._webrtc.__id&&n.getMediaStream()&&h._mediaStream&&h._mediaStream.id===n.getMediaStream().id||(e.removeAttribute(i,d),h=null),h)?(h.gatherWebrtcMediaStream(h._mediaStream,r),h._statsCount()):n&&o&&(c=o.getStreamById(n.id))?n=c:u&&clearInterval(u)},c),i.__intervalIds[d]=u,u}}(r,i)})});
},{"./Util":"Qsy+"}],"oIaS":[function(require,module,exports) {
var t=require("../../../webrtc/src/components/Util"),e=t.tagLogger("MouseTrigger"),i={LEFT:1,WHEEL:2,RIGHT:4,WHEEL_ROLL_UP:8,WHEEL_ROLL_DOWN:16,KEY_UP:0,KEY_DOWN:1,MOVE:2,KEYBOARD_DOWN:3,KEYBOARD_UP:4};module.exports=t.prototypeExtend({_timeoutMillis:500,_time:(new Date).getTime(),isKeyup:function(){return i.KEY_UP==this.oper},isKeydown:function(){return i.KEY_DOWN==this.oper},isWheelup:function(){return i.WHEEL_ROLL_UP==this.btn},isWheeldown:function(){return i.WHEEL_ROLL_DOWN==this.btn},isLeftKey:function(){return i.LEFT==this.btn},isRightKey:function(){return i.RIGHT==this.btn},isWheelKey:function(){return i.WHEEL==this.btn},isWheelRoll:function(){return this.isWheeldown()||this.isWheelup()},timeout:function(){return(new Date).getTime()-this._time>=this._timeoutMillis},_toString:function(){return t.list("btn:",this.btn,", oper:",this.oper,", timeout:",this.timeout(),", at (",this.xy.x,", ",this.xy.y,")").join("")}}),module.exports.BTN=i;
},{"../../../webrtc/src/components/Util":"Qsy+"}],"LM64":[function(require,module,exports) {
var t=require("../../../webrtc/src/components/Util"),e=t.tagLogger("MouseTrack"),i=require("./MouseTrigger");module.exports=t.prototypeExtend({_scale:1,__init__:function(){},getTargetPageXY:function(){return this._target&&t.extend({},t.getDomPageRect(this._target))},onMouseTrack:function(t,e,i){},onMouseTrigger:function(t,e){},_onMouseTrack:function(t,e,i){this.onMouseTrack&&this.onMouseTrack(t,e,i)},_onMouseTrigger:function(t,e){this.onMouseTrigger&&this.onMouseTrigger(t,e)},track:function(e){var i=e=t.extend({},e),s=this.getTargetPageXY();s&&(i={x:(e=this._calPosition(e)).x,y:e.y,pageX:s.x+e.x,pageY:s.y+e.y}),this._onMouseTrack(i,this._lastPageXY,this._lastTrigger),this._lastPageXY=i},trigger:function(t){t=new i(t);var e,s=this.getTargetPageXY();s&&(e=this._calPosition(t.xy),t.xy={x:e.x,y:e.y,pageX:s.x+e.x,pageY:s.y+e.y}),t._time||(t._time=(new Date).getTime()),this._onMouseTrigger(t,this._lastTrigger),this._lastTrigger=t},releaseTrigger:function(){this._lastTrigger=void 0,this._lastPageXY=void 0,this.onReleaseTrigger&&this.onReleaseTrigger(this._lastTrigger)},_calPosition:function(e){this._referenceVideo&&(e=emedia.Service.prototype.eventXYAtVideo.call(null,e,this._referenceVideo));var i=this.getTargetPageXY();if(!i)return e;t.isFloat(e.x)&&void 0!==e.width&&(e.x=e.x*e.width*this._scale*(i.width/e.width)),t.isFloat(e.y)&&void 0!==e.height&&(e.y=e.y*e.height*this._scale*(i.height/e.height)),t.isFloat(e.x)&&void 0===e.width&&(e.x=e.x*this._scale*i.width),t.isFloat(e.y)&&void 0===e.height&&(e.y=e.y*this._scale*i.height),t.isInt(e.x)&&void 0!==e.width&&(e.x=e.x*this._scale*(i.width/e.width)),t.isInt(e.y)&&void 0!==e.height&&(e.y=e.y*this._scale*(i.height/e.height)),t.isInt(e.x)&&void 0===e.width&&(e.x=e.x*this._scale),t.isInt(e.y)&&void 0===e.height&&(e.y=e.y*this._scale);var s=Math.floor(e.x),h=Math.floor(e.y);return s<0&&(s=i.width+s),h<0&&(h=i.width+h),{x:s,y:h,width:i.width,height:i.height}}});
},{"../../../webrtc/src/components/Util":"Qsy+","./MouseTrigger":"oIaS"}],"yEWu":[function(require,module,exports) {
var t,a=require("../../../webrtc/src/components/Util"),e=a.tagLogger("DefaultTrack"),i=require("./MouseTrack");function n(t,a,i){var n=t.getContext("2d"),o=t.width,r=t.height;n.scale(o/a,r/i),e.warn("Canvas scale",o/a,r/i,a,i);var s=n.getImageData(0,0,o,r);t.width=a,t.height=i,n.putImageData(s,0,0)}function o(t){var a;return a=document.createElement("canvas"),t.appendChild(a),a.style.cssText="position: absolute; background: transparent; width: 100%; height: 100%",a.width=t.offsetWidth,a.height=t.offsetHeight,e.warn("Canvas",a.width,a.height),a}module.exports=t=i.extend({__init__:function(){this._canvas||(this._canvas=o(this._target)),this._canvasContext||(this._canvasContext=this._canvas.getContext("2d"))},resizeCanvas:function(){},_calPosition:function(){var t=i.prototype._calPosition.apply(this,arguments);return t.x=Math.floor(t.x*this._canvas.width/t.width),t.y=Math.floor(t.y*this._canvas.height/t.height),t},_draw:function(t,a,e,i,n,o){var r=this._canvasContext;(!a||a<=1)&&(a=2);var s=r.getImageData(t.x-a/2,t.y-a/2,a,a);s&&function(t,a,e,i,n){for(var o=0,r=t.data;o<r.length;o+=4){var s={r:void 0===a?r[o]:a,g:void 0===e?r[o+1]:e,b:void 0===i?r[o+2]:i,alpha:void 0===n?r[o+3]:n};r[o]=s.r,r[o+1]=s.g,r[o+2]=s.b,r[o+3]=s.alpha}}(s,e,i,n,o),r.putImageData(s,t.x,t.y)},redraw:function(a,e,i,n,o,r){t.prototype._draw.bind(this)({x:a,y:e},2)},onMouseTrigger:function(t,a){t.isLeftKey()&&this._draw(t.xy,8,189,56,51,255),t.isRightKey()&&this._draw(t.xy,8,45,23,189,255),t.isWheelKey()&&this._draw(t.xy,8,58,189,76,255)},onMouseTrack:function(t,a,e){this._draw(t,2,227,18,247,255)}});
},{"../../../webrtc/src/components/Util":"Qsy+","./MouseTrack":"LM64"}],"rBvl":[function(require,module,exports) {
var e=require("./Util"),t=require("underscore"),i=e.tagLogger("Service"),o=require("./Session"),n=require("./Attendee"),r=require("./event"),a=require("./EventHandler"),s=require("./_Desktop"),c=new s({onExtLoaded:function(){i.info("Share desktop ext. had loaded.")}}),d=require("./_Stream"),u=require("./PCStats"),f=require("../../../pannel/src/components/DefaultTrack");module.exports=e.prototypeExtend({__init__:function(){i.warn("emedia version: ",window._emediaVersion||"unkown"),i.warn("UserAgent: ",navigator.userAgent);var t=e.parseURL("__log_level___");t&&(emedia.LOG_LEVEL=parseInt(t)),this.namespace=Math.uuidFast(),emedia.useCurrentXService=this,void 0===this.useRTCCfg&&(this.useRTCCfg=emedia.config.useRTCCfgIfServerReturn),"string"==typeof this.useRTCCfg&&(this.useRTCCfg=JSON.parse(this.useRTCCfg)),this.inboundAudio=u.inboundAudio.bind(this),this.inboundVideo=u.inboundVideo.bind(this),this.outboundAudio=u.outboundAudio.bind(this),this.outboundVideo=u.outboundVideo.bind(this)},AVPubstream:d.extend({__init__:function(){this.type=0,this._located=!0,this.mutedMuted=!0,this.constaints&&(this.constaints.video||(this.voff=1),this.constaints.audio||(this.aoff=1)),this.constaints||(this.constaints={audio:!0,video:!0}),emedia.config.maxVideoBitrate&&(this.vbitrate=emedia.config.maxVideoBitrate),emedia.config.maxAudioBitrate&&(this.abitrate=emedia.config.maxAudioBitrate)}}),AudioMixerPubstream:new d.extend({__init__:function(){if(this.type=2,this._located=!0,this.mutedMuted=!0,this.constaints||(this.constaints={audio:!0,video:!1}),this.constaints){var e=!!this.constaints.audio;this.constaints.video||(this.constaints.video=!1),this.constaints.video||(this.voff=1),this.constaints.audio||(this.aoff=1),!1===e&&(this.aoff=1)}emedia.config.maxVideoBitrate&&(this.vbitrate=emedia.config.maxVideoBitrate),emedia.config.maxAudioBitrate&&(this.abitrate=emedia.config.maxAudioBitrate)},onGotRemoteMediaStream:function(e){if(!this.remotePlayAudioObject){var t="__o_remote_play_audio_"+this.id,i=document.querySelector("#"+t);i||((i=document.createElement("audio")).style.display="none",i.id="__o_remote_play_audio_"+this.id,i.autoplay=!0,i.playsinline=!0,document.body.appendChild(i)),this.remotePlayAudioObject=i}this.remotePlayAudioObject.srcObject=e}}),ShareDesktopPubstream:d.extend({voff:0,__init__:function(){this.type=1,this._located=!0,this.mutedMuted=!0,this.constaints={audio:!this.aoff,video:!0},emedia.config.maxVideoBitrate&&(this.vbitrate=emedia.config.maxVideoBitrate),emedia.config.maxAudioBitrate&&(this.abitrate=emedia.config.maxAudioBitrate)}}),__assertCurrent:function(){if(!this.current)throw i.error("Please call emedia.service.setup(ticket)"),"Please call emedia.service.setup(ticket)";if(this.current.closed)throw i.error("current closed"),"current closed"},hasAudioMixers:function(){for(var e in this.__assertCurrent(),this.current.audioMixers){var t=this.current.audioMixers[e];if(t&&t.located())return!0}},getMediaDevices:function(e,t,o){"function"==typeof e&&(o=t,t=e,e=void 0),navigator.mediaDevices.enumerateDevices().then(function(o){for(var n=[],r=0;r!==o.length;++r){var a=o[r];e?e===a.kind?n.push(a):"audioinput"===a.kind||"audiooutput"===a.kind||"videoinput"===a.kind||i.info("Some other kind of source/device: ",a):n.push(a)}t&&t(n)}).catch(function(e){i.warn("navigator.getUserMedia error: ",e),o&&o(e)})},attachSinkId:function(e,t){void 0!==e.sinkId?e.setSinkId(t).then(function(){i.info("Success, audio output device attached: "+t)}).catch(function(e){var t=e;"SecurityError"===e.name&&(t="You need to use HTTPS for selecting audio output device: "+e),i.warn(t)}):i.warn("Browser does not support output device selection.")},_stopTracks:function(e){emedia.stopTracks(e),e&&i.warn("Stream tracks stop. it = ",e)},_enableVideoTracks:function(e,t){emedia.enableVideoTracks(e,t)},_enableAudioTracks:function(e,t){emedia.enableAudioTracks(e,t)},openUserMedia:function(e){i.debug("begin open user media",e);var t=this;if(!e)throw i.error("require pubS"),"require pubS";return{then:function(o,n){function r(){o.apply(null,arguments);var i=e.localStream;i&&(i.oninactive=t._onStreamInactive.bind(t,e,i),i.onactive=t._onStreamActive.bind(t,e,i))}if(e instanceof t.AVPubstream)t._openCamera(e,r,n);else if(e instanceof t.ShareDesktopPubstream)t._openSharedDesktop(e,r,n);else{if(!(e instanceof t.AudioMixerPubstream))throw i.error("Unspported pubS"),"Unspported pubS";t._openCamera(e,r,n)}}}},_openSharedDesktop:function(t,o,n){var a,s=this;function d(e){var t={audio:!0};e.constaints&&("object"==typeof e.constaints.audio&&e.constaints.audio||e.constaints.audio||(t.audio=!1)),s.__getUserMedia(t,function(t,i){var n=new MediaStream;n._located=!0,i&&i.getAudioTracks().forEach(function(e){n.addTrack(e)}),e.localStream&&e.localStream.getVideoTracks().forEach(function(e){n.addTrack(e)}),e.localStream=n,o&&o(s.current,n)},n)}if(t._localMediaStream&&(a=t._localMediaStream.getVideoTracks())&&a.length>0)return t.localStream=t._localMediaStream,void(t.constaints.audio?d(t):o&&o(s.current,stream));c.openDesktopMedia(t.screenOptions||["screen","window","tab"],function(a){if(a instanceof r.OpenDesktopMedia){var c=a.desktopStreamId;i.warn("desktop streamId",c);var u={audio:!1,video:{mandatory:e.extend(t.mandatory||{},{chromeMediaSource:"desktop",chromeMediaSourceId:c}),optional:[]}};s.__getUserMedia(u,function(e,i){t.localStream=i,t.constaints.audio?d(t):o&&o(s.current,i)},n)}else s.current&&s.current.onEvent(new r.ShareDesktopExtensionNotFound({member:s.current})),n&&n(a)})},_openCamera:function(e,t,i){var o=this,n=e.constaints||{audio:!0,video:!0};o.__getUserMedia(n,function(i,n){o.__controlStream(e,n),e.localStream=n,t&&t(o.current,n)}.bind(n),i)},__controlStream:function(e,t){emedia.enableVideoTracks(t,!e.voff),emedia.enableAudioTracks(t,!e.aoff)},__getUserMedia:function(t,o,n){i.debug("get user media. using constaints",t);var a,s=this;function c(e){i.debug("[WebRTC-API] getUserMedia() error: ",e),emedia.stopTracks(a),s.current&&s.current.onEvent(new r.OpenMediaError({member:s.current,event:e})),n&&n(new r.OpenMediaError({member:s.current,event:e}))}t=e.extend({},t),s.__sysGetUserMedia(t,function(e){s.current&&!s.current.closed&&(s.current._openedRtcMediaStreams[e.id]=e,e._bindAttendee=s.current,e._bindAttendeeId=s.current.getMemberId(),i.info("stream bind attendee.",e.id,s.current.ticket&&s.current.ticket.id,s.current.getMemberId(),s.current.memName)),emedia._yetGetUserMedia=!0,a=e;var n=e.getVideoTracks(),r=e.getAudioTracks();if(n.length>0){var d=n[0];i.debug(e.id,"using video device: ",d.id,d.label,d.kind,d.enabled)}if(r.length>0){var u=r[0];i.debug(e.id,"using audio device: ",u.id,u.label,u.kind,u.enabled)}if(e._located=!0,"boolean"==typeof e.active&&!e.active)return i.error("media stream not active. it is",e.id),void c({constraint:t,name:"NotAllowedStreamNonactive",message:"stream non-active"});o&&o(s.current,e)},c)},_onStreamInactive:function(t,o,n){var r=this;i.warn("media stream inactive. it =",o.id),t.onMediaInactive&&r.current&&e.forEach(r.current._cacheStreams,function(e,i){i.located()&&i.localStream&&i.localStream.id===o.id&&(i._webrtc&&i._webrtc.closed||t.onMediaInactive.call(i,o,n,r))})},_onStreamActive:function(t,o,n){var r=this;i.warn("media stream active. it =",o.id),t.onMediaActive&&r.current&&e.forEach(r.current._cacheStreams,function(e,i){i.located()&&i.localStream&&i.localStream.id===o.id&&t.onMediaActive.call(i,o,n,r)})},__sysGetUserMedia:function(o,n,r){function a(t,o,n){"object"==typeof emedia.config.globalConstraints&&("object"==typeof emedia.config.globalConstraints.audio&&t.audio&&("boolean"==typeof t.audio?t.audio=e.extend({},emedia.config.globalConstraints.audio):t.audio=e.extend({},emedia.config.globalConstraints.audio,t.audio)),"object"==typeof emedia.config.globalConstraints.video&&t.video&&("boolean"==typeof t.video?t.video=e.extend({},emedia.config.globalConstraints.video):t.video=e.extend({},emedia.config.globalConstraints.video,t.video))),i.info("navigator.mediaDevices.getUserMedia constaints = ",JSON.stringify(t)),navigator.mediaDevices.getUserMedia(t).then(o).catch(n)}if(emedia.isSafari){if((o=t.extend({},o)).audio){var s={audio:o.audio};a(s,u.bind(s),f)}if(o.video){var c={video:o.video};a(c,u.bind(c),f)}o.video||o.audio||f("Failed to execute 'getUserMedia' on 'MediaDevices': At least one of audio and video must be requested")}else a(o,n,r);function d(){var e=new MediaStream;o.audioStream&&o.audioStream.getAudioTracks().forEach(function(t){e.addTrack(t)}),o.videoStream&&o.videoStream.getVideoTracks().forEach(function(t){e.addTrack(t)}),n&&n(e)}function u(e){o.failed?emedia.stopTracks(e):(!this.audio||(o.audioStream=e,o.video))&&(!this.video||(o.videoStream=e,o.audio))?o.audioStream&&o.videoStream&&d():d()}function f(e){o.failed||(o.failed=!0,r(e))}},attachMediaStream:window.attachMediaStream.bind({logger:i}),setup:function(t,o){var s=this;i.count(),i.debug("recv ticket",t,o),i.debug("use sdk version",window._emediaVersion),i.debug(navigator.userAgent);var c,d,u=o=o||{};if(e.isPlainObject(o))o=JSON.stringify(o);else try{u=JSON.parse(o)}catch(l){}if("string"==typeof t&&(t=JSON.parse(t)),c=d=t.memName,emedia._lastSetupConfr=t.confrId,emedia._lastSetupMemName=d,emedia._lastSetupDate=new Date,emedia._lastSetupTktId=t.tktId,s.current&&!s.current.closed){var f=new r.CurrentCalling;throw s.current.onEvent(f),i.error("confr not close. calling..."),f}var m=(s.Attendee||n).extend(a);return s.current=new m({_service:s,service:s,autoSub:emedia.config.autoSub,getCopyIntervalMillis:emedia.config.getCopyIntervalMillis,sysUserId:c,memName:d,resource:s.resource,nickName:s.nickName,ticket:t,ext:o,extObj:u,sessionFactory:function(){return s.newSession(this,t)}},s.listeners||{})},getStreamById:function(t){var i=this.current&&this.current._cacheStreams[t];return i&&e.extend(!1,{},i)},getStreamsByRtcId:function(t){if(this.current&&this.current._cacheStreams){var i=[];return e.forEach(this.current._cacheStreams,function(e,o){o.rtcId===t&&i.push(o)}),i}},getMemberById:function(t){var i=this.current&&this.current._cacheMembers[t];return i&&e.extend(!1,{},i)},exit:function(e){i.warn("User click exit ",e),this.current&&this.current.exit(e)},join:function(e,t){i.debug("begin join ...");if(this.__assertCurrent(),this.current._memberId)return i.warn("Had joined. igrone it"),void(e&&e(this.memId));this.current._session._sessionId=void 0,this.current.join(e,t)},withpublish:function(e){if(!e||!e.localStream)throw i.error("pubS null or stream not open"),"pubS null or stream not open";return this.__assertCurrent(),this.current._memberId?i.warn("Had joined. igrone it"):this.current._session._sessionId=void 0,this.current.withpublish(e)},push:function(e,t,o){i.debug("begin push ...");if(2===arguments.length&&(o=t,t=void 0),!e||!e.localStream)throw i.error("pubS or stream open"),"pubS or stream open";this.__assertCurrent(),this.current.push(e,t,o,!1)},subscribe:function(t,o,n,r){var a=this;if(i.info("begin subscribe ",t,r),o&&e.isPlainObject(o)&&(r=o,o=n=void 0),n&&e.isPlainObject(n)&&(r=n,n=o,o=void 0),emedia.isSafari){var s={streamId:t,onSub:o,subfail:n,subArgs:r},c=a.__safari_subs||(a.__safari_subs=[]);function d(){try{var e=c.shift();e&&e.onSub&&e.onSub.apply(e,arguments)}finally{f()}}function u(){try{var e=c.shift();e&&e.subfail&&e.subfail.apply(e,arguments)}finally{f()}}function f(){c.length>0&&a.__subscribe(c[0].streamId,d,u,c[0].subArgs)}c.push(s),1===c.length&&f()}else a.__subscribe(t,o,n,r)},__subscribe:function(t,o,n,r){this.__assertCurrent(),2==arguments.length&&(n=o,o=void 0),o&&e.isPlainObject(o)&&(r=o,o=void 0),n&&e.isPlainObject(n)&&(r=n,n=void 0),r||(r={subSVideo:!0,subSAudio:!0});this.current._cacheStreams[t];var a=this.current._getWebrtc(t),s=a&&a.isConnected(),c=s&&a.getRemoteStream();if(c&&(s=c.active)){var d=c.getAudioTracks().length,u=c.getVideoTracks().length;(d||!0!==r.subSAudio)&&(u||!0!==r.subSVideo)||(s=!1)}if(i.info("sub stream",t,", use prertcpeer =",s),s)return this.current.subscribeStream(a._rtcId,t,n,r,o),void(o&&o());a&&!a.closed&&this.current.closeWebrtc(a.getRtcId(),!0,!1),this.current.createWebrtcAndSubscribeStream(t,{onGotRemote:function(e){o&&o(e)},onEvent:function(e){n&&n(e)}},void 0,r)},closePubstream:function(e){e.located()&&(emedia.stopTracks(e._localMediaStream),emedia.stopTracks(e.localStream))},hungup:function(e){var t=this.getStreamById(e);try{this._hungup(e)}finally{this.onHungup&&t&&this.onHungup(t)}},_hungup:function(t){this.__assertCurrent();var o=this.current,n=o._cacheStreams[t];n&&!n.closeReason&&n.updateAttributes({closeReason:"UserHangup"});var r=n&&n.rtcId;if(r&&(o.closeWebrtc(r),n.located()&&(1!==n.type&&n._localMediaStream&&emedia.stopTracks(n._localMediaStream),n.remotePlayAudioObject&&document.body.removeChild(n.remotePlayAudioObject),o._cacheStreams[t]&&o.onRemoveStream(n),e.removeAttribute(o._cacheStreams,t),this._streamAutomators&&e.removeAttribute(this._streamAutomators,t))),n&&!n.located()){if(o._linkedStreams[n.id]&&e.removeAttribute(o._linkedStreams,n.id),i.warn("Hangeup remove from _linkedStreams. stream = ",n.id),!(n=o._cacheStreams[t]))return;n.updateAttributes({rtcId:void 0,_webrtc:void 0,mediaStream:void 0});var a=new d(n);o.onUpdateStream(a,new a.Update(a))}},postMessage:function(e,t,i,o){var n=t;"string"!=typeof t&&(t=JSON.stringify(t)),this.__assertCurrent();var a,s=this.current,c=s._linkedStreams[e];a=c&&c.owner?c.owner.id:e;t=s.newMessage({op:1003,memId:a,arg:t});s.postMessage(t,(i||o)&&function(e){if(o&&o(e,n),0!=e.result){var c=new r.RemoteControlFail({memId:a,failed:e.result,cause:e.msg,type:"postMessage",postMessage:t});return s.onEvent(c),void(i&&i(c,n))}})},torchRemote:function(e,t,o,n){"function"==typeof t&&(n=o,o=t,t=void 0),void 0!==t&&(t=t?1:0),this.__assertCurrent();var a=this.current,s=a._linkedStreams[e];if(!s||s.located())throw i.error("not exsits or locate, not connect",e),e+" not exsits or locate, not connect";var c=s.torch,d={op2:20,streamId:e,tor:t=void 0===t?s.torch?0:1:t},u=a.newMessage({op:1002,memId:s.owner.id,arg:JSON.stringify(d),_reqOps:[100206]});s.updateAttributes({torch:t}),a.postMessage(u,function(e){if(0!=e.result){var t=new r.RemoteControlFail({stream:s,failed:e.result,cause:e.msg,type:"torch_control"});return a.onEvent(t),s.updateAttributes({torch:c}),void(n&&n(t,s.torch))}o&&o(s.torch)})},freezeFrameRemote:function(e,t,o){this.__assertCurrent();var n=this.current,a=n._linkedStreams[e];if(!a||a.located())throw i.error("not exsits or locate, not connect",e),e+" not exsits or locate, not connect";var s=!a.freezeFrame,c={op2:20,streamId:e,frz:s?1:0},d=n.newMessage({op:1002,memId:a.owner.id,arg:JSON.stringify(c),_reqOps:[100204]});a.updateAttributes({freezeFrame:s}),n.postMessage(d,function(e){if(0!=e.result){var i=new r.RemoteControlFail({stream:a,failed:e.result,cause:e.msg,type:"freeze_control"});return n.onEvent(i),a.updateAttributes({freezeFrame:!a.freezeFrame}),void(o&&o(i,a.freezeFrame))}t&&t(a.freezeFrame)})},base64Img2Blob:function(e){for(var t=e.split(";base64,"),i=t[0].split(":")[1],o=window.atob(t[1]),n=o.length,r=new Uint8Array(n),a=0;a<n;++a)r[a]=o.charCodeAt(a);return new Blob([r],{type:i})},blob2URL:function(e){return URL.createObjectURL(e)},imagesPngContext2URL:function(e){return this.blob2URL(this.blob2URL(e))},downloadFile:function(e,t,i){var o=document.createElement("a");o.style.display="none";var n,r=t?this.base64Img2Blob(t):i;o.download=e,o.href=n=this.blob2URL(r),o.rel="noopener";var a=document.createEvent("HTMLEvents");a.initEvent("click",!1,!1),o.dispatchEvent(a),document.body.appendChild(o),o.click(),o.parentNode.removeChild(o),setTimeout(function(){URL.revokeObjectURL&&URL.revokeObjectURL(n)},4e4)},videoCaptureBase64Context2URL:function(e){return this.imagesPngContext2URL(this.getCaptureBase64Context(e))},getCaptureBase64Context:function(e){var t=document.createElement("canvas");t.id="__capture_video_"+(new Date).getTime();return t.width=e.videoWidth,t.height=e.videoHeight,t.getContext("2d").drawImage(e,0,0,t.width,t.height),t.toDataURL("images/png")},captureVideo:function(e,t,i){var o=this.getCaptureBase64Context(e);return t&&(i=i||"capture_"+(new Date).getTime(),this.downloadFile(i,o)),o},capturePictureRemote:function(e,t,o,n){this.__assertCurrent();var a=this.current,s=a._linkedStreams[e];if(!s||s.located())throw i.error("not exsits or locate, not connect",e),e+" not exsits or locate, not connect";var c={op2:20,streamId:e,pic:1,rspBase64Pic:!0===t},d=a.newMessage({op:1002,memId:s.owner.id,arg:JSON.stringify(c),_reqOps:[100205]});a.postMessage(d,function(e){if(0!=e.result){var i=new r.RemoteControlFail({stream:s,failed:e.result,cause:e.msg,type:"capture_control"});return a.onEvent(i),void(n&&n(i))}if(t)if(e.arg){var c=JSON.parse(e.arg);o&&o(c.pic)}else n&&n(new r.RemoteControlFail({stream:s,failed:e.result,cause:"Not found base64 pic"}));else o&&o()})},zoomRemote:function(e,t,o,n){this.__assertCurrent();var a=this.current,s=a._linkedStreams[e];if(!s||s.located())throw i.error("not exsits or locate, not connect",e),e+" not exsits or locate, not connect";s._zoom||s.updateAttributes({_zoom:1});var c=s._zoom*t;if(!(c<1)){s.updateAttributes({_zoom:c});var d={op2:20,streamId:e,zoom:Math.round(1e4*c)},u=a.newMessage({op:1002,memId:s.owner.id,arg:JSON.stringify(d),_reqOps:[100201]});a.postMessage(u,function(e){if(0!=e.result){var t=new r.RemoteControlFail({stream:s,failed:e.result,cause:e.msg,type:"zoom_control"});return a.onEvent(t),void(o&&o(t))}n&&n()})}},_getPosition:function(e){for(var t=0,i=0;e;)i+=e.offsetLeft,t+=e.offsetTop,e=e.offsetParent;return{clientX:i,clientY:t}},eventXYAtMedia:function(t,i){var o=e.getDomPageRect(i),n=o.width,r=o.height,a=i.videoWidth,s=i.videoHeight;if(s/a>r/n){var c=a/s;a=(s=r)*c}else{c=s/a;s=(a=n)*c}var d,u,f=t;if((d=e.isFloat(f.x))&&(f.x=f.x*n),(u=e.isFloat(f.y))&&(f.y=f.y*r),!(Math.abs(f.x)<(n-a)/2||n-Math.abs(f.x)<(n-a)/2||Math.abs(f.y)<(r-s)/2||r-Math.abs(f.y)<(r-s)/2))return f.x=f.x<0?Math.floor(f.x+(n-a)/2):Math.floor(f.x-(n-a)/2),f.y=f.y<0?Math.floor(f.y+(r-s)/2):Math.floor(f.y-(r-s)/2),d&&(f.x=f.x/a),u&&(f.y=f.y/s),{x:f.x,y:f.y,width:a,height:s}},eventXYAtVideo:function(t,i){var o,n,r=e.getDomPageRect(i),a=r.width,s=r.height,c=i.videoWidth,d=i.videoHeight;if(d/c>s/a){var u=c/d;c=(d=s)*u}else{u=d/c;d=(c=a)*u}return(o=e.isFloat(t.x))&&(t.x=t.x*c),(n=e.isFloat(t.y))&&(t.y=t.y*d),t.x=t.x<0?Math.floor(t.x-(a-c)/2):Math.floor(t.x+(a-c)/2),t.y=t.y<0?Math.floor(t.y-(s-d)/2):Math.floor(t.y+(s-d)/2),o&&(t.x=t.x/a),n&&(t.y=t.y/s),t},getClickXY:function(e,t){var o=t||window.event,n=document.documentElement.scrollLeft||document.body.scrollLeft,r=document.documentElement.scrollTop||document.body.scrollTop,a=o.pageX||o.clientX+n,s=o.pageY||o.clientY+r,c=this._getPosition(e);i.info("Video tag position ",c.clientX,":",c.clientY);var d=e.videoWidth,u=e.videoHeight;if(u/d>e.offsetHeight/e.offsetWidth){var f=d/u;d=(u=e.offsetHeight)*f,c.clientX+=(e.offsetWidth-d)/2}else{f=u/d;u=(d=e.offsetWidth)*f,c.clientY+=(e.offsetHeight-u)/2}return i.info("Media position ",c.clientX,":",c.clientY),i.info("Media xy ",d,":",u),i.info("Click position ",a,":",s),{mediaWidth:d,mediaHeight:u,x:a-c.clientX,y:s-c.clientY}},focusExpoRemote:function(e,t,o,n,r){var a=o||window.event,s=document.documentElement.scrollLeft||document.body.scrollLeft,c=document.documentElement.scrollTop||document.body.scrollTop,d=a.pageX||a.clientX+s,u=a.pageY||a.clientY+c,f=this._getPosition(t);i.info("Video tag position ",f.clientX,":",f.clientY);var m=t.videoWidth,l=t.videoHeight;if(l/m>t.offsetHeight/t.offsetWidth){var h=m/l;m=(l=t.offsetHeight)*h,f.clientX+=(t.offsetWidth-m)/2}else{h=l/m;l=(m=t.offsetWidth)*h,f.clientY+=(t.offsetHeight-l)/2}i.info("Media position ",f.clientX,":",f.clientY),i.info("Media xy ",m,":",l),i.info("Click position ",d,":",u),this._focusExpo(e,m,l,d-f.clientX,u-f.clientY,n,r)},_focusExpo:function(e,t,o,n,a,s,c){if(!(n<=0||n>t||a<=0||a>o)){this.__assertCurrent();var d=this.current,u=d._linkedStreams[e];if(!u||u.located())throw i.error("not exsits or locate, not connect",e),e+" not exsits or locate, not connect";var f={op2:20,streamId:e,focus:1,expo:1,x:0===t?0:Math.round(1e4*n/t),y:0===o?0:Math.round(1e4*a/o)},m=d.newMessage({op:1002,memId:u.owner.id,arg:JSON.stringify(f),_reqOps:[100202,100203]});d.postMessage(m,function(e){if(0!=e.result){var t=new r.RemoteControlFail({stream:u,failed:e.result,cause:e.msg,type:"focus_expo_control"});return d.onEvent(t),void(s&&s(t))}c&&c()})}},_republish:function(e,t,o){i.info("Republish stream. it = ",e.id);var n,r,a=this;if(e.id){var s=a.current.__getWebrtcFor(e.id);s&&a.current.closeWebrtc(s,!0),n=a.current._getWebrtc(e.id)}switch(e.type){case 0:emedia.stopTracks(e._localMediaStream),r=new a.AVPubstream(e);break;case 1:emedia.stopAndRemoveAudioTracks(e._localMediaStream),r=new a.ShareDesktopPubstream(e);break;case 2:emedia.stopTracks(e._localMediaStream),r=new a.AudioMixerPubstream(e)}setTimeout(function(){a.openUserMedia(r).then(function(){e.localStream=r.localStream,e.isRepublished=!0,e.optimalVideoCodecs=e.optimalVideoCodecs||n&&n.optimalVideoCodecs,a.push(e,t,o)},o)},100)},switchMobileCamera:function(t,o,n){if("string"==typeof t?t=this.current._cacheStreams[t]:t.id&&(t=this.current._cacheStreams[t.id]),t.voff)i.warn("Stream id = ",t.id," voff, do not chanage camera.");else{t.constaints||(t.constaints={});var r=e.extend({},t.constaints);t._lastConstaints=r,t.constaints.video="object"==typeof t.constaints.video?t.constaints.video:{},"user"!==t.constaints.video.facingMode&&t.constaints.video.facingMode?t.constaints.video.facingMode="user":t.constaints.video.facingMode={exact:"environment"},this._republish(t,function(e){n&&n(e)},function(e){e instanceof emedia.event.OpenMediaError&&(t.constaints=r),o&&o(e)})}},chanageCamera:function(t,o,n){var r=this;"string"==typeof t?t=r.current._cacheStreams[t]:t.id&&(t=r.current._cacheStreams[t.id]),t.voff?i.warn("Stream id = ",t.id," voff, do not chanage camera."):r.getMediaDevices("videoinput",function(a){if(a.length<=1)i.warn("Only video input. not chanage");else{var s=t._cameraIndex;if(null===t._cameraIndex||void 0===t._cameraIndex){var c=t.getLocalMediaStream(),d=(l=c&&c.getVideoTracks())&&l.length&&l[0];if(d&&d.getCapabilities&&"function"==typeof d.getCapabilities){var u=d.getCapabilities(),f=u&&u.deviceId;for(var m in a){if((p=a[m]).deviceId===f||p.label==d.label){s=parseInt(m);break}}}else for(var m in a){if((p=a[m]).label==d.label){s=parseInt(m);break}}}for(;s<a.length;){var l,h=a[s],p=a[s=(s+1)%a.length];if(!(l=t.getLocalMediaStream().getVideoTracks())||0===l.length||p.label!=l[0].label)break}var v=(p=a[s]).label;i.warn("Stream ",t.id,h.label,">>",v),t._cameraIndex=s,t.constaints||(t.constaints={});var g=e.extend({},t.constaints);t._lastConstaints=g,t.constaints.video="object"==typeof t.constaints.video?t.constaints.video:{},t.constaints.video.deviceId={exact:p.deviceId},r._republish(t,function(e){n&&n(e)},function(e){e instanceof emedia.event.OpenMediaError&&(t.constaints=g),o&&o(e)})}},o)},chanageConstraints:function(o,n,r,a){if("string"==typeof o?o=this.current._cacheStreams[o]:o.id&&(o=this.current._cacheStreams[o.id]),o){if(i.info("chanage pubstream constraints. it",o.id,n),t.isObject(n)&&!t.isEqual(o.constaints,n)){var s=o.constaints||{},c=o.voff,d=o.aoff;return o._lastConstaints=s,o.constaints=e.extend(!0,{},s,n),o.aoff=o.constaints.audio?0:1,o.voff=o.constaints.video?0:1,void this._republish(o,function(e){u(),a&&a(e)},function(e){e instanceof emedia.event.OpenMediaError&&(o.constaints=s,o.aoff=d,o.voff=c),r&&r(e)})}u(),a&&a(o.getMediaStream())}else i.warn("Not found pubS");function u(){var e=o.getMediaStream();emedia.enableVideoTracks(e,!o.voff),emedia.enableAudioTracks(e,!o.aoff)}},voff:function(e,t,o,n){var r=this;"string"==typeof e&&(e=r.current._cacheStreams[e]);var a=e.voff;function s(){t!=a?(emedia.enableVideoTracks(e.getMediaStream(),!t),r.current&&r.current.voff(e,t)):i.info("pubstream voff not chanage.")}if(t=t?1:0,e.voff=t,!t&&e.constaints&&!e.constaints.video){var c=e.constaints.video;return e.constaints.video=!0,void r._republish(e,function(e){s(),n&&n(e)},function(t){t instanceof emedia.event.OpenMediaError&&(e.constaints.video=c,e.voff=a),o&&o(t)})}s(),n&&n(e.getMediaStream())},aoff:function(e,t,o,n){var r=this;"string"==typeof e&&(e=r.current._cacheStreams[e]);var a=e.aoff;function s(){t!=a?(emedia.enableAudioTracks(e.getMediaStream(),!t),r.current&&r.current.aoff(e,t)):i.info("pubstream aoff not chanage.")}if(t=t?1:0,e.aoff=t,!t&&e.constaints&&!e.constaints.audio){var c=e.constaints.audio;return e.constaints.audio=!0,void r._republish(e,function(e){s(),n&&n(e)},function(t){t instanceof emedia.event.OpenMediaError&&(e.constaints.audio=c,e.aoff=a),o&&o(t)})}s(),n&&n(e.getMediaStream())},iceing:function(t){return e.isPlainObject(this.current._linkedStreams[t])},recording:function(t){return e.isPlainObject(this.current._records[t])},startRecord:function(e,t){var o=this.current._linkedStreams[e];if(!o)throw i.error("not at linked streams",e),e+" not at linked streams";o._webrtc||t&&t(!1),this.current.startRecord(o,t)},stopRecord:function(e,t){var o=this.current._records[e];if(!o)throw i.error("not at recording streams",e),e+" not at recording streams";this.current.stopRecord(o,t)},getCurrentMembers:function(){return this.current.getCurrentMembers()},_onCapturePicture:function(e){var t,o=e.arg.rspBase64Pic,n=e.arg.streamId,r=this.current._cacheStreams[n];if(o){var a;if("function"!=typeof this.getHTMLVideo||!(a=this.getHTMLVideo(n)))return void i.warn("Not support capture picture. caused by htmlVideo not found");t=this.getCaptureBase64Context(a)}else{if("function"!=typeof this.onCapturePicture)return void i.warn("Not support capture picture. caused by onCapturePicture not found");this.onCapturePicture(r)}var s=this.current.newMessage({op:1001,tsxId:e.tsxId,memId:e.memId,arg:JSON.stringify(t?{pic:t}:{}),result:0});return this.current.postMessage(s,function(e){i.warn("Send remote control onCapturePicture response. the result = ",e.result,e.msg||"")}),!0},newSession:function(t,n){var r=this;return new(r.Session||o)({ticket:n,owner:t,onTcklC:function(e){t.onTcklC(e.rtcId,e.cands)},onAcptC:function(e){t.onAcptC(e.rtcId,e.sdp,e.cands)},onAnsC:function(e){t.onAnsC(e.rtcId,e.sdp,e.cands)},onTermC:function(o){i.info("Server termc rtc: ",o.rtcId,o.message||o.msg),21===o.endReason||22===o.endReason?e.forEach(t._cacheStreams,function(e,i){var n;i.rtcId===o.rtcId&&(n=21===o.endReason?new emedia.event.SwitchVCodes({stream:i,useVCodes:o.useVCodes}):new emedia.event.SubFailNotSupportVCodes({stream:i}),t.onEvent(n))}):t.closeWebrtc(o.rtcId,!1,!0)},onEnter:function(e){t.onEnter(e.cver,e.mem)},onExit:function(e){t.onExit(e.cver,e.memId,e.reason||0)},onPub:function(e){t.onPub(e.cver,e.memId,e.pubS)},onUnpub:function(e){t.onUnpub(e.cver,e.memId,e.pubSId)},onMems:function(e){},onClose:function(e){t.onClose(e.cver,e.confrId)},onEvent:function(e){t.onEvent(e)},onStreamControl:function(e){t.onStreamControl(e.cver,e.streamId,e.voff,e.aoff,e.sver)},onRoleUpdate:function(e){t._onRoleUpdate(e.role,e.roleToken)},onRemoteControl:function(e){if("string"==typeof e.arg&&(e.arg=JSON.parse(e.arg)),20!==e.arg.op2||!e.arg.pic||!r._onCapturePicture.call(r,e)){if(30===e.arg.op2&&r._onRemotePannelControl)try{return void r._onRemotePannelControl.call(r,e)}catch(n){i.warn(n)}i.warn("Not support remote control");var o=t.newMessage({op:1001,tsxId:e.tsxId,memId:e.memId,arg:JSON.stringify(e.arg),result:e&&e.arg&&30===e.arg.op2?-405:-507,msg:"Not support the remote control."});t.postMessage(o,function(e){i.warn("Send remote control response. the result = ",e.result,e.msg||"")})}},onRecvRemoteMessage:function(e){t._onRecvRemoteMessage&&t._onRecvRemoteMessage(e.memId,e.arg,e)}})},_judgeTalking:function(e){return!!e&&e.instant>=emedia.config.judgeTalkingByInstantGE},graffitiVideo:function(e,t,i){var o=this.getStreamById(e),n=new MediaStream;n._located=!0,o._localMediaStream.getAudioTracks().forEach(function(e){n.addTrack(e)}),i.captureStream(25).getVideoTracks().forEach(function(e){n.addTrack(e)}),t.srcObject=n,o.updateAttributes({localStream:n,isRepublished:!0,optimalVideoCodecs:o.optimalVideoCodecs}),this.push(o)},resetCanvas:function(t){var o;if(arguments.length>1)for(var n=0;n<arguments.length;n++)"function"==typeof(o=arguments[n])&&o(t),"function"!=typeof o&&e.isPlainObject(o)&&e.forEach(o,function(e,o){i.debug("Canvas set ",e," = ",o),t.setAttribute(e,o)})},_random:function(e){return Math.floor(Math.random()*e)},requestFrame:function(e,t){var i,o=this;if("string"==typeof e)i=this.current._cacheStreams[e];else{if(!e.id)return;i=this.current._cacheStreams[e.id]}function n(){(i.requestFrame(),i.canvas)&&f.prototype.redraw.bind({_canvasContext:i.canvas.getContext("2d")})(3,3)}i&&(t?setTimeout(function(){n(),o.requestFrame(i,t)},t):n())},graffitiCanvas:function(t,i){e.targetDOM(t)&&(i=t,t=!1);var o=this,n=new o.ShareDesktopPubstream({voff:0,aoff:t?0:1});i||(i=document.createElement("canvas")),i.getContext("2d"),n.canvas=i;var r=function(){};return r.prototype.setCanvas=function(e){return this.canvasTag=i,o.resetCanvas(i,e),this},r.prototype.push=function(e,t){this._push(e,t)},r.prototype._push=function(e,r){"function"==typeof e&&(r=e,e=void 0),i.captureStream&&(i.captureStream.enabled=!0);var a=i.captureStream(e||25);function s(e){e.canvas=i,r&&r(e,i,a),t&&e.requestFrame()}function c(e,t){var i=new MediaStream;i._located=!0,e._localMediaStream&&e._localMediaStream.getAudioTracks().forEach(function(e){i.addTrack(e)}),a.getVideoTracks().forEach(function(e){i.addTrack(e)}),e._localMediaStream=i,e.localStream=i,o.push(e,t)}return t?o.__getUserMedia({audio:!0},function(e,t){n._localMediaStream=t,c(n,s)}):c(n,s),this},new r},blobRecorder:function(t,o,n,r){var a=this;e.targetDOM(t)&&(t=t.srcObject),o||(o={mimeType:"video/webm;codecs=vp9"}),MediaRecorder.isTypeSupported(o.mimeType)||(i.info(o.mimeType," is not Supported"),o={mimeType:"video/webm;codecs=vp8"},MediaRecorder.isTypeSupported(o.mimeType)||(i.info(o.mimeType," is not Supported"),o={mimeType:"video/webm"},MediaRecorder.isTypeSupported(o.mimeType)||(i.info(o.mimeType," is not Supported"),o={mimeType:""})));try{var s=new MediaRecorder(t,o)}catch(u){return void i.error("Exception while creating MediaRecorder: ",u)}var c=[];function d(){this.blobs=c}return s.onstop=r||function(e){i.info("Recorder stopped: ",e)},s.ondataavailable=n||function(e){e.data&&e.data.size>0&&c.push(e.data)},d.prototype.start=function(e){s.start(e)},d.prototype.stop=function(){s.stop()},d.prototype.playurl=function(e){var t=new Blob(this.blobs,e||{type:"video/webm"});return window.URL.createObjectURL(t)},d.prototype.download=function(e,t){var i=new Blob(this.blobs,t||{type:"video/webm"});a.downloadFile(e,void 0,i)},new d}});
},{"./Util":"Qsy+","underscore":"sd4Q","./Session":"VjWY","./Attendee":"yuX1","./event":"zP2G","./EventHandler":"1jqB","./_Desktop":"4PaW","./_Stream":"/mhd","./PCStats":"gqHj","../../../pannel/src/components/DefaultTrack":"yEWu"}],"4FmY":[function(require,module,exports) {
var e=require("./Util"),t=e.tagLogger("AddonsP2P"),r=require("./event"),s=function(r){var s=r.extend({postMessage:function(e,t){var s=this,o=e.tsxId;e.tsxId||(o=e.tsxId="MSG"+Date.now()+"-"+emedia.__session_globalCount++),r.prototype.postMessage.call(s,e,t),function(e){s.owner.isP2P()&&s._callbacks[e]&&setTimeout(function(){var t=s._callbacks[e];if(t&&1004===t.op){var r=s.newMessage({op:1001,tsxId:t.tsxId,memId:t.memId,result:0,msg:"3000ms not recv response. will success callback. "+t.tsxId});s.onMessage(r)}},3e3)}(o)},__modifyMessageForPost:function(t){var s=this;t=r.prototype.__modifyMessageForPost.call(s,t);var o=s.owner;if(o.isP2P()){if(102===t.op||105===t.op){var i=s.newMessage({op:1001,tsxId:t.tsxId,memId:t.memId,result:0,streamId:t.rtcId+(o.isCaller()?"__Caller":"__Callee"),sver:1});if(setTimeout(function(){s.onMessage(i)},100),!t._cached_){var a=e.extend({_cached_:!0},t);e.removeAttribute(a,"tsxId"),102===t.op&&(o.__cache_[t.rtcId]=[]).push(a),105===t.op&&o.__cache_[t.rtcId]&&o.__cache_[t.rtcId].push(a),o.__cache_[t.rtcId]&&(o.__cache_[t.rtcId].selfId=o.getMemberId())}}if(e.removeAttribute(t,"_cached_"),t.memId)t=s.newMessage({op:1004,sessId:e.removeAttribute(t,"sessId"),memId:e.removeAttribute(t,"memId"),tsxId:e.removeAttribute(t,"tsxId"),arg:JSON.stringify(t)});switch(t.op){case 205:i=s.newMessage({op:1001,tsxId:t.tsxId,result:0});return void setTimeout(function(){s.onMessage(i)},50);case 102:case 104:case 105:case 106:case 107:if(-10===t.endReason)return;case 1001:case 400:t=s.newMessage({op:1004,sessId:e.removeAttribute(t,"sessId"),tsxId:e.removeAttribute(t,"tsxId"),arg:JSON.stringify(t)});break;case 303:case 206:return}}return t},onP2PMessage:function(r){var s=this,o=s.owner;if(s.owner.isConfr())t.warn("Recv p2p ctrl message. when CONFR. ignore");else{var i=JSON.parse(r.arg);if(i.memId=r.memId,i.tsxId=r.tsxId,i.sessId=r.sessId,400===i.op&&(i.streamId=i.rtcId+(s.owner.isCaller()?"__Callee":"__Caller")),1001!==i.op){var a=s.newMessage({op:1001,tsxId:r.tsxId,memId:r.memId,sessId:r.sessId,result:0,msg:"Web sdk success recv"});102!==i.op&&105!==i.op||e.extend(a,{streamId:i.rtcId+(o.isCaller()?"__Callee":"__Caller"),sver:1}),s.postMessage(a)}!function(e){setTimeout(function(){s.onMessage(e)},10)}(i)}}});return e.extend(s.prototype._events,{1004:"onP2PMessage"}),s},o=function(s){return s.extend({__init__:function(){s.prototype.__init__.call(this),this.__cache_={};var e=this.iceRebuild;this.iceRebuild=function(r){this.isP2P()&&r.rtcId?r._webrtc&&!0===r._webrtc.answerWebrtc?t.warn("Stream not auto iceRebuild. caused by answer webrtc. it = ",r.id,r):r.located()?e.call(this,r):t.warn("Stream not auto iceRebuild. caused by not located. it = ",r.id,r):e.call(this,r)}},onEnter:function(t,r){var o=this;try{s.prototype.onEnter.call(o,t,r)}finally{if(!o.isP2P()||!(r=o._cacheMembers[r.id]))return;e.forEach(o.__cache_,function(t,s){!0!==s.answered&&e.forEach(s,function(e,t){!function(e){e.memId=r.id,o.postMessage(e)}(t)})})}},rejectAnswer:function(e,t,s,o){var i=this,a=i.newMessage().setOp(107).setRtcId(t).setMemId(e).setEndReason(s);i.postMessage(a,function(e){if(0!=e.result)return i.onEvent(new r.RspFail({request:a,response:e})),void(o&&o(new r.RspFail({request:a,response:e})))})},closeWebrtc:function(r,o,i){var a=this,c=!1;if(a.isP2P()){var n=a._ices[r];if(n)c=(c="failed"===n.iceConnectionState())&&n._rebuildCount<emedia.config.iceRebuildCount,t.warn("Webrtc state failed. it is ",r,n._rebuildCount,emedia.config.iceRebuildCount,n.__id)}if(s.prototype.closeWebrtc.call(a,r,o,i||c),a.isP2P()&&!i&&c&&e.forEach(a._cacheStreams,function(e,s){s.rtcId===r&&(a._linkedStreams[e]=s,t.warn("Reput stream to _linkedStreams",e))}),a.isP2P()&&!o){e.removeAttribute(a.__cache_,r);var d=e.extend({},a._cacheStreams);e.forEach(d,function(s,o){if(r===o.rtcId){e.removeAttribute(a._linkedStreams,o.id);var i=e.removeAttribute(a._cacheStreams,o.id);if(a._streamAutomators&&e.removeAttribute(a._streamAutomators,o.id),t.warn("P2P close webrtc. remove stream from _cacheStreams. it = ",o.id,o),i._localMediaStream&&a._service._stopTracks(i._localMediaStream),a.onRemoveStream){o=a.newStream(o);a.onRemoveStream(o)}}})}},subscribeStream:function(e,o,i,a){if(this.isP2P()){var c=this._ices[e],n=this._cacheStreams[o];if(n.updateAttributes({_webrtc:c,rtcId:e}),a=a||{subSVideo:!0,subSAudio:!0},n.updateAttributes({subArgs:n.subArgs||{subSVideo:!0,subSAudio:!0}}),n._webrtc&&n._webrtc.setSubArgs(n._webrtc.subArgs||{subSVideo:!0,subSAudio:!0}),!n.subArgs.subSVideo&&a.subSVideo&&n.voff)throw t.error("Sub not allow. stream voff"),"Sub not allow. stream voff";if(!n.subArgs.subSAudio&&a.subSAudio&&n.aoff)throw t.error("Sub not allow. stream aoff"),"Sub not allow. stream aoff";if(n.subArgs.subSVideo&&!a.subSVideo&&!n.voff&&emedia.isSafari)throw t.error("Sub not allow. safari close sub video. will error"),"Sub not allow. safari close sub video. will error";a&&n._webrtc&&n._webrtc.setSubArgs(a),a&&n.updateAttributes({subArgs:a});var d=new r.SubSuccess({stream:n,hidden:!0});this._updateRemoteStream(n,n._webrtc.getRemoteStream()),this.onEvent(d)}else s.prototype.subscribeStream.call(this,e,o,i,a)},unsubscribeStream:function(e){this.isP2P()||s.prototype.unsubscribeStream.call(this,e)},onPub:function(e,t,r){if(this.isP2P())return s.prototype.onPub.call(this,e,t,r);s.prototype.onPub.call(this,e,t,r)},onStreams:function(e,r){this.isP2P()?t.warn("P2P ingrone the onStreams"):s.prototype.onStreams.call(this,e,r)},_howDoWebrtcWhenCrtExsitsWebrtc:function(e){this.isP2P()?this.closeWebrtc(e.getRtcId(),!0,!0):s.prototype._howDoWebrtcWhenCrtExsitsWebrtc.call(this,e)},createWebrtcAndSubscribeStream:function(o,i,a,c){if((n=this).isP2P()){var n;i||(i={});var d=(n=this)._cacheStreams[o],u=n._cacheMembers[d.owner.id],l=d;c=c||l.subArgs||{subSVideo:!0,subSAudio:!0};var m=d.vcodes,_=u.vcodes,b=n.supportVCodes,f=n._getOptimalVideoCodecsSubset(m,_,b);c=c||l.subArgs;var I=l.subArgs,h=!(l.vcodes&&l.vcodes.length>0),p={offerToReceiveAudio:!0,offerToReceiveVideo:c.subSVideo&&h};p.offerToReceiveAudio||p.offerToReceiveVideo||t.warn("offerToReceiveAudio == false and offerToReceiveVideo == false");var v=n.createWebrtc({_rtcId:l.rtcId,iceServerConfig:a,optimalVideoCodecs:f,offerOptions:p,onGotMediaStream:function(e){var t=new r.SubSuccess({stream:l,hidden:!0});i.onGotRemote&&i.onGotRemote(l),n.onEvent&&n.onEvent(t)}},l.iceRebuildCount),S=v.getRtcId();t.warn(S," sub stream ",o,f);var w=l._webrtc;if(l.updateAttributes({_webrtc:v,rtcId:S,owner:e.extend({},u)}),n._ices[S]=v,v.answerWebrtc=!0,c&&l._webrtc&&l._webrtc.setSubArgs(c),c&&l.updateAttributes({subArgs:c}),S==="rtc-"+n.ticket.confrId){n.__lastCalleePub;var g=n._cacheStreams[S+(n.isCaller()?"__Caller":"__Callee")];g=new n._service.AVPubstream(g||{constaints:{audio:!l.aoff,video:!l.voff}});w&&w.getLocalStream()&&n._service._stopTracks(w.getLocalStream()),n._service.openUserMedia(g).then(function(){var e=n.newStream(g);e.updateAttributes({_localMediaStream:g.localStream,_webrtc:v,rtcId:v.getRtcId(),id:S+(n.isCaller()?"__Caller":"__Callee"),owner:{id:n.getMemberId(),nickName:n.nickName,name:n.sysUserId,ext:n.extObj}}),n.onEvent(new r.PushSuccess({stream:e,hidden:!0})),C(g.localStream),n.answerCall(S,g,A)},A)}else C(),n.answer(S,A)}else s.prototype.createWebrtcAndSubscribeStream.call(n,o,i,a,c);function A(e){t.warn("sub stream error",o,e),I&&l._webrtc&&l._webrtc.setSubArgs(I),I&&l.updateAttributes({subArgs:I}),e=new r.SubFail({stream:l,hidden:!0===e.hidden,cause:e}),i&&i.onEvent&&i.onEvent(e),n.onEvent&&n.onEvent(e)}function C(e){e&&v.setLocalStream(e),v.setRemoteDescription(l.sdp),l.cands&&l.cands.length>0&&v.addIceCandidate(l.cands)}}})},i=function(s,o,i){return s.extend({Session:o,Attendee:i,__init__:function(){s.prototype.__init__.call(this),void 0!==this.useRTCCfg&&!1!==this.useRTCCfg&&null!==this.useRTCCfg||(this.useRTCCfg=emedia.config.forceUseRTCCfgIfServerReturnWhenP2P)},push:function(e,r,o){if(this.current&&this.current.isP2P()){if(2===e.type)throw t.error("P2P do not allow audio_mixer"),"P2P do not allow audio_mixer";if(e instanceof this.AVPubstream&&!e.rtcId)this.current._cacheStreams["rtc-"+this.current.ticket.confrId+"__Caller"]||this.current._cacheStreams["rtc-"+this.current.ticket.confrId+"__Callee"]||(e.rtcId="rtc-"+this.current.ticket.confrId)}s.prototype.push.call(this,e,r,o)},newSession:function(o,i){var a=this,c=s.prototype.newSession.call(a,o,i),n=c.onTermC,d=c.onAnsC;return e.extend(c,{onInitC:function(t){if(o.isP2P()){if(t.rtcId==="rtc-"+o.ticket.confrId){var r=t.rtcId+(o.isCaller()?"__Callee":"__Caller");if((s=o._cacheStreams[r])&&s.owner&&s.owner.id!==t.memId)return o.rejectAnswer(t.memId,t.rtcId,10),void o.postMessage(o.newMessage({op:1001,memId:t.memId,tsxId:t.tsxId,result:-554,msg:"Other device call it. you no."}))}var s;t.pubS.sdp=t.sdp,t.pubS.cands=t.cands,t.pubS.id=t.rtcId+(o.isCaller()?"__Callee":"__Caller"),t.pubS._located=!1,t.pubS.memId=t.memId,t.pubS.rtcId=t.rtcId,t.pubS.sver=0,(s=o._cacheStreams[t.pubS.id])&&(t.pubS.sver=s.sver+1,e.removeAttribute(o._maybeNotExistStreams,t.pubS.id)),o.onPub.call(o,++o._cver,t.memId,t.pubS)}},onTermC:function(s){if(o.isP2P()){if(-20===s.endReason){var i=o._cacheStreams[s.rtcId+"__Caller"];return t.warn("Begin re-publish. 20",i),void(i&&a._republish(i))}if(s.memId&&s.memId!==o.getMemberId()){var c=[];return e.forEach(o._cacheStreams,function(e,t){c.push(t)}),c=c.sort(function(e,t){var r=-1;return e.id>t.id&&(r=1),o.isCallee()?0-r:r}),void e.forEach(c,function(e,t){t&&t.owner&&t.owner.id===s.memId&&s.rtcId===t.rtcId&&(-10!==s.endReason&&n.call(o,s),s.rtcId==="rtc-"+o.ticket.confrId&&o.onUnpub(++o._cver,s.memId,t.id),10===s.endReason&&o.onEvent(new r.OtherDeviceAnswer({rtcId:s.rtcId,stream:t}))),t&&t.owner&&t.owner.id===o.getMemberId()&&s.rtcId===t.rtcId&&(o.closeWebrtc(s.rtcId),o.onUnpub(++o._cver,t.owner.id,t.id))})}-10!==s.endReason&&n.call(o,s),10===s.endReason&&o.onEvent(new r.OtherDeviceAnswer({rtcId:s.rtcId}))}else n.call(o,s)},onAnsC:function(s){if(o.isP2P())if(o.__cache_[s.rtcId]){if(!0===o.__cache_[s.rtcId].answered)return t.warn("Webrtc ",s.rtcId,"had been ansC"),o.rejectAnswer(s.memId,s.rtcId,10),void o.postMessage(o.newMessage({op:1001,memId:s.memId,tsxId:s.tsxId,result:-554,msg:"Other device sub it. you no."}));try{if(s.pubS){var i=o.newStream(s.pubS);i.updateAttributes({_webrtc:o._ices[s.rtcId],rtcId:s.rtcId,id:s.rtcId+(o.isCaller()?"__Callee":"__Caller"),owner:o._cacheMembers[s.memId]}),o._cacheStreams[i.id]?o._cacheStreams[i.id]=i:o.onPub.call(o,++o._cver,s.memId,i),o.onEvent(new r.SubSuccess({stream:i,hidden:!0}))}var a=o._cacheMembers[s.memId];d.call(o,s),e.forEach(o._cacheMembers,function(e,t){e!==s.memId&&a.memName===t.memName&&o.rejectAnswer(e,s.rtcId,10)})}finally{o.__cache_[s.rtcId].answered=!0}}else t.warn("Webrtc ",s.rtcId,"not created. drop the answer");else d.call(o,s)}})}})};module.exports=function(e){var t=e.prototype.Session||require("./Session"),r=s(t.extend({})),a=e.prototype.Attendee||require("./Attendee"),c=o(a.extend({}));return i(e,r,c)};
},{"./Util":"Qsy+","./event":"zP2G","./Session":"VjWY","./Attendee":"yuX1"}],"qxUW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__extends=e,exports.__rest=n,exports.__decorate=o,exports.__param=a,exports.__metadata=u,exports.__awaiter=i,exports.__generator=c,exports.__exportStar=f,exports.__values=l,exports.__read=s,exports.__spread=p,exports.__spreadArrays=y,exports.__await=_,exports.__asyncGenerator=h,exports.__asyncDelegator=v,exports.__asyncValues=b,exports.__makeTemplateObject=d,exports.__importStar=x,exports.__importDefault=w,exports.__assign=void 0;var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};function e(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return exports.__assign=r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function o(t,e,r,n){var o,a=arguments.length,u=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,r,n);else for(var i=t.length-1;i>=0;i--)(o=t[i])&&(u=(a<3?o(u):a>3?o(e,r,u):o(e,r))||u);return a>3&&u&&Object.defineProperty(e,r,u),u}function a(t,e){return function(r,n){e(r,n,t)}}function u(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function i(t,e,r,n){return new(r||(r=Promise))(function(o,a){function u(t){try{c(n.next(t))}catch(e){a(e)}}function i(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(u,i)}c((n=n.apply(t,e||[])).next())})}function c(t,e){var r,n,o,a,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return u.label++,{value:a[1],done:!1};case 5:u.label++,n=a[1],a=[0];continue;case 7:a=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){u=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){u.label=a[1];break}if(6===a[0]&&u.label<o[1]){u.label=o[1],o=a;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(a);break}o[2]&&u.ops.pop(),u.trys.pop();continue}a=e.call(t,u)}catch(i){a=[6,i],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}}function f(t,e){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}function l(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)u.push(n.value)}catch(i){o={error:i}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return u}function p(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}function y(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var a=arguments[e],u=0,i=a.length;u<i;u++,o++)n[o]=a[u];return n}function _(t){return this instanceof _?(this.v=t,this):new _(t)}function h(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),a=[];return n={},u("next"),u("throw"),u("return"),n[Symbol.asyncIterator]=function(){return this},n;function u(t){o[t]&&(n[t]=function(e){return new Promise(function(r,n){a.push([t,e,r,n])>1||i(t,e)})})}function i(t,e){try{(r=o[t](e)).value instanceof _?Promise.resolve(r.value.v).then(c,f):l(a[0][2],r)}catch(n){l(a[0][3],n)}var r}function c(t){i("next",t)}function f(t){i("throw",t)}function l(t,e){t(e),a.shift(),a.length&&i(a[0][0],a[0][1])}}function v(t){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:_(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof l?l(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,o){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,o,(e=t[r](e)).done,e.value)})}}}function d(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function x(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function w(t){return t&&t.__esModule?t:{default:t}}exports.__assign=r;
},{}],"s5lC":[function(require,module,exports) {
"use strict";function e(e){return"function"==typeof e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isFunction=e;
},{}],"EXLc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.config=void 0;var e=!1,r={Promise:void 0,set useDeprecatedSynchronousErrorHandling(r){r&&(new Error).stack;e=r},get useDeprecatedSynchronousErrorHandling(){return e}};exports.config=r;
},{}],"aCfY":[function(require,module,exports) {
"use strict";function e(e){setTimeout(function(){throw e},0)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.hostReportError=e;
},{}],"V7Y4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.empty=void 0;var e=require("./config"),r=require("./util/hostReportError"),o={closed:!0,next:function(e){},error:function(o){if(e.config.useDeprecatedSynchronousErrorHandling)throw o;(0,r.hostReportError)(o)},complete:function(){}};exports.empty=o;
},{"./config":"EXLc","./util/hostReportError":"aCfY"}],"aAcO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isArray=void 0;var r=function(){return Array.isArray||function(r){return r&&"number"==typeof r.length}}();exports.isArray=r;
},{}],"nw2+":[function(require,module,exports) {
"use strict";function e(e){return null!==e&&"object"==typeof e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isObject=e;
},{}],"tFzU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UnsubscriptionError=void 0;var r=function(){function r(r){return Error.call(this),this.message=r?r.length+" errors occurred during unsubscription:\n"+r.map(function(r,t){return t+1+") "+r.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=r,this}return r.prototype=Object.create(Error.prototype),r}(),t=r;exports.UnsubscriptionError=t;
},{}],"ab35":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Subscription=void 0;var r=require("./util/isArray"),i=require("./util/isObject"),s=require("./util/isFunction"),t=require("./util/UnsubscriptionError"),n=function(){function n(r){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,r&&(this._unsubscribe=r)}var o;return n.prototype.unsubscribe=function(){var o;if(!this.closed){var u=this._parentOrParents,c=this._unsubscribe,a=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,u instanceof n)u.remove(this);else if(null!==u)for(var f=0;f<u.length;++f){u[f].remove(this)}if((0,s.isFunction)(c))try{c.call(this)}catch(h){o=h instanceof t.UnsubscriptionError?e(h.errors):[h]}if((0,r.isArray)(a)){f=-1;for(var p=a.length;++f<p;){var l=a[f];if((0,i.isObject)(l))try{l.unsubscribe()}catch(h){o=o||[],h instanceof t.UnsubscriptionError?o=o.concat(e(h.errors)):o.push(h)}}}if(o)throw new t.UnsubscriptionError(o)}},n.prototype.add=function(r){var i=r;if(!r)return n.EMPTY;switch(typeof r){case"function":i=new n(r);case"object":if(i===this||i.closed||"function"!=typeof i.unsubscribe)return i;if(this.closed)return i.unsubscribe(),i;if(!(i instanceof n)){var s=i;(i=new n)._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+r+" added to Subscription.")}var t=i._parentOrParents;if(null===t)i._parentOrParents=this;else if(t instanceof n){if(t===this)return i;i._parentOrParents=[t,this]}else{if(-1!==t.indexOf(this))return i;t.push(this)}var e=this._subscriptions;return null===e?this._subscriptions=[i]:e.push(i),i},n.prototype.remove=function(r){var i=this._subscriptions;if(i){var s=i.indexOf(r);-1!==s&&i.splice(s,1)}},n.EMPTY=((o=new n).closed=!0,o),n}();function e(r){return r.reduce(function(r,i){return r.concat(i instanceof t.UnsubscriptionError?i.errors:i)},[])}exports.Subscription=n;
},{"./util/isArray":"aAcO","./util/isObject":"nw2+","./util/isFunction":"s5lC","./util/UnsubscriptionError":"tFzU"}],"SjPv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.$$rxSubscriber=exports.rxSubscriber=void 0;var r=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}();exports.rxSubscriber=r;var e=r;exports.$$rxSubscriber=e;
},{}],"+Es2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SafeSubscriber=exports.Subscriber=void 0;var r=c(require("tslib")),t=require("./util/isFunction"),e=require("./Observer"),n=require("./Subscription"),s=require("../internal/symbol/rxSubscriber"),i=require("./config"),o=require("./util/hostReportError");function c(r){if(r&&r.__esModule)return r;var t={};if(null!=r)for(var e in r)if(Object.prototype.hasOwnProperty.call(r,e)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,e):{};n.get||n.set?Object.defineProperty(t,e,n):t[e]=r[e]}return t.default=r,t}var u=function(t){function n(r,s,i){var o=t.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=e.empty;break;case 1:if(!r){o.destination=e.empty;break}if("object"==typeof r){r instanceof n?(o.syncErrorThrowable=r.syncErrorThrowable,o.destination=r,r.add(o)):(o.syncErrorThrowable=!0,o.destination=new p(o,r));break}default:o.syncErrorThrowable=!0,o.destination=new p(o,r,s,i)}return o}return r.__extends(n,t),n.prototype[s.rxSubscriber]=function(){return this},n.create=function(r,t,e){var s=new n(r,t,e);return s.syncErrorThrowable=!1,s},n.prototype.next=function(r){this.isStopped||this._next(r)},n.prototype.error=function(r){this.isStopped||(this.isStopped=!0,this._error(r))},n.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},n.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},n.prototype._next=function(r){this.destination.next(r)},n.prototype._error=function(r){this.destination.error(r),this.unsubscribe()},n.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},n.prototype._unsubscribeAndRecycle=function(){var r=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=r,this},n}(n.Subscription);exports.Subscriber=u;var p=function(n){function s(r,s,i,o){var c,u=n.call(this)||this;u._parentSubscriber=r;var p=u;return(0,t.isFunction)(s)?c=s:s&&(c=s.next,i=s.error,o=s.complete,s!==e.empty&&(p=Object.create(s),(0,t.isFunction)(p.unsubscribe)&&u.add(p.unsubscribe.bind(p)),p.unsubscribe=u.unsubscribe.bind(u))),u._context=p,u._next=c,u._error=i,u._complete=o,u}return r.__extends(s,n),s.prototype.next=function(r){if(!this.isStopped&&this._next){var t=this._parentSubscriber;i.config.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,r)&&this.unsubscribe():this.__tryOrUnsub(this._next,r)}},s.prototype.error=function(r){if(!this.isStopped){var t=this._parentSubscriber,e=i.config.useDeprecatedSynchronousErrorHandling;if(this._error)e&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,r),this.unsubscribe()):(this.__tryOrUnsub(this._error,r),this.unsubscribe());else if(t.syncErrorThrowable)e?(t.syncErrorValue=r,t.syncErrorThrown=!0):(0,o.hostReportError)(r),this.unsubscribe();else{if(this.unsubscribe(),e)throw r;(0,o.hostReportError)(r)}}},s.prototype.complete=function(){var r=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var e=function(){return r._complete.call(r._context)};i.config.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}},s.prototype.__tryOrUnsub=function(r,t){try{r.call(this._context,t)}catch(e){if(this.unsubscribe(),i.config.useDeprecatedSynchronousErrorHandling)throw e;(0,o.hostReportError)(e)}},s.prototype.__tryOrSetError=function(r,t,e){if(!i.config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,e)}catch(n){return i.config.useDeprecatedSynchronousErrorHandling?(r.syncErrorValue=n,r.syncErrorThrown=!0,!0):((0,o.hostReportError)(n),!0)}return!1},s.prototype._unsubscribe=function(){var r=this._parentSubscriber;this._context=null,this._parentSubscriber=null,r.unsubscribe()},s}(u);exports.SafeSubscriber=p;
},{"tslib":"qxUW","./util/isFunction":"s5lC","./Observer":"V7Y4","./Subscription":"ab35","../internal/symbol/rxSubscriber":"SjPv","./config":"EXLc","./util/hostReportError":"aCfY"}],"f6R0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.canReportError=e;var r=require("../Subscriber");function e(e){for(;e;){var t=e,o=t.closed,i=t.destination,n=t.isStopped;if(o||n)return!1;e=i&&i instanceof r.Subscriber?i:null}return!0}
},{"../Subscriber":"+Es2"}],"dZZ1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.toSubscriber=i;var r=require("../Subscriber"),e=require("../symbol/rxSubscriber"),b=require("../Observer");function i(i,u,s){if(i){if(i instanceof r.Subscriber)return i;if(i[e.rxSubscriber])return i[e.rxSubscriber]()}return i||u||s?new r.Subscriber(i,u,s):new r.Subscriber(b.empty)}
},{"../Subscriber":"+Es2","../symbol/rxSubscriber":"SjPv","../Observer":"V7Y4"}],"154F":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.observable=void 0;var e=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();exports.observable=e;
},{}],"WRNt":[function(require,module,exports) {
"use strict";function e(){}Object.defineProperty(exports,"__esModule",{value:!0}),exports.noop=e;
},{}],"8Vx0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pipe=r,exports.pipeFromArray=n;var e=require("./noop");function r(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return n(e)}function n(r){return r?1===r.length?r[0]:function(e){return r.reduce(function(e,r){return r(e)},e)}:e.noop}
},{"./noop":"WRNt"}],"+1Kv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Observable=void 0;var r=require("./util/canReportError"),e=require("./util/toSubscriber"),o=require("./symbol/observable"),t=require("./util/pipe"),n=require("./config"),i=function(){function i(r){this._isScalar=!1,r&&(this._subscribe=r)}return i.prototype.lift=function(r){var e=new i;return e.source=this,e.operator=r,e},i.prototype.subscribe=function(r,o,t){var i=this.operator,s=(0,e.toSubscriber)(r,o,t);if(i?s.add(i.call(s,this.source)):s.add(this.source||n.config.useDeprecatedSynchronousErrorHandling&&!s.syncErrorThrowable?this._subscribe(s):this._trySubscribe(s)),n.config.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable&&(s.syncErrorThrowable=!1,s.syncErrorThrown))throw s.syncErrorValue;return s},i.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(o){n.config.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=o),(0,r.canReportError)(e)?e.error(o):console.warn(o)}},i.prototype.forEach=function(r,e){var o=this;return new(e=s(e))(function(e,t){var n;n=o.subscribe(function(e){try{r(e)}catch(o){t(o),n&&n.unsubscribe()}},t,e)})},i.prototype._subscribe=function(r){var e=this.source;return e&&e.subscribe(r)},i.prototype[o.observable]=function(){return this},i.prototype.pipe=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return 0===r.length?this:(0,t.pipeFromArray)(r)(this)},i.prototype.toPromise=function(r){var e=this;return new(r=s(r))(function(r,o){var t;e.subscribe(function(r){return t=r},function(r){return o(r)},function(){return r(t)})})},i.create=function(r){return new i(r)},i}();function s(r){if(r||(r=n.config.Promise||Promise),!r)throw new Error("no Promise impl found");return r}exports.Observable=i;
},{"./util/canReportError":"f6R0","./util/toSubscriber":"dZZ1","./symbol/observable":"154F","./util/pipe":"8Vx0","./config":"EXLc"}],"1U3B":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ObjectUnsubscribedError=void 0;var r=function(){function r(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return r.prototype=Object.create(Error.prototype),r}(),e=r;exports.ObjectUnsubscribedError=e;
},{}],"WUX+":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SubjectSubscription=void 0;var e=r(require("tslib")),t=require("./Subscription");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}var i=function(t){function r(e,r){var i=t.call(this)||this;return i.subject=e,i.subscriber=r,i.closed=!1,i}return e.__extends(r,t),r.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var r=t.indexOf(this.subscriber);-1!==r&&t.splice(r,1)}}},r}(t.Subscription);exports.SubjectSubscription=i;
},{"tslib":"qxUW","./Subscription":"ab35"}],"Drrb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AnonymousSubject=exports.Subject=exports.SubjectSubscriber=void 0;var r=c(require("tslib")),e=require("./Observable"),t=require("./Subscriber"),o=require("./Subscription"),s=require("./util/ObjectUnsubscribedError"),i=require("./SubjectSubscription"),n=require("../internal/symbol/rxSubscriber");function c(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)if(Object.prototype.hasOwnProperty.call(r,t)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,t):{};o.get||o.set?Object.defineProperty(e,t,o):e[t]=r[t]}return e.default=r,e}var u=function(e){function t(r){var t=e.call(this,r)||this;return t.destination=r,t}return r.__extends(t,e),t}(t.Subscriber);exports.SubjectSubscriber=u;var b=function(t){function c(){var r=t.call(this)||this;return r.observers=[],r.closed=!1,r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return r.__extends(c,t),c.prototype[n.rxSubscriber]=function(){return new u(this)},c.prototype.lift=function(r){var e=new p(this,this);return e.operator=r,e},c.prototype.next=function(r){if(this.closed)throw new s.ObjectUnsubscribedError;if(!this.isStopped)for(var e=this.observers,t=e.length,o=e.slice(),i=0;i<t;i++)o[i].next(r)},c.prototype.error=function(r){if(this.closed)throw new s.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=r,this.isStopped=!0;for(var e=this.observers,t=e.length,o=e.slice(),i=0;i<t;i++)o[i].error(r);this.observers.length=0},c.prototype.complete=function(){if(this.closed)throw new s.ObjectUnsubscribedError;this.isStopped=!0;for(var r=this.observers,e=r.length,t=r.slice(),o=0;o<e;o++)t[o].complete();this.observers.length=0},c.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},c.prototype._trySubscribe=function(r){if(this.closed)throw new s.ObjectUnsubscribedError;return t.prototype._trySubscribe.call(this,r)},c.prototype._subscribe=function(r){if(this.closed)throw new s.ObjectUnsubscribedError;return this.hasError?(r.error(this.thrownError),o.Subscription.EMPTY):this.isStopped?(r.complete(),o.Subscription.EMPTY):(this.observers.push(r),new i.SubjectSubscription(this,r))},c.prototype.asObservable=function(){var r=new e.Observable;return r.source=this,r},c.create=function(r,e){return new p(r,e)},c}(e.Observable);exports.Subject=b;var p=function(e){function t(r,t){var o=e.call(this)||this;return o.destination=r,o.source=t,o}return r.__extends(t,e),t.prototype.next=function(r){var e=this.destination;e&&e.next&&e.next(r)},t.prototype.error=function(r){var e=this.destination;e&&e.error&&this.destination.error(r)},t.prototype.complete=function(){var r=this.destination;r&&r.complete&&this.destination.complete()},t.prototype._subscribe=function(r){return this.source?this.source.subscribe(r):o.Subscription.EMPTY},t}(b);exports.AnonymousSubject=p;
},{"tslib":"qxUW","./Observable":"+1Kv","./Subscriber":"+Es2","./Subscription":"ab35","./util/ObjectUnsubscribedError":"1U3B","./SubjectSubscription":"WUX+","../internal/symbol/rxSubscriber":"SjPv"}],"Ux37":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.refCount=r;var e=t(require("tslib")),n=require("../Subscriber");function t(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};r.get||r.set?Object.defineProperty(n,t,r):n[t]=e[t]}return n.default=e,n}function r(){return function(e){return e.lift(new c(e))}}var c=function(){function e(e){this.connectable=e}return e.prototype.call=function(e,n){var t=this.connectable;t._refCount++;var r=new o(e,t),c=n.subscribe(r);return r.closed||(r.connection=t.connect()),c},e}(),o=function(n){function t(e,t){var r=n.call(this,e)||this;return r.connectable=t,r}return e.__extends(t,n),t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var n=e._refCount;if(n<=0)this.connection=null;else if(e._refCount=n-1,n>1)this.connection=null;else{var t=this.connection,r=e._connection;this.connection=null,!r||t&&r!==t||r.unsubscribe()}}else this.connection=null},t}(n.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"Jnv2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.connectableObservableDescriptor=exports.ConnectableObservable=void 0;var e=i(require("tslib")),t=require("../Subject"),n=require("../Observable"),r=require("../Subscriber"),o=require("../Subscription"),c=require("../operators/refCount");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}var u=function(t){function n(e,n){var r=t.call(this)||this;return r.source=e,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return e.__extends(n,t),n.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},n.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},n.prototype.connect=function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new o.Subscription).add(this.source.subscribe(new l(this.getSubject(),this))),e.closed&&(this._connection=null,e=o.Subscription.EMPTY)),e},n.prototype.refCount=function(){return(0,c.refCount)()(this)},n}(n.Observable);exports.ConnectableObservable=u;var s=function(){var e=u.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:e._subscribe},_isComplete:{value:e._isComplete,writable:!0},getSubject:{value:e.getSubject},connect:{value:e.connect},refCount:{value:e.refCount}}}();exports.connectableObservableDescriptor=s;var l=function(t){function n(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return e.__extends(n,t),n.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},n.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},n.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}},n}(t.SubjectSubscriber),b=function(){function e(e){this.connectable=e}return e.prototype.call=function(e,t){var n=this.connectable;n._refCount++;var r=new a(e,n),o=t.subscribe(r);return r.closed||(r.connection=n.connect()),o},e}(),a=function(t){function n(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return e.__extends(n,t),n.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},n}(r.Subscriber);
},{"tslib":"qxUW","../Subject":"Drrb","../Observable":"+1Kv","../Subscriber":"+Es2","../Subscription":"ab35","../operators/refCount":"Ux37"}],"zY6H":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.groupBy=s,exports.GroupedObservable=void 0;var e=n(require("tslib")),t=require("../Subscriber"),r=require("../Subscription"),o=require("../Observable"),i=require("../Subject");function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};o.get||o.set?Object.defineProperty(t,r,o):t[r]=e[r]}return t.default=e,t}function s(e,t,r,o){return function(i){return i.lift(new u(e,t,r,o))}}var u=function(){function e(e,t,r,o){this.keySelector=e,this.elementSelector=t,this.durationSelector=r,this.subjectSelector=o}return e.prototype.call=function(e,t){return t.subscribe(new c(e,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},e}(),c=function(t){function r(e,r,o,i,n){var s=t.call(this,e)||this;return s.keySelector=r,s.elementSelector=o,s.durationSelector=i,s.subjectSelector=n,s.groups=null,s.attemptedToUnsubscribe=!1,s.count=0,s}return e.__extends(r,t),r.prototype._next=function(e){var t;try{t=this.keySelector(e)}catch(r){return void this.error(r)}this._group(e,t)},r.prototype._group=function(e,t){var r=this.groups;r||(r=this.groups=new Map);var o,n=r.get(t);if(this.elementSelector)try{o=this.elementSelector(e)}catch(c){this.error(c)}else o=e;if(!n){n=this.subjectSelector?this.subjectSelector():new i.Subject,r.set(t,n);var s=new l(t,n,this);if(this.destination.next(s),this.durationSelector){var u=void 0;try{u=this.durationSelector(new l(t,n))}catch(c){return void this.error(c)}this.add(u.subscribe(new p(t,n,this)))}}n.closed||n.next(o)},r.prototype._error=function(e){var t=this.groups;t&&(t.forEach(function(t,r){t.error(e)}),t.clear()),this.destination.error(e)},r.prototype._complete=function(){var e=this.groups;e&&(e.forEach(function(e,t){e.complete()}),e.clear()),this.destination.complete()},r.prototype.removeGroup=function(e){this.groups.delete(e)},r.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&t.prototype.unsubscribe.call(this))},r}(t.Subscriber),p=function(t){function r(e,r,o){var i=t.call(this,r)||this;return i.key=e,i.group=r,i.parent=o,i}return e.__extends(r,t),r.prototype._next=function(e){this.complete()},r.prototype._unsubscribe=function(){var e=this.parent,t=this.key;this.key=this.parent=null,e&&e.removeGroup(t)},r}(t.Subscriber),l=function(t){function o(e,r,o){var i=t.call(this)||this;return i.key=e,i.groupSubject=r,i.refCountSubscription=o,i}return e.__extends(o,t),o.prototype._subscribe=function(e){var t=new r.Subscription,o=this.refCountSubscription,i=this.groupSubject;return o&&!o.closed&&t.add(new a(o)),t.add(i.subscribe(e)),t},o}(o.Observable);exports.GroupedObservable=l;var a=function(t){function r(e){var r=t.call(this)||this;return r.parent=e,e.count++,r}return e.__extends(r,t),r.prototype.unsubscribe=function(){var e=this.parent;e.closed||this.closed||(t.prototype.unsubscribe.call(this),e.count-=1,0===e.count&&e.attemptedToUnsubscribe&&e.unsubscribe())},r}(r.Subscription);
},{"tslib":"qxUW","../Subscriber":"+Es2","../Subscription":"ab35","../Observable":"+1Kv","../Subject":"Drrb"}],"is7q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BehaviorSubject=void 0;var e=o(require("tslib")),t=require("./Subject"),r=require("./util/ObjectUnsubscribedError");function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};o.get||o.set?Object.defineProperty(t,r,o):t[r]=e[r]}return t.default=e,t}var i=function(t){function o(e){var r=t.call(this)||this;return r._value=e,r}return e.__extends(o,t),Object.defineProperty(o.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),o.prototype._subscribe=function(e){var r=t.prototype._subscribe.call(this,e);return r&&!r.closed&&e.next(this._value),r},o.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new r.ObjectUnsubscribedError;return this._value},o.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},o}(t.Subject);exports.BehaviorSubject=i;
},{"tslib":"qxUW","./Subject":"Drrb","./util/ObjectUnsubscribedError":"1U3B"}],"eM7R":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Action=void 0;var e=r(require("tslib")),t=require("../Subscription");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}var i=function(t){function r(e,r){return t.call(this)||this}return e.__extends(r,t),r.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},r}(t.Subscription);exports.Action=i;
},{"tslib":"qxUW","../Subscription":"ab35"}],"rgkq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AsyncAction=void 0;var t=i(require("tslib")),e=require("./Action");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};r.get||r.set?Object.defineProperty(e,i,r):e[i]=t[i]}return e.default=t,e}var r=function(e){function i(t,i){var r=e.call(this,t,i)||this;return r.scheduler=t,r.work=i,r.pending=!1,r}return t.__extends(i,e),i.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this},i.prototype.requestAsyncId=function(t,e,i){return void 0===i&&(i=0),setInterval(t.flush.bind(t,this),i)},i.prototype.recycleAsyncId=function(t,e,i){if(void 0===i&&(i=0),null!==i&&this.delay===i&&!1===this.pending)return e;clearInterval(e)},i.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},i.prototype._execute=function(t,e){var i=!1,r=void 0;try{this.work(t)}catch(n){i=!0,r=!!n&&n||new Error(n)}if(i)return this.unsubscribe(),r},i.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,i=e.actions,r=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&i.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},i}(e.Action);exports.AsyncAction=r;
},{"tslib":"qxUW","./Action":"eM7R"}],"29+R":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QueueAction=void 0;var e=r(require("tslib")),t=require("./AsyncAction");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};o.get||o.set?Object.defineProperty(t,r,o):t[r]=e[r]}return t.default=e,t}var o=function(t){function r(e,r){var o=t.call(this,e,r)||this;return o.scheduler=e,o.work=r,o}return e.__extends(r,t),r.prototype.schedule=function(e,r){return void 0===r&&(r=0),r>0?t.prototype.schedule.call(this,e,r):(this.delay=r,this.state=e,this.scheduler.flush(this),this)},r.prototype.execute=function(e,r){return r>0||this.closed?t.prototype.execute.call(this,e,r):this._execute(e,r)},r.prototype.requestAsyncId=function(e,r,o){return void 0===o&&(o=0),null!==o&&o>0||null===o&&this.delay>0?t.prototype.requestAsyncId.call(this,e,r,o):e.flush(this)},r}(t.AsyncAction);exports.QueueAction=o;
},{"tslib":"qxUW","./AsyncAction":"rgkq"}],"h2eM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Scheduler=void 0;var e=function(){function e(t,o){void 0===o&&(o=e.now),this.SchedulerAction=t,this.now=o}return e.prototype.schedule=function(e,t,o){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(o,t)},e.now=function(){return Date.now()},e}();exports.Scheduler=e;
},{}],"cFS1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AsyncScheduler=void 0;var e=r(require("tslib")),t=require("../Scheduler");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}var i=function(r){function i(e,o){void 0===o&&(o=t.Scheduler.now);var c=r.call(this,e,function(){return i.delegate&&i.delegate!==c?i.delegate.now():o()})||this;return c.actions=[],c.active=!1,c.scheduled=void 0,c}return e.__extends(i,r),i.prototype.schedule=function(e,t,o){return void 0===t&&(t=0),i.delegate&&i.delegate!==this?i.delegate.schedule(e,t,o):r.prototype.schedule.call(this,e,t,o)},i.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var r;this.active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}},i}(t.Scheduler);exports.AsyncScheduler=i;
},{"tslib":"qxUW","../Scheduler":"h2eM"}],"GpA6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.QueueScheduler=void 0;var e=t(require("tslib")),r=require("./AsyncScheduler");function t(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var u=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};u.get||u.set?Object.defineProperty(r,t,u):r[t]=e[t]}return r.default=e,r}var u=function(r){function t(){return null!==r&&r.apply(this,arguments)||this}return e.__extends(t,r),t}(r.AsyncScheduler);exports.QueueScheduler=u;
},{"tslib":"qxUW","./AsyncScheduler":"cFS1"}],"6w2Y":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.queue=void 0;var e=require("./QueueAction"),u=require("./QueueScheduler"),r=new u.QueueScheduler(e.QueueAction);exports.queue=r;
},{"./QueueAction":"29+R","./QueueScheduler":"GpA6"}],"I8Qo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.empty=t,exports.EMPTY=void 0;var e=require("../Observable"),r=new e.Observable(function(e){return e.complete()});function t(e){return e?n(e):r}function n(r){return new e.Observable(function(e){return r.schedule(function(){return e.complete()})})}exports.EMPTY=r;
},{"../Observable":"+1Kv"}],"RN4p":[function(require,module,exports) {
"use strict";function e(e){return e&&"function"==typeof e.schedule}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isScheduler=e;
},{}],"83yL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.subscribeToArray=void 0;var e=function(e){return function(r){for(var o=0,t=e.length;o<t&&!r.closed;o++)r.next(e[o]);r.complete()}};exports.subscribeToArray=e;
},{}],"TNk6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.scheduleArray=t;var e=require("../Observable"),r=require("../Subscription");function t(t,n){return new e.Observable(function(e){var u=new r.Subscription,s=0;return u.add(n.schedule(function(){s!==t.length?(e.next(t[s++]),e.closed||u.add(this.schedule())):e.complete()})),u})}
},{"../Observable":"+1Kv","../Subscription":"ab35"}],"E5BW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromArray=u;var e=require("../Observable"),r=require("../util/subscribeToArray"),s=require("../scheduled/scheduleArray");function u(u,a){return a?(0,s.scheduleArray)(u,a):new e.Observable((0,r.subscribeToArray)(u))}
},{"../Observable":"+1Kv","../util/subscribeToArray":"83yL","../scheduled/scheduleArray":"TNk6"}],"N4eK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.of=t;var e=require("../util/isScheduler"),r=require("./fromArray"),u=require("../scheduled/scheduleArray");function t(){for(var t=[],l=0;l<arguments.length;l++)t[l]=arguments[l];var o=t[t.length-1];return(0,e.isScheduler)(o)?(t.pop(),(0,u.scheduleArray)(t,o)):(0,r.fromArray)(t)}
},{"../util/isScheduler":"RN4p","./fromArray":"E5BW","../scheduled/scheduleArray":"TNk6"}],"nAit":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.throwError=e;var r=require("../Observable");function e(e,o){return o?new r.Observable(function(r){return o.schedule(n,0,{error:e,subscriber:r})}):new r.Observable(function(r){return r.error(e)})}function n(r){var e=r.error;r.subscriber.error(e)}
},{"../Observable":"+1Kv"}],"io6T":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Notification=exports.NotificationKind=void 0;var e,t=require("./observable/empty"),r=require("./observable/of"),o=require("./observable/throwError");exports.NotificationKind=e,function(e){e.NEXT="N",e.ERROR="E",e.COMPLETE="C"}(e||(exports.NotificationKind=e={}));var i=function(){function e(e,t,r){this.kind=e,this.value=t,this.error=r,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,r){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return r&&r()}},e.prototype.accept=function(e,t,r){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,r)},e.prototype.toObservable=function(){switch(this.kind){case"N":return(0,r.of)(this.value);case"E":return(0,o.throwError)(this.error);case"C":return(0,t.empty)()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}();exports.Notification=i;
},{"./observable/empty":"I8Qo","./observable/of":"N4eK","./observable/throwError":"nAit"}],"U6my":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.observeOn=s,exports.ObserveOnMessage=exports.ObserveOnSubscriber=exports.ObserveOnOperator=void 0;var e=i(require("tslib")),t=require("../Subscriber"),r=require("../Notification");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}function s(e,t){return void 0===t&&(t=0),function(r){return r.lift(new n(e,t))}}var n=function(){function e(e,t){void 0===t&&(t=0),this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return t.subscribe(new o(e,this.scheduler,this.delay))},e}();exports.ObserveOnOperator=n;var o=function(t){function i(e,r,i){void 0===i&&(i=0);var s=t.call(this,e)||this;return s.scheduler=r,s.delay=i,s}return e.__extends(i,t),i.dispatch=function(e){var t=e.notification,r=e.destination;t.observe(r),this.unsubscribe()},i.prototype.scheduleMessage=function(e){this.destination.add(this.scheduler.schedule(i.dispatch,this.delay,new c(e,this.destination)))},i.prototype._next=function(e){this.scheduleMessage(r.Notification.createNext(e))},i.prototype._error=function(e){this.scheduleMessage(r.Notification.createError(e)),this.unsubscribe()},i.prototype._complete=function(){this.scheduleMessage(r.Notification.createComplete()),this.unsubscribe()},i}(t.Subscriber);exports.ObserveOnSubscriber=o;var c=function(){return function(e,t){this.notification=e,this.destination=t}}();exports.ObserveOnMessage=c;
},{"tslib":"qxUW","../Subscriber":"+Es2","../Notification":"io6T"}],"H1hQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReplaySubject=void 0;var e=u(require("tslib")),t=require("./Subject"),r=require("./scheduler/queue"),i=require("./Subscription"),n=require("./operators/observeOn"),s=require("./util/ObjectUnsubscribedError"),o=require("./SubjectSubscription");function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}var c=function(t){function u(e,r,i){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===r&&(r=Number.POSITIVE_INFINITY);var n=t.call(this)||this;return n.scheduler=i,n._events=[],n._infiniteTimeWindow=!1,n._bufferSize=e<1?1:e,n._windowTime=r<1?1:r,r===Number.POSITIVE_INFINITY?(n._infiniteTimeWindow=!0,n.next=n.nextInfiniteTimeWindow):n.next=n.nextTimeWindow,n}return e.__extends(u,t),u.prototype.nextInfiniteTimeWindow=function(e){var r=this._events;r.push(e),r.length>this._bufferSize&&r.shift(),t.prototype.next.call(this,e)},u.prototype.nextTimeWindow=function(e){this._events.push(new h(this._getNow(),e)),this._trimBufferThenGetEvents(),t.prototype.next.call(this,e)},u.prototype._subscribe=function(e){var t,r=this._infiniteTimeWindow,u=r?this._events:this._trimBufferThenGetEvents(),c=this.scheduler,h=u.length;if(this.closed)throw new s.ObjectUnsubscribedError;if(this.isStopped||this.hasError?t=i.Subscription.EMPTY:(this.observers.push(e),t=new o.SubjectSubscription(this,e)),c&&e.add(e=new n.ObserveOnSubscriber(e,c)),r)for(var p=0;p<h&&!e.closed;p++)e.next(u[p]);else for(p=0;p<h&&!e.closed;p++)e.next(u[p].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t},u.prototype._getNow=function(){return(this.scheduler||r.queue).now()},u.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,r=this._windowTime,i=this._events,n=i.length,s=0;s<n&&!(e-i[s].time<r);)s++;return n>t&&(s=Math.max(s,n-t)),s>0&&i.splice(0,s),i},u}(t.Subject);exports.ReplaySubject=c;var h=function(){return function(e,t){this.time=e,this.value=t}}();
},{"tslib":"qxUW","./Subject":"Drrb","./scheduler/queue":"6w2Y","./Subscription":"ab35","./operators/observeOn":"U6my","./util/ObjectUnsubscribedError":"1U3B","./SubjectSubscription":"WUX+"}],"0X8v":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AsyncSubject=void 0;var t=o(require("tslib")),e=require("./Subject"),r=require("./Subscription");function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};o.get||o.set?Object.defineProperty(e,r,o):e[r]=t[r]}return e.default=t,e}var s=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=null,t.hasNext=!1,t.hasCompleted=!1,t}return t.__extends(o,e),o.prototype._subscribe=function(t){return this.hasError?(t.error(this.thrownError),r.Subscription.EMPTY):this.hasCompleted&&this.hasNext?(t.next(this.value),t.complete(),r.Subscription.EMPTY):e.prototype._subscribe.call(this,t)},o.prototype.next=function(t){this.hasCompleted||(this.value=t,this.hasNext=!0)},o.prototype.error=function(t){this.hasCompleted||e.prototype.error.call(this,t)},o.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&e.prototype.next.call(this,this.value),e.prototype.complete.call(this)},o}(e.Subject);exports.AsyncSubject=s;
},{"tslib":"qxUW","./Subject":"Drrb","./Subscription":"ab35"}],"e1sm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Immediate=void 0;var e=1,t={};function r(e){var r=t[e];r&&r()}var i={setImmediate:function(i){var n=e++;return t[n]=i,Promise.resolve().then(function(){return r(n)}),n},clearImmediate:function(e){delete t[e]}};exports.Immediate=i;
},{}],"Eaqr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AsapAction=void 0;var e=i(require("tslib")),t=require("../util/Immediate"),r=require("./AsyncAction");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}var n=function(r){function i(e,t){var i=r.call(this,e,t)||this;return i.scheduler=e,i.work=t,i}return e.__extends(i,r),i.prototype.requestAsyncId=function(e,i,n){return void 0===n&&(n=0),null!==n&&n>0?r.prototype.requestAsyncId.call(this,e,i,n):(e.actions.push(this),e.scheduled||(e.scheduled=t.Immediate.setImmediate(e.flush.bind(e,null))))},i.prototype.recycleAsyncId=function(e,i,n){if(void 0===n&&(n=0),null!==n&&n>0||null===n&&this.delay>0)return r.prototype.recycleAsyncId.call(this,e,i,n);0===e.actions.length&&(t.Immediate.clearImmediate(i),e.scheduled=void 0)},i}(r.AsyncAction);exports.AsapAction=n;
},{"tslib":"qxUW","../util/Immediate":"e1sm","./AsyncAction":"rgkq"}],"Z/dW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AsapScheduler=void 0;var e=r(require("tslib")),t=require("./AsyncScheduler");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}var i=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(r,t),r.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,r=this.actions,i=-1,s=r.length;e=e||r.shift();do{if(t=e.execute(e.state,e.delay))break}while(++i<s&&(e=r.shift()));if(this.active=!1,t){for(;++i<s&&(e=r.shift());)e.unsubscribe();throw t}},r}(t.AsyncScheduler);exports.AsapScheduler=i;
},{"tslib":"qxUW","./AsyncScheduler":"cFS1"}],"TfHP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.asap=void 0;var e=require("./AsapAction"),r=require("./AsapScheduler"),s=new r.AsapScheduler(e.AsapAction);exports.asap=s;
},{"./AsapAction":"Eaqr","./AsapScheduler":"Z/dW"}],"yL84":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.async=void 0;var e=require("./AsyncAction"),r=require("./AsyncScheduler"),c=new r.AsyncScheduler(e.AsyncAction);exports.async=c;
},{"./AsyncAction":"rgkq","./AsyncScheduler":"cFS1"}],"L0g3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AnimationFrameAction=void 0;var e=r(require("tslib")),t=require("./AsyncAction");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}var n=function(t){function r(e,r){var n=t.call(this,e,r)||this;return n.scheduler=e,n.work=r,n}return e.__extends(r,t),r.prototype.requestAsyncId=function(e,r,n){return void 0===n&&(n=0),null!==n&&n>0?t.prototype.requestAsyncId.call(this,e,r,n):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame(function(){return e.flush(null)})))},r.prototype.recycleAsyncId=function(e,r,n){if(void 0===n&&(n=0),null!==n&&n>0||null===n&&this.delay>0)return t.prototype.recycleAsyncId.call(this,e,r,n);0===e.actions.length&&(cancelAnimationFrame(r),e.scheduled=void 0)},r}(t.AsyncAction);exports.AnimationFrameAction=n;
},{"tslib":"qxUW","./AsyncAction":"rgkq"}],"80zM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AnimationFrameScheduler=void 0;var e=r(require("tslib")),t=require("./AsyncScheduler");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}var i=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(r,t),r.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,r=this.actions,i=-1,n=r.length;e=e||r.shift();do{if(t=e.execute(e.state,e.delay))break}while(++i<n&&(e=r.shift()));if(this.active=!1,t){for(;++i<n&&(e=r.shift());)e.unsubscribe();throw t}},r}(t.AsyncScheduler);exports.AnimationFrameScheduler=i;
},{"tslib":"qxUW","./AsyncScheduler":"cFS1"}],"697z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.animationFrame=void 0;var e=require("./AnimationFrameAction"),i=require("./AnimationFrameScheduler"),r=new i.AnimationFrameScheduler(e.AnimationFrameAction);exports.animationFrame=r;
},{"./AnimationFrameAction":"L0g3","./AnimationFrameScheduler":"80zM"}],"gP1m":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VirtualAction=exports.VirtualTimeScheduler=void 0;var e=i(require("tslib")),t=require("./AsyncAction"),r=require("./AsyncScheduler");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}var n=function(t){function r(e,r){void 0===e&&(e=o),void 0===r&&(r=Number.POSITIVE_INFINITY);var i=t.call(this,e,function(){return i.frame})||this;return i.maxFrames=r,i.frame=0,i.index=-1,i}return e.__extends(r,t),r.prototype.flush=function(){for(var e,t,r=this.actions,i=this.maxFrames;(t=r[0])&&t.delay<=i&&(r.shift(),this.frame=t.delay,!(e=t.execute(t.state,t.delay))););if(e){for(;t=r.shift();)t.unsubscribe();throw e}},r.frameTimeFactor=10,r}(r.AsyncScheduler);exports.VirtualTimeScheduler=n;var o=function(t){function r(e,r,i){void 0===i&&(i=e.index+=1);var n=t.call(this,e,r)||this;return n.scheduler=e,n.work=r,n.index=i,n.active=!0,n.index=e.index=i,n}return e.__extends(r,t),r.prototype.schedule=function(e,i){if(void 0===i&&(i=0),!this.id)return t.prototype.schedule.call(this,e,i);this.active=!1;var n=new r(this.scheduler,this.work);return this.add(n),n.schedule(e,i)},r.prototype.requestAsyncId=function(e,t,i){void 0===i&&(i=0),this.delay=e.frame+i;var n=e.actions;return n.push(this),n.sort(r.sortActions),!0},r.prototype.recycleAsyncId=function(e,t,r){void 0===r&&(r=0)},r.prototype._execute=function(e,r){if(!0===this.active)return t.prototype._execute.call(this,e,r)},r.sortActions=function(e,t){return e.delay===t.delay?e.index===t.index?0:e.index>t.index?1:-1:e.delay>t.delay?1:-1},r}(t.AsyncAction);exports.VirtualAction=o;
},{"tslib":"qxUW","./AsyncAction":"rgkq","./AsyncScheduler":"cFS1"}],"UYfx":[function(require,module,exports) {
"use strict";function e(e){return e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.identity=e;
},{}],"vOpz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isObservable=r;var e=require("../Observable");function r(r){return!!r&&(r instanceof e.Observable||"function"==typeof r.lift&&"function"==typeof r.subscribe)}
},{"../Observable":"+1Kv"}],"ubev":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ArgumentOutOfRangeError=void 0;var r=function(){function r(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return r.prototype=Object.create(Error.prototype),r}(),e=r;exports.ArgumentOutOfRangeError=e;
},{}],"6ZXy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EmptyError=void 0;var r=function(){function r(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return r.prototype=Object.create(Error.prototype),r}(),e=r;exports.EmptyError=e;
},{}],"vaeu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TimeoutError=void 0;var r=function(){function r(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return r.prototype=Object.create(Error.prototype),r}(),e=r;exports.TimeoutError=e;
},{}],"krfZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.map=n,exports.MapOperator=void 0;var t=e(require("tslib")),r=require("../Subscriber");function e(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,e):{};n.get||n.set?Object.defineProperty(r,e,n):r[e]=t[e]}return r.default=t,r}function n(t,r){return function(e){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return e.lift(new o(t,r))}}var o=function(){function t(t,r){this.project=t,this.thisArg=r}return t.prototype.call=function(t,r){return r.subscribe(new i(t,this.project,this.thisArg))},t}();exports.MapOperator=o;var i=function(r){function e(t,e,n){var o=r.call(this,t)||this;return o.project=e,o.count=0,o.thisArg=n||o,o}return t.__extends(e,r),e.prototype._next=function(t){var r;try{r=this.project.call(this.thisArg,t,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(r)},e}(r.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"8fE/":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bindCallback=a;var r=require("../Observable"),e=require("../AsyncSubject"),t=require("../operators/map"),c=require("../util/canReportError"),n=require("../util/isArray"),u=require("../util/isScheduler");function a(s,o,l){if(o){if(!(0,u.isScheduler)(o))return function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return a(s,l).apply(void 0,r).pipe((0,t.map)(function(r){return(0,n.isArray)(r)?o.apply(void 0,r):o(r)}))};l=o}return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var u,a=this,o={context:a,subject:u,callbackFunc:s,scheduler:l};return new r.Observable(function(r){if(l){var n={args:t,subscriber:r,params:o};return l.schedule(i,0,n)}if(!u){u=new e.AsyncSubject;try{s.apply(a,t.concat([function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];u.next(r.length<=1?r[0]:r),u.complete()}]))}catch(b){(0,c.canReportError)(u)?u.error(b):console.warn(b)}}return u.subscribe(r)})}}function i(r){var t=this,c=r.args,n=r.subscriber,u=r.params,a=u.callbackFunc,i=u.context,o=u.scheduler,l=u.subject;if(!l){l=u.subject=new e.AsyncSubject;try{a.apply(i,c.concat([function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var c=r.length<=1?r[0]:r;t.add(o.schedule(s,0,{value:c,subject:l}))}]))}catch(b){l.error(b)}}this.add(l.subscribe(n))}function s(r){var e=r.value,t=r.subject;t.next(e),t.complete()}function o(r){var e=r.err;r.subject.error(e)}
},{"../Observable":"+1Kv","../AsyncSubject":"0X8v","../operators/map":"krfZ","../util/canReportError":"f6R0","../util/isArray":"aAcO","../util/isScheduler":"RN4p"}],"gDRA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bindNodeCallback=s;var e=require("../Observable"),r=require("../AsyncSubject"),t=require("../operators/map"),c=require("../util/canReportError"),u=require("../util/isScheduler"),n=require("../util/isArray");function s(i,o,l){if(o){if(!(0,u.isScheduler)(o))return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return s(i,l).apply(void 0,e).pipe((0,t.map)(function(e){return(0,n.isArray)(e)?o.apply(void 0,e):o(e)}))};l=o}return function(){for(var t=[],u=0;u<arguments.length;u++)t[u]=arguments[u];var n={subject:void 0,args:t,callbackFunc:i,scheduler:l,context:this};return new e.Observable(function(e){var u=n.context,s=n.subject;if(l)return l.schedule(a,0,{params:n,subscriber:e,context:u});if(!s){s=n.subject=new r.AsyncSubject;try{i.apply(u,t.concat([function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=e.shift();t?s.error(t):(s.next(e.length<=1?e[0]:e),s.complete())}]))}catch(o){(0,c.canReportError)(s)?s.error(o):console.warn(o)}}return s.subscribe(e)})}}function a(e){var t=this,c=e.params,u=e.subscriber,n=e.context,s=c.callbackFunc,a=c.args,l=c.scheduler,b=c.subject;if(!b){b=c.subject=new r.AsyncSubject;try{s.apply(n,a.concat([function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var c=e.shift();if(c)t.add(l.schedule(o,0,{err:c,subject:b}));else{var u=e.length<=1?e[0]:e;t.add(l.schedule(i,0,{value:u,subject:b}))}}]))}catch(d){this.add(l.schedule(o,0,{err:d,subject:b}))}}this.add(b.subscribe(u))}function i(e){var r=e.value,t=e.subject;t.next(r),t.complete()}function o(e){var r=e.err;e.subject.error(r)}
},{"../Observable":"+1Kv","../AsyncSubject":"0X8v","../operators/map":"krfZ","../util/canReportError":"f6R0","../util/isScheduler":"RN4p","../util/isArray":"aAcO"}],"VHfM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OuterSubscriber=void 0;var e=r(require("tslib")),t=require("./Subscriber");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};o.get||o.set?Object.defineProperty(t,r,o):t[r]=e[r]}return t.default=e,t}var o=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(r,t),r.prototype.notifyNext=function(e,t,r,o,i){this.destination.next(t)},r.prototype.notifyError=function(e,t){this.destination.error(e)},r.prototype.notifyComplete=function(e){this.destination.complete()},r}(t.Subscriber);exports.OuterSubscriber=o;
},{"tslib":"qxUW","./Subscriber":"+Es2"}],"wrBi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InnerSubscriber=void 0;var e=r(require("tslib")),t=require("./Subscriber");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}var i=function(t){function r(e,r,i){var n=t.call(this)||this;return n.parent=e,n.outerValue=r,n.outerIndex=i,n.index=0,n}return e.__extends(r,t),r.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},r.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},r.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},r}(t.Subscriber);exports.InnerSubscriber=i;
},{"tslib":"qxUW","./Subscriber":"+Es2"}],"NbzE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.subscribeToPromise=void 0;var r=require("./hostReportError"),e=function(e){return function(o){return e.then(function(r){o.closed||(o.next(r),o.complete())},function(r){return o.error(r)}).then(null,r.hostReportError),o}};exports.subscribeToPromise=e;
},{"./hostReportError":"aCfY"}],"WuiM":[function(require,module,exports) {
"use strict";function t(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getSymbolIterator=t,exports.$$iterator=exports.iterator=void 0;var r=t();exports.iterator=r;var e=r;exports.$$iterator=e;
},{}],"kyW5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.subscribeToIterable=void 0;var e=require("../symbol/iterator"),r=function(r){return function(t){for(var o=r[e.iterator]();;){var n=o.next();if(n.done){t.complete();break}if(t.next(n.value),t.closed)break}return"function"==typeof o.return&&t.add(function(){o.return&&o.return()}),t}};exports.subscribeToIterable=r;
},{"../symbol/iterator":"WuiM"}],"aQMb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.subscribeToObservable=void 0;var e=require("../symbol/observable"),r=function(r){return function(o){var b=r[e.observable]();if("function"!=typeof b.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return b.subscribe(o)}};exports.subscribeToObservable=r;
},{"../symbol/observable":"154F"}],"NV6R":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isArrayLike=void 0;var e=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};exports.isArrayLike=e;
},{}],"/IHN":[function(require,module,exports) {
"use strict";function e(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isPromise=e;
},{}],"LOmD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.subscribeTo=void 0;var e=require("./subscribeToArray"),r=require("./subscribeToPromise"),i=require("./subscribeToIterable"),s=require("./subscribeToObservable"),o=require("./isArrayLike"),b=require("./isPromise"),u=require("./isObject"),t=require("../symbol/iterator"),a=require("../symbol/observable"),c=function(c){if(c&&"function"==typeof c[a.observable])return(0,s.subscribeToObservable)(c);if((0,o.isArrayLike)(c))return(0,e.subscribeToArray)(c);if((0,b.isPromise)(c))return(0,r.subscribeToPromise)(c);if(c&&"function"==typeof c[t.iterator])return(0,i.subscribeToIterable)(c);var n=(0,u.isObject)(c)?"an invalid object":"'"+c+"'";throw new TypeError("You provided "+n+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};exports.subscribeTo=c;
},{"./subscribeToArray":"83yL","./subscribeToPromise":"NbzE","./subscribeToIterable":"kyW5","./subscribeToObservable":"aQMb","./isArrayLike":"NV6R","./isPromise":"/IHN","./isObject":"nw2+","../symbol/iterator":"WuiM","../symbol/observable":"154F"}],"kr3X":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.subscribeToResult=b;var e=require("../InnerSubscriber"),r=require("./subscribeTo"),s=require("../Observable");function b(b,i,u,c,n){if(void 0===n&&(n=new e.InnerSubscriber(b,u,c)),!n.closed)return i instanceof s.Observable?i.subscribe(n):(0,r.subscribeTo)(i)(n)}
},{"../InnerSubscriber":"wrBi","./subscribeTo":"LOmD","../Observable":"+1Kv"}],"Ccxw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.combineLatest=l,exports.CombineLatestSubscriber=exports.CombineLatestOperator=void 0;var t=n(require("tslib")),e=require("../util/isScheduler"),r=require("../util/isArray"),i=require("../OuterSubscriber"),o=require("../util/subscribeToResult"),s=require("./fromArray");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}var u={};function l(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var o=null,n=null;return(0,e.isScheduler)(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(o=t.pop()),1===t.length&&(0,r.isArray)(t[0])&&(t=t[0]),(0,s.fromArray)(t,n).lift(new c(o))}var c=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.resultSelector))},t}();exports.CombineLatestOperator=c;var a=function(e){function r(t,r){var i=e.call(this,t)||this;return i.resultSelector=r,i.active=0,i.values=[],i.observables=[],i}return t.__extends(r,e),r.prototype._next=function(t){this.values.push(u),this.observables.push(t)},r.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var r=0;r<e;r++){var i=t[r];this.add((0,o.subscribeToResult)(this,i,i,r))}}},r.prototype.notifyComplete=function(t){0==(this.active-=1)&&this.destination.complete()},r.prototype.notifyNext=function(t,e,r,i,o){var s=this.values,n=s[r],l=this.toRespond?n===u?--this.toRespond:this.toRespond:0;s[r]=e,0===l&&(this.resultSelector?this._tryResultSelector(s):this.destination.next(s.slice()))},r.prototype._tryResultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(r){return void this.destination.error(r)}this.destination.next(e)},r}(i.OuterSubscriber);exports.CombineLatestSubscriber=a;
},{"tslib":"qxUW","../util/isScheduler":"RN4p","../util/isArray":"aAcO","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X","./fromArray":"E5BW"}],"G1Uf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.scheduleObservable=u;var e=require("../Observable"),r=require("../Subscription"),n=require("../symbol/observable");function u(u,t){return new e.Observable(function(e){var o=new r.Subscription;return o.add(t.schedule(function(){var r=u[n.observable]();o.add(r.subscribe({next:function(r){o.add(t.schedule(function(){return e.next(r)}))},error:function(r){o.add(t.schedule(function(){return e.error(r)}))},complete:function(){o.add(t.schedule(function(){return e.complete()}))}}))})),o})}
},{"../Observable":"+1Kv","../Subscription":"ab35","../symbol/observable":"154F"}],"5LXL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.schedulePromise=n;var e=require("../Observable"),r=require("../Subscription");function n(n,u){return new e.Observable(function(e){var t=new r.Subscription;return t.add(u.schedule(function(){return n.then(function(r){t.add(u.schedule(function(){e.next(r),t.add(u.schedule(function(){return e.complete()}))}))},function(r){t.add(u.schedule(function(){return e.error(r)}))})})),t})}
},{"../Observable":"+1Kv","../Subscription":"ab35"}],"dBQ0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.scheduleIterable=n;var e=require("../Observable"),r=require("../Subscription"),t=require("../symbol/iterator");function n(n,u){if(!n)throw new Error("Iterable cannot be null");return new e.Observable(function(e){var o,i=new r.Subscription;return i.add(function(){o&&"function"==typeof o.return&&o.return()}),i.add(u.schedule(function(){o=n[t.iterator](),i.add(u.schedule(function(){if(!e.closed){var r,t;try{var n=o.next();r=n.value,t=n.done}catch(u){return void e.error(u)}t?e.complete():(e.next(r),this.schedule())}}))})),i})}
},{"../Observable":"+1Kv","../Subscription":"ab35","../symbol/iterator":"WuiM"}],"g2zc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isInteropObservable=r;var e=require("../symbol/observable");function r(r){return r&&"function"==typeof r[e.observable]}
},{"../symbol/observable":"154F"}],"0kx1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isIterable=r;var e=require("../symbol/iterator");function r(r){return r&&"function"==typeof r[e.iterator]}
},{"../symbol/iterator":"WuiM"}],"z8Tn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.scheduled=a;var e=require("./scheduleObservable"),r=require("./schedulePromise"),i=require("./scheduleArray"),s=require("./scheduleIterable"),u=require("../util/isInteropObservable"),l=require("../util/isPromise"),t=require("../util/isArrayLike"),o=require("../util/isIterable");function a(a,b){if(null!=a){if((0,u.isInteropObservable)(a))return(0,e.scheduleObservable)(a,b);if((0,l.isPromise)(a))return(0,r.schedulePromise)(a,b);if((0,t.isArrayLike)(a))return(0,i.scheduleArray)(a,b);if((0,o.isIterable)(a)||"string"==typeof a)return(0,s.scheduleIterable)(a,b)}throw new TypeError((null!==a&&typeof a||a)+" is not observable")}
},{"./scheduleObservable":"G1Uf","./schedulePromise":"5LXL","./scheduleArray":"TNk6","./scheduleIterable":"dBQ0","../util/isInteropObservable":"g2zc","../util/isPromise":"/IHN","../util/isArrayLike":"NV6R","../util/isIterable":"0kx1"}],"udX+":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.from=u;var e=require("../Observable"),r=require("../util/subscribeTo"),s=require("../scheduled/scheduled");function u(u,b){return b?(0,s.scheduled)(u,b):u instanceof e.Observable?u:new e.Observable((0,r.subscribeTo)(u))}
},{"../Observable":"+1Kv","../util/subscribeTo":"LOmD","../scheduled/scheduled":"z8Tn"}],"bWJj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.mergeMap=u,exports.MergeMapSubscriber=exports.MergeMapOperator=void 0;var e=s(require("tslib")),t=require("../util/subscribeToResult"),r=require("../OuterSubscriber"),i=require("../InnerSubscriber"),n=require("./map"),o=require("../observable/from");function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}function u(e,t,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"function"==typeof t?function(i){return i.pipe(u(function(r,i){return(0,o.from)(e(r,i)).pipe((0,n.map)(function(e,n){return t(r,e,i,n)}))},r))}:("number"==typeof t&&(r=t),function(t){return t.lift(new c(e,r))})}var c=function(){function e(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=t}return e.prototype.call=function(e,t){return t.subscribe(new p(e,this.project,this.concurrent))},e}();exports.MergeMapOperator=c;var p=function(r){function n(e,t,i){void 0===i&&(i=Number.POSITIVE_INFINITY);var n=r.call(this,e)||this;return n.project=t,n.concurrent=i,n.hasCompleted=!1,n.buffer=[],n.active=0,n.index=0,n}return e.__extends(n,r),n.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},n.prototype._tryNext=function(e){var t,r=this.index++;try{t=this.project(e,r)}catch(i){return void this.destination.error(i)}this.active++,this._innerSub(t,e,r)},n.prototype._innerSub=function(e,r,n){var o=new i.InnerSubscriber(this,void 0,void 0);this.destination.add(o),(0,t.subscribeToResult)(this,e,r,n,o)},n.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},n.prototype.notifyNext=function(e,t,r,i,n){this.destination.next(t)},n.prototype.notifyComplete=function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},n}(r.OuterSubscriber);exports.MergeMapSubscriber=p;
},{"tslib":"qxUW","../util/subscribeToResult":"kr3X","../OuterSubscriber":"VHfM","../InnerSubscriber":"wrBi","./map":"krfZ","../observable/from":"udX+"}],"khf/":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.mergeAll=t;var e=require("./mergeMap"),r=require("../util/identity");function t(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),(0,e.mergeMap)(r.identity,t)}
},{"./mergeMap":"bWJj","../util/identity":"UYfx"}],"r2ff":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.concatAll=r;var e=require("./mergeAll");function r(){return(0,e.mergeAll)(1)}
},{"./mergeAll":"khf/"}],"o1KK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.concat=o;var e=require("./of"),r=require("../operators/concatAll");function o(){for(var o=[],t=0;t<arguments.length;t++)o[t]=arguments[t];return(0,r.concatAll)()(e.of.apply(void 0,o))}
},{"./of":"N4eK","../operators/concatAll":"r2ff"}],"F/q0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defer=u;var e=require("../Observable"),r=require("./from"),t=require("./empty");function u(u){return new e.Observable(function(e){var o;try{o=u()}catch(i){return void e.error(i)}return(o?(0,r.from)(o):(0,t.empty)()).subscribe(e)})}
},{"../Observable":"+1Kv","./from":"udX+","./empty":"I8Qo"}],"PyCL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.forkJoin=u;var r=require("../Observable"),e=require("../util/isArray"),t=require("../operators/map"),n=require("../util/isObject"),o=require("./from");function u(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];if(1===r.length){var u=r[0];if((0,e.isArray)(u))return i(u,null);if((0,n.isObject)(u)&&Object.getPrototypeOf(u)===Object.prototype){var f=Object.keys(u);return i(f.map(function(r){return u[r]}),f)}}if("function"==typeof r[r.length-1]){var c=r.pop();return i(r=1===r.length&&(0,e.isArray)(r[0])?r[0]:r,null).pipe((0,t.map)(function(r){return c.apply(void 0,r)}))}return i(r,null)}function i(e,t){return new r.Observable(function(r){var n=e.length;if(0!==n)for(var u=new Array(n),i=0,f=0,c=function(c){var l=(0,o.from)(e[c]),a=!1;r.add(l.subscribe({next:function(r){a||(a=!0,f++),u[c]=r},error:function(e){return r.error(e)},complete:function(){++i!==n&&a||(f===n&&r.next(t?t.reduce(function(r,e,t){return r[e]=u[t],r},{}):u),r.complete())}}))},l=0;l<n;l++)c(l);else r.complete()})}
},{"../Observable":"+1Kv","../util/isArray":"aAcO","../operators/map":"krfZ","../util/isObject":"nw2+","./from":"udX+"}],"+oEH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromEvent=i;var e=require("../Observable"),n=require("../util/isArray"),t=require("../util/isFunction"),r=require("../operators/map"),o=function(){return Object.prototype.toString}();function i(o,f,c,a){return(0,t.isFunction)(c)&&(a=c,c=void 0),a?i(o,f,c).pipe((0,r.map)(function(e){return(0,n.isArray)(e)?a.apply(void 0,e):a(e)})):new e.Observable(function(e){u(o,f,function(n){arguments.length>1?e.next(Array.prototype.slice.call(arguments)):e.next(n)},e,c)})}function u(e,n,t,r,o){var i;if(a(e)){var s=e;e.addEventListener(n,t,o),i=function(){return s.removeEventListener(n,t,o)}}else if(c(e)){var v=e;e.on(n,t),i=function(){return v.off(n,t)}}else if(f(e)){var p=e;e.addListener(n,t),i=function(){return p.removeListener(n,t)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var l=0,d=e.length;l<d;l++)u(e[l],n,t,r,o)}r.add(i)}function f(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}function c(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}function a(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}
},{"../Observable":"+1Kv","../util/isArray":"aAcO","../util/isFunction":"s5lC","../operators/map":"krfZ"}],"BEI+":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromEventPattern=i;var r=require("../Observable"),e=require("../util/isArray"),t=require("../util/isFunction"),n=require("../operators/map");function i(u,o,a){return a?i(u,o).pipe((0,n.map)(function(r){return(0,e.isArray)(r)?a.apply(void 0,r):a(r)})):new r.Observable(function(r){var e,n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.next(1===e.length?e[0]:e)};try{e=u(n)}catch(i){return void r.error(i)}if((0,t.isFunction)(o))return function(){return o(n,e)}})}
},{"../Observable":"+1Kv","../util/isArray":"aAcO","../util/isFunction":"s5lC","../operators/map":"krfZ"}],"mPWX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.generate=i;var e=require("../Observable"),r=require("../util/identity"),t=require("../util/isScheduler");function i(i,c,n,a,s){var u,d;if(1==arguments.length){var l=i;d=l.initialState,c=l.condition,n=l.iterate,u=l.resultSelector||r.identity,s=l.scheduler}else void 0===a||(0,t.isScheduler)(a)?(d=i,u=r.identity,s=a):(d=i,u=a);return new e.Observable(function(e){var r=d;if(s)return s.schedule(o,0,{subscriber:e,iterate:n,condition:c,resultSelector:u,state:r});for(;;){if(c){var t=void 0;try{t=c(r)}catch(a){return void e.error(a)}if(!t){e.complete();break}}var i=void 0;try{i=u(r)}catch(a){return void e.error(a)}if(e.next(i),e.closed)break;try{r=n(r)}catch(a){return void e.error(a)}}})}function o(e){var r=e.subscriber,t=e.condition;if(!r.closed){if(e.needIterate)try{e.state=e.iterate(e.state)}catch(c){return void r.error(c)}else e.needIterate=!0;if(t){var i=void 0;try{i=t(e.state)}catch(c){return void r.error(c)}if(!i)return void r.complete();if(r.closed)return}var o;try{o=e.resultSelector(e.state)}catch(c){return void r.error(c)}if(!r.closed&&(r.next(o),!r.closed))return this.schedule(e)}}
},{"../Observable":"+1Kv","../util/identity":"UYfx","../util/isScheduler":"RN4p"}],"kyQJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.iif=t;var e=require("./defer"),r=require("./empty");function t(t,i,u){return void 0===i&&(i=r.EMPTY),void 0===u&&(u=r.EMPTY),(0,e.defer)(function(){return t()?i:u})}
},{"./defer":"F/q0","./empty":"I8Qo"}],"qT3A":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isNumeric=e;var r=require("./isArray");function e(e){return!(0,r.isArray)(e)&&e-parseFloat(e)+1>=0}
},{"./isArray":"aAcO"}],"3PF2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.interval=i;var e=require("../Observable"),r=require("../scheduler/async"),u=require("../util/isNumeric");function i(i,c){return void 0===i&&(i=0),void 0===c&&(c=r.async),(!(0,u.isNumeric)(i)||i<0)&&(i=0),c&&"function"==typeof c.schedule||(c=r.async),new e.Observable(function(e){return e.add(c.schedule(s,i,{subscriber:e,counter:0,period:i})),e})}function s(e){var r=e.subscriber,u=e.counter,i=e.period;r.next(u),this.schedule({subscriber:r,counter:u+1,period:i},i)}
},{"../Observable":"+1Kv","../scheduler/async":"yL84","../util/isNumeric":"qT3A"}],"zbcP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.merge=u;var e=require("../Observable"),r=require("../util/isScheduler"),l=require("../operators/mergeAll"),t=require("./fromArray");function u(){for(var u=[],o=0;o<arguments.length;o++)u[o]=arguments[o];var n=Number.POSITIVE_INFINITY,p=null,i=u[u.length-1];return(0,r.isScheduler)(i)?(p=u.pop(),u.length>1&&"number"==typeof u[u.length-1]&&(n=u.pop())):"number"==typeof i&&(n=u.pop()),null===p&&1===u.length&&u[0]instanceof e.Observable?u[0]:(0,l.mergeAll)(n)((0,t.fromArray)(u,p))}
},{"../Observable":"+1Kv","../util/isScheduler":"RN4p","../operators/mergeAll":"khf/","./fromArray":"E5BW"}],"RjbU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.never=t,exports.NEVER=void 0;var e=require("../Observable"),r=require("../util/noop"),o=new e.Observable(r.noop);function t(){return o}exports.NEVER=o;
},{"../Observable":"+1Kv","../util/noop":"WRNt"}],"p5GO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.onErrorResumeNext=i;var e=require("../Observable"),r=require("./from"),t=require("../util/isArray"),n=require("./empty");function i(){for(var u=[],o=0;o<arguments.length;o++)u[o]=arguments[o];if(0===u.length)return n.EMPTY;var s=u[0],a=u.slice(1);return 1===u.length&&(0,t.isArray)(s)?i.apply(void 0,s):new e.Observable(function(e){var t=function(){return e.add(i.apply(void 0,a).subscribe(e))};return(0,r.from)(s).subscribe({next:function(r){e.next(r)},error:t,complete:t})})}
},{"../Observable":"+1Kv","./from":"udX+","../util/isArray":"aAcO","./empty":"I8Qo"}],"OlqV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pairs=s,exports.dispatch=i;var e=require("../Observable"),r=require("../Subscription");function s(s,t){return t?new e.Observable(function(e){var n=Object.keys(s),b=new r.Subscription;return b.add(t.schedule(i,0,{keys:n,index:0,subscriber:e,subscription:b,obj:s})),b}):new e.Observable(function(e){for(var r=Object.keys(s),i=0;i<r.length&&!e.closed;i++){var t=r[i];s.hasOwnProperty(t)&&e.next([t,s[t]])}e.complete()})}function i(e){var r=e.keys,s=e.index,i=e.subscriber,t=e.subscription,n=e.obj;if(!i.closed)if(s<r.length){var b=r[s];i.next([b,n[b]]),t.add(this.schedule({keys:r,index:s+1,subscriber:i,subscription:t,obj:n}))}else i.complete()}
},{"../Observable":"+1Kv","../Subscription":"ab35"}],"dH5v":[function(require,module,exports) {
"use strict";function e(e,r){function t(){return!t.pred.apply(t.thisArg,arguments)}return t.pred=e,t.thisArg=r,t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.not=e;
},{}],"AJqx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.filter=i;var t=r(require("tslib")),e=require("../Subscriber");function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}function i(t,e){return function(r){return r.lift(new n(t,e))}}var n=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new o(t,this.predicate,this.thisArg))},t}(),o=function(e){function r(t,r,i){var n=e.call(this,t)||this;return n.predicate=r,n.thisArg=i,n.count=0,n}return t.__extends(r,e),r.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(r){return void this.destination.error(r)}e&&this.destination.next(t)},r}(e.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"q/Hj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.partition=s;var e=require("../util/not"),r=require("../util/subscribeTo"),t=require("../operators/filter"),i=require("../Observable");function s(s,u,b){return[(0,t.filter)(u,b)(new i.Observable((0,r.subscribeTo)(s))),(0,t.filter)((0,e.not)(u,b))(new i.Observable((0,r.subscribeTo)(s)))]}
},{"../util/not":"dH5v","../util/subscribeTo":"LOmD","../operators/filter":"AJqx","../Observable":"+1Kv"}],"mhkV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.race=n,exports.RaceSubscriber=exports.RaceOperator=void 0;var r=o(require("tslib")),e=require("../util/isArray"),t=require("./fromArray"),s=require("../OuterSubscriber"),i=require("../util/subscribeToResult");function o(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)if(Object.prototype.hasOwnProperty.call(r,t)){var s=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,t):{};s.get||s.set?Object.defineProperty(e,t,s):e[t]=r[t]}return e.default=r,e}function n(){for(var r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];if(1===r.length){if(!(0,e.isArray)(r[0]))return r[0];r=r[0]}return(0,t.fromArray)(r,void 0).lift(new u)}var u=function(){function r(){}return r.prototype.call=function(r,e){return e.subscribe(new c(r))},r}();exports.RaceOperator=u;var c=function(e){function t(r){var t=e.call(this,r)||this;return t.hasFirst=!1,t.observables=[],t.subscriptions=[],t}return r.__extends(t,e),t.prototype._next=function(r){this.observables.push(r)},t.prototype._complete=function(){var r=this.observables,e=r.length;if(0===e)this.destination.complete();else{for(var t=0;t<e&&!this.hasFirst;t++){var s=r[t],o=(0,i.subscribeToResult)(this,s,s,t);this.subscriptions&&this.subscriptions.push(o),this.add(o)}this.observables=null}},t.prototype.notifyNext=function(r,e,t,s,i){if(!this.hasFirst){this.hasFirst=!0;for(var o=0;o<this.subscriptions.length;o++)if(o!==t){var n=this.subscriptions[o];n.unsubscribe(),this.remove(n)}this.subscriptions=null}this.destination.next(e)},t}(s.OuterSubscriber);exports.RaceSubscriber=c;
},{"tslib":"qxUW","../util/isArray":"aAcO","./fromArray":"E5BW","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"nsRy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.range=r,exports.dispatch=t;var e=require("../Observable");function r(r,s,i){return void 0===r&&(r=0),new e.Observable(function(e){void 0===s&&(s=r,r=0);var n=0,o=r;if(i)return i.schedule(t,0,{index:n,count:s,start:r,subscriber:e});for(;;){if(n++>=s){e.complete();break}if(e.next(o++),e.closed)break}})}function t(e){var r=e.start,t=e.index,s=e.count,i=e.subscriber;t>=s?i.complete():(i.next(r),i.closed||(e.index=t+1,e.start=r+1,this.schedule(e)))}
},{"../Observable":"+1Kv"}],"2rs8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.timer=s;var e=require("../Observable"),r=require("../scheduler/async"),i=require("../util/isNumeric"),u=require("../util/isScheduler");function s(s,n,t){void 0===s&&(s=0);var d=-1;return(0,i.isNumeric)(n)?d=Number(n)<1?1:Number(n):(0,u.isScheduler)(n)&&(t=n),(0,u.isScheduler)(t)||(t=r.async),new e.Observable(function(e){var r=(0,i.isNumeric)(s)?s:+s-t.now();return t.schedule(c,r,{index:0,period:d,subscriber:e})})}function c(e){var r=e.index,i=e.period,u=e.subscriber;if(u.next(r),!u.closed){if(-1===i)return u.complete();e.index=r+1,this.schedule(e,i)}}
},{"../Observable":"+1Kv","../scheduler/async":"yL84","../util/isNumeric":"qT3A","../util/isScheduler":"RN4p"}],"gRTy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.using=t;var r=require("../Observable"),e=require("./from"),u=require("./empty");function t(t,n){return new r.Observable(function(r){var i,s;try{i=t()}catch(c){return void r.error(c)}try{s=n(i)}catch(c){return void r.error(c)}var o=(s?(0,e.from)(s):u.EMPTY).subscribe(r);return function(){o.unsubscribe(),i&&i.unsubscribe()}})}
},{"../Observable":"+1Kv","./from":"udX+","./empty":"I8Qo"}],"OlW6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.zip=a,exports.ZipSubscriber=exports.ZipOperator=void 0;var t=u(require("tslib")),e=require("./fromArray"),r=require("../util/isArray"),i=require("../Subscriber"),n=require("../OuterSubscriber"),o=require("../util/subscribeToResult"),s=require("../../internal/symbol/iterator");function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}function a(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=t[t.length-1];return"function"==typeof i&&t.pop(),(0,e.fromArray)(t,void 0).lift(new l(i))}var l=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new p(t,this.resultSelector))},t}();exports.ZipOperator=l;var p=function(e){function i(t,r,i){void 0===i&&(i=Object.create(null));var n=e.call(this,t)||this;return n.iterators=[],n.active=0,n.resultSelector="function"==typeof r?r:null,n.values=i,n}return t.__extends(i,e),i.prototype._next=function(t){var e=this.iterators;(0,r.isArray)(t)?e.push(new c(t)):"function"==typeof t[s.iterator]?e.push(new h(t[s.iterator]())):e.push(new f(this.destination,this,t))},i.prototype._complete=function(){var t=this.iterators,e=t.length;if(this.unsubscribe(),0!==e){this.active=e;for(var r=0;r<e;r++){var i=t[r];if(i.stillUnsubscribed)this.destination.add(i.subscribe(i,r));else this.active--}}else this.destination.complete()},i.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},i.prototype.checkIterators=function(){for(var t=this.iterators,e=t.length,r=this.destination,i=0;i<e;i++){if("function"==typeof(s=t[i]).hasValue&&!s.hasValue())return}var n=!1,o=[];for(i=0;i<e;i++){var s,u=(s=t[i]).next();if(s.hasCompleted()&&(n=!0),u.done)return void r.complete();o.push(u.value)}this.resultSelector?this._tryresultSelector(o):r.next(o),n&&r.complete()},i.prototype._tryresultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(r){return void this.destination.error(r)}this.destination.next(e)},i}(i.Subscriber);exports.ZipSubscriber=p;var h=function(){function t(t){this.iterator=t,this.nextResult=t.next()}return t.prototype.hasValue=function(){return!0},t.prototype.next=function(){var t=this.nextResult;return this.nextResult=this.iterator.next(),t},t.prototype.hasCompleted=function(){var t=this.nextResult;return t&&t.done},t}(),c=function(){function t(t){this.array=t,this.index=0,this.length=0,this.length=t.length}return t.prototype[s.iterator]=function(){return this},t.prototype.next=function(t){var e=this.index++,r=this.array;return e<this.length?{value:r[e],done:!1}:{value:null,done:!0}},t.prototype.hasValue=function(){return this.array.length>this.index},t.prototype.hasCompleted=function(){return this.array.length===this.index},t}(),f=function(e){function r(t,r,i){var n=e.call(this,t)||this;return n.parent=r,n.observable=i,n.stillUnsubscribed=!0,n.buffer=[],n.isComplete=!1,n}return t.__extends(r,e),r.prototype[s.iterator]=function(){return this},r.prototype.next=function(){var t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}},r.prototype.hasValue=function(){return this.buffer.length>0},r.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},r.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},r.prototype.notifyNext=function(t,e,r,i,n){this.buffer.push(e),this.parent.checkIterators()},r.prototype.subscribe=function(t,e){return(0,o.subscribeToResult)(this,this.observable,this,e)},r}(n.OuterSubscriber);
},{"tslib":"qxUW","./fromArray":"E5BW","../util/isArray":"aAcO","../Subscriber":"+Es2","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X","../../internal/symbol/iterator":"WuiM"}],"W5vH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"Observable",{enumerable:!0,get:function(){return e.Observable}}),Object.defineProperty(exports,"ConnectableObservable",{enumerable:!0,get:function(){return r.ConnectableObservable}}),Object.defineProperty(exports,"GroupedObservable",{enumerable:!0,get:function(){return t.GroupedObservable}}),Object.defineProperty(exports,"observable",{enumerable:!0,get:function(){return n.observable}}),Object.defineProperty(exports,"Subject",{enumerable:!0,get:function(){return i.Subject}}),Object.defineProperty(exports,"BehaviorSubject",{enumerable:!0,get:function(){return u.BehaviorSubject}}),Object.defineProperty(exports,"ReplaySubject",{enumerable:!0,get:function(){return o.ReplaySubject}}),Object.defineProperty(exports,"AsyncSubject",{enumerable:!0,get:function(){return b.AsyncSubject}}),Object.defineProperty(exports,"asapScheduler",{enumerable:!0,get:function(){return a.asap}}),Object.defineProperty(exports,"asyncScheduler",{enumerable:!0,get:function(){return l.async}}),Object.defineProperty(exports,"queueScheduler",{enumerable:!0,get:function(){return c.queue}}),Object.defineProperty(exports,"animationFrameScheduler",{enumerable:!0,get:function(){return p.animationFrame}}),Object.defineProperty(exports,"VirtualTimeScheduler",{enumerable:!0,get:function(){return s.VirtualTimeScheduler}}),Object.defineProperty(exports,"VirtualAction",{enumerable:!0,get:function(){return s.VirtualAction}}),Object.defineProperty(exports,"Scheduler",{enumerable:!0,get:function(){return f.Scheduler}}),Object.defineProperty(exports,"Subscription",{enumerable:!0,get:function(){return d.Subscription}}),Object.defineProperty(exports,"Subscriber",{enumerable:!0,get:function(){return m.Subscriber}}),Object.defineProperty(exports,"Notification",{enumerable:!0,get:function(){return g.Notification}}),Object.defineProperty(exports,"NotificationKind",{enumerable:!0,get:function(){return g.NotificationKind}}),Object.defineProperty(exports,"pipe",{enumerable:!0,get:function(){return y.pipe}}),Object.defineProperty(exports,"noop",{enumerable:!0,get:function(){return O.noop}}),Object.defineProperty(exports,"identity",{enumerable:!0,get:function(){return j.identity}}),Object.defineProperty(exports,"isObservable",{enumerable:!0,get:function(){return P.isObservable}}),Object.defineProperty(exports,"ArgumentOutOfRangeError",{enumerable:!0,get:function(){return x.ArgumentOutOfRangeError}}),Object.defineProperty(exports,"EmptyError",{enumerable:!0,get:function(){return v.EmptyError}}),Object.defineProperty(exports,"ObjectUnsubscribedError",{enumerable:!0,get:function(){return q.ObjectUnsubscribedError}}),Object.defineProperty(exports,"UnsubscriptionError",{enumerable:!0,get:function(){return E.UnsubscriptionError}}),Object.defineProperty(exports,"TimeoutError",{enumerable:!0,get:function(){return S.TimeoutError}}),Object.defineProperty(exports,"bindCallback",{enumerable:!0,get:function(){return h.bindCallback}}),Object.defineProperty(exports,"bindNodeCallback",{enumerable:!0,get:function(){return N.bindNodeCallback}}),Object.defineProperty(exports,"combineLatest",{enumerable:!0,get:function(){return R.combineLatest}}),Object.defineProperty(exports,"concat",{enumerable:!0,get:function(){return k.concat}}),Object.defineProperty(exports,"defer",{enumerable:!0,get:function(){return C.defer}}),Object.defineProperty(exports,"empty",{enumerable:!0,get:function(){return A.empty}}),Object.defineProperty(exports,"EMPTY",{enumerable:!0,get:function(){return A.EMPTY}}),Object.defineProperty(exports,"forkJoin",{enumerable:!0,get:function(){return T.forkJoin}}),Object.defineProperty(exports,"from",{enumerable:!0,get:function(){return V.from}}),Object.defineProperty(exports,"fromEvent",{enumerable:!0,get:function(){return U.fromEvent}}),Object.defineProperty(exports,"fromEventPattern",{enumerable:!0,get:function(){return B.fromEventPattern}}),Object.defineProperty(exports,"generate",{enumerable:!0,get:function(){return w.generate}}),Object.defineProperty(exports,"iif",{enumerable:!0,get:function(){return z.iif}}),Object.defineProperty(exports,"interval",{enumerable:!0,get:function(){return F.interval}}),Object.defineProperty(exports,"merge",{enumerable:!0,get:function(){return J.merge}}),Object.defineProperty(exports,"never",{enumerable:!0,get:function(){return L.never}}),Object.defineProperty(exports,"NEVER",{enumerable:!0,get:function(){return L.NEVER}}),Object.defineProperty(exports,"of",{enumerable:!0,get:function(){return M.of}}),Object.defineProperty(exports,"onErrorResumeNext",{enumerable:!0,get:function(){return G.onErrorResumeNext}}),Object.defineProperty(exports,"pairs",{enumerable:!0,get:function(){return K.pairs}}),Object.defineProperty(exports,"partition",{enumerable:!0,get:function(){return Y.partition}}),Object.defineProperty(exports,"race",{enumerable:!0,get:function(){return _.race}}),Object.defineProperty(exports,"range",{enumerable:!0,get:function(){return D.range}}),Object.defineProperty(exports,"throwError",{enumerable:!0,get:function(){return H.throwError}}),Object.defineProperty(exports,"timer",{enumerable:!0,get:function(){return I.timer}}),Object.defineProperty(exports,"using",{enumerable:!0,get:function(){return Q.using}}),Object.defineProperty(exports,"zip",{enumerable:!0,get:function(){return W.zip}}),Object.defineProperty(exports,"scheduled",{enumerable:!0,get:function(){return X.scheduled}}),Object.defineProperty(exports,"config",{enumerable:!0,get:function(){return Z.config}});var e=require("./internal/Observable"),r=require("./internal/observable/ConnectableObservable"),t=require("./internal/operators/groupBy"),n=require("./internal/symbol/observable"),i=require("./internal/Subject"),u=require("./internal/BehaviorSubject"),o=require("./internal/ReplaySubject"),b=require("./internal/AsyncSubject"),a=require("./internal/scheduler/asap"),l=require("./internal/scheduler/async"),c=require("./internal/scheduler/queue"),p=require("./internal/scheduler/animationFrame"),s=require("./internal/scheduler/VirtualTimeScheduler"),f=require("./internal/Scheduler"),d=require("./internal/Subscription"),m=require("./internal/Subscriber"),g=require("./internal/Notification"),y=require("./internal/util/pipe"),O=require("./internal/util/noop"),j=require("./internal/util/identity"),P=require("./internal/util/isObservable"),x=require("./internal/util/ArgumentOutOfRangeError"),v=require("./internal/util/EmptyError"),q=require("./internal/util/ObjectUnsubscribedError"),E=require("./internal/util/UnsubscriptionError"),S=require("./internal/util/TimeoutError"),h=require("./internal/observable/bindCallback"),N=require("./internal/observable/bindNodeCallback"),R=require("./internal/observable/combineLatest"),k=require("./internal/observable/concat"),C=require("./internal/observable/defer"),A=require("./internal/observable/empty"),T=require("./internal/observable/forkJoin"),V=require("./internal/observable/from"),U=require("./internal/observable/fromEvent"),B=require("./internal/observable/fromEventPattern"),w=require("./internal/observable/generate"),z=require("./internal/observable/iif"),F=require("./internal/observable/interval"),J=require("./internal/observable/merge"),L=require("./internal/observable/never"),M=require("./internal/observable/of"),G=require("./internal/observable/onErrorResumeNext"),K=require("./internal/observable/pairs"),Y=require("./internal/observable/partition"),_=require("./internal/observable/race"),D=require("./internal/observable/range"),H=require("./internal/observable/throwError"),I=require("./internal/observable/timer"),Q=require("./internal/observable/using"),W=require("./internal/observable/zip"),X=require("./internal/scheduled/scheduled"),Z=require("./internal/config");
},{"./internal/Observable":"+1Kv","./internal/observable/ConnectableObservable":"Jnv2","./internal/operators/groupBy":"zY6H","./internal/symbol/observable":"154F","./internal/Subject":"Drrb","./internal/BehaviorSubject":"is7q","./internal/ReplaySubject":"H1hQ","./internal/AsyncSubject":"0X8v","./internal/scheduler/asap":"TfHP","./internal/scheduler/async":"yL84","./internal/scheduler/queue":"6w2Y","./internal/scheduler/animationFrame":"697z","./internal/scheduler/VirtualTimeScheduler":"gP1m","./internal/Scheduler":"h2eM","./internal/Subscription":"ab35","./internal/Subscriber":"+Es2","./internal/Notification":"io6T","./internal/util/pipe":"8Vx0","./internal/util/noop":"WRNt","./internal/util/identity":"UYfx","./internal/util/isObservable":"vOpz","./internal/util/ArgumentOutOfRangeError":"ubev","./internal/util/EmptyError":"6ZXy","./internal/util/ObjectUnsubscribedError":"1U3B","./internal/util/UnsubscriptionError":"tFzU","./internal/util/TimeoutError":"vaeu","./internal/observable/bindCallback":"8fE/","./internal/observable/bindNodeCallback":"gDRA","./internal/observable/combineLatest":"Ccxw","./internal/observable/concat":"o1KK","./internal/observable/defer":"F/q0","./internal/observable/empty":"I8Qo","./internal/observable/forkJoin":"PyCL","./internal/observable/from":"udX+","./internal/observable/fromEvent":"+oEH","./internal/observable/fromEventPattern":"BEI+","./internal/observable/generate":"mPWX","./internal/observable/iif":"kyQJ","./internal/observable/interval":"3PF2","./internal/observable/merge":"zbcP","./internal/observable/never":"RjbU","./internal/observable/of":"N4eK","./internal/observable/onErrorResumeNext":"p5GO","./internal/observable/pairs":"OlqV","./internal/observable/partition":"q/Hj","./internal/observable/race":"mhkV","./internal/observable/range":"nsRy","./internal/observable/throwError":"nAit","./internal/observable/timer":"2rs8","./internal/observable/using":"gRTy","./internal/observable/zip":"OlW6","./internal/scheduled/scheduled":"z8Tn","./internal/config":"EXLc"}],"jKl9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.audit=o;var t=i(require("tslib")),e=require("../OuterSubscriber"),r=require("../util/subscribeToResult");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}function o(t){return function(e){return e.lift(new n(t))}}var n=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.durationSelector))},t}(),u=function(e){function i(t,r){var i=e.call(this,t)||this;return i.durationSelector=r,i.hasValue=!1,i}return t.__extends(i,e),i.prototype._next=function(t){if(this.value=t,this.hasValue=!0,!this.throttled){var e=void 0;try{e=(0,this.durationSelector)(t)}catch(o){return this.destination.error(o)}var i=(0,r.subscribeToResult)(this,e);!i||i.closed?this.clearThrottle():this.add(this.throttled=i)}},i.prototype.clearThrottle=function(){var t=this.value,e=this.hasValue,r=this.throttled;r&&(this.remove(r),this.throttled=null,r.unsubscribe()),e&&(this.value=null,this.hasValue=!1,this.destination.next(t))},i.prototype.notifyNext=function(t,e,r,i){this.clearThrottle()},i.prototype.notifyComplete=function(){this.clearThrottle()},i}(e.OuterSubscriber);
},{"tslib":"qxUW","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"+/SS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.auditTime=i;var e=require("../scheduler/async"),r=require("./audit"),t=require("../observable/timer");function i(i,u){return void 0===u&&(u=e.async),(0,r.audit)(function(){return(0,t.timer)(i,u)})}
},{"../scheduler/async":"yL84","./audit":"jKl9","../observable/timer":"2rs8"}],"URP9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buffer=n;var e=i(require("tslib")),t=require("../OuterSubscriber"),r=require("../util/subscribeToResult");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}function n(e){return function(t){return t.lift(new u(e))}}var u=function(){function e(e){this.closingNotifier=e}return e.prototype.call=function(e,t){return t.subscribe(new o(e,this.closingNotifier))},e}(),o=function(t){function i(e,i){var n=t.call(this,e)||this;return n.buffer=[],n.add((0,r.subscribeToResult)(n,i)),n}return e.__extends(i,t),i.prototype._next=function(e){this.buffer.push(e)},i.prototype.notifyNext=function(e,t,r,i,n){var u=this.buffer;this.buffer=[],this.destination.next(u)},i}(t.OuterSubscriber);
},{"tslib":"qxUW","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"F3qJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bufferCount=i;var t=r(require("tslib")),e=require("../Subscriber");function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}function i(t,e){return void 0===e&&(e=null),function(r){return r.lift(new n(t,e))}}var n=function(){function t(t,e){this.bufferSize=t,this.startBufferEvery=e,this.subscriberClass=e&&t!==e?u:s}return t.prototype.call=function(t,e){return e.subscribe(new this.subscriberClass(t,this.bufferSize,this.startBufferEvery))},t}(),s=function(e){function r(t,r){var i=e.call(this,t)||this;return i.bufferSize=r,i.buffer=[],i}return t.__extends(r,e),r.prototype._next=function(t){var e=this.buffer;e.push(t),e.length==this.bufferSize&&(this.destination.next(e),this.buffer=[])},r.prototype._complete=function(){var t=this.buffer;t.length>0&&this.destination.next(t),e.prototype._complete.call(this)},r}(e.Subscriber),u=function(e){function r(t,r,i){var n=e.call(this,t)||this;return n.bufferSize=r,n.startBufferEvery=i,n.buffers=[],n.count=0,n}return t.__extends(r,e),r.prototype._next=function(t){var e=this.bufferSize,r=this.startBufferEvery,i=this.buffers,n=this.count;this.count++,n%r==0&&i.push([]);for(var s=i.length;s--;){var u=i[s];u.push(t),u.length===e&&(i.splice(s,1),this.destination.next(u))}},r.prototype._complete=function(){for(var t=this.buffers,r=this.destination;t.length>0;){var i=t.shift();i.length>0&&r.next(i)}e.prototype._complete.call(this)},r}(e.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"mquI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bufferTime=o;var e=i(require("tslib")),t=require("../scheduler/async"),r=require("../Subscriber"),n=require("../util/isScheduler");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}function o(e){var r=arguments.length,i=t.async;(0,n.isScheduler)(arguments[arguments.length-1])&&(i=arguments[arguments.length-1],r--);var o=null;r>=2&&(o=arguments[1]);var u=Number.POSITIVE_INFINITY;return r>=3&&(u=arguments[2]),function(t){return t.lift(new s(e,o,u,i))}}var s=function(){function e(e,t,r,n){this.bufferTimeSpan=e,this.bufferCreationInterval=t,this.maxBufferSize=r,this.scheduler=n}return e.prototype.call=function(e,t){return t.subscribe(new c(e,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},e}(),u=function(){return function(){this.buffer=[]}}(),c=function(t){function r(e,r,n,i,o){var s=t.call(this,e)||this;s.bufferTimeSpan=r,s.bufferCreationInterval=n,s.maxBufferSize=i,s.scheduler=o,s.contexts=[];var u=s.openContext();if(s.timespanOnly=null==n||n<0,s.timespanOnly){var c={subscriber:s,context:u,bufferTimeSpan:r};s.add(u.closeAction=o.schedule(f,r,c))}else{var h={subscriber:s,context:u},p={bufferTimeSpan:r,bufferCreationInterval:n,subscriber:s,scheduler:o};s.add(u.closeAction=o.schedule(a,r,h)),s.add(o.schedule(l,n,p))}return s}return e.__extends(r,t),r.prototype._next=function(e){for(var t,r=this.contexts,n=r.length,i=0;i<n;i++){var o=r[i],s=o.buffer;s.push(e),s.length==this.maxBufferSize&&(t=o)}t&&this.onBufferFull(t)},r.prototype._error=function(e){this.contexts.length=0,t.prototype._error.call(this,e)},r.prototype._complete=function(){for(var e=this.contexts,r=this.destination;e.length>0;){var n=e.shift();r.next(n.buffer)}t.prototype._complete.call(this)},r.prototype._unsubscribe=function(){this.contexts=null},r.prototype.onBufferFull=function(e){this.closeContext(e);var t=e.closeAction;if(t.unsubscribe(),this.remove(t),!this.closed&&this.timespanOnly){e=this.openContext();var r=this.bufferTimeSpan,n={subscriber:this,context:e,bufferTimeSpan:r};this.add(e.closeAction=this.scheduler.schedule(f,r,n))}},r.prototype.openContext=function(){var e=new u;return this.contexts.push(e),e},r.prototype.closeContext=function(e){this.destination.next(e.buffer);var t=this.contexts;(t?t.indexOf(e):-1)>=0&&t.splice(t.indexOf(e),1)},r}(r.Subscriber);function f(e){var t=e.subscriber,r=e.context;r&&t.closeContext(r),t.closed||(e.context=t.openContext(),e.context.closeAction=this.schedule(e,e.bufferTimeSpan))}function l(e){var t=e.bufferCreationInterval,r=e.bufferTimeSpan,n=e.subscriber,i=e.scheduler,o=n.openContext();n.closed||(n.add(o.closeAction=i.schedule(a,r,{subscriber:n,context:o})),this.schedule(e,t))}function a(e){var t=e.subscriber,r=e.context;t.closeContext(r)}
},{"tslib":"qxUW","../scheduler/async":"yL84","../Subscriber":"+Es2","../util/isScheduler":"RN4p"}],"la/b":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bufferToggle=n;var t=i(require("tslib")),e=require("../Subscription"),r=require("../util/subscribeToResult"),o=require("../OuterSubscriber");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};o.get||o.set?Object.defineProperty(e,r,o):e[r]=t[r]}return e.default=t,e}function n(t,e){return function(r){return r.lift(new s(t,e))}}var s=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.openings,this.closingSelector))},t}(),u=function(o){function i(t,e,i){var n=o.call(this,t)||this;return n.openings=e,n.closingSelector=i,n.contexts=[],n.add((0,r.subscribeToResult)(n,e)),n}return t.__extends(i,o),i.prototype._next=function(t){for(var e=this.contexts,r=e.length,o=0;o<r;o++)e[o].buffer.push(t)},i.prototype._error=function(t){for(var e=this.contexts;e.length>0;){var r=e.shift();r.subscription.unsubscribe(),r.buffer=null,r.subscription=null}this.contexts=null,o.prototype._error.call(this,t)},i.prototype._complete=function(){for(var t=this.contexts;t.length>0;){var e=t.shift();this.destination.next(e.buffer),e.subscription.unsubscribe(),e.buffer=null,e.subscription=null}this.contexts=null,o.prototype._complete.call(this)},i.prototype.notifyNext=function(t,e,r,o,i){t?this.closeBuffer(t):this.openBuffer(e)},i.prototype.notifyComplete=function(t){this.closeBuffer(t.context)},i.prototype.openBuffer=function(t){try{var e=this.closingSelector.call(this,t);e&&this.trySubscribe(e)}catch(r){this._error(r)}},i.prototype.closeBuffer=function(t){var e=this.contexts;if(e&&t){var r=t.buffer,o=t.subscription;this.destination.next(r),e.splice(e.indexOf(t),1),this.remove(o),o.unsubscribe()}},i.prototype.trySubscribe=function(t){var o=this.contexts,i=new e.Subscription,n={buffer:[],subscription:i};o.push(n);var s=(0,r.subscribeToResult)(this,t,n);!s||s.closed?this.closeBuffer(n):(s.context=n,this.add(s),i.add(s))},i}(o.OuterSubscriber);
},{"tslib":"qxUW","../Subscription":"ab35","../util/subscribeToResult":"kr3X","../OuterSubscriber":"VHfM"}],"XhJV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bufferWhen=s;var t=n(require("tslib")),e=require("../Subscription"),r=require("../OuterSubscriber"),i=require("../util/subscribeToResult");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}function s(t){return function(e){return e.lift(new o(t))}}var o=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.closingSelector))},t}(),u=function(r){function n(t,e){var i=r.call(this,t)||this;return i.closingSelector=e,i.subscribing=!1,i.openBuffer(),i}return t.__extends(n,r),n.prototype._next=function(t){this.buffer.push(t)},n.prototype._complete=function(){var t=this.buffer;t&&this.destination.next(t),r.prototype._complete.call(this)},n.prototype._unsubscribe=function(){this.buffer=null,this.subscribing=!1},n.prototype.notifyNext=function(t,e,r,i,n){this.openBuffer()},n.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},n.prototype.openBuffer=function(){var t=this.closingSubscription;t&&(this.remove(t),t.unsubscribe());var r,n=this.buffer;this.buffer&&this.destination.next(n),this.buffer=[];try{r=(0,this.closingSelector)()}catch(s){return this.error(s)}t=new e.Subscription,this.closingSubscription=t,this.add(t),this.subscribing=!0,t.add((0,i.subscribeToResult)(this,r)),this.subscribing=!1},n}(r.OuterSubscriber);
},{"tslib":"qxUW","../Subscription":"ab35","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"pYB0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.catchError=u;var r=o(require("tslib")),e=require("../OuterSubscriber"),t=require("../InnerSubscriber"),i=require("../util/subscribeToResult");function o(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)if(Object.prototype.hasOwnProperty.call(r,t)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,t):{};i.get||i.set?Object.defineProperty(e,t,i):e[t]=r[t]}return e.default=r,e}function u(r){return function(e){var t=new n(r),i=e.lift(t);return t.caught=i}}var n=function(){function r(r){this.selector=r}return r.prototype.call=function(r,e){return e.subscribe(new c(r,this.selector,this.caught))},r}(),c=function(e){function o(r,t,i){var o=e.call(this,r)||this;return o.selector=t,o.caught=i,o}return r.__extends(o,e),o.prototype.error=function(r){if(!this.isStopped){var o=void 0;try{o=this.selector(r,this.caught)}catch(n){return void e.prototype.error.call(this,n)}this._unsubscribeAndRecycle();var u=new t.InnerSubscriber(this,void 0,void 0);this.add(u),(0,i.subscribeToResult)(this,o,void 0,void 0,u)}},o}(e.OuterSubscriber);
},{"tslib":"qxUW","../OuterSubscriber":"VHfM","../InnerSubscriber":"wrBi","../util/subscribeToResult":"kr3X"}],"57AO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.combineAll=t;var e=require("../observable/combineLatest");function t(t){return function(r){return r.lift(new e.CombineLatestOperator(t))}}
},{"../observable/combineLatest":"Ccxw"}],"cXRl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.combineLatest=n;var e=require("../util/isArray"),r=require("../observable/combineLatest"),t=require("../observable/from"),o={};function n(){for(var o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];var i=null;return"function"==typeof o[o.length-1]&&(i=o.pop()),1===o.length&&(0,e.isArray)(o[0])&&(o=o[0].slice()),function(e){return e.lift.call((0,t.from)([e].concat(o)),new r.CombineLatestOperator(i))}}
},{"../util/isArray":"aAcO","../observable/combineLatest":"Ccxw","../observable/from":"udX+"}],"op/w":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.concat=t;var e=require("../observable/concat");function t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return function(r){return r.lift.call(e.concat.apply(void 0,[r].concat(t)))}}
},{"../observable/concat":"o1KK"}],"+GMT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.concatMap=r;var e=require("./mergeMap");function r(r,t){return(0,e.mergeMap)(r,t,1)}
},{"./mergeMap":"bWJj"}],"CtQr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.concatMapTo=t;var e=require("./concatMap");function t(t,r){return(0,e.concatMap)(function(){return t},r)}
},{"./concatMap":"+GMT"}],"mYns":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.count=i;var t=r(require("tslib")),e=require("../Subscriber");function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}function i(t){return function(e){return e.lift(new n(t,e))}}var n=function(){function t(t,e){this.predicate=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new o(t,this.predicate,this.source))},t}(),o=function(e){function r(t,r,i){var n=e.call(this,t)||this;return n.predicate=r,n.source=i,n.count=0,n.index=0,n}return t.__extends(r,e),r.prototype._next=function(t){this.predicate?this._tryPredicate(t):this.count++},r.prototype._tryPredicate=function(t){var e;try{e=this.predicate(t,this.index++,this.source)}catch(r){return void this.destination.error(r)}e&&this.count++},r.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},r}(e.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"V4oe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.debounce=o;var t=i(require("tslib")),e=require("../OuterSubscriber"),r=require("../util/subscribeToResult");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}function o(t){return function(e){return e.lift(new n(t))}}var n=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.durationSelector))},t}(),u=function(e){function i(t,r){var i=e.call(this,t)||this;return i.durationSelector=r,i.hasValue=!1,i.durationSubscription=null,i}return t.__extends(i,e),i.prototype._next=function(t){try{var e=this.durationSelector.call(this,t);e&&this._tryNext(t,e)}catch(r){this.destination.error(r)}},i.prototype._complete=function(){this.emitValue(),this.destination.complete()},i.prototype._tryNext=function(t,e){var i=this.durationSubscription;this.value=t,this.hasValue=!0,i&&(i.unsubscribe(),this.remove(i)),(i=(0,r.subscribeToResult)(this,e))&&!i.closed&&this.add(this.durationSubscription=i)},i.prototype.notifyNext=function(t,e,r,i,o){this.emitValue()},i.prototype.notifyComplete=function(){this.emitValue()},i.prototype.emitValue=function(){if(this.hasValue){var t=this.value,r=this.durationSubscription;r&&(this.durationSubscription=null,r.unsubscribe(),this.remove(r)),this.value=null,this.hasValue=!1,e.prototype._next.call(this,t)}},i}(e.OuterSubscriber);
},{"tslib":"qxUW","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"m1C5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.debounceTime=n;var e=r(require("tslib")),t=require("../Subscriber"),i=require("../scheduler/async");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,i):{};r.get||r.set?Object.defineProperty(t,i,r):t[i]=e[i]}return t.default=e,t}function n(e,t){return void 0===t&&(t=i.async),function(i){return i.lift(new u(e,t))}}var u=function(){function e(e,t){this.dueTime=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.dueTime,this.scheduler))},e}(),s=function(t){function i(e,i,r){var n=t.call(this,e)||this;return n.dueTime=i,n.scheduler=r,n.debouncedSubscription=null,n.lastValue=null,n.hasValue=!1,n}return e.__extends(i,t),i.prototype._next=function(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(o,this.dueTime,this))},i.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},i.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var e=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}},i.prototype.clearDebounce=function(){var e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)},i}(t.Subscriber);function o(e){e.debouncedNext()}
},{"tslib":"qxUW","../Subscriber":"+Es2","../scheduler/async":"yL84"}],"cKW4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultIfEmpty=n;var t=r(require("tslib")),e=require("../Subscriber");function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}function n(t){return void 0===t&&(t=null),function(e){return e.lift(new i(t))}}var i=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.defaultValue))},t}(),u=function(e){function r(t,r){var n=e.call(this,t)||this;return n.defaultValue=r,n.isEmpty=!0,n}return t.__extends(r,e),r.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},r.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},r}(e.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"Pk7A":[function(require,module,exports) {
"use strict";function e(e){return e instanceof Date&&!isNaN(+e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isDate=e;
},{}],"Sa60":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.delay=o;var e=s(require("tslib")),t=require("../scheduler/async"),i=require("../util/isDate"),r=require("../Subscriber"),n=require("../Notification");function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,i):{};r.get||r.set?Object.defineProperty(t,i,r):t[i]=e[i]}return t.default=e,t}function o(e,r){void 0===r&&(r=t.async);var n=(0,i.isDate)(e)?+e-r.now():Math.abs(e);return function(e){return e.lift(new u(n,r))}}var u=function(){function e(e,t){this.delay=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new c(e,this.delay,this.scheduler))},e}(),c=function(t){function i(e,i,r){var n=t.call(this,e)||this;return n.delay=i,n.scheduler=r,n.queue=[],n.active=!1,n.errored=!1,n}return e.__extends(i,t),i.dispatch=function(e){for(var t=e.source,i=t.queue,r=e.scheduler,n=e.destination;i.length>0&&i[0].time-r.now()<=0;)i.shift().notification.observe(n);if(i.length>0){var s=Math.max(0,i[0].time-r.now());this.schedule(e,s)}else this.unsubscribe(),t.active=!1},i.prototype._schedule=function(e){this.active=!0,this.destination.add(e.schedule(i.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))},i.prototype.scheduleNotification=function(e){if(!0!==this.errored){var t=this.scheduler,i=new a(t.now()+this.delay,e);this.queue.push(i),!1===this.active&&this._schedule(t)}},i.prototype._next=function(e){this.scheduleNotification(n.Notification.createNext(e))},i.prototype._error=function(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()},i.prototype._complete=function(){this.scheduleNotification(n.Notification.createComplete()),this.unsubscribe()},i}(r.Subscriber),a=function(){return function(e,t){this.time=e,this.notification=t}}();
},{"tslib":"qxUW","../scheduler/async":"yL84","../util/isDate":"Pk7A","../Subscriber":"+Es2","../Notification":"io6T"}],"QJ+e":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.delayWhen=n;var t=s(require("tslib")),e=require("../Subscriber"),r=require("../Observable"),i=require("../OuterSubscriber"),o=require("../util/subscribeToResult");function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}function n(t,e){return e?function(r){return new p(r,e).lift(new u(t))}:function(e){return e.lift(new u(t))}}var u=function(){function t(t){this.delayDurationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.delayDurationSelector))},t}(),c=function(e){function r(t,r){var i=e.call(this,t)||this;return i.delayDurationSelector=r,i.completed=!1,i.delayNotifierSubscriptions=[],i.index=0,i}return t.__extends(r,e),r.prototype.notifyNext=function(t,e,r,i,o){this.destination.next(t),this.removeSubscription(o),this.tryComplete()},r.prototype.notifyError=function(t,e){this._error(t)},r.prototype.notifyComplete=function(t){var e=this.removeSubscription(t);e&&this.destination.next(e),this.tryComplete()},r.prototype._next=function(t){var e=this.index++;try{var r=this.delayDurationSelector(t,e);r&&this.tryDelay(r,t)}catch(i){this.destination.error(i)}},r.prototype._complete=function(){this.completed=!0,this.tryComplete(),this.unsubscribe()},r.prototype.removeSubscription=function(t){t.unsubscribe();var e=this.delayNotifierSubscriptions.indexOf(t);return-1!==e&&this.delayNotifierSubscriptions.splice(e,1),t.outerValue},r.prototype.tryDelay=function(t,e){var r=(0,o.subscribeToResult)(this,t,e);r&&!r.closed&&(this.destination.add(r),this.delayNotifierSubscriptions.push(r))},r.prototype.tryComplete=function(){this.completed&&0===this.delayNotifierSubscriptions.length&&this.destination.complete()},r}(i.OuterSubscriber),p=function(e){function r(t,r){var i=e.call(this)||this;return i.source=t,i.subscriptionDelay=r,i}return t.__extends(r,e),r.prototype._subscribe=function(t){this.subscriptionDelay.subscribe(new b(t,this.source))},r}(r.Observable),b=function(e){function r(t,r){var i=e.call(this)||this;return i.parent=t,i.source=r,i.sourceSubscribed=!1,i}return t.__extends(r,e),r.prototype._next=function(t){this.subscribeToSource()},r.prototype._error=function(t){this.unsubscribe(),this.parent.error(t)},r.prototype._complete=function(){this.unsubscribe(),this.subscribeToSource()},r.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},r}(e.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2","../Observable":"+1Kv","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"xkf0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.dematerialize=n;var e=r(require("tslib")),t=require("../Subscriber");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}function n(){return function(e){return e.lift(new i)}}var i=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new o(e))},e}(),o=function(t){function r(e){return t.call(this,e)||this}return e.__extends(r,t),r.prototype._next=function(e){e.observe(this.destination)},r}(t.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"E3qE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.distinct=n,exports.DistinctSubscriber=void 0;var e=i(require("tslib")),t=require("../OuterSubscriber"),r=require("../util/subscribeToResult");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}function n(e,t){return function(r){return r.lift(new o(e,t))}}var o=function(){function e(e,t){this.keySelector=e,this.flushes=t}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.keySelector,this.flushes))},e}(),s=function(t){function i(e,i,n){var o=t.call(this,e)||this;return o.keySelector=i,o.values=new Set,n&&o.add((0,r.subscribeToResult)(o,n)),o}return e.__extends(i,t),i.prototype.notifyNext=function(e,t,r,i,n){this.values.clear()},i.prototype.notifyError=function(e,t){this._error(e)},i.prototype._next=function(e){this.keySelector?this._useKeySelector(e):this._finalizeNext(e,e)},i.prototype._useKeySelector=function(e){var t,r=this.destination;try{t=this.keySelector(e)}catch(i){return void r.error(i)}this._finalizeNext(t,e)},i.prototype._finalizeNext=function(e,t){var r=this.values;r.has(e)||(r.add(e),this.destination.next(t))},i}(t.OuterSubscriber);exports.DistinctSubscriber=s;
},{"tslib":"qxUW","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"Td6E":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.distinctUntilChanged=n;var e=r(require("tslib")),t=require("../Subscriber");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}function n(e,t){return function(r){return r.lift(new i(e,t))}}var i=function(){function e(e,t){this.compare=e,this.keySelector=t}return e.prototype.call=function(e,t){return t.subscribe(new o(e,this.compare,this.keySelector))},e}(),o=function(t){function r(e,r,n){var i=t.call(this,e)||this;return i.keySelector=n,i.hasKey=!1,"function"==typeof r&&(i.compare=r),i}return e.__extends(r,t),r.prototype.compare=function(e,t){return e===t},r.prototype._next=function(e){var t;try{var r=this.keySelector;t=r?r(e):e}catch(i){return this.destination.error(i)}var n=!1;if(this.hasKey)try{n=(0,this.compare)(this.key,t)}catch(i){return this.destination.error(i)}else this.hasKey=!0;n||(this.key=t,this.destination.next(e))},r}(t.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"OZhF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.distinctUntilKeyChanged=e;var t=require("./distinctUntilChanged");function e(e,n){return(0,t.distinctUntilChanged)(function(t,i){return n?n(t[e],i[e]):t[e]===i[e]})}
},{"./distinctUntilChanged":"Td6E"}],"uA9W":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.throwIfEmpty=o;var r=n(require("tslib")),t=require("../util/EmptyError"),e=require("../Subscriber");function n(r){if(r&&r.__esModule)return r;var t={};if(null!=r)for(var e in r)if(Object.prototype.hasOwnProperty.call(r,e)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,e):{};n.get||n.set?Object.defineProperty(t,e,n):t[e]=r[e]}return t.default=r,t}function o(r){return void 0===r&&(r=c),function(t){return t.lift(new i(r))}}var i=function(){function r(r){this.errorFactory=r}return r.prototype.call=function(r,t){return t.subscribe(new u(r,this.errorFactory))},r}(),u=function(t){function e(r,e){var n=t.call(this,r)||this;return n.errorFactory=e,n.hasValue=!1,n}return r.__extends(e,t),e.prototype._next=function(r){this.hasValue=!0,this.destination.next(r)},e.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var r=void 0;try{r=this.errorFactory()}catch(t){r=t}this.destination.error(r)},e}(e.Subscriber);function c(){return new t.EmptyError}
},{"tslib":"qxUW","../util/EmptyError":"6ZXy","../Subscriber":"+Es2"}],"FZsI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.take=o;var t=i(require("tslib")),e=require("../Subscriber"),r=require("../util/ArgumentOutOfRangeError"),n=require("../observable/empty");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}function o(t){return function(e){return 0===t?(0,n.empty)():e.lift(new u(t))}}var u=function(){function t(t){if(this.total=t,this.total<0)throw new r.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.total))},t}(),s=function(e){function r(t,r){var n=e.call(this,t)||this;return n.total=r,n.count=0,n}return t.__extends(r,e),r.prototype._next=function(t){var e=this.total,r=++this.count;r<=e&&(this.destination.next(t),r===e&&(this.destination.complete(),this.unsubscribe()))},r}(e.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2","../util/ArgumentOutOfRangeError":"ubev","../observable/empty":"I8Qo"}],"5dDD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.elementAt=f;var e=require("../util/ArgumentOutOfRangeError"),r=require("./filter"),t=require("./throwIfEmpty"),u=require("./defaultIfEmpty"),n=require("./take");function f(f,i){if(f<0)throw new e.ArgumentOutOfRangeError;var o=arguments.length>=2;return function(a){return a.pipe((0,r.filter)(function(e,r){return r===f}),(0,n.take)(1),o?(0,u.defaultIfEmpty)(i):(0,t.throwIfEmpty)(function(){return new e.ArgumentOutOfRangeError}))}}
},{"../util/ArgumentOutOfRangeError":"ubev","./filter":"AJqx","./throwIfEmpty":"uA9W","./defaultIfEmpty":"cKW4","./take":"FZsI"}],"74kY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.endWith=o;var e=require("../observable/concat"),r=require("../observable/of");function o(){for(var o=[],t=0;t<arguments.length;t++)o[t]=arguments[t];return function(t){return(0,e.concat)(t,r.of.apply(void 0,o))}}
},{"../observable/concat":"o1KK","../observable/of":"N4eK"}],"fC2l":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.every=i;var t=r(require("tslib")),e=require("../Subscriber");function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}function i(t,e){return function(r){return r.lift(new n(t,e,r))}}var n=function(){function t(t,e,r){this.predicate=t,this.thisArg=e,this.source=r}return t.prototype.call=function(t,e){return e.subscribe(new o(t,this.predicate,this.thisArg,this.source))},t}(),o=function(e){function r(t,r,i,n){var o=e.call(this,t)||this;return o.predicate=r,o.thisArg=i,o.source=n,o.index=0,o.thisArg=i||o,o}return t.__extends(r,e),r.prototype.notifyComplete=function(t){this.destination.next(t),this.destination.complete()},r.prototype._next=function(t){var e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(r){return void this.destination.error(r)}e||this.notifyComplete(!1)},r.prototype._complete=function(){this.notifyComplete(!0)},r}(e.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"Rfcn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.exhaust=n;var t=i(require("tslib")),e=require("../OuterSubscriber"),r=require("../util/subscribeToResult");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}function n(){return function(t){return t.lift(new o)}}var o=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new s(t))},t}(),s=function(e){function i(t){var r=e.call(this,t)||this;return r.hasCompleted=!1,r.hasSubscription=!1,r}return t.__extends(i,e),i.prototype._next=function(t){this.hasSubscription||(this.hasSubscription=!0,this.add((0,r.subscribeToResult)(this,t)))},i.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},i.prototype.notifyComplete=function(t){this.remove(t),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},i}(e.OuterSubscriber);
},{"tslib":"qxUW","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"KLQj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.exhaustMap=u;var t=s(require("tslib")),e=require("../OuterSubscriber"),r=require("../InnerSubscriber"),i=require("../util/subscribeToResult"),n=require("./map"),o=require("../observable/from");function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}function u(t,e){return e?function(r){return r.pipe(u(function(r,i){return(0,o.from)(t(r,i)).pipe((0,n.map)(function(t,n){return e(r,t,i,n)}))}))}:function(e){return e.lift(new c(t))}}var c=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new p(t,this.project))},t}(),p=function(e){function n(t,r){var i=e.call(this,t)||this;return i.project=r,i.hasSubscription=!1,i.hasCompleted=!1,i.index=0,i}return t.__extends(n,e),n.prototype._next=function(t){this.hasSubscription||this.tryNext(t)},n.prototype.tryNext=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(i){return void this.destination.error(i)}this.hasSubscription=!0,this._innerSub(e,t,r)},n.prototype._innerSub=function(t,e,n){var o=new r.InnerSubscriber(this,void 0,void 0);this.destination.add(o),(0,i.subscribeToResult)(this,t,e,n,o)},n.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},n.prototype.notifyNext=function(t,e,r,i,n){this.destination.next(e)},n.prototype.notifyError=function(t){this.destination.error(t)},n.prototype.notifyComplete=function(t){this.destination.remove(t),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},n}(e.OuterSubscriber);
},{"tslib":"qxUW","../OuterSubscriber":"VHfM","../InnerSubscriber":"wrBi","../util/subscribeToResult":"kr3X","./map":"krfZ","../observable/from":"udX+"}],"sB9h":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.expand=s,exports.ExpandSubscriber=exports.ExpandOperator=void 0;var e=i(require("tslib")),t=require("../OuterSubscriber"),r=require("../util/subscribeToResult");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}function s(e,t,r){return void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===r&&(r=void 0),t=(t||0)<1?Number.POSITIVE_INFINITY:t,function(i){return i.lift(new o(e,t,r))}}var o=function(){function e(e,t,r){this.project=e,this.concurrent=t,this.scheduler=r}return e.prototype.call=function(e,t){return t.subscribe(new n(e,this.project,this.concurrent,this.scheduler))},e}();exports.ExpandOperator=o;var n=function(t){function i(e,r,i,s){var o=t.call(this,e)||this;return o.project=r,o.concurrent=i,o.scheduler=s,o.index=0,o.active=0,o.hasCompleted=!1,i<Number.POSITIVE_INFINITY&&(o.buffer=[]),o}return e.__extends(i,t),i.dispatch=function(e){var t=e.subscriber,r=e.result,i=e.value,s=e.index;t.subscribeToProjection(r,i,s)},i.prototype._next=function(e){var t=this.destination;if(t.closed)this._complete();else{var r=this.index++;if(this.active<this.concurrent){t.next(e);try{var s=(0,this.project)(e,r);if(this.scheduler){var o={subscriber:this,result:s,value:e,index:r};this.destination.add(this.scheduler.schedule(i.dispatch,0,o))}else this.subscribeToProjection(s,e,r)}catch(n){t.error(n)}}else this.buffer.push(e)}},i.prototype.subscribeToProjection=function(e,t,i){this.active++,this.destination.add((0,r.subscribeToResult)(this,e,t,i))},i.prototype._complete=function(){this.hasCompleted=!0,this.hasCompleted&&0===this.active&&this.destination.complete(),this.unsubscribe()},i.prototype.notifyNext=function(e,t,r,i,s){this._next(t)},i.prototype.notifyComplete=function(e){var t=this.buffer;this.destination.remove(e),this.active--,t&&t.length>0&&this._next(t.shift()),this.hasCompleted&&0===this.active&&this.destination.complete()},i}(t.OuterSubscriber);exports.ExpandSubscriber=n;
},{"tslib":"qxUW","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"kuiD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.finalize=i;var e=n(require("tslib")),r=require("../Subscriber"),t=require("../Subscription");function n(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}function i(e){return function(r){return r.lift(new u(e))}}var u=function(){function e(e){this.callback=e}return e.prototype.call=function(e,r){return r.subscribe(new c(e,this.callback))},e}(),c=function(r){function n(e,n){var i=r.call(this,e)||this;return i.add(new t.Subscription(n)),i}return e.__extends(n,r),n}(r.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2","../Subscription":"ab35"}],"SQVa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.find=i,exports.FindValueSubscriber=exports.FindValueOperator=void 0;var e=r(require("tslib")),t=require("../Subscriber");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}function i(e,t){if("function"!=typeof e)throw new TypeError("predicate is not a function");return function(r){return r.lift(new n(e,r,!1,t))}}var n=function(){function e(e,t,r,i){this.predicate=e,this.source=t,this.yieldIndex=r,this.thisArg=i}return e.prototype.call=function(e,t){return t.subscribe(new o(e,this.predicate,this.source,this.yieldIndex,this.thisArg))},e}();exports.FindValueOperator=n;var o=function(t){function r(e,r,i,n,o){var s=t.call(this,e)||this;return s.predicate=r,s.source=i,s.yieldIndex=n,s.thisArg=o,s.index=0,s}return e.__extends(r,t),r.prototype.notifyComplete=function(e){var t=this.destination;t.next(e),t.complete(),this.unsubscribe()},r.prototype._next=function(e){var t=this.predicate,r=this.thisArg,i=this.index++;try{t.call(r||this,e,i,this.source)&&this.notifyComplete(this.yieldIndex?i:e)}catch(n){this.destination.error(n)}},r.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},r}(t.Subscriber);exports.FindValueSubscriber=o;
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"nimY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.findIndex=r;var e=require("../operators/find");function r(r,t){return function(n){return n.lift(new e.FindValueOperator(r,n,!0,t))}}
},{"../operators/find":"SQVa"}],"umi5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.first=f;var r=require("../util/EmptyError"),e=require("./filter"),t=require("./take"),i=require("./defaultIfEmpty"),u=require("./throwIfEmpty"),n=require("../util/identity");function f(f,o){var p=arguments.length>=2;return function(l){return l.pipe(f?(0,e.filter)(function(r,e){return f(r,e,l)}):n.identity,(0,t.take)(1),p?(0,i.defaultIfEmpty)(o):(0,u.throwIfEmpty)(function(){return new r.EmptyError}))}}
},{"../util/EmptyError":"6ZXy","./filter":"AJqx","./take":"FZsI","./defaultIfEmpty":"cKW4","./throwIfEmpty":"uA9W","../util/identity":"UYfx"}],"e5+C":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ignoreElements=n;var e=t(require("tslib")),r=require("../Subscriber");function t(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}function n(){return function(e){return e.lift(new i)}}var i=function(){function e(){}return e.prototype.call=function(e,r){return r.subscribe(new o(e))},e}(),o=function(r){function t(){return null!==r&&r.apply(this,arguments)||this}return e.__extends(t,r),t.prototype._next=function(e){},t}(r.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"Envu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isEmpty=n;var t=r(require("tslib")),e=require("../Subscriber");function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}function n(){return function(t){return t.lift(new o)}}var o=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new i(t))},t}(),i=function(e){function r(t){return e.call(this,t)||this}return t.__extends(r,e),r.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete()},r.prototype._next=function(t){this.notifyComplete(!1)},r.prototype._complete=function(){this.notifyComplete(!0)},r}(e.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"qBpl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.takeLast=o;var t=i(require("tslib")),e=require("../Subscriber"),r=require("../util/ArgumentOutOfRangeError"),n=require("../observable/empty");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}function o(t){return function(e){return 0===t?(0,n.empty)():e.lift(new u(t))}}var u=function(){function t(t){if(this.total=t,this.total<0)throw new r.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.total))},t}(),s=function(e){function r(t,r){var n=e.call(this,t)||this;return n.total=r,n.ring=new Array,n.count=0,n}return t.__extends(r,e),r.prototype._next=function(t){var e=this.ring,r=this.total,n=this.count++;e.length<r?e.push(t):e[n%r]=t},r.prototype._complete=function(){var t=this.destination,e=this.count;if(e>0)for(var r=this.count>=this.total?this.total:this.count,n=this.ring,i=0;i<r;i++){var o=e++%r;t.next(n[o])}t.complete()},r}(e.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2","../util/ArgumentOutOfRangeError":"ubev","../observable/empty":"I8Qo"}],"B4io":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.last=f;var t=require("../util/EmptyError"),e=require("./filter"),r=require("./takeLast"),i=require("./throwIfEmpty"),u=require("./defaultIfEmpty"),n=require("../util/identity");function f(f,o){var p=arguments.length>=2;return function(a){return a.pipe(f?(0,e.filter)(function(t,e){return f(t,e,a)}):n.identity,(0,r.takeLast)(1),p?(0,u.defaultIfEmpty)(o):(0,i.throwIfEmpty)(function(){return new t.EmptyError}))}}
},{"../util/EmptyError":"6ZXy","./filter":"AJqx","./takeLast":"qBpl","./throwIfEmpty":"uA9W","./defaultIfEmpty":"cKW4","../util/identity":"UYfx"}],"D9M6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.mapTo=n;var e=r(require("tslib")),t=require("../Subscriber");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}function n(e){return function(t){return t.lift(new i(e))}}var i=function(){function e(e){this.value=e}return e.prototype.call=function(e,t){return t.subscribe(new u(e,this.value))},e}(),u=function(t){function r(e,r){var n=t.call(this,e)||this;return n.value=r,n}return e.__extends(r,t),r.prototype._next=function(e){this.destination.next(this.value)},r}(t.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"3HsG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.materialize=i;var t=n(require("tslib")),e=require("../Subscriber"),r=require("../Notification");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}function i(){return function(t){return t.lift(new o)}}var o=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new c(t))},t}(),c=function(e){function n(t){return e.call(this,t)||this}return t.__extends(n,e),n.prototype._next=function(t){this.destination.next(r.Notification.createNext(t))},n.prototype._error=function(t){var e=this.destination;e.next(r.Notification.createError(t)),e.complete()},n.prototype._complete=function(){var t=this.destination;t.next(r.Notification.createComplete()),t.complete()},n}(e.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2","../Notification":"io6T"}],"zXwg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.scan=i;var e=r(require("tslib")),t=require("../Subscriber");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}function i(e,t){var r=!1;return arguments.length>=2&&(r=!0),function(i){return i.lift(new n(e,t,r))}}var n=function(){function e(e,t,r){void 0===r&&(r=!1),this.accumulator=e,this.seed=t,this.hasSeed=r}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.accumulator,this.seed,this.hasSeed))},e}(),s=function(t){function r(e,r,i,n){var s=t.call(this,e)||this;return s.accumulator=r,s._seed=i,s.hasSeed=n,s.index=0,s}return e.__extends(r,t),Object.defineProperty(r.prototype,"seed",{get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e},enumerable:!0,configurable:!0}),r.prototype._next=function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)},r.prototype._tryNext=function(e){var t,r=this.index++;try{t=this.accumulator(this.seed,e,r)}catch(i){this.destination.error(i)}this.seed=t,this.destination.next(t)},r}(t.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"/M6Z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.reduce=n;var e=require("./scan"),t=require("./takeLast"),r=require("./defaultIfEmpty"),u=require("../util/pipe");function n(n,i){return arguments.length>=2?function(a){return(0,u.pipe)((0,e.scan)(n,i),(0,t.takeLast)(1),(0,r.defaultIfEmpty)(i))(a)}:function(r){return(0,u.pipe)((0,e.scan)(function(e,t,r){return n(e,t,r+1)}),(0,t.takeLast)(1))(r)}}
},{"./scan":"zXwg","./takeLast":"qBpl","./defaultIfEmpty":"cKW4","../util/pipe":"8Vx0"}],"TovV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.max=r;var e=require("./reduce");function r(r){var t="function"==typeof r?function(e,t){return r(e,t)>0?e:t}:function(e,r){return e>r?e:r};return(0,e.reduce)(t)}
},{"./reduce":"/M6Z"}],"erCu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.merge=r;var e=require("../observable/merge");function r(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return function(t){return t.lift.call(e.merge.apply(void 0,[t].concat(r)))}}
},{"../observable/merge":"zbcP"}],"n+GI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.mergeMapTo=r;var e=require("./mergeMap");function r(r,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof t?(0,e.mergeMap)(function(){return r},t,n):("number"==typeof t&&(n=t),(0,e.mergeMap)(function(){return r},n))}
},{"./mergeMap":"bWJj"}],"bUKq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.mergeScan=s,exports.MergeScanSubscriber=exports.MergeScanOperator=void 0;var t=n(require("tslib")),e=require("../util/subscribeToResult"),r=require("../OuterSubscriber"),i=require("../InnerSubscriber");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}function s(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),function(i){return i.lift(new o(t,e,r))}}var o=function(){function t(t,e,r){this.accumulator=t,this.seed=e,this.concurrent=r}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.accumulator,this.seed,this.concurrent))},t}();exports.MergeScanOperator=o;var c=function(r){function n(t,e,i,n){var s=r.call(this,t)||this;return s.accumulator=e,s.acc=i,s.concurrent=n,s.hasValue=!1,s.hasCompleted=!1,s.buffer=[],s.active=0,s.index=0,s}return t.__extends(n,r),n.prototype._next=function(t){if(this.active<this.concurrent){var e=this.index++,r=this.destination,i=void 0;try{i=(0,this.accumulator)(this.acc,t,e)}catch(n){return r.error(n)}this.active++,this._innerSub(i,t,e)}else this.buffer.push(t)},n.prototype._innerSub=function(t,r,n){var s=new i.InnerSubscriber(this,void 0,void 0);this.destination.add(s),(0,e.subscribeToResult)(this,t,r,n,s)},n.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete()),this.unsubscribe()},n.prototype.notifyNext=function(t,e,r,i,n){var s=this.destination;this.acc=e,this.hasValue=!0,s.next(e)},n.prototype.notifyComplete=function(t){var e=this.buffer;this.destination.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},n}(r.OuterSubscriber);exports.MergeScanSubscriber=c;
},{"tslib":"qxUW","../util/subscribeToResult":"kr3X","../OuterSubscriber":"VHfM","../InnerSubscriber":"wrBi"}],"+cdK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.min=r;var e=require("./reduce");function r(r){var t="function"==typeof r?function(e,t){return r(e,t)<0?e:t}:function(e,r){return e<r?e:r};return(0,e.reduce)(t)}
},{"./reduce":"/M6Z"}],"MdA6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.multicast=e,exports.MulticastOperator=void 0;var t=require("../observable/ConnectableObservable");function e(e,c){return function(o){var n;if(n="function"==typeof e?e:function(){return e},"function"==typeof c)return o.lift(new r(n,c));var s=Object.create(o,t.connectableObservableDescriptor);return s.source=o,s.subjectFactory=n,s}}var r=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var r=this.selector,c=this.subjectFactory(),o=r(c).subscribe(t);return o.add(e.subscribe(c)),o},t}();exports.MulticastOperator=r;
},{"../observable/ConnectableObservable":"Jnv2"}],"Lfx6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.onErrorResumeNext=u,exports.onErrorResumeNextStatic=c;var e=s(require("tslib")),r=require("../observable/from"),t=require("../util/isArray"),i=require("../OuterSubscriber"),o=require("../InnerSubscriber"),n=require("../util/subscribeToResult");function s(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};i.get||i.set?Object.defineProperty(r,t,i):r[t]=e[t]}return r.default=e,r}function u(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return 1===e.length&&(0,t.isArray)(e[0])&&(e=e[0]),function(r){return r.lift(new b(e))}}function c(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var o;return 1===e.length&&(0,t.isArray)(e[0])&&(e=e[0]),o=e.shift(),(0,r.from)(o,null).lift(new b(e))}var b=function(){function e(e){this.nextSources=e}return e.prototype.call=function(e,r){return r.subscribe(new f(e,this.nextSources))},e}(),f=function(r){function t(e,t){var i=r.call(this,e)||this;return i.destination=e,i.nextSources=t,i}return e.__extends(t,r),t.prototype.notifyError=function(e,r){this.subscribeToNextSource()},t.prototype.notifyComplete=function(e){this.subscribeToNextSource()},t.prototype._error=function(e){this.subscribeToNextSource(),this.unsubscribe()},t.prototype._complete=function(){this.subscribeToNextSource(),this.unsubscribe()},t.prototype.subscribeToNextSource=function(){var e=this.nextSources.shift();if(e){var r=new o.InnerSubscriber(this,void 0,void 0);this.destination.add(r),(0,n.subscribeToResult)(this,e,void 0,void 0,r)}else this.destination.complete()},t}(i.OuterSubscriber);
},{"tslib":"qxUW","../observable/from":"udX+","../util/isArray":"aAcO","../OuterSubscriber":"VHfM","../InnerSubscriber":"wrBi","../util/subscribeToResult":"kr3X"}],"2AYp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pairwise=n;var e=t(require("tslib")),r=require("../Subscriber");function t(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};n.get||n.set?Object.defineProperty(r,t,n):r[t]=e[t]}return r.default=e,r}function n(){return function(e){return e.lift(new i)}}var i=function(){function e(){}return e.prototype.call=function(e,r){return r.subscribe(new o(e))},e}(),o=function(r){function t(e){var t=r.call(this,e)||this;return t.hasPrev=!1,t}return e.__extends(t,r),t.prototype._next=function(e){var r;this.hasPrev?r=[this.prev,e]:this.hasPrev=!0,this.prev=e,r&&this.destination.next(r)},t}(r.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"5Vv/":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.partition=t;var e=require("../util/not"),r=require("./filter");function t(t,i){return function(n){return[(0,r.filter)(t,i)(n),(0,r.filter)((0,e.not)(t,i))(n)]}}
},{"../util/not":"dH5v","./filter":"AJqx"}],"/Bc3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pluck=e;var r=require("./map");function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=e.length;if(0===o)throw new Error("list of properties cannot be empty.");return function(n){return(0,r.map)(t(e,o))(n)}}function t(r,e){return function(t){for(var n=t,o=0;o<e;o++){var u=n[r[o]];if(void 0===u)return;n=u}return n}}
},{"./map":"krfZ"}],"SAj0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.publish=u;var e=require("../Subject"),t=require("./multicast");function u(u){return u?(0,t.multicast)(function(){return new e.Subject},u):(0,t.multicast)(new e.Subject)}
},{"../Subject":"Drrb","./multicast":"MdA6"}],"Ns3t":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.publishBehavior=t;var e=require("../BehaviorSubject"),r=require("./multicast");function t(t){return function(u){return(0,r.multicast)(new e.BehaviorSubject(t))(u)}}
},{"../BehaviorSubject":"is7q","./multicast":"MdA6"}],"c/kZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.publishLast=r;var e=require("../AsyncSubject"),t=require("./multicast");function r(){return function(r){return(0,t.multicast)(new e.AsyncSubject)(r)}}
},{"../AsyncSubject":"0X8v","./multicast":"MdA6"}],"8GhN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.publishReplay=u;var e=require("../ReplaySubject"),t=require("./multicast");function u(u,r,n,i){n&&"function"!=typeof n&&(i=n);var o="function"==typeof n?n:void 0,c=new e.ReplaySubject(u,r,i);return function(e){return(0,t.multicast)(function(){return c},o)(e)}}
},{"../ReplaySubject":"H1hQ","./multicast":"MdA6"}],"mH+d":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.race=t;var r=require("../util/isArray"),e=require("../observable/race");function t(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return function(a){return 1===t.length&&(0,r.isArray)(t[0])&&(t=t[0]),a.lift.call(e.race.apply(void 0,[a].concat(t)))}}
},{"../util/isArray":"aAcO","../observable/race":"mhkV"}],"5h/r":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.repeat=n;var e=i(require("tslib")),t=require("../Subscriber"),r=require("../observable/empty");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}function n(e){return void 0===e&&(e=-1),function(t){return 0===e?(0,r.empty)():e<0?t.lift(new o(-1,t)):t.lift(new o(e-1,t))}}var o=function(){function e(e,t){this.count=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new u(e,this.count,this.source))},e}(),u=function(t){function r(e,r,i){var n=t.call(this,e)||this;return n.count=r,n.source=i,n}return e.__extends(r,t),r.prototype.complete=function(){if(!this.isStopped){var e=this.source,r=this.count;if(0===r)return t.prototype.complete.call(this);r>-1&&(this.count=r-1),e.subscribe(this._unsubscribeAndRecycle())}},r}(t.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2","../observable/empty":"I8Qo"}],"HNzm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.repeatWhen=n;var t=s(require("tslib")),e=require("../Subject"),i=require("../OuterSubscriber"),r=require("../util/subscribeToResult");function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};r.get||r.set?Object.defineProperty(e,i,r):e[i]=t[i]}return e.default=t,e}function n(t){return function(e){return e.lift(new o(t))}}var o=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.notifier,e))},t}(),u=function(i){function s(t,e,r){var s=i.call(this,t)||this;return s.notifier=e,s.source=r,s.sourceIsBeingSubscribedTo=!0,s}return t.__extends(s,i),s.prototype.notifyNext=function(t,e,i,r,s){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},s.prototype.notifyComplete=function(t){if(!1===this.sourceIsBeingSubscribedTo)return i.prototype.complete.call(this)},s.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return i.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next()}},s.prototype._unsubscribe=function(){var t=this.notifications,e=this.retriesSubscription;t&&(t.unsubscribe(),this.notifications=null),e&&(e.unsubscribe(),this.retriesSubscription=null),this.retries=null},s.prototype._unsubscribeAndRecycle=function(){var t=this._unsubscribe;return this._unsubscribe=null,i.prototype._unsubscribeAndRecycle.call(this),this._unsubscribe=t,this},s.prototype.subscribeToRetries=function(){var t;this.notifications=new e.Subject;try{t=(0,this.notifier)(this.notifications)}catch(s){return i.prototype.complete.call(this)}this.retries=t,this.retriesSubscription=(0,r.subscribeToResult)(this,t)},s}(i.OuterSubscriber);
},{"tslib":"qxUW","../Subject":"Drrb","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"NQbw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.retry=n;var r=e(require("tslib")),t=require("../Subscriber");function e(r){if(r&&r.__esModule)return r;var t={};if(null!=r)for(var e in r)if(Object.prototype.hasOwnProperty.call(r,e)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,e):{};n.get||n.set?Object.defineProperty(t,e,n):t[e]=r[e]}return t.default=r,t}function n(r){return void 0===r&&(r=-1),function(t){return t.lift(new i(r,t))}}var i=function(){function r(r,t){this.count=r,this.source=t}return r.prototype.call=function(r,t){return t.subscribe(new o(r,this.count,this.source))},r}(),o=function(t){function e(r,e,n){var i=t.call(this,r)||this;return i.count=e,i.source=n,i}return r.__extends(e,t),e.prototype.error=function(r){if(!this.isStopped){var e=this.source,n=this.count;if(0===n)return t.prototype.error.call(this,r);n>-1&&(this.count=n-1),e.subscribe(this._unsubscribeAndRecycle())}},e}(t.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"I63F":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.retryWhen=u;var r=s(require("tslib")),e=require("../Subject"),t=require("../OuterSubscriber"),i=require("../util/subscribeToResult");function s(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)if(Object.prototype.hasOwnProperty.call(r,t)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(r,t):{};i.get||i.set?Object.defineProperty(e,t,i):e[t]=r[t]}return e.default=r,e}function u(r){return function(e){return e.lift(new n(r,e))}}var n=function(){function r(r,e){this.notifier=r,this.source=e}return r.prototype.call=function(r,e){return e.subscribe(new o(r,this.notifier,this.source))},r}(),o=function(t){function s(r,e,i){var s=t.call(this,r)||this;return s.notifier=e,s.source=i,s}return r.__extends(s,t),s.prototype.error=function(r){if(!this.isStopped){var s=this.errors,u=this.retries,n=this.retriesSubscription;if(u)this.errors=null,this.retriesSubscription=null;else{s=new e.Subject;try{u=(0,this.notifier)(s)}catch(o){return t.prototype.error.call(this,o)}n=(0,i.subscribeToResult)(this,u)}this._unsubscribeAndRecycle(),this.errors=s,this.retries=u,this.retriesSubscription=n,s.next(r)}},s.prototype._unsubscribe=function(){var r=this.errors,e=this.retriesSubscription;r&&(r.unsubscribe(),this.errors=null),e&&(e.unsubscribe(),this.retriesSubscription=null),this.retries=null},s.prototype.notifyNext=function(r,e,t,i,s){var u=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=u,this.source.subscribe(this)},s}(t.OuterSubscriber);
},{"tslib":"qxUW","../Subject":"Drrb","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"JXuq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.sample=n;var t=i(require("tslib")),e=require("../OuterSubscriber"),r=require("../util/subscribeToResult");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}function n(t){return function(e){return e.lift(new u(t))}}var u=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var i=new o(t),n=e.subscribe(i);return n.add((0,r.subscribeToResult)(i,this.notifier)),n},t}(),o=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasValue=!1,t}return t.__extends(r,e),r.prototype._next=function(t){this.value=t,this.hasValue=!0},r.prototype.notifyNext=function(t,e,r,i,n){this.emitValue()},r.prototype.notifyComplete=function(){this.emitValue()},r.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},r}(e.OuterSubscriber);
},{"tslib":"qxUW","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"t6Lb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.sampleTime=n;var e=i(require("tslib")),t=require("../Subscriber"),r=require("../scheduler/async");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}function n(e,t){return void 0===t&&(t=r.async),function(r){return r.lift(new s(e,t))}}var s=function(){function e(e,t){this.period=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new u(e,this.period,this.scheduler))},e}(),u=function(t){function r(e,r,i){var n=t.call(this,e)||this;return n.period=r,n.scheduler=i,n.hasValue=!1,n.add(i.schedule(o,r,{subscriber:n,period:r})),n}return e.__extends(r,t),r.prototype._next=function(e){this.lastValue=e,this.hasValue=!0},r.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))},r}(t.Subscriber);function o(e){var t=e.subscriber,r=e.period;t.notifyNext(),this.schedule(e,r)}
},{"tslib":"qxUW","../Subscriber":"+Es2","../scheduler/async":"yL84"}],"YiLY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.sequenceEqual=o,exports.SequenceEqualSubscriber=exports.SequenceEqualOperator=void 0;var t=r(require("tslib")),e=require("../Subscriber");function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};o.get||o.set?Object.defineProperty(e,r,o):e[r]=t[r]}return e.default=t,e}function o(t,e){return function(r){return r.lift(new n(t,e))}}var n=function(){function t(t,e){this.compareTo=t,this.comparator=e}return t.prototype.call=function(t,e){return e.subscribe(new i(t,this.compareTo,this.comparator))},t}();exports.SequenceEqualOperator=n;var i=function(e){function r(t,r,o){var n=e.call(this,t)||this;return n.compareTo=r,n.comparator=o,n._a=[],n._b=[],n._oneComplete=!1,n.destination.add(r.subscribe(new s(t,n))),n}return t.__extends(r,e),r.prototype._next=function(t){this._oneComplete&&0===this._b.length?this.emit(!1):(this._a.push(t),this.checkValues())},r.prototype._complete=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0,this.unsubscribe()},r.prototype.checkValues=function(){for(var t=this._a,e=this._b,r=this.comparator;t.length>0&&e.length>0;){var o=t.shift(),n=e.shift(),i=!1;try{i=r?r(o,n):o===n}catch(s){this.destination.error(s)}i||this.emit(!1)}},r.prototype.emit=function(t){var e=this.destination;e.next(t),e.complete()},r.prototype.nextB=function(t){this._oneComplete&&0===this._a.length?this.emit(!1):(this._b.push(t),this.checkValues())},r.prototype.completeB=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0},r}(e.Subscriber);exports.SequenceEqualSubscriber=i;var s=function(e){function r(t,r){var o=e.call(this,t)||this;return o.parent=r,o}return t.__extends(r,e),r.prototype._next=function(t){this.parent.nextB(t)},r.prototype._error=function(t){this.parent.error(t),this.unsubscribe()},r.prototype._complete=function(){this.parent.completeB(),this.unsubscribe()},r}(e.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"VOv+":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.share=n;var e=require("./multicast"),r=require("./refCount"),t=require("../Subject");function u(){return new t.Subject}function n(){return function(t){return(0,r.refCount)()((0,e.multicast)(u)(t))}}
},{"./multicast":"MdA6","./refCount":"Ux37","../Subject":"Drrb"}],"ihqz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shareReplay=r;var e=require("../ReplaySubject");function r(e,r,t){var n;return n=e&&"object"==typeof e?e:{bufferSize:e,windowTime:r,refCount:!1,scheduler:t},function(e){return e.lift(u(n))}}function u(r){var u,t,n=r.bufferSize,i=void 0===n?Number.POSITIVE_INFINITY:n,o=r.windowTime,c=void 0===o?Number.POSITIVE_INFINITY:o,s=r.refCount,f=r.scheduler,b=0,d=!1,a=!1;return function(r){b++,u&&!d||(d=!1,u=new e.ReplaySubject(i,c,f),t=r.subscribe({next:function(e){u.next(e)},error:function(e){d=!0,u.error(e)},complete:function(){a=!0,u.complete()}}));var n=u.subscribe(this);this.add(function(){b--,n.unsubscribe(),t&&!a&&s&&0===b&&(t.unsubscribe(),t=void 0,u=void 0)})}}
},{"../ReplaySubject":"H1hQ"}],"frLT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.single=n;var e=i(require("tslib")),t=require("../Subscriber"),r=require("../util/EmptyError");function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}function n(e){return function(t){return t.lift(new o(e,t))}}var o=function(){function e(e,t){this.predicate=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.predicate,this.source))},e}(),s=function(t){function i(e,r,i){var n=t.call(this,e)||this;return n.predicate=r,n.source=i,n.seenValue=!1,n.index=0,n}return e.__extends(i,t),i.prototype.applySingleValue=function(e){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=e)},i.prototype._next=function(e){var t=this.index++;this.predicate?this.tryNext(e,t):this.applySingleValue(e)},i.prototype.tryNext=function(e,t){try{this.predicate(e,t,this.source)&&this.applySingleValue(e)}catch(r){this.destination.error(r)}},i.prototype._complete=function(){var e=this.destination;this.index>0?(e.next(this.seenValue?this.singleValue:void 0),e.complete()):e.error(new r.EmptyError)},i}(t.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2","../util/EmptyError":"6ZXy"}],"AYHj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.skip=n;var t=r(require("tslib")),e=require("../Subscriber");function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}function n(t){return function(e){return e.lift(new i(t))}}var i=function(){function t(t){this.total=t}return t.prototype.call=function(t,e){return e.subscribe(new o(t,this.total))},t}(),o=function(e){function r(t,r){var n=e.call(this,t)||this;return n.total=r,n.count=0,n}return t.__extends(r,e),r.prototype._next=function(t){++this.count>this.total&&this.destination.next(t)},r}(e.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"h2HR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.skipLast=i;var t=n(require("tslib")),r=require("../Subscriber"),e=require("../util/ArgumentOutOfRangeError");function n(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,e):{};n.get||n.set?Object.defineProperty(r,e,n):r[e]=t[e]}return r.default=t,r}function i(t){return function(r){return r.lift(new u(t))}}var u=function(){function t(t){if(this._skipCount=t,this._skipCount<0)throw new e.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return 0===this._skipCount?e.subscribe(new r.Subscriber(t)):e.subscribe(new o(t,this._skipCount))},t}(),o=function(r){function e(t,e){var n=r.call(this,t)||this;return n._skipCount=e,n._count=0,n._ring=new Array(e),n}return t.__extends(e,r),e.prototype._next=function(t){var r=this._skipCount,e=this._count++;if(e<r)this._ring[e]=t;else{var n=e%r,i=this._ring,u=i[n];i[n]=t,this.destination.next(u)}},e}(r.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2","../util/ArgumentOutOfRangeError":"ubev"}],"zBcu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.skipUntil=o;var e=n(require("tslib")),t=require("../OuterSubscriber"),r=require("../InnerSubscriber"),i=require("../util/subscribeToResult");function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}function o(e){return function(t){return t.lift(new u(e))}}var u=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.notifier))},e}(),s=function(t){function n(e,n){var o=t.call(this,e)||this;o.hasValue=!1;var u=new r.InnerSubscriber(o,void 0,void 0);return o.add(u),o.innerSubscription=u,(0,i.subscribeToResult)(o,n,void 0,void 0,u),o}return e.__extends(n,t),n.prototype._next=function(e){this.hasValue&&t.prototype._next.call(this,e)},n.prototype.notifyNext=function(e,t,r,i,n){this.hasValue=!0,this.innerSubscription&&this.innerSubscription.unsubscribe()},n.prototype.notifyComplete=function(){},n}(t.OuterSubscriber);
},{"tslib":"qxUW","../OuterSubscriber":"VHfM","../InnerSubscriber":"wrBi","../util/subscribeToResult":"kr3X"}],"myb6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.skipWhile=i;var t=r(require("tslib")),e=require("../Subscriber");function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}function i(t){return function(e){return e.lift(new n(t))}}var n=function(){function t(t){this.predicate=t}return t.prototype.call=function(t,e){return e.subscribe(new o(t,this.predicate))},t}(),o=function(e){function r(t,r){var i=e.call(this,t)||this;return i.predicate=r,i.skipping=!0,i.index=0,i}return t.__extends(r,e),r.prototype._next=function(t){var e=this.destination;this.skipping&&this.tryCallPredicate(t),this.skipping||e.next(t)},r.prototype.tryCallPredicate=function(t){try{var e=this.predicate(t,this.index++);this.skipping=Boolean(e)}catch(r){this.destination.error(r)}},r}(e.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"kuBz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.startWith=t;var e=require("../observable/concat"),r=require("../util/isScheduler");function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var u=t[t.length-1];return(0,r.isScheduler)(u)?(t.pop(),function(r){return(0,e.concat)(t,r,u)}):function(r){return(0,e.concat)(t,r)}}
},{"../observable/concat":"o1KK","../util/isScheduler":"RN4p"}],"w/Gc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SubscribeOnObservable=void 0;var e=i(require("tslib")),r=require("../Observable"),t=require("../scheduler/asap"),s=require("../util/isNumeric");function i(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var s=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};s.get||s.set?Object.defineProperty(r,t,s):r[t]=e[t]}return r.default=e,r}var u=function(r){function i(e,i,u){void 0===i&&(i=0),void 0===u&&(u=t.asap);var c=r.call(this)||this;return c.source=e,c.delayTime=i,c.scheduler=u,(!(0,s.isNumeric)(i)||i<0)&&(c.delayTime=0),u&&"function"==typeof u.schedule||(c.scheduler=t.asap),c}return e.__extends(i,r),i.create=function(e,r,s){return void 0===r&&(r=0),void 0===s&&(s=t.asap),new i(e,r,s)},i.dispatch=function(e){var r=e.source,t=e.subscriber;return this.add(r.subscribe(t))},i.prototype._subscribe=function(e){var r=this.delayTime,t=this.source;return this.scheduler.schedule(i.dispatch,r,{source:t,subscriber:e})},i}(r.Observable);exports.SubscribeOnObservable=u;
},{"tslib":"qxUW","../Observable":"+1Kv","../scheduler/asap":"TfHP","../util/isNumeric":"qT3A"}],"Ya9t":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.subscribeOn=r;var e=require("../observable/SubscribeOnObservable");function r(e,r){return void 0===r&&(r=0),function(n){return n.lift(new t(e,r))}}var t=function(){function r(e,r){this.scheduler=e,this.delay=r}return r.prototype.call=function(r,t){return new e.SubscribeOnObservable(t,this.delay,this.scheduler).subscribe(r)},r}();
},{"../observable/SubscribeOnObservable":"w/Gc"}],"L25Y":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.switchMap=s;var t=u(require("tslib")),e=require("../OuterSubscriber"),r=require("../InnerSubscriber"),i=require("../util/subscribeToResult"),n=require("./map"),o=require("../observable/from");function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}function s(t,e){return"function"==typeof e?function(r){return r.pipe(s(function(r,i){return(0,o.from)(t(r,i)).pipe((0,n.map)(function(t,n){return e(r,t,i,n)}))}))}:function(e){return e.lift(new c(t))}}var c=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new p(t,this.project))},t}(),p=function(e){function n(t,r){var i=e.call(this,t)||this;return i.project=r,i.index=0,i}return t.__extends(n,e),n.prototype._next=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(i){return void this.destination.error(i)}this._innerSub(e,t,r)},n.prototype._innerSub=function(t,e,n){var o=this.innerSubscription;o&&o.unsubscribe();var u=new r.InnerSubscriber(this,void 0,void 0);this.destination.add(u),this.innerSubscription=(0,i.subscribeToResult)(this,t,e,n,u)},n.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this),this.unsubscribe()},n.prototype._unsubscribe=function(){this.innerSubscription=null},n.prototype.notifyComplete=function(t){this.destination.remove(t),this.innerSubscription=null,this.isStopped&&e.prototype._complete.call(this)},n.prototype.notifyNext=function(t,e,r,i,n){this.destination.next(e)},n}(e.OuterSubscriber);
},{"tslib":"qxUW","../OuterSubscriber":"VHfM","../InnerSubscriber":"wrBi","../util/subscribeToResult":"kr3X","./map":"krfZ","../observable/from":"udX+"}],"NZNN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.switchAll=i;var e=require("./switchMap"),t=require("../util/identity");function i(){return(0,e.switchMap)(t.identity)}
},{"./switchMap":"L25Y","../util/identity":"UYfx"}],"ilqN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.switchMapTo=e;var t=require("./switchMap");function e(e,r){return r?(0,t.switchMap)(function(){return e},r):(0,t.switchMap)(function(){return e})}
},{"./switchMap":"L25Y"}],"4Ru4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.takeUntil=i;var e=n(require("tslib")),t=require("../OuterSubscriber"),r=require("../util/subscribeToResult");function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}function i(e){return function(t){return t.lift(new u(e))}}var u=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){var n=new o(e),i=(0,r.subscribeToResult)(n,this.notifier);return i&&!n.seenValue?(n.add(i),t.subscribe(n)):n},e}(),o=function(t){function r(e){var r=t.call(this,e)||this;return r.seenValue=!1,r}return e.__extends(r,t),r.prototype.notifyNext=function(e,t,r,n,i){this.seenValue=!0,this.complete()},r.prototype.notifyComplete=function(){},r}(t.OuterSubscriber);
},{"tslib":"qxUW","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"dVOf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.takeWhile=i;var e=r(require("tslib")),t=require("../Subscriber");function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};i.get||i.set?Object.defineProperty(t,r,i):t[r]=e[r]}return t.default=e,t}function i(e,t){return void 0===t&&(t=!1),function(r){return r.lift(new n(e,t))}}var n=function(){function e(e,t){this.predicate=e,this.inclusive=t}return e.prototype.call=function(e,t){return t.subscribe(new o(e,this.predicate,this.inclusive))},e}(),o=function(t){function r(e,r,i){var n=t.call(this,e)||this;return n.predicate=r,n.inclusive=i,n.index=0,n}return e.__extends(r,t),r.prototype._next=function(e){var t,r=this.destination;try{t=this.predicate(e,this.index++)}catch(i){return void r.error(i)}this.nextOrComplete(e,t)},r.prototype.nextOrComplete=function(e,t){var r=this.destination;Boolean(t)?r.next(e):(this.inclusive&&r.next(e),r.complete())},r}(t.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2"}],"UMSv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.tap=i;var t=n(require("tslib")),e=require("../Subscriber"),r=require("../util/noop"),o=require("../util/isFunction");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};o.get||o.set?Object.defineProperty(e,r,o):e[r]=t[r]}return e.default=t,e}function i(t,e,r){return function(o){return o.lift(new p(t,e,r))}}var p=function(){function t(t,e,r){this.nextOrObserver=t,this.error=e,this.complete=r}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.nextOrObserver,this.error,this.complete))},t}(),c=function(e){function n(t,n,i,p){var c=e.call(this,t)||this;return c._tapNext=r.noop,c._tapError=r.noop,c._tapComplete=r.noop,c._tapError=i||r.noop,c._tapComplete=p||r.noop,(0,o.isFunction)(n)?(c._context=c,c._tapNext=n):n&&(c._context=n,c._tapNext=n.next||r.noop,c._tapError=n.error||r.noop,c._tapComplete=n.complete||r.noop),c}return t.__extends(n,e),n.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)},n.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)},n.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},n}(e.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2","../util/noop":"WRNt","../util/isFunction":"s5lC"}],"7IHZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.throttle=o,exports.defaultThrottleConfig=void 0;var t=i(require("tslib")),e=require("../OuterSubscriber"),r=require("../util/subscribeToResult");function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};i.get||i.set?Object.defineProperty(e,r,i):e[r]=t[r]}return e.default=t,e}var n={leading:!0,trailing:!1};function o(t,e){return void 0===e&&(e=n),function(r){return r.lift(new s(t,e.leading,e.trailing))}}exports.defaultThrottleConfig=n;var s=function(){function t(t,e,r){this.durationSelector=t,this.leading=e,this.trailing=r}return t.prototype.call=function(t,e){return e.subscribe(new l(t,this.durationSelector,this.leading,this.trailing))},t}(),l=function(e){function i(t,r,i,n){var o=e.call(this,t)||this;return o.destination=t,o.durationSelector=r,o._leading=i,o._trailing=n,o._hasValue=!1,o}return t.__extends(i,e),i.prototype._next=function(t){this._hasValue=!0,this._sendValue=t,this._throttled||(this._leading?this.send():this.throttle(t))},i.prototype.send=function(){var t=this._hasValue,e=this._sendValue;t&&(this.destination.next(e),this.throttle(e)),this._hasValue=!1,this._sendValue=null},i.prototype.throttle=function(t){var e=this.tryDurationSelector(t);e&&this.add(this._throttled=(0,r.subscribeToResult)(this,e))},i.prototype.tryDurationSelector=function(t){try{return this.durationSelector(t)}catch(e){return this.destination.error(e),null}},i.prototype.throttlingDone=function(){var t=this._throttled,e=this._trailing;t&&t.unsubscribe(),this._throttled=null,e&&this.send()},i.prototype.notifyNext=function(t,e,r,i,n){this.throttlingDone()},i.prototype.notifyComplete=function(){this.throttlingDone()},i}(e.OuterSubscriber);
},{"tslib":"qxUW","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"kC0m":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.throttleTime=s;var t=n(require("tslib")),i=require("../Subscriber"),e=require("../scheduler/async"),r=require("./throttle");function n(t){if(t&&t.__esModule)return t;var i={};if(null!=t)for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,e):{};r.get||r.set?Object.defineProperty(i,e,r):i[e]=t[e]}return i.default=t,i}function s(t,i,n){return void 0===i&&(i=e.async),void 0===n&&(n=r.defaultThrottleConfig),function(e){return e.lift(new l(t,i,n.leading,n.trailing))}}var l=function(){function t(t,i,e,r){this.duration=t,this.scheduler=i,this.leading=e,this.trailing=r}return t.prototype.call=function(t,i){return i.subscribe(new a(t,this.duration,this.scheduler,this.leading,this.trailing))},t}(),a=function(i){function e(t,e,r,n,s){var l=i.call(this,t)||this;return l.duration=e,l.scheduler=r,l.leading=n,l.trailing=s,l._hasTrailingValue=!1,l._trailingValue=null,l}return t.__extends(e,i),e.prototype._next=function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(u,this.duration,{subscriber:this})),this.leading?this.destination.next(t):this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0))},e.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},e.prototype.clearThrottle=function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)},e}(i.Subscriber);function u(t){t.subscriber.clearThrottle()}
},{"tslib":"qxUW","../Subscriber":"+Es2","../scheduler/async":"yL84","./throttle":"7IHZ"}],"lii4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.timeInterval=u,exports.TimeInterval=void 0;var e=require("../scheduler/async"),r=require("./scan"),n=require("../observable/defer"),t=require("./map");function u(u){return void 0===u&&(u=e.async),function(e){return(0,n.defer)(function(){return e.pipe((0,r.scan)(function(e,r){var n=e.current;return{value:r,current:u.now(),last:n}},{current:u.now(),value:void 0,last:void 0}),(0,t.map)(function(e){var r=e.current,n=e.last,t=e.value;return new i(t,r-n)}))})}}var i=function(){return function(e,r){this.value=e,this.interval=r}}();exports.TimeInterval=i;
},{"../scheduler/async":"yL84","./scan":"zXwg","../observable/defer":"F/q0","./map":"krfZ"}],"Dwz7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.timeoutWith=o;var t=u(require("tslib")),e=require("../scheduler/async"),i=require("../util/isDate"),r=require("../OuterSubscriber"),s=require("../util/subscribeToResult");function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};r.get||r.set?Object.defineProperty(e,i,r):e[i]=t[i]}return e.default=t,e}function o(t,r,s){return void 0===s&&(s=e.async),function(e){var u=(0,i.isDate)(t),o=u?+t-s.now():Math.abs(t);return e.lift(new n(o,u,r,s))}}var n=function(){function t(t,e,i,r){this.waitFor=t,this.absoluteTimeout=e,this.withObservable=i,this.scheduler=r}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},t}(),c=function(e){function i(t,i,r,s,u){var o=e.call(this,t)||this;return o.absoluteTimeout=i,o.waitFor=r,o.withObservable=s,o.scheduler=u,o.action=null,o.scheduleTimeout(),o}return t.__extends(i,e),i.dispatchTimeout=function(t){var e=t.withObservable;t._unsubscribeAndRecycle(),t.add((0,s.subscribeToResult)(t,e))},i.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(i.dispatchTimeout,this.waitFor,this))},i.prototype._next=function(t){this.absoluteTimeout||this.scheduleTimeout(),e.prototype._next.call(this,t)},i.prototype._unsubscribe=function(){this.action=null,this.scheduler=null,this.withObservable=null},i}(r.OuterSubscriber);
},{"tslib":"qxUW","../scheduler/async":"yL84","../util/isDate":"Pk7A","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"tgQ6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.timeout=i;var r=require("../scheduler/async"),e=require("../util/TimeoutError"),t=require("./timeoutWith"),o=require("../observable/throwError");function i(i,u){return void 0===u&&(u=r.async),(0,t.timeoutWith)(i,(0,o.throwError)(new e.TimeoutError),u)}
},{"../scheduler/async":"yL84","../util/TimeoutError":"vaeu","./timeoutWith":"Dwz7","../observable/throwError":"nAit"}],"R8Kj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.timestamp=r,exports.Timestamp=void 0;var e=require("../scheduler/async"),t=require("./map");function r(r){return void 0===r&&(r=e.async),(0,t.map)(function(e){return new i(e,r.now())})}var i=function(){return function(e,t){this.value=e,this.timestamp=t}}();exports.Timestamp=i;
},{"../scheduler/async":"yL84","./map":"krfZ"}],"1//p":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.toArray=t;var e=require("./reduce");function r(e,r,t){return 0===t?[r]:(e.push(r),e)}function t(){return(0,e.reduce)(r,[])}
},{"./reduce":"/M6Z"}],"3HAF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.window=i;var t=n(require("tslib")),e=require("../Subject"),r=require("../OuterSubscriber"),o=require("../util/subscribeToResult");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};o.get||o.set?Object.defineProperty(e,r,o):e[r]=t[r]}return e.default=t,e}function i(t){return function(e){return e.lift(new u(t))}}var u=function(){function t(t){this.windowBoundaries=t}return t.prototype.call=function(t,e){var r=new s(t),n=e.subscribe(r);return n.closed||r.add((0,o.subscribeToResult)(r,this.windowBoundaries)),n},t}(),s=function(r){function o(t){var o=r.call(this,t)||this;return o.window=new e.Subject,t.next(o.window),o}return t.__extends(o,r),o.prototype.notifyNext=function(t,e,r,o,n){this.openWindow()},o.prototype.notifyError=function(t,e){this._error(t)},o.prototype.notifyComplete=function(t){this._complete()},o.prototype._next=function(t){this.window.next(t)},o.prototype._error=function(t){this.window.error(t),this.destination.error(t)},o.prototype._complete=function(){this.window.complete(),this.destination.complete()},o.prototype._unsubscribe=function(){this.window=null},o.prototype.openWindow=function(){var t=this.window;t&&t.complete();var r=this.destination,o=this.window=new e.Subject;r.next(o)},o}(r.OuterSubscriber);
},{"tslib":"qxUW","../Subject":"Drrb","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"fsbz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.windowCount=n;var t=r(require("tslib")),e=require("../Subscriber"),i=require("../Subject");function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};r.get||r.set?Object.defineProperty(e,i,r):e[i]=t[i]}return e.default=t,e}function n(t,e){return void 0===e&&(e=0),function(i){return i.lift(new o(t,e))}}var o=function(){function t(t,e){this.windowSize=t,this.startWindowEvery=e}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.windowSize,this.startWindowEvery))},t}(),s=function(e){function r(t,r,n){var o=e.call(this,t)||this;return o.destination=t,o.windowSize=r,o.startWindowEvery=n,o.windows=[new i.Subject],o.count=0,t.next(o.windows[0]),o}return t.__extends(r,e),r.prototype._next=function(t){for(var e=this.startWindowEvery>0?this.startWindowEvery:this.windowSize,r=this.destination,n=this.windowSize,o=this.windows,s=o.length,c=0;c<s&&!this.closed;c++)o[c].next(t);var u=this.count-n+1;if(u>=0&&u%e==0&&!this.closed&&o.shift().complete(),++this.count%e==0&&!this.closed){var w=new i.Subject;o.push(w),r.next(w)}},r.prototype._error=function(t){var e=this.windows;if(e)for(;e.length>0&&!this.closed;)e.shift().error(t);this.destination.error(t)},r.prototype._complete=function(){var t=this.windows;if(t)for(;t.length>0&&!this.closed;)t.shift().complete();this.destination.complete()},r.prototype._unsubscribe=function(){this.count=0,this.windows=null},r}(e.Subscriber);
},{"tslib":"qxUW","../Subscriber":"+Es2","../Subject":"Drrb"}],"9TeG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.windowTime=u;var e=s(require("tslib")),i=require("../Subject"),n=require("../scheduler/async"),t=require("../Subscriber"),r=require("../util/isNumeric"),o=require("../util/isScheduler");function s(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var t=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};t.get||t.set?Object.defineProperty(i,n,t):i[n]=e[n]}return i.default=e,i}function u(e){var i=n.async,t=null,s=Number.POSITIVE_INFINITY;return(0,o.isScheduler)(arguments[3])&&(i=arguments[3]),(0,o.isScheduler)(arguments[2])?i=arguments[2]:(0,r.isNumeric)(arguments[2])&&(s=arguments[2]),(0,o.isScheduler)(arguments[1])?i=arguments[1]:(0,r.isNumeric)(arguments[1])&&(t=arguments[1]),function(n){return n.lift(new c(e,t,s,i))}}var c=function(){function e(e,i,n,t){this.windowTimeSpan=e,this.windowCreationInterval=i,this.maxWindowSize=n,this.scheduler=t}return e.prototype.call=function(e,i){return i.subscribe(new l(e,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))},e}(),d=function(i){function n(){var e=null!==i&&i.apply(this,arguments)||this;return e._numberOfNextedValues=0,e}return e.__extends(n,i),n.prototype.next=function(e){this._numberOfNextedValues++,i.prototype.next.call(this,e)},Object.defineProperty(n.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),n}(i.Subject),l=function(i){function n(e,n,t,r,o){var s=i.call(this,e)||this;s.destination=e,s.windowTimeSpan=n,s.windowCreationInterval=t,s.maxWindowSize=r,s.scheduler=o,s.windows=[];var u=s.openWindow();if(null!==t&&t>=0){var c={subscriber:s,window:u,context:null},d={windowTimeSpan:n,windowCreationInterval:t,subscriber:s,scheduler:o};s.add(o.schedule(p,n,c)),s.add(o.schedule(w,t,d))}else{var l={subscriber:s,window:u,windowTimeSpan:n};s.add(o.schedule(a,n,l))}return s}return e.__extends(n,i),n.prototype._next=function(e){for(var i=this.windows,n=i.length,t=0;t<n;t++){var r=i[t];r.closed||(r.next(e),r.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(r))}},n.prototype._error=function(e){for(var i=this.windows;i.length>0;)i.shift().error(e);this.destination.error(e)},n.prototype._complete=function(){for(var e=this.windows;e.length>0;){var i=e.shift();i.closed||i.complete()}this.destination.complete()},n.prototype.openWindow=function(){var e=new d;return this.windows.push(e),this.destination.next(e),e},n.prototype.closeWindow=function(e){e.complete();var i=this.windows;i.splice(i.indexOf(e),1)},n}(t.Subscriber);function a(e){var i=e.subscriber,n=e.windowTimeSpan,t=e.window;t&&i.closeWindow(t),e.window=i.openWindow(),this.schedule(e,n)}function w(e){var i=e.windowTimeSpan,n=e.subscriber,t=e.scheduler,r=e.windowCreationInterval,o=n.openWindow(),s={action:this,subscription:null},u={subscriber:n,window:o,context:s};s.subscription=t.schedule(p,i,u),this.add(s.subscription),this.schedule(e,r)}function p(e){var i=e.subscriber,n=e.window,t=e.context;t&&t.action&&t.subscription&&t.action.remove(t.subscription),i.closeWindow(n)}
},{"tslib":"qxUW","../Subject":"Drrb","../scheduler/async":"yL84","../Subscriber":"+Es2","../util/isNumeric":"qT3A","../util/isScheduler":"RN4p"}],"t8Wz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.windowToggle=s;var t=n(require("tslib")),e=require("../Subject"),r=require("../Subscription"),o=require("../OuterSubscriber"),i=require("../util/subscribeToResult");function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};o.get||o.set?Object.defineProperty(e,r,o):e[r]=t[r]}return e.default=t,e}function s(t,e){return function(r){return r.lift(new c(t,e))}}var c=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.openings,this.closingSelector))},t}(),u=function(o){function n(t,e,r){var n=o.call(this,t)||this;return n.openings=e,n.closingSelector=r,n.contexts=[],n.add(n.openSubscription=(0,i.subscribeToResult)(n,e,e)),n}return t.__extends(n,o),n.prototype._next=function(t){var e=this.contexts;if(e)for(var r=e.length,o=0;o<r;o++)e[o].window.next(t)},n.prototype._error=function(t){var e=this.contexts;if(this.contexts=null,e)for(var r=e.length,i=-1;++i<r;){var n=e[i];n.window.error(t),n.subscription.unsubscribe()}o.prototype._error.call(this,t)},n.prototype._complete=function(){var t=this.contexts;if(this.contexts=null,t)for(var e=t.length,r=-1;++r<e;){var i=t[r];i.window.complete(),i.subscription.unsubscribe()}o.prototype._complete.call(this)},n.prototype._unsubscribe=function(){var t=this.contexts;if(this.contexts=null,t)for(var e=t.length,r=-1;++r<e;){var o=t[r];o.window.unsubscribe(),o.subscription.unsubscribe()}},n.prototype.notifyNext=function(t,o,n,s,c){if(t===this.openings){var u=void 0;try{u=(0,this.closingSelector)(o)}catch(h){return this.error(h)}var p=new e.Subject,l=new r.Subscription,b={window:p,subscription:l};this.contexts.push(b);var f=(0,i.subscribeToResult)(this,u,b);f.closed?this.closeWindow(this.contexts.length-1):(f.context=b,l.add(f)),this.destination.next(p)}else this.closeWindow(this.contexts.indexOf(t))},n.prototype.notifyError=function(t){this.error(t)},n.prototype.notifyComplete=function(t){t!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(t.context))},n.prototype.closeWindow=function(t){if(-1!==t){var e=this.contexts,r=e[t],o=r.window,i=r.subscription;e.splice(t,1),o.complete(),i.unsubscribe()}},n}(o.OuterSubscriber);
},{"tslib":"qxUW","../Subject":"Drrb","../Subscription":"ab35","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"SHsU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.windowWhen=r;var t=n(require("tslib")),i=require("../Subject"),e=require("../OuterSubscriber"),o=require("../util/subscribeToResult");function n(t){if(t&&t.__esModule)return t;var i={};if(null!=t)for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,e):{};o.get||o.set?Object.defineProperty(i,e,o):i[e]=t[e]}return i.default=t,i}function r(t){return function(i){return i.lift(new s(t))}}var s=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,i){return i.subscribe(new c(t,this.closingSelector))},t}(),c=function(e){function n(t,i){var o=e.call(this,t)||this;return o.destination=t,o.closingSelector=i,o.openWindow(),o}return t.__extends(n,e),n.prototype.notifyNext=function(t,i,e,o,n){this.openWindow(n)},n.prototype.notifyError=function(t,i){this._error(t)},n.prototype.notifyComplete=function(t){this.openWindow(t)},n.prototype._next=function(t){this.window.next(t)},n.prototype._error=function(t){this.window.error(t),this.destination.error(t),this.unsubscribeClosingNotification()},n.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},n.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},n.prototype.openWindow=function(t){void 0===t&&(t=null),t&&(this.remove(t),t.unsubscribe());var e=this.window;e&&e.complete();var n,r=this.window=new i.Subject;this.destination.next(r);try{n=(0,this.closingSelector)()}catch(s){return this.destination.error(s),void this.window.error(s)}this.add(this.closingNotification=(0,o.subscribeToResult)(this,n))},n}(e.OuterSubscriber);
},{"tslib":"qxUW","../Subject":"Drrb","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"Jyug":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.withLatestFrom=n;var t=o(require("tslib")),e=require("../OuterSubscriber"),r=require("../util/subscribeToResult");function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};o.get||o.set?Object.defineProperty(e,r,o):e[r]=t[r]}return e.default=t,e}function n(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var r;"function"==typeof t[t.length-1]&&(r=t.pop());var o=t;return e.lift(new i(o,r))}}var i=function(){function t(t,e){this.observables=t,this.project=e}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.observables,this.project))},t}(),s=function(e){function o(t,o,n){var i=e.call(this,t)||this;i.observables=o,i.project=n,i.toRespond=[];var s=o.length;i.values=new Array(s);for(var u=0;u<s;u++)i.toRespond.push(u);for(u=0;u<s;u++){var c=o[u];i.add((0,r.subscribeToResult)(i,c,c,u))}return i}return t.__extends(o,e),o.prototype.notifyNext=function(t,e,r,o,n){this.values[r]=e;var i=this.toRespond;if(i.length>0){var s=i.indexOf(r);-1!==s&&i.splice(s,1)}},o.prototype.notifyComplete=function(){},o.prototype._next=function(t){if(0===this.toRespond.length){var e=[t].concat(this.values);this.project?this._tryProject(e):this.destination.next(e)}},o.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(r){return void this.destination.error(r)}this.destination.next(e)},o}(e.OuterSubscriber);
},{"tslib":"qxUW","../OuterSubscriber":"VHfM","../util/subscribeToResult":"kr3X"}],"hMGS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.zip=r;var e=require("../observable/zip");function r(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return function(t){return t.lift.call(e.zip.apply(void 0,[t].concat(r)))}}
},{"../observable/zip":"OlW6"}],"571d":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.zipAll=r;var e=require("../observable/zip");function r(r){return function(t){return t.lift(new e.ZipOperator(r))}}
},{"../observable/zip":"OlW6"}],"Dc+8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"audit",{enumerable:!0,get:function(){return e.audit}}),Object.defineProperty(exports,"auditTime",{enumerable:!0,get:function(){return r.auditTime}}),Object.defineProperty(exports,"buffer",{enumerable:!0,get:function(){return t.buffer}}),Object.defineProperty(exports,"bufferCount",{enumerable:!0,get:function(){return n.bufferCount}}),Object.defineProperty(exports,"bufferTime",{enumerable:!0,get:function(){return o.bufferTime}}),Object.defineProperty(exports,"bufferToggle",{enumerable:!0,get:function(){return i.bufferToggle}}),Object.defineProperty(exports,"bufferWhen",{enumerable:!0,get:function(){return u.bufferWhen}}),Object.defineProperty(exports,"catchError",{enumerable:!0,get:function(){return a.catchError}}),Object.defineProperty(exports,"combineAll",{enumerable:!0,get:function(){return p.combineAll}}),Object.defineProperty(exports,"combineLatest",{enumerable:!0,get:function(){return l.combineLatest}}),Object.defineProperty(exports,"concat",{enumerable:!0,get:function(){return s.concat}}),Object.defineProperty(exports,"concatAll",{enumerable:!0,get:function(){return c.concatAll}}),Object.defineProperty(exports,"concatMap",{enumerable:!0,get:function(){return f.concatMap}}),Object.defineProperty(exports,"concatMapTo",{enumerable:!0,get:function(){return b.concatMapTo}}),Object.defineProperty(exports,"count",{enumerable:!0,get:function(){return m.count}}),Object.defineProperty(exports,"debounce",{enumerable:!0,get:function(){return d.debounce}}),Object.defineProperty(exports,"debounceTime",{enumerable:!0,get:function(){return g.debounceTime}}),Object.defineProperty(exports,"defaultIfEmpty",{enumerable:!0,get:function(){return y.defaultIfEmpty}}),Object.defineProperty(exports,"delay",{enumerable:!0,get:function(){return x.delay}}),Object.defineProperty(exports,"delayWhen",{enumerable:!0,get:function(){return O.delayWhen}}),Object.defineProperty(exports,"dematerialize",{enumerable:!0,get:function(){return q.dematerialize}}),Object.defineProperty(exports,"distinct",{enumerable:!0,get:function(){return j.distinct}}),Object.defineProperty(exports,"distinctUntilChanged",{enumerable:!0,get:function(){return P.distinctUntilChanged}}),Object.defineProperty(exports,"distinctUntilKeyChanged",{enumerable:!0,get:function(){return h.distinctUntilKeyChanged}}),Object.defineProperty(exports,"elementAt",{enumerable:!0,get:function(){return w.elementAt}}),Object.defineProperty(exports,"endWith",{enumerable:!0,get:function(){return T.endWith}}),Object.defineProperty(exports,"every",{enumerable:!0,get:function(){return W.every}}),Object.defineProperty(exports,"exhaust",{enumerable:!0,get:function(){return k.exhaust}}),Object.defineProperty(exports,"exhaustMap",{enumerable:!0,get:function(){return M.exhaustMap}}),Object.defineProperty(exports,"expand",{enumerable:!0,get:function(){return A.expand}}),Object.defineProperty(exports,"filter",{enumerable:!0,get:function(){return E.filter}}),Object.defineProperty(exports,"finalize",{enumerable:!0,get:function(){return z.finalize}}),Object.defineProperty(exports,"find",{enumerable:!0,get:function(){return C.find}}),Object.defineProperty(exports,"findIndex",{enumerable:!0,get:function(){return L.findIndex}}),Object.defineProperty(exports,"first",{enumerable:!0,get:function(){return v.first}}),Object.defineProperty(exports,"groupBy",{enumerable:!0,get:function(){return I.groupBy}}),Object.defineProperty(exports,"ignoreElements",{enumerable:!0,get:function(){return U.ignoreElements}}),Object.defineProperty(exports,"isEmpty",{enumerable:!0,get:function(){return R.isEmpty}}),Object.defineProperty(exports,"last",{enumerable:!0,get:function(){return B.last}}),Object.defineProperty(exports,"map",{enumerable:!0,get:function(){return F.map}}),Object.defineProperty(exports,"mapTo",{enumerable:!0,get:function(){return K.mapTo}}),Object.defineProperty(exports,"materialize",{enumerable:!0,get:function(){return N.materialize}}),Object.defineProperty(exports,"max",{enumerable:!0,get:function(){return S.max}}),Object.defineProperty(exports,"merge",{enumerable:!0,get:function(){return _.merge}}),Object.defineProperty(exports,"mergeAll",{enumerable:!0,get:function(){return D.mergeAll}}),Object.defineProperty(exports,"mergeMap",{enumerable:!0,get:function(){return G.mergeMap}}),Object.defineProperty(exports,"flatMap",{enumerable:!0,get:function(){return G.mergeMap}}),Object.defineProperty(exports,"mergeMapTo",{enumerable:!0,get:function(){return H.mergeMapTo}}),Object.defineProperty(exports,"mergeScan",{enumerable:!0,get:function(){return J.mergeScan}}),Object.defineProperty(exports,"min",{enumerable:!0,get:function(){return Q.min}}),Object.defineProperty(exports,"multicast",{enumerable:!0,get:function(){return V.multicast}}),Object.defineProperty(exports,"observeOn",{enumerable:!0,get:function(){return X.observeOn}}),Object.defineProperty(exports,"onErrorResumeNext",{enumerable:!0,get:function(){return Y.onErrorResumeNext}}),Object.defineProperty(exports,"pairwise",{enumerable:!0,get:function(){return Z.pairwise}}),Object.defineProperty(exports,"partition",{enumerable:!0,get:function(){return $.partition}}),Object.defineProperty(exports,"pluck",{enumerable:!0,get:function(){return ee.pluck}}),Object.defineProperty(exports,"publish",{enumerable:!0,get:function(){return re.publish}}),Object.defineProperty(exports,"publishBehavior",{enumerable:!0,get:function(){return te.publishBehavior}}),Object.defineProperty(exports,"publishLast",{enumerable:!0,get:function(){return ne.publishLast}}),Object.defineProperty(exports,"publishReplay",{enumerable:!0,get:function(){return oe.publishReplay}}),Object.defineProperty(exports,"race",{enumerable:!0,get:function(){return ie.race}}),Object.defineProperty(exports,"reduce",{enumerable:!0,get:function(){return ue.reduce}}),Object.defineProperty(exports,"repeat",{enumerable:!0,get:function(){return ae.repeat}}),Object.defineProperty(exports,"repeatWhen",{enumerable:!0,get:function(){return pe.repeatWhen}}),Object.defineProperty(exports,"retry",{enumerable:!0,get:function(){return le.retry}}),Object.defineProperty(exports,"retryWhen",{enumerable:!0,get:function(){return se.retryWhen}}),Object.defineProperty(exports,"refCount",{enumerable:!0,get:function(){return ce.refCount}}),Object.defineProperty(exports,"sample",{enumerable:!0,get:function(){return fe.sample}}),Object.defineProperty(exports,"sampleTime",{enumerable:!0,get:function(){return be.sampleTime}}),Object.defineProperty(exports,"scan",{enumerable:!0,get:function(){return me.scan}}),Object.defineProperty(exports,"sequenceEqual",{enumerable:!0,get:function(){return de.sequenceEqual}}),Object.defineProperty(exports,"share",{enumerable:!0,get:function(){return ge.share}}),Object.defineProperty(exports,"shareReplay",{enumerable:!0,get:function(){return ye.shareReplay}}),Object.defineProperty(exports,"single",{enumerable:!0,get:function(){return xe.single}}),Object.defineProperty(exports,"skip",{enumerable:!0,get:function(){return Oe.skip}}),Object.defineProperty(exports,"skipLast",{enumerable:!0,get:function(){return qe.skipLast}}),Object.defineProperty(exports,"skipUntil",{enumerable:!0,get:function(){return je.skipUntil}}),Object.defineProperty(exports,"skipWhile",{enumerable:!0,get:function(){return Pe.skipWhile}}),Object.defineProperty(exports,"startWith",{enumerable:!0,get:function(){return he.startWith}}),Object.defineProperty(exports,"subscribeOn",{enumerable:!0,get:function(){return we.subscribeOn}}),Object.defineProperty(exports,"switchAll",{enumerable:!0,get:function(){return Te.switchAll}}),Object.defineProperty(exports,"switchMap",{enumerable:!0,get:function(){return We.switchMap}}),Object.defineProperty(exports,"switchMapTo",{enumerable:!0,get:function(){return ke.switchMapTo}}),Object.defineProperty(exports,"take",{enumerable:!0,get:function(){return Me.take}}),Object.defineProperty(exports,"takeLast",{enumerable:!0,get:function(){return Ae.takeLast}}),Object.defineProperty(exports,"takeUntil",{enumerable:!0,get:function(){return Ee.takeUntil}}),Object.defineProperty(exports,"takeWhile",{enumerable:!0,get:function(){return ze.takeWhile}}),Object.defineProperty(exports,"tap",{enumerable:!0,get:function(){return Ce.tap}}),Object.defineProperty(exports,"throttle",{enumerable:!0,get:function(){return Le.throttle}}),Object.defineProperty(exports,"throttleTime",{enumerable:!0,get:function(){return ve.throttleTime}}),Object.defineProperty(exports,"throwIfEmpty",{enumerable:!0,get:function(){return Ie.throwIfEmpty}}),Object.defineProperty(exports,"timeInterval",{enumerable:!0,get:function(){return Ue.timeInterval}}),Object.defineProperty(exports,"timeout",{enumerable:!0,get:function(){return Re.timeout}}),Object.defineProperty(exports,"timeoutWith",{enumerable:!0,get:function(){return Be.timeoutWith}}),Object.defineProperty(exports,"timestamp",{enumerable:!0,get:function(){return Fe.timestamp}}),Object.defineProperty(exports,"toArray",{enumerable:!0,get:function(){return Ke.toArray}}),Object.defineProperty(exports,"window",{enumerable:!0,get:function(){return Ne.window}}),Object.defineProperty(exports,"windowCount",{enumerable:!0,get:function(){return Se.windowCount}}),Object.defineProperty(exports,"windowTime",{enumerable:!0,get:function(){return _e.windowTime}}),Object.defineProperty(exports,"windowToggle",{enumerable:!0,get:function(){return De.windowToggle}}),Object.defineProperty(exports,"windowWhen",{enumerable:!0,get:function(){return Ge.windowWhen}}),Object.defineProperty(exports,"withLatestFrom",{enumerable:!0,get:function(){return He.withLatestFrom}}),Object.defineProperty(exports,"zip",{enumerable:!0,get:function(){return Je.zip}}),Object.defineProperty(exports,"zipAll",{enumerable:!0,get:function(){return Qe.zipAll}});var e=require("../internal/operators/audit"),r=require("../internal/operators/auditTime"),t=require("../internal/operators/buffer"),n=require("../internal/operators/bufferCount"),o=require("../internal/operators/bufferTime"),i=require("../internal/operators/bufferToggle"),u=require("../internal/operators/bufferWhen"),a=require("../internal/operators/catchError"),p=require("../internal/operators/combineAll"),l=require("../internal/operators/combineLatest"),s=require("../internal/operators/concat"),c=require("../internal/operators/concatAll"),f=require("../internal/operators/concatMap"),b=require("../internal/operators/concatMapTo"),m=require("../internal/operators/count"),d=require("../internal/operators/debounce"),g=require("../internal/operators/debounceTime"),y=require("../internal/operators/defaultIfEmpty"),x=require("../internal/operators/delay"),O=require("../internal/operators/delayWhen"),q=require("../internal/operators/dematerialize"),j=require("../internal/operators/distinct"),P=require("../internal/operators/distinctUntilChanged"),h=require("../internal/operators/distinctUntilKeyChanged"),w=require("../internal/operators/elementAt"),T=require("../internal/operators/endWith"),W=require("../internal/operators/every"),k=require("../internal/operators/exhaust"),M=require("../internal/operators/exhaustMap"),A=require("../internal/operators/expand"),E=require("../internal/operators/filter"),z=require("../internal/operators/finalize"),C=require("../internal/operators/find"),L=require("../internal/operators/findIndex"),v=require("../internal/operators/first"),I=require("../internal/operators/groupBy"),U=require("../internal/operators/ignoreElements"),R=require("../internal/operators/isEmpty"),B=require("../internal/operators/last"),F=require("../internal/operators/map"),K=require("../internal/operators/mapTo"),N=require("../internal/operators/materialize"),S=require("../internal/operators/max"),_=require("../internal/operators/merge"),D=require("../internal/operators/mergeAll"),G=require("../internal/operators/mergeMap"),H=require("../internal/operators/mergeMapTo"),J=require("../internal/operators/mergeScan"),Q=require("../internal/operators/min"),V=require("../internal/operators/multicast"),X=require("../internal/operators/observeOn"),Y=require("../internal/operators/onErrorResumeNext"),Z=require("../internal/operators/pairwise"),$=require("../internal/operators/partition"),ee=require("../internal/operators/pluck"),re=require("../internal/operators/publish"),te=require("../internal/operators/publishBehavior"),ne=require("../internal/operators/publishLast"),oe=require("../internal/operators/publishReplay"),ie=require("../internal/operators/race"),ue=require("../internal/operators/reduce"),ae=require("../internal/operators/repeat"),pe=require("../internal/operators/repeatWhen"),le=require("../internal/operators/retry"),se=require("../internal/operators/retryWhen"),ce=require("../internal/operators/refCount"),fe=require("../internal/operators/sample"),be=require("../internal/operators/sampleTime"),me=require("../internal/operators/scan"),de=require("../internal/operators/sequenceEqual"),ge=require("../internal/operators/share"),ye=require("../internal/operators/shareReplay"),xe=require("../internal/operators/single"),Oe=require("../internal/operators/skip"),qe=require("../internal/operators/skipLast"),je=require("../internal/operators/skipUntil"),Pe=require("../internal/operators/skipWhile"),he=require("../internal/operators/startWith"),we=require("../internal/operators/subscribeOn"),Te=require("../internal/operators/switchAll"),We=require("../internal/operators/switchMap"),ke=require("../internal/operators/switchMapTo"),Me=require("../internal/operators/take"),Ae=require("../internal/operators/takeLast"),Ee=require("../internal/operators/takeUntil"),ze=require("../internal/operators/takeWhile"),Ce=require("../internal/operators/tap"),Le=require("../internal/operators/throttle"),ve=require("../internal/operators/throttleTime"),Ie=require("../internal/operators/throwIfEmpty"),Ue=require("../internal/operators/timeInterval"),Re=require("../internal/operators/timeout"),Be=require("../internal/operators/timeoutWith"),Fe=require("../internal/operators/timestamp"),Ke=require("../internal/operators/toArray"),Ne=require("../internal/operators/window"),Se=require("../internal/operators/windowCount"),_e=require("../internal/operators/windowTime"),De=require("../internal/operators/windowToggle"),Ge=require("../internal/operators/windowWhen"),He=require("../internal/operators/withLatestFrom"),Je=require("../internal/operators/zip"),Qe=require("../internal/operators/zipAll");
},{"../internal/operators/audit":"jKl9","../internal/operators/auditTime":"+/SS","../internal/operators/buffer":"URP9","../internal/operators/bufferCount":"F3qJ","../internal/operators/bufferTime":"mquI","../internal/operators/bufferToggle":"la/b","../internal/operators/bufferWhen":"XhJV","../internal/operators/catchError":"pYB0","../internal/operators/combineAll":"57AO","../internal/operators/combineLatest":"cXRl","../internal/operators/concat":"op/w","../internal/operators/concatAll":"r2ff","../internal/operators/concatMap":"+GMT","../internal/operators/concatMapTo":"CtQr","../internal/operators/count":"mYns","../internal/operators/debounce":"V4oe","../internal/operators/debounceTime":"m1C5","../internal/operators/defaultIfEmpty":"cKW4","../internal/operators/delay":"Sa60","../internal/operators/delayWhen":"QJ+e","../internal/operators/dematerialize":"xkf0","../internal/operators/distinct":"E3qE","../internal/operators/distinctUntilChanged":"Td6E","../internal/operators/distinctUntilKeyChanged":"OZhF","../internal/operators/elementAt":"5dDD","../internal/operators/endWith":"74kY","../internal/operators/every":"fC2l","../internal/operators/exhaust":"Rfcn","../internal/operators/exhaustMap":"KLQj","../internal/operators/expand":"sB9h","../internal/operators/filter":"AJqx","../internal/operators/finalize":"kuiD","../internal/operators/find":"SQVa","../internal/operators/findIndex":"nimY","../internal/operators/first":"umi5","../internal/operators/groupBy":"zY6H","../internal/operators/ignoreElements":"e5+C","../internal/operators/isEmpty":"Envu","../internal/operators/last":"B4io","../internal/operators/map":"krfZ","../internal/operators/mapTo":"D9M6","../internal/operators/materialize":"3HsG","../internal/operators/max":"TovV","../internal/operators/merge":"erCu","../internal/operators/mergeAll":"khf/","../internal/operators/mergeMap":"bWJj","../internal/operators/mergeMapTo":"n+GI","../internal/operators/mergeScan":"bUKq","../internal/operators/min":"+cdK","../internal/operators/multicast":"MdA6","../internal/operators/observeOn":"U6my","../internal/operators/onErrorResumeNext":"Lfx6","../internal/operators/pairwise":"2AYp","../internal/operators/partition":"5Vv/","../internal/operators/pluck":"/Bc3","../internal/operators/publish":"SAj0","../internal/operators/publishBehavior":"Ns3t","../internal/operators/publishLast":"c/kZ","../internal/operators/publishReplay":"8GhN","../internal/operators/race":"mH+d","../internal/operators/reduce":"/M6Z","../internal/operators/repeat":"5h/r","../internal/operators/repeatWhen":"HNzm","../internal/operators/retry":"NQbw","../internal/operators/retryWhen":"I63F","../internal/operators/refCount":"Ux37","../internal/operators/sample":"JXuq","../internal/operators/sampleTime":"t6Lb","../internal/operators/scan":"zXwg","../internal/operators/sequenceEqual":"YiLY","../internal/operators/share":"VOv+","../internal/operators/shareReplay":"ihqz","../internal/operators/single":"frLT","../internal/operators/skip":"AYHj","../internal/operators/skipLast":"h2HR","../internal/operators/skipUntil":"zBcu","../internal/operators/skipWhile":"myb6","../internal/operators/startWith":"kuBz","../internal/operators/subscribeOn":"Ya9t","../internal/operators/switchAll":"NZNN","../internal/operators/switchMap":"L25Y","../internal/operators/switchMapTo":"ilqN","../internal/operators/take":"FZsI","../internal/operators/takeLast":"qBpl","../internal/operators/takeUntil":"4Ru4","../internal/operators/takeWhile":"dVOf","../internal/operators/tap":"UMSv","../internal/operators/throttle":"7IHZ","../internal/operators/throttleTime":"kC0m","../internal/operators/throwIfEmpty":"uA9W","../internal/operators/timeInterval":"lii4","../internal/operators/timeout":"tgQ6","../internal/operators/timeoutWith":"Dwz7","../internal/operators/timestamp":"R8Kj","../internal/operators/toArray":"1//p","../internal/operators/window":"3HAF","../internal/operators/windowCount":"fsbz","../internal/operators/windowTime":"9TeG","../internal/operators/windowToggle":"t8Wz","../internal/operators/windowWhen":"SHsU","../internal/operators/withLatestFrom":"Jyug","../internal/operators/zip":"hMGS","../internal/operators/zipAll":"571d"}],"da6W":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=i(require("../Util")),t=require("rxjs"),o=i(require("zepto-webpack"));function i(e){return e&&e.__esModule?e:{default:e}}function n(e,o,i){this.mgr=e,this.confrId=o,r.apply(this),this.subject=new t.Subject,this.onRemoteStream=i}function r(){e.default.extend(this,{subscribe:function(e,t,o){return this.subject.subscribe(e,t,o)}},{onMeExit:function(e,t){this.mgr._onExit(this.confrId,e,t)},onAddMember:function(e){this.mgr.onMemberJoin(e,this.confrId)},onRemoveMember:function(e,t){this.mgr.onMemberLeave(e,t,this.confrId)},onAddStream:function(e){0!=e.id&&(e.located()||this.onRemoteStream&&this.onRemoteStream(e),this.mgr.streamBindVideo(e,void 0,this.confrId),this.mgr._onAddMemberStream(e,this.confrId))},onRemoveStream:function(t){if(0!=t.id){var o=this.mgr._confr(this.confrId);o&&t&&t.located()&&(o.av&&o.av.id===t.id&&(o.av=void 0),o.desktop&&o.desktop.id===t.id&&(o.desktop=void 0));var i=e.default.removeAttribute(this.mgr._videos,t.id);this.mgr._onRemoveMemberStream(t,this.confrId),i&&this.mgr.unloadVideo(t.owner,t,i)}},onUpdateStream:function(e,t){if(0!=e.id){var i=this,n=this.mgr._videos[e.id];n&&(t&&t.ifMediaStream(function(e){n&&attachMediaStream(n,e),n&&n.hasAttribute("flow")&&i.mgr.onMediaTransmission(n,function(e,t,i,r){(0,o.default)(n).trigger("onMediaTransmission",[e,t,i,r])})}),e.aoff?n.setAttribute("aoff","aoff"):n.removeAttribute("aoff"),e.voff?n.setAttribute("voff","voff"):n.removeAttribute("voff"));var r={video:!e.voff,audio:!e.aoff};t&&t.ifVoff(function(t){r||(r={}),r.video=!t,e.located()||(r.video=e.subArgs?e.subArgs.subSVideo:!e.voff)}),t&&t.ifAoff(function(t){r||(r={}),r.audio=!t,e.located()||(r.audio=e.subArgs?e.subArgs.subSAudio:!e.aoff,2===e.type&&(r.audio=!0))}),r&&this.mgr._onMemberMediaChanaged(e.owner,e,r,this.confrId),r&&this.mgr._onUpdateMemberStream(e,r,this.confrId)}},onNetworkWeak:function(){},onNotSupportPublishVideoCodecs:function(e){this.mgr._onNotSupportMemberPublishVideoCodecs(e,this.confrId)},onRecvRemoteMessage:function(e,t){this.mgr._onRecvRemoteMessage(e,t,this.confrId)},onSoundChanage:function(e,t,o){this.mgr._onMemberSoundChanaged(e,t,o,this.confrId)},onTalking:function(e,t,o){this.mgr._onTalking(e,t,o,this.confrId)},onRoleUpdate:function(e,t){var o=this.mgr._confrs[this.confrId];t&&(o.roleToken=t),o.role=e,e==this.mgr.Role.AUDIENCE&&(o.av&&this.mgr.hungup(o.av),o.desktop&&this.mgr.hungup(o.desktop)),this.mgr._onRoleUpdated(e,this.confrId)},onNotifyEvent:function(t){var o=this;try{if(t instanceof emedia.event.ICEChanage){var i=t.webrtc,n=t.state;e.default.forEach(o._cacheStreams,function(t,r){if(r.rtcId==i.getRtcId()){var s=e.default.extend({},r),d=e.default.extend({},r.owner);o.mgr._onStreamIceStateChanged(d,s,n,o.confrId)}})}}finally{o.subject.next(t)}}})}var s=n;exports.default=s;
},{"../Util":"Qsy+","rxjs":"W5vH","zepto-webpack":"75TC"}],"E8HX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.single=void 0;var e=a(require("../Util")),r=a(require("zepto-webpack")),t=a(require("underscore")),o=require("rxjs"),n=require("rxjs/operators"),i=a(require("../_Stream"));function a(e){return e&&e.__esModule?e:{default:e}}var s=e.default.tagLogger("mgr");window.emedia=window.emedia||{};var c={createConfr:"/easemob/rtc/req/ticket",reqTkt:"/easemob/rtc/req/ticket",chanageRoles:"/easemob/rtc/chanage/roles",disbandConfr:"/easemob/rtc/disband/conference",kickMember:"/easemob/rtc/kick/member",selectConfr:"/easemob/rtc/select/confr"};function u(){this._confrs={},this._services={},this._events={},this._videos={}}u.prototype.ConfrType={COMMUNICATION:10,COMMUNICATION_MIX:11,LIVE:12,P2P:13,INTERCOMM:14},u.prototype.Role={ADMIN:7,TALKER:3,AUDIENCE:1};var f=function(t,o){return new Promise(function(n,i){r.default.ajax({type:"POST",url:t,data:JSON.stringify(o),contentType:"application/json",dataType:"json",success:function(r,a,c){s.debug("REST: ",r," -> ",o,t),0===r.error?(e.default.removeAttribute(r,"error"),n(r)):(e.default.extend(r,{errorType:"server_refuse"}),i(r))},error:function(e,r,n){var a={errorType:"http_error",error:e.status,errorMessage:n};s.debug("REST: ",a," -> ",o,t),i({errorType:"http_error",error:e.status,errorMessage:n})}})})},d=function(t,o){return function(n){r.default.ajax({type:"POST",url:t,data:JSON.stringify(o),contentType:"application/json",dataType:"json",success:function(r,i,a){s.debug("REST: ",r," -> ",o,t),0===r.error?(e.default.removeAttribute(r,"error"),n.next(r),n.complete()):(e.default.extend(r,{errorType:"server_refuse"}),n.error(r))},error:function(e,r,i){var a={errorType:"http_error",error:e.status,errorMessage:i};s.debug("REST: ",a," -> ",o,t),n.error({errorType:"http_error",error:e.status,errorMessage:i})}})}};!function(r){e.default.forEach(r,function(e,r){u.prototype[e]=function(t){var o=r;o=o+"?_ct="+(new Date).getTime(),t.region&&(o=o+"&REGION="+t.region),t.confrId&&(o=o+"&CONFRID="+t.confrId);var n=this.createUrl(o,e);return d(n,t)}})}(c),u.prototype.createUrl=function(e,r){return(emedia.config&&emedia.config.restPrefix||"")+e},u.prototype.setUrlCreator=function(e){this.createUrl=e.bind(this)},u.prototype.destroy=function(){},u.prototype.ZeroStream=i.default.extend({__init__:function(){this.type=2,this.id="0",this._located=!1,this.mutedMuted=!1},onGotRemoteMediaStream:function(e){if(!this.remotePlayAudioObject){this.id;var r=document.createElement("audio");r.style.display="none",r.id="__o_remote_play_audio_"+this.id,r.autoplay=!0,r.playsinline=!0,this.remotePlayAudioObject=r,document.body.appendChild(r)}this.remotePlayAudioObject.srcObject=e}}),u.prototype.setIdentity=function(e,r,t){this.identityName=e,this.identityToken=r,this.ext=t,this._terminalInfo={browser:emedia.browser,browserVersion:emedia.browserVersion,version:window._emediaVersion||emedia.config.version,userAgent:emedia.config.userAgent},s.info("set identity: ",e,r),this.destroy(),emedia.config({autoSub:!1,onlyEnter:!0})},u.prototype.EventsObservable=require("./EventsObservable").default;var l=(0,n.catchError)((e,r)=>{throw s.error(e),e});function p(r,i,a,s){var c=this,f=void 0;if(arguments.length>=0&&"object"==typeof arguments[0]){var d=arguments[0];f=d.region,r=d.confrType,i=d.password,a=d.rec,s=d.recMerge}return"string"==typeof r&&(r=parseInt(r)),o.Observable.create(u.prototype.createConfr.call(c,{region:f,uid:c.identityName,token:c.identityToken,confrType:r,password:i,terminal:c._terminalInfo,rec:a,recMerge:s})).pipe((0,n.map)(r=>(r.mixed=11===r.type||12===r.type,r.id=r.serverConfrId=r.confrId,c._confrs[r.confrId]=t.default.extend({},r),e.default.removeAttribute(r,"rtcCfg"),r)),l)}function m(r,i,a,s,c){var f=this,d=void 0;if(arguments.length>=0&&"object"==typeof arguments[0]){var p=arguments[0];d=p.region,r=p.confrType,i=p.password,a=p.rec,s=p.recMerge,c=p.supportWechatMiniProgram}"string"==typeof r&&(r=parseInt(r));var m={region:d,uid:f.identityName,token:f.identityToken,confrType:r,password:i,terminal:f._terminalInfo,rec:a,recMerge:s,supportWechatMiniProgram:c};return c&&(m.useVCodes=["VP8","H264"]),o.Observable.create(u.prototype.createConfr.call(f,m)).pipe((0,n.map)(r=>(r.mixed=11===r.type||12===r.type,r.id=r.serverConfrId=r.confrId,f._confrs[r.confrId]=t.default.extend({},r),e.default.removeAttribute(r,"rtcCfg"),r)),l)}function h(r,t){var i=this,a=i._confr(r),s={uid:i.identityName,token:i.identityToken,confrId:a&&a.id||r,password:t,terminal:i._terminalInfo};return i._confrs[r]&&(s.roleToken=i._confrs[r].roleToken),o.Observable.create(u.prototype.reqTkt.call(i,s)).pipe((0,n.map)(t=>(t.mixed=11===t.type||12===t.type,t.id=t.serverConfrId=t.confrId=r,i._confrs[r]=e.default.extend(i._confrs[r]||{},t),e.default.removeAttribute(t,"rtcCfg"),t)),l)}function v(e,r,t){var i=this._confr(t),a=this._service(t),s={confrId:i&&i.id||t,uids:r,role:e,roleToken:i.roleToken};return o.Observable.create(u.prototype.chanageRoles.call(this,s)).pipe((0,n.map)(e=>(a&&a.current&&a.current._sysCopy(),i.id)),l)}function g(r,t){var i=this,a=i._confr(r),s={confrId:a&&a.id||r,roleToken:a&&a.roleToken||t};return o.Observable.create(u.prototype.disbandConfr.call(i,s)).pipe((0,n.map)(t=>(e.default.removeAttribute(i._confrs,r),a.id)),l)}function b(e,r){var t=this._confr(r),i={confrId:t&&t.id||r,uids:e,roleToken:t.roleToken};return o.Observable.create(u.prototype.kickMember.call(this,i)).pipe((0,n.map)(e=>t.id),l)}function _(e,r){var t=this._confr(e),n={uid:this.identityName,token:this.identityToken,confrId:t&&t.id||e,password:r};return t&&(n.password=r||t.password,n.roleToken=t.roleToken),o.Observable.create(u.prototype.selectConfr.call(this,n)).pipe(l)}function y(e,r){}function M(r,t){var i=this,a=i._confr(r),s=i._service(r);switch(a.type){case 0:case 10:case 11:break;case 12:var c=new i.ZeroStream;if(s.current._cacheStreams[c.id]=c,s.current.role==X.Role.AUDIENCE)return U.call(i,r,c,!1,!0).pipe((0,n.concatMap)(()=>(0,o.of)(e.default.extend({},i._confrs[r]))));break;case 13:case 14:default:return(0,o.throwError)("not support conf type: "+a.type)}return(0,o.of)(e.default.extend({},i._confrs[r]))}function C(r,t,n){var i=this;return emedia.ctrl.support(n,function(e,t,o){i.onHasRemoteControl(e,t,o,r)},function(e,t,o){i.onRemoteFreeControl(e,t,o,r)}),s.info("support remote control. ",r,t),(0,o.of)(e.default.extend({},i._confrs[r]))}function w(e,r,t){var i=this;if(i.joined(e))return(0,o.throwError)("had joined confr "+e+", if you want join again, please call exitConference");var a=i._events[e]=new i.EventsObservable(i,e,function(r){y.call(i,e,r)});i.confrEventsObserver&&a.subscribe(i.confrEventsObserver);var s=i._service(e);return(s=i._services[e]=new emedia.XService({listeners:a})).setup(r,t),o.Observable.create(function(r){s.join(function(t){i.__current_confrId=e,i._confrs[e].joinId=t,i._confrs[e].role=s.current&&s.current.role,r.next(i._confrs[e]),r.complete()},function(e){s.exit(),r.error({errorType:"join_fail",error:-200,errorMessage:e.message()})})}).pipe((0,n.concatMap)((r,t)=>C.call(i,e,r,s)),(0,n.concatMap)((r,t)=>M.call(i,e,r)),l)}function A(e,r,t){var o=this;return h.call(o,e,r,t).pipe((0,n.concatMap)((r,n)=>w.call(o,e,r.ticket,t)))}function I(e,r,t){var o=this;return _.call(o,e,r,t).pipe((0,n.concatMap)((n,i)=>A.call(o,e,r,t)))}function T(e,r){var t=this._service(e);return o.Observable.create(function(e){t.openUserMedia(r).then(function(){e.next(r),e.complete()},function(r){e.error({errorType:"open_user_media_fail",error:-201,errorMessage:r.message()})})}).pipe(l)}function S(e,r){var t=this._service(e);return o.Observable.create(function(e){t.push(r,function(r){e.next(r),e.complete()},function(r){e.error({errorType:"push_fail",error:-203,errorMessage:r.message()})})}).pipe(l)}function x(e,r,n){this._confr(n);var i=this._service(n);return(e="string"==typeof e?i.getStreamById(e):i.getStreamById(e.id))?r?t.default.isEqual(r,e.constaints.video)?R.call(this,n,e,0):E.call(this,n,e,r):R.call(this,n,e,1):(0,o.throwError)("pub stream not exsits. it is "+e)}function R(e,r,t){var n=this._service(e);return o.Observable.create(function(e){n.voff(r,t,function(r){e.error({errorType:"voff_fail",error:-203,errorMessage:r.message()})},function(){e.next(n.getStreamById(r.id)),e.complete()})}).pipe(l)}function E(r,n,i){var a=this._service(r);return o.Observable.create(function(r){var o={};t.default.isObject(n.constaints)&&(o=e.default.extend(!0,{},n.constaints)),o.video=i,a.chanageConstraints(n,o,function(e){r.error({errorType:"ChanageVideoConstraints_fail",error:-203,errorMessage:e.message()})},function(){r.next(a.getStreamById(n.id)),r.complete()})}).pipe(l)}function O(e,r,t){var n=this._confr(t),i=this._service(t);return(e="string"==typeof e?i.getStreamById(e):i.getStreamById(e.id))?n.type!==this.ConfrType.COMMUNICATION_MIX&&n.type!==this.ConfrType.LIVE||1!==e.type||r?k.call(this,t,e,r):(s.warn("confr mix. not allow desktop with audio."),(0,o.throwError)("confr mix. not allow desktop with audio.")):(0,o.throwError)("pub stream not exsits. it is "+e)}function k(e,r,t){var n=this._service(e);return o.Observable.create(function(e){n.aoff(r,t,function(r){e.error({errorType:"aoff_fail",error:-203,errorMessage:r.message()})},function(){e.next(n.getStreamById(r.id)),e.complete()})}).pipe(l)}function V(r,t,i,a){var c=this,u=c._confr(r),f=c._service(r);if(f.current.role==c.Role.AUDIENCE)return(0,o.throwError)("Audience not allow publish");if(u.av)return(0,o.throwError)("Audio and video stream has been published. not allow repeat publish.");var d=u.mixed?f.AudioMixerPubstream:f.AVPubstream,l=u.av=new d({constaints:t,aoff:0,voff:0,ext:a});return T.call(c,u.id,l).pipe((0,n.concatMap)(r=>(i&&e.default.targetDOM(i)&&attachMediaStream(i,r.localStream),S.call(c,u.id,r,a))),(0,n.map)(r=>(u.av=r,i&&c.streamBindVideo(u.av,i),u.type==c.ConfrType.LIVE&&c.hungup(0),e.default.extend({},r))),(0,n.catchError)((e,r)=>{throw u.av&&c.hungup(u.av),u.av=void 0,s.error(e),e}))}function P(e){var r=this._confr(e),t=this._service(e);return t.current.role==this.Role.AUDIENCE?(0,o.throwError)("Audience not allow publish"):o.Observable.create(function(e){t.switchMobileCamera(r.av,function(r){e.error({errorType:"switch_camera_fail",error:-203,errorMessage:r.message()})},function(){e.complete()})}).pipe(l)}function N(e){var r=this._confr(e),t=this._service(e);return t.current.role==this.Role.AUDIENCE?(0,o.throwError)("Audience not allow publish"):o.Observable.create(function(e){t.chanageCamera(r.av,function(r){e.error({errorType:"switch_camera_fail",error:-203,errorMessage:r.message()})},function(){e.complete()})}).pipe(l)}function j(r,t,i,a){var c=this,u=c._confr(r),f=c._service(r);if(f.current.role==c.Role.AUDIENCE)return(0,o.throwError)("Audience not allow publish");if(u.desktop)return(0,o.throwError)("desktop stream has been published. not allow repeat publish.");if((u.type===c.ConfrType.COMMUNICATION_MIX||u.type===c.ConfrType.LIVE)&&t.audio)return s.warn("confr mix. not allow desktop with audio."),(0,o.throwError)("confr mix. not allow desktop with audio.");t.audio||!u.av||u.av.aoff||s.warn("repeat audio. desktop and av");var d=u.desktop=new f.ShareDesktopPubstream({screenOptions:t.video&&t.video.screenOptions||["screen","window","tab"],mandatory:t.video&&t.video.mandatory||{},vbitrate:t.video&&t.video.bitrate,abitrate:t.audio&&t.audio.bitrate,aoff:t.audio?0:1,ext:a});return T.call(c,u.id,d).pipe((0,n.concatMap)(r=>(i&&e.default.targetDOM(i)&&attachMediaStream(i,r.localStream),S.call(c,u.id,r,a))),(0,n.map)(r=>(u.desktop=r,i&&e.default.targetDOM(i)&&c.streamBindVideo(u.desktop,i),e.default.extend({},r))),(0,n.catchError)((e,r)=>{throw u.desktop=void 0,s.error(e),e}))}function U(r,t,n,i,a){var c=this,u="string"==typeof t?t:t.id,f=c._confr(r),d=c._service(r);return 2===t.type&&1==i&&0!=t.id&&(i=!1,s.warn("Mixed audio stream. not allow repeat sub audio. force reset subSAudio = false")),a&&e.default.targetDOM(a)&&c.streamBindVideo(u,a),o.Observable.create(function(e){d.subscribe(u,function(r){try{if("0"!=u){var t=d.getStreamById(u),o={video:t.subArgs?t.subArgs.subSVideo:!t.voff,audio:t.subArgs?t.subArgs.subSAudio:!t.aoff};2===t.type&&(o.audio=!0),c._onMemberMediaChanaged(t.owner,t,o,f.confrId)}}finally{e.next(r),e.complete()}},function(r){e.error({errorType:"sub_fail",error:-203,errorMessage:r.message()})},{subSVideo:n,subSAudio:i})}).pipe(l)}function D(e,t,o){var n=this,i=n._service(o);e=i.current._cacheStreams["string"==typeof e?e:e.id];var a=t||n.crtAndReturnVideo(e.owner,e);if(a){n._videos[e.id]=a,a.setAttribute("autoplay","autoplay"),a.setAttribute("playsinline","playsinline"),a.setAttribute("hx_stream",e.id),e.aoff?a.setAttribute("aoff","aoff"):a.removeAttribute("aoff"),e.voff?a.setAttribute("voff","voff"):a.removeAttribute("voff"),e.ifMediaStream(function(e){a&&attachMediaStream(a,e),a.hasAttribute("flow")&&n.onMediaTransmission(a,function(e,t,o,n){(0,r.default)(a).trigger("onMediaTransmission",[e,t,o,n])})});var c=(0,r.default)(a);c.off("hungup"),c.on("hungup",function(r,t,i){n.hungup(e,o),i&&i()}),c.off("subscribe"),c.on("subscribe",function(r,t,i,a,s){e.located()?a&&a("local stream not allow sub"):(t=e.subArgs&&e.subArgs.subSVideo||!0,i=e.subArgs&&e.subArgs.subSAudio||!0,n.subscribe(e.owner,e,t,i,o).then(s).catch(a))}),c.off("pauseVideo"),c.on("pauseVideo",function(r,t,a){(e=i.current._cacheStreams["string"==typeof e?e:e.id]).located()?(c[0].__constaints_video=e.constaints&&e.constaints.video,n.pauseVideo(e,o).then(a).catch(t)):n.subscribe(e.owner,e,!1,e.subArgs&&e.subArgs.subSAudio||!e.aoff,o).then(a).catch(t)}),c.off("resumeVideo"),c.on("resumeVideo",function(r,t,a,s){(e=i.current._cacheStreams["string"==typeof e?e:e.id]).located()?(void 0===s&&(void 0!==(s=c[0].__constaints_video)&&null!=s||(s=!0)),c[0].__constaints_video=void 0,n.resumeVideo(e,s,o).then(a).catch(t)):n.subscribe(e.owner,e,!0,e.subArgs&&e.subArgs.subSVideo||!e.voff,o).then(a).catch(t)}),c.off("pauseAudio"),c.on("pauseAudio",function(r,t,i){e.located()?n.pauseAudio(e,o).then(i).catch(t):n.subscribe(e.owner,e,e.subArgs.subSVideo,!1,o).then(i).catch(t)}),c.off("resumeAudio"),c.on("resumeAudio",function(r,t,i){e.located()?n.resumeAudio(e,o).then(i).catch(t):n.subscribe(e.owner,e,e.subArgs.subSVideo,!0,o).then(i).catch(t)}),c.off("remoteControl"),c.on("remoteControl",function(r,t,i,c,u,f,d,l){if(e.located())throw s.error("not allow remote control at local"),"not allow remote control at local";n.remoteControl(e,a,a,t,i,c,u,f,d,l,o)}),c.off("chanageCamera"),c.on("chanageCamera",function(e,r,t){n.chanageCamera(o).then(t).catch(r)}),c.off("captureVideo"),c.on("captureVideo",function(e,r,t,i){var s=n.captureVideo(a,t,i,o);r&&r(s)}),c.off("capturePictureRemote"),c.on("capturePictureRemote",function(r,t,i){n.capturePictureRemote(e,!1,o).then(i).catch(t)}),c.off("freezeFrameRemote"),c.on("freezeFrameRemote",function(r,t,i){n.freezeFrameRemote(e,o).then(i).catch(t)}),c.off("zoomRemote"),c.on("zoomRemote",function(r,t,i,a){n.zoomRemote(e,t,o).then(a).catch(i)}),c.off("torchRemote"),c.on("torchRemote",function(r,t,i,a){n.torchRemote(e,t,o).then(a).catch(i)}),c.off("freeRemoteControl"),c.on("freeRemoteControl",function(r,t,i){try{n.freeRemoteControl(e,o)}finally{i&&i()}});var u={video:!e.voff,audio:!e.aoff,voff:e.voff,aoff:e.aoff};e.located()||(u={video:e.subArgs?e.subArgs.subSVideo:!e.voff,audio:e.subArgs?e.subArgs.subSAudio:!e.aoff,voff:e.voff,aoff:e.aoff}),c.trigger("onMediaChanaged",[u,e,e.owner,o]),a.getAttribute("sound")&&(i.current._monitSoundChanagedStreams=i.current._monitSoundChanagedStreams||{},i.current._monitSoundChanagedStreams[e.id]=e.id)}}function B(e,r,t,n){"string"!=typeof r&&(r=r.id);this._confr(e);var i=this._service(e);return o.Observable.create(function(e){i.focusExpoRemote(r,t,n,function(r){e.error({errorType:"focusexpo_remote_fail",error:-203,errorMessage:r.message()})},function(){e.complete()})}).pipe(l)}function z(e,r,t){"string"!=typeof r&&(r=r.id);this._confr(e);var n=this._service(e);return o.Observable.create(function(e){n.capturePictureRemote(r,t,function(r){e.next(r),e.complete()},function(r){e.error({errorType:"capture_remote_fail",error:-203,errorMessage:r.message()})})}).pipe(l)}function L(e,r,t){"string"!=typeof r&&(r=r.id);this._confr(e);var n=this._service(e);return o.Observable.create(function(e){n.zoomRemote(r,t,function(r){e.error({errorType:"capture_remote_fail",error:-203,errorMessage:r.message()})},function(){e.complete()})}).pipe(l)}function q(e,r,t){"string"!=typeof r&&(r=r.id);this._confr(e);var n=this._service(e);return o.Observable.create(function(e){n.torchRemote(r,t,function(r){e.next(r),e.complete()},function(r){e.error({errorType:"torch_remote_fail",error:-203,errorMessage:r.message()})})}).pipe(l)}function F(e,r){"string"!=typeof r&&(r=r.id);this._confr(e);var t=this._service(e);return o.Observable.create(function(e){t.freezeFrameRemote(r,function(r){e.next(r),e.complete()},function(r){e.error({errorType:"freeze_remote_fail",error:-203,errorMessage:r.message()})})}).pipe(l)}var W=e.default.extend(new u,{_confr:function(e){return e||(e=this.__current_confrId),this._confrs[e]},_service:function(e){return e||(e=this.__current_confrId),this._services[e]},getStreamById:function(e,r){var t=this._service(r);return t&&t.getStreamById(e)},getMemberById:function(e,r){var t=this._service(r);return t&&t.getMemberById(e)},streamBindVideo:function(e,r,t){D.call(this,e,r,t)},getBindVideoBy:function(e){if("string"!=typeof e&&e&&e.id&&(e=e.id),"string"!=typeof e)throw s.error("Bad stream ",e),"Bad stream "+e;return this._videos[e]},createConfr:function(e,r,t,o){return p.apply(this,arguments).toPromise()},createConfrSptMnPrg:function(e,r,t,o){return m.apply(this,arguments).toPromise()},reqTkt:function(e,r){return h.apply(this,arguments).toPromise()},chanageRoles:function(e,r,t){return v.apply(this,arguments).toPromise()},disbandConfr:function(e,r){return g.apply(this,arguments).toPromise()},kickMember:function(e,r){return b.apply(this,arguments).toPromise()},selectConfr:function(e,r){return _.apply(this,arguments).toPromise()},joinUsePassword:function(e,r,t){return I.call(this,e,r,t).toPromise()},joinUseTicket:function(e,r,t){return w.call(this,e,r,t).toPromise()},joined:function(e){return e&&this._confrs[e]&&this._confrs[e].joinId},shareDesktopWithAudio:function(r,t,o,n,i){e.default.targetDOM(o)||(i=n,n=o,o=void 0);var a={video:r,audio:t};return j.call(this,i,a,o,n).toPromise()},chanageCamera:function(e){return N.call(this,e).toPromise()},switchMobileCamera:function(e){return P.call(this,e).toPromise()},shareVideoWithAudio:function(r,t,o,n,i){e.default.targetDOM(o)||(i=n,n=o,o=void 0);var a={video:r,audio:t};return V.call(this,i,a,o,n).toPromise()},captureVideo:function(e,r,t,o){return this._service(o).captureVideo(e,r,t)},openUserMedia:function(e,r){var t=this._service(r);return o.Observable.create(function(r){t.__getUserMedia(e,function(e,t){r.next(t),r.complete()},function(e){r.error(e)})}).pipe(l).toPromise()},mediaDevices:function(e){return"function"==typeof e&&(e=void 0),o.Observable.create(function(r){navigator.mediaDevices.enumerateDevices().then(function(t){for(var o=[],n=0;n!==t.length;++n){var i=t[n];i.deviceId;e||o.push(i),e&&e===i.kind?o.push(i):"audioinput"===i.kind||"audiooutput"===i.kind||"videoinput"===i.kind||s.info("Some other kind of source/device: ",i)}r.next(o),r.complete()}).catch(function(e){s.warn("navigator.getUserMedia error: ",e),r.error(e)})}).pipe(l).toPromise()},resumeVideo:function(e,r,t){return x.call(this,e,r||!0,t).toPromise()},pauseVideo:function(e,r){return x.call(this,e,!1,r).toPromise()},resumeAudio:function(e,r){return O.call(this,e,!1,r).toPromise()},pauseAudio:function(e,r){return O.call(this,e,!0,r).toPromise()},freezeFrameRemote:function(e,r){return F.call(this,r,e).toPromise()},torchRemote:function(e,r,t){return q.call(this,t,e,r).toPromise()},zoomRemote:function(e,r,t){return L.call(this,t,e,r).toPromise()},capturePictureRemote:function(e,r){return z.call(this,r,e,!1).toPromise()},focusExpoRemote:function(e,r,t,o){return B.call(this,o,e,r,t).toPromise()},onFocusExpoRemoteWhenClickVideo:function(e,t,o,n){var i=this;return"function"==typeof t&&(n=o,o=t,t=void 0),(0,r.default)(e).off(t||"click"),(0,r.default)(e).on(t||"click",function(r){var t=e.getAttribute("hx_stream");i.focusExpoRemote(t,e,r).then(n).catch(o)}),t},offEventAtTag:function(e,t){t&&(0,r.default)(e).off(t)},hungup:function(e,r){var t;t="string"==typeof e?e:e.id||e+"";var o=this._service(r),n=this._confr(r);if(n&&o){o.hungup(t);var i=!1;if(n.av&&(i=n.av.id===t)&&(n.av=void 0),n.desktop&&n.desktop.id===t&&(n.desktop=void 0),i&&n.type==this.ConfrType.LIVE&&o.current.role==X.Role.AUDIENCE){var a=o.current&&o.current._cacheStreams[0];this.subscribe(o.current,a,!1,!0,r)}}else s.warn("when hungup stream. not found confr and service.",e)},subscribe:function(r,t,o,n,i,a){return e.default.targetDOM(i)||(a=i,i=void 0),U.call(this,a,t,o,n,i).toPromise()},exit:function(e,r){var t=this._service(r);t?t.exit(e):s.warn("when exit. not found service.",r)},_onExit:function(r,t,o){try{this.__current_confrId=void 0,this.onExit(t,o,r)}finally{e.default.removeAttribute(this._confrs,r),e.default.removeAttribute(this._services,r),e.default.removeAttribute(this._videos,r),e.default.removeAttribute(this._events,r)}},onExit:(e,r,t)=>{},_onRoleUpdated:(e,r)=>{},onMemberJoin:(e,r)=>{},onMemberLeave:(e,r,t)=>{},_onRecvRemoteMessage:function(e,r,t){},crtAndReturnVideo:(e,r,t)=>{},unloadVideo:(e,r,t,o)=>{},remoteControl:function(e,r,t,o,n,i,a,s,c,u,f){var d=this._service(f);o=!!o;var l="string"==typeof e?e:e.id;o?emedia.ctrl.mirrorControlled(d,l,r,t,n,i,a,s,c,u):emedia.ctrl.controlled(d,l,r,t,n,i,a,s,c,u)},freeRemoteControl:function(e,r){var t=this._service(r),o="string"==typeof e?e:e.id;emedia.ctrl.disControlled(t,o)},zeptoTrigger:function(e,t){var n=[];return Array.prototype.push.apply(n,Array.prototype.slice.call(arguments,2)),o.Observable.create(function(o){var i=[function(){o.error.apply(o,arguments)},function(){o.next.apply(o,arguments),o.complete()}];Array.prototype.push.apply(i,n),(0,r.default)(e).trigger(t,i)}).pipe(l).toPromise()},_onAddMemberStream:function(e,r){},_onRemoveMemberStream:function(e,r){},_onUpdateMemberStream:function(e,r,t){},_onMemberMediaChanaged:function(e,t,o,n){var i=this._videos[t.id];o&&(o.voff=t.voff,o.aoff=t.aoff),i&&(0,r.default)(i).trigger("onMediaChanaged",[o,t,e,n])},onMediaChanaged:function(e,r){this.addVideoEventListener(e,"onMediaChanaged",r)},_onMemberSoundChanaged:function(e,t,o,n){var i=this._videos[t.id];i&&(0,r.default)(i).trigger("onSoundChanaged",[o,t,e,n])},onSoundChanaged:function(e,r){if(!emedia.config.getMediaMeterIntervalMillis||emedia.config.getMediaMeterIntervalMillis<=0)throw s.error("monit sound chanaged not config. please config getMediaMeterIntervalMillis"),"monit sound chanaged not config. please config getMediaMeterIntervalMillis";e.setAttribute("sound","sound"),this.addVideoEventListener(e,"onSoundChanaged",r)},onMediaTransmission:function(e,r){if(emedia.helper&&"function"==typeof emedia.helper.inboundVideo){var t=this._service(),o=e.getAttribute("hx_stream"),n=o&&t.getStreamById(o),i=e.getAttribute("flowWebrtc");n&&n._webrtc&&i==n._webrtc.__id||(e.hasAttribute("flow")&&n&&n._webrtc?(n.located()?emedia.helper.outboundVideo(n,r,1e3):emedia.helper.inboundVideo(n,r,1e3),e.setAttribute("flowWebrtc",n._webrtc.__id)):(this.addVideoEventListener(e,"onMediaTransmission",r),e.setAttribute("flow","flow")))}else s.warn("please import helper. <script>")},_onTalking:function(e,r,t,o){},_onNotSupportMemberPublishVideoCodecs:function(e,t,o){var n=this._videos[t.id];n&&(0,r.default)(n).trigger("onNotSupportVideoCodecs",[t,e,o])},onNotSupportVideoCodecs:function(e,r){this.addVideoEventListener(e,"onNotSupportVideoCodecs",r)},_onStreamIceStateChanged:function(e,t,o,n){var i=this._videos[t.id];i&&(0,r.default)(i).trigger("onIceStateChanged",[o,t,e,n])},onIceStateChanged:function(e,r){this.addVideoEventListener(e,"onIceStateChanged",r)},onHasRemoteControl:function(e,t,o,n){var i=this._videos[e.id];i&&(0,r.default)(i).trigger("onRemoteControl",[t,o,e,n])},onRemoteControl:function(e,r){this.addVideoEventListener(e,"onRemoteControl",r)},onRemoteFreeControl:function(e,t,o,n){var i=this._videos[e.id];i&&(0,r.default)(i).trigger("onFreeControl",[t,o,e,n])},onFreeControl:function(e,r){this.addVideoEventListener(e,"onFreeControl",r)},addVideoEventListener:function(e,t,o){(0,r.default)(e).off(t),(0,r.default)(e).on(t,function(){for(var r=[],t=1;t<arguments.length;t++)r.push(arguments[t]);o&&o.apply(e,r)})}});t.default.each(["hungup","subscribe","pauseVideo","resumeVideo","pauseAudio","resumeAudio","chanageCamera","freeRemoteControl","capturePictureRemote","freezeFrameRemote"],function(e,r){var t=e.replace(/\b[a-z]/g,function(e){return e.toUpperCase()});W["trigger"+t]=function(r){var t=[];return t.push(r),t.push(e),Array.prototype.push.apply(t,Array.prototype.slice.call(arguments,1)),W.zeptoTrigger.apply(W,t)}}),W.triggerTorchRemote=function(e,t){return o.Observable.create(function(o){(0,r.default)(e).trigger("torchRemote",[t,function(){o.error.apply(o,arguments)},function(){o.next.apply(o,arguments),o.complete()}])}).pipe(l).toPromise()},W.triggerZoomRemote=function(e,t){return o.Observable.create(function(o){(0,r.default)(e).trigger("zoomRemote",[t,function(){o.error.apply(o,arguments)},function(){o.next.apply(o,arguments),o.complete()}])}).pipe(l).toPromise()},W.triggerSubscribe=function(e,t,n){return o.Observable.create(function(o){(0,r.default)(e).trigger("subscribe",[t,n,function(){o.error.apply(o,arguments)},function(){o.next.apply(o,arguments),o.complete()}])}).pipe(l).toPromise()},W.triggerRemoteControl=function(e,t,o,n,i,a,s,c){(0,r.default)(e).trigger("remoteControl",[t,o,n,i,a,s,c])},W.triggerCaptureVideo=function(e,t,n){return o.Observable.create(function(o){(0,r.default)(e).trigger("captureVideo",[function(){o.next.apply(o,arguments),o.complete()},t,n])}).pipe(l).toPromise()};let X=W;exports.single=X;
},{"../Util":"Qsy+","zepto-webpack":"75TC","underscore":"sd4Q","rxjs":"W5vH","rxjs/operators":"Dc+8","../_Stream":"/mhd","./EventsObservable":"da6W"}],"2RU2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.outer=void 0;var e=require("./Manager"),n=r(require("underscore")),o=r(require("zepto-webpack"));function r(e){return e&&e.__esModule?e:{default:e}}var i={};e.single.onMemberJoin=function(n,o){emedia.decodeMemeberName(n),this.onMemberJoined(n,e.single._confr(o))},e.single.onMemberLeave=function(n,o,r){emedia.decodeMemeberName(n),this.onMemberExited(n,o,e.single._confr(r))},e.single._onRoleUpdated=function(n,o){this.onRoleChanged(n,e.single._confr(o))},e.single._onAddMemberStream=function(n,o){n&&emedia.decodeMemeberName(n.owner),this.onStreamAdded(n.owner,n,e.single._confr(o))},e.single._onRemoveMemberStream=function(n,o){n&&emedia.decodeMemeberName(n.owner),this.onStreamRemoved(n.owner,n,e.single._confr(o))},e.single._onUpdateMemberStream=function(n,o,r){n&&emedia.decodeMemeberName(n.owner),this.onStreamUpdated&&this.onStreamUpdated(n.owner,n,o,e.single._confr(r))},e.single.onExit=function(n,o,r){this.onConferenceExit(n,o,e.single._confr(r))},i.onMemberJoined=function(e){},i.onMemberExited=function(e,n){},i.onRoleChanged=function(e){},i.onStreamAdded=function(e,n){},i.onStreamRemoved=function(e,n){},i.onConferenceExit=function(e,n){},i.joinConferenceWithTicket=e.single.joinUseTicket,i.joinConference=e.single.joinUsePassword,i.getConferenceTkt=e.single.reqTkt,i.publish=function(n,o,r){return e.single.shareVideoWithAudio(n.video,n.audio,o,r)},i.unpublish=function(n){return e.single.hungup(n)},i.unsubscribe=function(n){return e.single.hungup(n)},i.exitConference=function(n){return e.single.exit(n||!1)},i.getConferenceInfo=function(n,o){return e.single.selectConfr(n,o)},i.createConference=e.single.createConfr,i.createConfr=e.single.createConfrSptMnPrg,i.grantRole=function(n,o,r){return emedia.decodeMemeberName(o),e.single.chanageRoles(r,o,n.id)},i.kickMembersById=function(n,o){return emedia.decodeMemeberName(o),e.single.kickMember(o,n.id)},i.destroyConference=function(n){return e.single.disbandConfr(n,n.roleToken)},emedia.decodeMemeberName=function(e){if("function"!=typeof emedia.decodeMemeberNameString)return e;if("string"==typeof e)return emedia.decodeMemeberNameString(e);if(n.default.isArray(e)){for(var o=0;o<e.length;o++)e[o]=emedia.decodeMemeberName(e[o]);return e}return e.name?(e.globalName=e.name,void(e.memName=e.name=emedia.decodeMemeberName(e.name))):e.memName?(e.globalName=e.memName,void(e.memName=e.name=emedia.decodeMemeberName(e.memName))):void 0},emedia.ConfrType=e.single.ConfrType,emedia.Role=e.single.Role,(0,o.default)(function(){var n=window.WebIM;if(n&&n.conn&&"function"==typeof n.conn.onOpened){function o(){emedia.decodeMemeberNameString=function(e){if("string"==typeof e){if(e.indexOf(n.conn.orgName)<0)return e;var o=e.indexOf("_");o<0?o=0:o++;var r=e.indexOf("@");return r<0&&(r=e.length),e.substring(o,r)}return e},e.single.setUrlCreator(function(e,o){return n.conn.apiUrl+e}),e.single.setIdentity(n.conn.orgName+"#"+n.conn.appName+"_"+n.conn.user+"@"+n.conn.domain,n.conn.token)}var r=n.conn.onOpened;n.conn.onOpened=function(){r.apply(n.conn,arguments),o()},n.conn.token&&o()}});let t=n.default.extend(e.single,i);exports.outer=t;
},{"./Manager":"E8HX","underscore":"sd4Q","zepto-webpack":"75TC"}],"MXZN":[function(require,module,exports) {
var e=require("../../../webrtc/src/components/Util"),t=e.tagLogger("Mouse"),s=require("./MouseTrigger");module.exports=e.prototypeExtend({__init__:function(){this._handlers=e.extend({mousedown:this._handleMouseDown.bind(this),mouseup:this._handleMouseUp.bind(this),mousemove:this._handleMouseMove.bind(this),mousewheel:this._handleMouseWheel.bind(this),mousedisable:this._handleMouseDisable.bind(this),mouseover:this._handleMouseOver.bind(this),mouseout:this._handleMouseOut.bind(this)},this._handlers||{})},onMouseButton:function(e,t){},onMouseMove:function(e,t){},onMouseEnter:function(){},onMouseExit:function(){},_onMouseButton:function(e,t,o){var n=(new Date).getTime(),i=new s({xy:e,oper:t,btn:o,_time:n});this.onMouseButton&&this.onMouseButton(i,this._lastTrigger),this._lastTrigger=i},_onMouseMove:function(e){this.onMouseMove&&this.onMouseMove(e,this._lastTrigger)},_captureMouse:function(){this._target.setCapture&&this._target.setCapture(),this._mouseCaptured=!0},_releaseMouse:function(){this._target.releaseCapture&&this._target.releaseCapture(),this._mouseCaptured=!1},_resetDoubleClickTimer:function(){this._doubleClickTimer=null},_handleMouseOver:function(e){!1!==this._mouseExit&&(this._mouseExit=!1,this.onMouseEnter&&this.onMouseEnter())},_handleMouseOut:function(e){!0!==this._mouseExit&&(this._mouseExit=!0,this.onMouseExit&&this.onMouseExit()),this._lastTrigger=void 0},_handleMouseDown:function(e){this._captureMouse(),this._handleMouseButton(e,s.BTN.KEY_DOWN)},_handleMouseUp:function(e){this._mouseCaptured&&(this._handleMouseButton(e,s.BTN.KEY_UP),this._releaseMouse())},_handleMouseWheel:function(t){if(this._focused){t=t||window.event;var o=e.getEventElementXY(t,this._target,this._scale),n=(t.detail?-1*t.detail:t.wheelDelta/40)>0?s.BTN.WHEEL_ROLL_UP:s.BTN.WHEEL_ROLL_DOWN;this._onMouseButton(o,s.BTN.KEY_DOWN,n),e.stopEvent(t)}},_handleMouseMove:function(t){if(this._focused){t=t||window.event;var s=e.getEventElementXY(t,this._target,this._scale);this._onMouseMove(s),e.stopEvent(t)}},_handleMouseDisable:function(t){if(this._focused){t=t||window.event;var s=e.getEventElementXY(t,this._target,this._scale);try{return!(s.realX>=0&&s.realY>=0&&s.realX<this._target.offsetWidth&&s.realY<this._target.offsetHeight)}finally{e.stopEvent(t)}}},_handleMouseButton:function(t,o){if(this._focused){t=t||window.event;var n,i=e.getEventElementXY(t,this._target,this._scale);if(t.touches||t.changedTouches){if(o==s.BTN.KEY_DOWN){if(null===this._doubleClickTimer)this._lastTouchPos=i;else{clearTimeout(this._doubleClickTimer);var u=this._lastTouchPos.x-i.x,h=this._lastTouchPos.y-i.y;Math.sqrt(u*u+h*h)<20*window.devicePixelRatio&&(i=this._lastTouchPos)}this._doubleClickTimer=setTimeout(this._resetDoubleClickTimer.bind(this),500)}n=s.BTN.LEFT}else n=t.which?1<<t.button:(1&t.button)+2*(2&t.button)+(4&t.button)/2;this._onMouseButton(i,o,n),e.stopEvent(t)}},grab:function(){var t=this._target;e.addEvent(t,"mouseover",this._handlers.mouseover),e.addEvent(t,"mouseout",this._handlers.mouseout),e.addEvent(t,"touchstart",this._handlers.mousedown),e.addEvent(t,"touchend",this._handlers.mouseup),e.addEvent(t,"touchmove",this._handlers.mousemove),e.addEvent(t,"mousedown",this._handlers.mousedown),e.addEvent(t,"mouseup",this._handlers.mouseup),e.addEvent(t,"mousemove",this._handlers.mousemove),e.addEvent(t,e.layoutEngine.gecko?"DOMMouseScroll":"mousewheel",this._handlers.mousewheel),e.addEvent(t,"contextmenu",this._handlers.mousedisable)},ungrab:function(){var t=this._target;e.removeEvent(t,"mouseover",this._handlers.mouseover),e.removeEvent(t,"mouseout",this._handlers.mouseout),e.removeEvent(t,"touchstart",this._handlers.mousedown),e.removeEvent(t,"touchend",this._handlers.mouseup),e.removeEvent(t,"touchmove",this._handlers.mousemove),e.removeEvent(t,"mousedown",this._handlers.mousedown),e.removeEvent(t,"mouseup",this._handlers.mouseup),e.removeEvent(t,"mousemove",this._handlers.mousemove),e.removeEvent(t,e.layoutEngine.gecko?"DOMMouseScroll":"mousewheel",this._handlers.mousewheel),e.removeEvent(t,"contextmenu",this._handlers.mousedisable)}});
},{"../../../webrtc/src/components/Util":"Qsy+","./MouseTrigger":"oIaS"}],"xAnc":[function(require,module,exports) {
var e=require("../../../webrtc/src/components/Util"),n=e.tagLogger("Keyboard");module.exports=e.prototypeExtend({__init__:function(){this._eventHandlers={keyup:this._handleKeyUp.bind(this),keydown:this._handleKeyDown.bind(this),keypress:this._handleKeyPress.bind(this),blur:this._allKeysUp.bind(this)}},getKey:function(e){return"keyCode"in e&&"key"in e?e.key+":"+e.keyCode:"keyCode"in e?e.keyCode:e.key},onKeyPress:function(e,n){},_onKeyPress:function(e,n){this.onKeyPress&&this.onKeyPress(e,n)},_handleRfbEvent:function(e,n){e.shiftKey,e.ctrlKey,e.altKey;var t=e.keyCode||e.which;this._onKeyPress(t,"keydown"==n)},_handleKeyDown:function(n){return!this._focused||!this._handleRfbEvent(n,"keydown")||(e.stopEvent(n),!1)},_handleKeyPress:function(n){return!this._focused||(e.stopEvent(n),!1)},_handleKeyUp:function(n){return!this._focused||!this._handleRfbEvent(n,"keyup")||(e.stopEvent(n),!1)},_allKeysUp:function(){},sync:function(e){},grab:function(){var t=this._target;e.addEvent(t,"keydown",this._eventHandlers.keydown),e.addEvent(t,"keyup",this._eventHandlers.keyup),e.addEvent(t,"keypress",this._eventHandlers.keypress),e.addEvent(t,"blur",this._eventHandlers.blur),n.info("keyboard grab at element")},ungrab:function(){var t=this._target;e.removeEvent(t,"keydown",this._eventHandlers.keydown),e.removeEvent(t,"keyup",this._eventHandlers.keyup),e.removeEvent(t,"keypress",this._eventHandlers.keypress),e.removeEvent(t,"blur",this._eventHandlers.blur),this._allKeysUp(),n.info("keyboard upgrab at element")}});
},{"../../../webrtc/src/components/Util":"Qsy+"}],"gITI":[function(require,module,exports) {
var e=require("../../../webrtc/src/components/Util"),n=e.tagLogger("EventBuffer");module.exports=e.prototypeExtend({_buffer:[],_sn:1,_beginIndex:0,_readIndex:0,_endIndex:0,_nextsn:function(){return this._sn++},put:function(e){e&&(e.sn=this._nextsn(),this._buffer.push(e),this._endIndex++)},_getUnread:function(e){return this._readIndex===this._endIndex?1===e?void 0:[]:this._buffer[this._readIndex]},getUnread:function(e){var n;try{return n=this._getUnread(e)}finally{n&&(this._readIndex+=1===e?1:n.length)}},getUnreadSize:function(){return this._endIndex-this._readIndex},getUnclearSize:function(){return this._readIndex-this._beginIndex},clearRead:function(e){if(this._readIndex!==this._beginIndex){for(var n=0,t=this._beginIndex;t<this._readIndex&&this._buffer[t].sn<=e;t++)n++;if(0===n)return 0;for(t=0;t<n;t++)this._buffer.shift();return this._beginIndex=0,this._readIndex-=n,this._endIndex-=n,n}}});
},{"../../../webrtc/src/components/Util":"Qsy+"}],"BupH":[function(require,module,exports) {
var e=require("../../../webrtc/src/components/Util"),n=e.tagLogger("TrackBuffer");module.exports=e.prototypeExtend({mouseTrackBufferSize:1e3,_sn:1,_compRadio:.25,_beginIndex:0,_readIndex:0,_endIndex:0,__init__:function(){this._mouseTrackBuffer=new Array(this.mouseTrackBufferSize)},_nextsn:function(){return this._sn++},_index:function(e){return e%this.mouseTrackBufferSize},comp1:function(e){if(!(e>=1)){for(var n=Math.floor(1/e),i=this._beginIndex,t=i+1;i<this._endIndex;){for(var r=2;r<n&&i+r<this._endIndex;r++)this._mouseTrackBuffer[this._index(t++)]=this._mouseTrackBuffer[this._index(i+r)];i+=n}this._endIndex=t}},put1:function(e){if(e){e.sn=this._nextsn(),this._endIndex-this._readIndex===this.mouseTrackBufferSize&&(this.comp1(this._compRadio),this._readIndex=this._beginIndex);var n=this._index(this._beginIndex),i=(this._index(this._readIndex),this._index(this._endIndex));i<=n&&i>=0&&this._endIndex>this._beginIndex&&this._beginIndex++,this._mouseTrackBuffer[i]=e,this._endIndex++}},compHalfOfUnread:function(){for(var e=this._readIndex+2,n=this._readIndex+1;e<this._endIndex;)this._mouseTrackBuffer[this._index(n++)]=this._mouseTrackBuffer[this._index(e)],e+=2;this._endIndex=n},put:function(e){if(e){e.sn=this._nextsn(),this._endIndex-this._beginIndex===this.mouseTrackBufferSize&&this.compHalfOfUnread();var n=this._index(this._endIndex);this._mouseTrackBuffer[n]=e,this._endIndex++}},_interval:function(e,n){var i=this._index(e),t=this._index(n);if(i<t)return this._mouseTrackBuffer.slice(i,t);var r=this._mouseTrackBuffer.slice(i);return Array.prototype.push.apply(r,this._mouseTrackBuffer.slice(0,t)),r},_getUnread:function(e){return this._readIndex===this._endIndex?1===e?void 0:[]:this._mouseTrackBuffer[this._index(this._readIndex)]},getUnread:function(e){var n;try{return n=this._getUnread(e)}finally{n&&(this._readIndex+=1===e?1:n.length)}},getUnreadSize:function(){return this._endIndex-this._readIndex},getUnclearSize:function(){return this._readIndex-this._beginIndex},clearRead:function(e){if(this._readIndex!==this._beginIndex){for(var n=0,i=this._beginIndex;i<this._readIndex;i++){var t=this._index(i);if(!(this._mouseTrackBuffer[t].sn<=e))break;this._beginIndex++,n++}return n}}});
},{"../../../webrtc/src/components/Util":"Qsy+"}],"7uAM":[function(require,module,exports) {
var e=require("../../../webrtc/src/components/Util"),t=e.tagLogger("TotalBuffer"),r=require("./EventBuffer"),n=require("./TrackBuffer"),f=require("./MouseTrigger");module.exports=e.prototypeExtend({trackBufferSize:100,_trackBufferCompRadio:.25,_sn:1,__init__:function(){this._eventBuffer=new r({_nextsn:this._nextsn.bind(this)}),this._trackBuffer=new n({_nextsn:this._nextsn.bind(this),_compRadio:this._trackBufferCompRadio,mouseTrackBufferSize:this.trackBufferSize})},_nextsn:function(){return this._sn++},put:function(e){e&&void 0!==e.oper&&(e.oper===f.BTN.MOVE?this._trackBuffer.put(e):this._eventBuffer.put(e))},getUnread1:function(e){function t(e,t){return e._time-t.time}var r;if(!e){var n=this._eventBuffer.getUnread(),i=this._trackBuffer.getUnread();return Array.prototype.push.apply(n,i),(r=n).sort(t),r}r=[];n=this._eventBuffer._getUnread(e),i=this._trackBuffer._getUnread(e);Array.prototype.push.apply(r,n),Array.prototype.push.apply(r,i),r.sort(t),r=r.slice(0,e>r.length?r.length:e);for(var u=0;u<r.length;u++)r[u].oper===f.BTN.MOVE?this._trackBuffer.getUnread(1):this._eventBuffer.getUnread(1);return r},getUnread:function(e){e||(e=this._eventBuffer.getUnreadSize()+this._trackBuffer.getUnreadSize());for(var t=[];t.length!==e;){var r=this._eventBuffer._getUnread(1),n=this._trackBuffer._getUnread(1);if(void 0===r&&n)t.push(this._trackBuffer.getUnread(1));else if(void 0===n&&r)t.push(this._eventBuffer.getUnread(1));else{if(void 0===n&&void 0===r)return t;r.sn<n.sn?t.push(this._eventBuffer.getUnread(1)):t.push(this._trackBuffer.getUnread(1))}}return t},getUnreadSize:function(){return this._trackBuffer.getUnreadSize()+this._eventBuffer.getUnreadSize()},getUnclearSize:function(){return this._trackBuffer.getUnclearSize()+this._eventBuffer.getUnclearSize()},clearRead:function(e){return this._eventBuffer.clearRead(e)+this._trackBuffer.clearRead(e)}});
},{"../../../webrtc/src/components/Util":"Qsy+","./EventBuffer":"gITI","./TrackBuffer":"BupH","./MouseTrigger":"oIaS"}],"Svh7":[function(require,module,exports) {
var e=require("./Util"),r=e.tagLogger("PannelVideo"),t=require("../../../pannel/src/components/Mouse"),o=require("../../../pannel/src/components/Keyboard"),n=require("../../../pannel/src/components/MouseTrack"),i=require("../../../pannel/src/components/MouseTrigger"),c=require("../../../pannel/src/components/TotalBuffer");function s(e){s._overrideCount++,s.overrideObj!==e&&(s.overrideObj=e,a.override=e.listeners.onRemoveMember,a.overrideService=e,e.listeners.onRemoveMember=a)}function a(t,o){try{var n=t&&t.id&&C(a.overrideService,t.id);n&&n.length&&e.forEach(n,function(e,o){r.warn("Remove member. free remote controller. it is ",o.id,o._ctrlStream.id,o._controller.memName,t.id),o._free(),o._callbacks&&o._callbacks.onRemoteFreeControl&&o._callbacks.onRemoteFreeControl(o._ctrlStream,o._controller,o._cId)})}finally{a.override&&a.override.apply(this,arguments)}}function u(e){u._overrideCount++,u.overrideObj!==e&&(u.overrideObj=e,m.override=e.listeners.onRemoveStream,m.overrideService=e,e.listeners.onRemoveStream=m)}function l(e){}function m(e){f(m.overrideService,e),m.override&&m.override.apply(this,arguments)}function f(r,t){k(r,t.id);var o=w(r,t);o&&e.forEach(o,function(e,r){r._free&&r._free()}),e.removeAttribute(r.current.__remoteControls,t.id)}function d(e){if(d._overrideCount++,d.overrideObj!==e){d.overrideObj=e;var r=e.onHungup;e.onHungup=function(t){f(e,t),r&&r.apply(this,arguments)}.bind(e)}}function _(e,r){if(_._overrideCount++,_.overrideObj!==e){_.overrideObj=e;var t=e._onRemotePannelControl;e._onRemotePannelControl=function(e){I(this,e,!1,r),t&&t.apply(this,arguments)}.bind(e)}}function v(e){}function h(r,t,o){var n=[];o&&e.forEach(o.actions,function(e,r){r.xy&&n.push({x:Math.round(1e4*r.xy.x),y:Math.round(1e4*r.xy.y),oper:r.oper,btn:r.btn,sn:r.sn,_time:r._time}),r.xy||n.push({oper:r.oper,btn:r.btn,sn:r.sn,_time:r._time})});var i={op2:30,evt:0,streamId:t.id,actions:n,cId:o.cId};return r.current.newMessage({op:1002,memId:t.owner.id,arg:JSON.stringify(i),_reqOps:[100230]})}function p(r){"string"==typeof r.arg&&(r.arg=JSON.parse(r.arg));var t=r.arg,o=[],n=[];t&&t.actions&&e.forEach(t.actions,function(e,r){void 0!==r.x&&void 0!==r.y&&o.push({xy:{x:r.x/1e4,y:r.y/1e4},oper:r.oper,btn:r.btn,sn:r.sn,_time:r._time}),(void 0===r.x||void 0===r.y)&&n.push({oper:r.oper,btn:r.btn,sn:r.sn,_time:r._time})}),t.mouse=o,t.keyboard=n}s._overrideCount=0,u._overrideCount=0,d._overrideCount=0,_._overrideCount=0;var y=0,g=e.prototypeExtend({__init__:function(){this.id=y++},accept:function(t,o){var n=this;if(n.hasOtherControl())throw n.busy(),r.error("Other has been controled."),"Other has been controled.";var i=!1,c=w(this._service,this._ctrlStream,this._controller);(c&&e.forEach(c,function(e,r){r.id<n.id?r._free():i=!0}),i)?n._free():((this._service.current.__remoteControls||(this._service.current.__remoteControls={}))[n.id]=n,K(this,t,o),b(this._service,this._reqevt,0))},controlling:function(){var r=this,t=[],o=w(this._service,this._ctrlStream);return o&&e.forEach(o,function(e,o){o._controller.memName===r._controller.memName&&t.push(o)}),t&&t.length?t:void 0},hasOtherControl:function(){var r=this,t=!1,o=w(this._service,this._ctrlStream);return o&&e.forEach(o,function(e,o){o._controller.memName!=r._controller.memName&&(t=!0)}),t},busy:function(){b(this._service,this._reqevt,-403)},reject:function(){b(this._service,this._reqevt,-402)},_free:function(){e.removeAttribute(this._service.current.__remoteControls,this.id)},forceDisconnect:function(){var t=w(this._service,this._ctrlStream);t&&e.forEach(t,function(e,r){r._free&&r._free()}),r.info("remote control force disconnect")}});function b(e,r,t){e.current.message({op:1001,tsxId:r.tsxId,memId:r.memId,arg:JSON.stringify({cId:r.arg.cId}),result:t}).post()}function x(e,r){b(e,r,-405)}function C(r,t,o){var n=[];return r.current.__remoteControls&&e.forEach(r.current.__remoteControls,function(e,r){o&&r._ctrlStream.id!==o.id||t&&r._controller.id!==t||n.push(r)}),n}function w(r,t,o,n){var i=[];return r.current.__remoteControls&&e.forEach(r.current.__remoteControls,function(e,r){t&&r._ctrlStream.id!==t.id||o&&r._controller.memName!==o.memName||n&&r._cId!==n||i.push(r)}),i}function I(t,o,n,c){p(o);var s=o.arg,a=s.cId,u=s.streamId,l=t.getMemberById(o.memId),m=t.getStreamById(u);if(n||!function(){if(!l||!m)return x(t,o),!0;if(1===s.evt){var r,n=new g({_service:t,_controller:l,_ctrlStream:m,_cId:a,_reqevt:o,_callbacks:c});return n.hasOtherControl()?(n.busy(),!0):(r=n.controlling())?(e.forEach(r,function(e,r){r._cId=a}),b(t,o,0),!0):(c&&c.onHasRemoteControl&&c.onHasRemoteControl(m,l,n),!0)}if(2===s.evt){var i=w(t,m,l,a);return i&&e.forEach(i,function(e,r){r._free&&r._free(),b(t,o,0)}),c&&c.onRemoteFreeControl&&c.onRemoteFreeControl(m,l,a),!0}}()){var f=w(t,m,l,a);if(n||f&&0!==f.length||x(t,o),f&&e.forEach(f,function(e,r){r._lastRecvTimestamp=(new Date).getTime()}),n){var d=t.current.__remoteControls[m.id];f=f||[],d&&f.push(d)}e.forEach(f,function(c,a){var u,l=0;if((u=s.mouse)&&u.length>0)try{e.forEach(u,function(e,r){r.sn>l&&(l=r.sn),r.oper===i.BTN.MOVE?a.mouseTrack&&a.mouseTrack.track(r.xy):a.mouseTrack&&a.mouseTrack.trigger(new i(r))})}catch(m){r.warn(m)}if((u=s.keyboard)&&u.length>0)try{e.forEach(u,function(e,r){r.sn>l&&(l=r.sn),a.keyboard&&(r.oper===i.BTN.KEYBOARD_DOWN?a.keyboard.onKeyDown(r.btn):r.oper===i.BTN.KEYBOARD_UP&&a.keyboard.onKeyUp(r.btn))})}catch(m){r.warn(m)}if(!0!==n)try{t.current.message({op:1001,tsxId:o.tsxId,memId:o.memId,arg:JSON.stringify({sn:l}),result:0}).post(function(e){r.debug("Send remote control response. the result = ",e.result,e.msg||"")})}catch(m){r.warn(m)}})}}function M(e,r,t,o,n){o&&o()}function S(e,r,t,o,n){o&&o()}function R(e,r,t,o,n,c,s){var a=e.eventXYAtMedia(o,t);a&&(O(e,{xy:a={x:a.x/a.width,y:a.y/a.height},oper:i.BTN.MOVE,sid:r},s),c&&c(a,n))}function N(r,t,o,n,i,c,s){n.xy=r.eventXYAtMedia(n.xy,o),n.xy&&(n.xy={x:n.xy.x/n.xy.width,y:n.xy.y/n.xy.height},e.extend(n,{sid:t}),O(r,n,s),c&&c(n,i))}function E(e,r,t,o,n,i){O(e,{oper:t,btn:o,sid:r},i),n&&n(t,o)}function B(e){var r=document.createElement("div");r.style=e.style,r.style.background="transparent",e.parentNode.appendChild(r)}function O(t,o,n){var i=o.sid,c=t.getStreamById(i);t.current.__remoteControls&&t.current.__remoteControls[i]&&I(t,h(t,c,{actions:[o]}),!0);var s=t.current.__pannelBuffers[i],a=s.getUnclearSize();if(s.put(o),a<emedia.config.allowSendWhenLessThan){!function o(){for(var a=s.getUnread(),u=0,l=0;a&&l<a.length;l++){var m=a[l];e.removeAttribute(m,"sid"),u<m.sn&&(u=m.sn)}a&&0!==a.length&&(r.debug(i,"buffer remain:",s.getUnclearSize(),", send evt:",a.length),t.current.postMessage(h(t,c,{actions:a,cId:s._cId}),function(t){if(-402!==t.result)if(-403!==t.result)if(-408!==t.result){if(-507===t.result||-405===t.result)return s.clearRead(u),void(n&&n.onNotAllowRemoteControl&&n.onNotAllowRemoteControl(c));0===t.result&&(s._lastRspTimestamp=(new Date).getTime());var a=t.arg;a&&(a=JSON.parse(a))&&!e.isInt(a.sn)?r.warn("rsp.sn not a Number.",a.sn,"for streamId",i):a&&void 0!==a.sn&&s.clearRead(a.sn),o()}else n&&n.onRemoteControlTimeout&&n.onRemoteControlTimeout(c);else n&&n.onBusy&&n.onBusy(c);else n&&n.onReject&&n.onReject(c)}))}()}}function k(t,o){var n,i=t.current.__pannelMouses&&e.removeAttribute(t.current.__pannelMouses,o),c=t.current.__pannelKeyboards&&e.removeAttribute(t.current.__pannelKeyboards,o);if(t.current.__pannelBuffers&&(n=e.removeAttribute(t.current.__pannelBuffers,o)),i&&i.ungrab(),c&&c.ungrab(),l(t),n){var s=t.getStreamById(o);if(n._callbacks&&n._callbacks.onDisControlled&&n._callbacks.onDisControlled(s),s){var a=t.current.newMessage({op:1002,memId:s.owner.id,arg:JSON.stringify({op2:30,streamId:s.id,evt:2,cId:n._cId}),_reqOps:[100230]});t.current.postMessage(a,function(e){0!==e.result&&r.warn("Unkown result：",e.result)})}}}function T(r,t,o,n){var i={};e.forEach(arguments,function(e,r){"function"==typeof r&&(i[r.name]=r)}),q(r,t,o,!0,n,i)}function A(r,t,o,n){var i={};e.forEach(arguments,function(e,r){"function"==typeof r&&(i[r.name]=r)}),q(r,t,o,!1,n,i)}function q(e,t,o,n,i,c){var s=Math.uuidFast();s=s.substr(s.length-6,6);var a=e.getStreamById(t);if(!a._webrtc)throw c&&c.onNotAllowRemoteControl&&c.onNotAllowRemoteControl(a),r.error("Not allow control. cause by the stream not sub"),"Not allow control. cause by the stream not sub";var u={op2:30,streamId:a.id,evt:1,cId:s},l=e.current.newMessage({op:1002,memId:a.owner.id,arg:JSON.stringify(u),_reqOps:[100230]});e.current.postMessage(l,function(u){if(-402!==u.result)if(-403!==u.result)if(-408!==u.result)if(-507!==u.result&&-405!==u.result){if(0===u.result)return j(e,t,o,n,i,c,s,!0),void(c&&c.onAccept&&c.onAccept(a));r.warn("Unkown result：",u.result),c&&c.onNotAllowRemoteControl&&c.onNotAllowRemoteControl(a)}else c&&c.onNotAllowRemoteControl&&c.onNotAllowRemoteControl(a);else c&&c.onRemoteControlTimeout&&c.onRemoteControlTimeout(a);else c&&c.onBusy&&c.onBusy(a);else c&&c.onReject&&c.onReject(a)})}function j(e,n,s,a,u,l,m,f){void 0===u&&(u=s);var d=e.getStreamById(n),_=(e.current.__pannelMouses||(e.current.__pannelMouses={}))[n];if(_&&k(e,n),!d.located()&&!d.owner.acptOps[1003])throw r.error("which do not recv remote message, it is ",d.owner.memName),d.owner.memName+" do not recv remote message";_=new t({_target:u,_focused:!0,onMouseEnter:function(){M.call(_,e,n,s,l&&l.onMouseEnter,l),v&&v.grab()},onMouseExit:function(){S.call(_,e,n,s,l&&l.onMouseExit,l),v&&v.ungrab()},onMouseButton:function(r,t){!0===a&&(r.xy.x=-r.xy.x),N.call(_,e,n,s,r,t,l&&l.onMouseButton,l)},onMouseMove:function(r,t){emedia.config.disableTrack||(!0===a&&(r.x=-r.x),R.call(_,e,n,s,r,t,l&&l.onMouseMove,l))}});var v;(e.current.__pannelBuffers||(e.current.__pannelBuffers={}))[n]=new c({_cId:m,_callbacks:l,trackBufferSize:emedia.config.trackBufferSize||1e3});(e.current.__pannelMouses||(e.current.__pannelMouses={}))[n]=_,_.grab(),f&&(v=new o({_target:document,_focused:!0,onKeyPress:function(r,t){var o=t?i.BTN.KEYBOARD_DOWN:i.BTN.KEYBOARD_UP,c=r;E.call(v,e,n,o,c,l&&l.onKeyboard,l)}}),(e.current.__pannelKeyboards||(e.current.__pannelKeyboards={}))[n]=v)}function D(e,r,o,n){var i=new t({_target:e,_focused:!0,onMouseEnter:function(){},onMouseExit:function(){r.releaseTrigger()},onMouseButton:function(e,t){e.xy={x:e.xy.x/e.xy.width,y:e.xy.y/e.xy.height},!0===n&&(e.xy.x=-e.xy.x),o&&(e.xy=emedia.Service.prototype.eventXYAtMedia.call(null,e.xy,o)),e.xy&&r.trigger(e)},onMouseMove:function(e,t){e={x:e.x/e.width,y:e.y/e.height},!0===n&&(e.x=-e.x),o&&(e=emedia.Service.prototype.eventXYAtMedia.call(null,e,o)),e&&r.track(e)}});return i.grab(),i}function K(e,r,t){var o=r;o&&(e.mouseTrack=o),e.keyboard=t}function U(r){var t={};e.forEach(arguments,function(e,r){0!=e&&"function"==typeof r&&(t[r.name]=r)}),d(r),u(r),s(r),_(r,t),P(r)}function J(e,r){var t=e.getStreamById(r),o=w(e,t);if(o&&0!==o.length)return o[0]._controller.memName}function Y(e,r,t,o){var n=e.getStreamById(r),i={_ctrlStream:n,_controller:n.owner,_service:e};K(i,t,o),(e.current.__remoteControls||(e.current.__remoteControls={}))[r]=i}function F(r,t){e.removeAttribute(r.current.__remoteControls,t)}var P=function(t){var o,n;(P.timeoutId&&clearTimeout(P.timeoutId),P.timeoutId=setTimeout(function(){P(t)},emedia.config.ctrlCheckIntervalMillis),t.current)&&((o=t.current.__remoteControls)&&e.forEach(o,function(e,t){if(void 0!==t.id&&e==t.id){var o=(new Date).getTime();t._lastRecvTimestamp&&o-t._lastRecvTimestamp>emedia.config.ctrlTimeoutMillis&&(r.warn("Timeout for remote controller. it is ",t.id,t._ctrlStream.id,t._controller.memName),t._free(),t._callbacks&&t._callbacks.onRemoteFreeControl&&t._callbacks.onRemoteFreeControl(t._ctrlStream,t._controller,t._cId))}}),(n=t.current.__pannelBuffers)&&e.forEach(n,function(e,r){var o=t.getStreamById(e);o&&!o.located()&&t.current.message({op:1002,memId:o.owner.id,arg:JSON.stringify({op2:30,streamId:o.id,evt:3,cId:r._cId}),_reqOps:[100230]}).post(function(e){})}))};module.exports={mirrorControlled:T,controlled:A,disControlled:k,controlling:K,graffiti:D,echoControl:Y,disEchoControl:F,support:U,getController:J};
},{"./Util":"Qsy+","../../../pannel/src/components/Mouse":"MXZN","../../../pannel/src/components/Keyboard":"xAnc","../../../pannel/src/components/MouseTrack":"LM64","../../../pannel/src/components/MouseTrigger":"oIaS","../../../pannel/src/components/TotalBuffer":"7uAM"}],"5Z4V":[function(require,module,exports) {
var t=require("./Util"),e=t.tagLogger("CompositeCanvas");function o(){}for(var n in CanvasRenderingContext2D.prototype)!function(t){o.prototype[t]=function(){if("function"==typeof this._canvasContext[t])this._canvasContext[t].apply(this._canvasContext,arguments);else{var e=arguments.length>=1?arguments[0]:void 0;if(!e)return this._canvasContext[t];this._canvasContext[t]=e}}}(n);var i=t.prototypeExtend(o,{__init__:function(){this.compositeCanvasTag||(this.compositeCanvasTag=document.createElement("canvas")),this._canvasContext=this.compositeCanvasTag.getContext("2d"),this._canvasContext.globalAlpha=void 0!==this._globalAlpha?this._globalAlpha:1,this._compositeOperation=this._compositeOperation||a.source_over,this.globalCompositeOperation(this._compositeOperation)},setCanvas:function(){for(var o,n=this,i=0;i<arguments.length;i++)"function"==typeof(o=arguments[i])&&o(this.compositeCanvasTag,this._canvasContext),"function"!=typeof o&&t.isPlainObject(o)&&t.forEach(o,function(t,o){e.debug("Canvas set ",t," = ",o),n.compositeCanvasTag.setAttribute(t,o)});return n},getCanvasImageData:function(t,e){for(var o=[],n=1;n<arguments.length;n++)o.push(arguments[n]);var i=t.getContext("2d");return i.globalAlpha=e||0,i.getImageData.apply(i,o)},_composite:function(t){return new i(this,{_compositeOperation:t})},composite:function(t){return this.globalCompositeOperation(t),this},requestAnimationFrame:function(t){var e=this;return e.requestFrame(),e._requestAnimationFrameStart=window.requestAnimationFrame(function(t){e.requestAnimationFrame(t)}),e},cancelAnimationFrame:function(){return this._requestAnimationFrameStart&&window.cancelAnimationFrame(this._requestAnimationFrameStart),this},requestFrame:function(t){var o;if("function"!=typeof this.requestOneFrame)throw e.error("Pleas implement requestOneFrame()"),"Pleas implement requestOneFrame()";try{this.requestOneFrame()}catch(i){e.error(i)}if(t&&(o=Math.floor(1e3/t)),!o)return this;var n=this.requestFrame.bind(this);return this.intervalId=setInterval(function(){n(t)},o),this},stopRequestFrame:function(){return this.intervalId&&clearInterval(this.intervalId),this}});i.CompositeOperation=["source-atop","source-in","source-out","source-over","destination-atop","destination-in","destination-out","destination-over","lighter","darker","xor","copy"];var a=i.operation={source_atop:"source-atop",source_in:"source-in",source_out:"source-out",source_over:"source-over",destination_atop:"destination-atop",destination_in:"destination-in",destination_out:"destination-out",destination_over:"destination-over",lighter:"lighter",darker:"darker",xor:"xor",copy:"copy"};i.compositeVideoOverCanvas=function(t,e,o){var n;return(n=t.compositeCanvas)||(n=new i({compositeCanvasTag:t,requestOneFrame:function(){e&&n.drawImage(e,0,0,t.width,t.height),o&&n.drawImage(o,0,0,t.width,t.height)}}),t.compositeCanvas=n),n},module.exports=i;
},{"./Util":"Qsy+"}],"RjIC":[function(require,module,exports) {
var o=require("../../../webrtc/src/components/Util"),e=o.tagLogger("Keyboard");module.exports=o.prototypeExtend({onKeyDown:function(o){},onKeyUp:function(o){}});
},{"../../../webrtc/src/components/Util":"Qsy+"}],"8Qcp":[function(require,module,exports) {
window.emedia=window.emedia||{};var e=require("./Util"),o=e.tagLogger("electron");emedia.electron=window.require("electron"),emedia.chooseElectronDesktopMedia=function(e,i,n){o.info("Choose desktop. ",e[0]),i(e[0])};
},{"./Util":"Qsy+"}],"xl1W":[function(require,module,exports) {
var e=window.emedia=window.emedia||{},n=e.util=require("./components/Util"),t=require("zepto-webpack");if(e.config=function(t){for(var o in t=n.extend({},t))e.config[o]=t[o],"logLevel"===o&&(e.LOG_LEVEL=t[o]);e.config.loglastConfrCount&&!e._logContext&&(e._logContext=new Array(e.config.loglastConfrCount),e._logContextIndex=-1)},e.config({autoSub:!0,onlyEnter:!1,reconnect:13,reconnectDelay:3e3,getCopyIntervalMillis:3e4,checkConnectIntervalMillis:1e3,iceRebuildCount:3,iceRebuildIntervalMillis:500,enterTimeout:2e4,useRTCCfgIfServerReturn:!1,forceUseRTCCfgIfServerReturnWhenP2P:!0,allowRepeatAudioMixerPublish:!1,logVolumeWhenInstantGE:.5,getMediaMeterIntervalMillis:400,_useRequestAnimationFrame:!1,meterWithTrackAudioLevel:!1,judgeTalkingByInstantGE:.05,_printSoundData:!1,trackBufferSize:20,allowSendWhenLessThan:4,disableTrack:!1,ctrlCheckIntervalMillis:1e4,ctrlTimeoutMillis:3e4,_printDebugStats:!1,statsSeconds:10,remainLastStatsCount:120,loglastConfrCount:2,loglastStoreArray:!0,consoleLogger:!0,printStatsWhenPCClose:!0,rebuildPeerConnectionWhenNetworkChanaged:!0,rtcStatsTypeMath:function(e,n){switch(e.type){case"remote-candidate":case"local-candidate":case"track":case"stream":case"inbound-rtp":case"outbound-rtp":case"transport":return!0}return!1}}),n.logger.count(),function(){var n=require("./_adapter/_Adapter.import").default;if(e.browser=n.__browser,e.browserVersion=n.__browserVersion,void 0===e.browser)throw"Not discern browser. may require adapter error. eg. it.default"}(),n.logger.info("Current browser",e.browser,e.browserVersion),e.AudioContext=window.AudioContext||window.webkitAudioContext,e.config.getMediaMeterIntervalMillis){try{"function"==typeof e.AudioContext?(e.__audioContext=new e.AudioContext,e.__usingWebAudio=!0):e.__usingWebAudio=!1}catch(s){e.__usingWebAudio=!1}e.__usingWebAudio&&"suspended"===e.__audioContext.state&&t(function(){var t=function(){"suspended"===e.__audioContext.state&&e.__audioContext.resume(),n.logger.warn("AudioContext state suspended ->",e.__audioContext.state),setTimeout(function(){"running"===e.__audioContext.state&&(document.body.removeEventListener("touchend",t,!1),document.body.removeEventListener("click",t,!1))},0)};document.body.addEventListener("touchend",t,!1),document.body.addEventListener("click",t,!1)}),e.__usingWebAudio||console.warn("'new AudioContext()' failed. can not know who talking."),e.__audioContext&&"suspended"===e.__audioContext.state&&console.warn("audioContext.state is suspended. can not know who talking. You can resume() emedia.__audioContext, but only in response to a tap.")}if(window.requestAnimationFrame&&e.config._useRequestAnimationFrame?e.requestAnimationFrame=function(e){window.requestAnimationFrame(e)}:e.requestAnimationFrame=function(n,t){return setTimeout(n,t||e.config.getMediaMeterIntervalMillis)},window.cancelAnimationFrame&&e.config._useRequestAnimationFrame?e.cancelAnimationFrame=function(e){window.cancelAnimationFrame(e)}:e.cancelAnimationFrame=function(e){clearTimeout(e)},e.isWifi=function(){try{var e=!0,n=window.navigator.userAgent,t=window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection;if(/MicroMessenger/.test(n)){if(n.indexOf("WIFI")>=0)return!0;e=!1}else if(t){var o=t.type;"wifi"!==o&&"2"!==o&&"unknown"!==o&&(e=!1)}return e}catch(s){return!1}},e.stopAudioTracks=function(e){e&&e.getAudioTracks().forEach(function(t){t.stop(),n.logger.info("Media stream stop audio track. stream =",e.id,"track =",t.id,t.kind)})},e.stopAndRemoveAudioTracks=function(e){var t=[];e&&e.getAudioTracks().forEach(function(o){o.stop(),t.push(o),n.logger.info("Media stream stop and remove audio tracks. stream =",e.id,"track =",o.id,o.kind)}),n.forEach(t,function(n,t){e.removeTrack(t)})},e.stopTracks=function(e){try{if(!e||!1===e.active)return void n.logger.debug("stream tracks had been stoped. it ",e&&e.id);e.getTracks().forEach(function(t){t.stop(),n.logger.info("Media stream stop track. stream =",e.id," track =",t.id,t.kind)}),e._bindAttendee&&(n.removeAttribute(e._bindAttendee._openedRtcMediaStreams,e.id),e._bindAttendee=null),n.logger.info("stream tracks stoped. it ",e.id)}catch(s){n.logger.error(s)}},e.enableVideoTracks=function(e,t){e&&e.getVideoTracks().forEach(function(o){if("function"==typeof o.enable)return o.enable(),n.logger.info("Media stream enable video track. stream =",e.id,"track =",o.kind,o.enabled,o.id),void(o.enabled===t||o.enable(t));o.enabled===t||(o.enabled=t)})},e.enableAudioTracks=function(e,t){e&&e.getAudioTracks().forEach(function(o){if("function"==typeof o.enable)return o.enable(),n.logger.info("Media stream enable audio track. stream =",e.id,"track =",o.kind,o.enabled,o.id),void(o.enabled===t||o.enable(t));o.enabled===t||(o.enabled=t)})},e.hasEnabledTracks=function(e){if(!e||"function"!=typeof e.getAudioTracks)return!1;if(!e.active)return!1;var n=e.getAudioTracks();if(0===n.length)return!1;for(var t in n)if("function"==typeof n[t].enable&&n[t].enable(),n[t].enabled)return!0;return!1},e.genReportName=function(){var n=e._lastSetupDate||new Date;return(e._lastSetupTktId||e._lastSetupConfr)+"_"+e._lastSetupMemName+"_"+n.getTime()+".log"},e.getReportUploadUrl=function(e,n,t){var o=new XMLHttpRequest;o.open(e,n,!0),o.addEventListener("load",function(e){t&&t(e)},!1),o.send(null)},e.uploadReport=function(t,o,r,i,a,s){var u=e.genReport();if(u){"function"==typeof r&&(s=a,a=i,i=r,r=void 0);var d=new Blob([u],{type:"text/plain"}),c=new FormData;c.append(t,d,t),r&&"function"==typeof c.set&&n.forEach(r,function(e,n){c.set(e,n)});var l=new XMLHttpRequest;l.open("POST",o,!0),l.setRequestHeader("X-File-Name",t),s&&s(l),l.addEventListener("load",function(e){console.info("log begin upload. result = ",e.currentTarget.status,t," > ",o),200===e.currentTarget.status?i&&i(e):a&&a(e)},!1),l.send(c),console.info("log begin upload. ",t," > ",o)}else a&&a("not logs")},e.genReport=function(){if(e._logContext&&e._logContext instanceof Array&&!(void 0===e._logContextIndex||e._logContextIndex<0)){var n=0,t=e._logContextIndex;e._logContextIndex>=e._logContext.length&&(n=e._logContextIndex-e._logContext.length+1);for(var o="",r=n;r<=t;r++){var i=r%e._logContext.length;o+=e._logContext[i].join("\r\n")+"\r\n"}return e._logContext.loadlogs&&e._logContext.loadlogs instanceof Array&&(o+="-------------------------------------------------------------\r\n",o+=e._logContext.loadlogs.join("\r\n")+"\r\n"),o}},e.fileReport=function(){var n=e.genReport();if(n){var t=encodeURIComponent(n),o=document.createElement("a");o.style.display="none",o.download="emedia-"+(new Date).toJSON()+".log",o.href="data:text/plain;charset=utf-8,"+t,document.body.appendChild(o),o.click(),o.parentNode.removeChild(o)}},navigator.mediaDevices){var o=navigator.mediaDevices.getSupportedConstraints();n.logger.info("Supported constraints",o)}e.config({globalConstraints:{}});var r=require("./components/Service"),i=require("./components/event");e.Webrtc=require("./components/_Webrtc"),e.Service=r,e.P2P=require("./components/AddonsP2P"),e.XService=r,e.XServiceWithP2P=e.P2P(r),e.mgr=require("./components/mgr/outer").outer,e.ctrl=require("./components/pannelVideo"),e.CompositeCanvas=require("./components/CompositeCanvas"),e.pannel||(e.pannel={}),e.pannel.DefaultMouseTrack=require("../../pannel/src/components/DefaultTrack"),e.pannel.MouseTrack=require("../../pannel/src/components/MouseTrack"),e.pannel.KeyboardTrack=require("../../pannel/src/components/KeyboardTrack");var a=e.PCStats=require("./components/PCStats");if(e.helper=e.helper||{},e.helper.PCStats=a,e.helper.pcstats=a.echo,e.helper.intervalPcstats=a.intervalEcho,e.helper.inboundAudio=a.inboundAudio,e.helper.inboundVideo=a.inboundVideo,e.helper.outboundAudio=a.outboundAudio,e.helper.outboundVideo=a.outboundVideo,e.event=i,e.LOG_LEVEL=0,e.isFirefox="firefox"===e.browser,e.isChrome="chrome"===e.browser,e.isSafari="safari"===e.browser,e.isEdge="edge"===e.browser,e.isElectron=/Electron/.test(navigator.userAgent),e.isElectron)try{require("./components/electron")}catch(s){n.logger.error(s)}e.youInSomeBrowsers=function(){if(e.isSafari){var n=new RegExp("(Version)/([0-9.]+)","i"),t=navigator.userAgent.match(n);if(null!=t){var o=unescape(t[2]);return(o=parseInt(o))<13}}return!1},e.replaceIpAndPortOfCandidate=function(e,n,t){return e.replace(/(candidate:\d+\s+\d+\s+UDP\s+\d+\s+)([\d\.]+)\s+(\d+)(\s+.*)/g,function(e,o,r,i,a){return o+n+" "+t+a})},e.replaceIpAndPort=function(e,n){return"function"!=typeof n?e:e.replace(/(candidate:\d+\s+\d+\s+UDP\s+\d+\s+)([\d\.]+)\s+(\d+)(\s+.*)/g,function(e,t,o,r,i){var a=n(o,r);return"string"==typeof a?t+(a=a.replace(":"," "))+i:t+ip+" "+port+i})},e.replaceURL=function(e,n){return"function"!=typeof n?e:e.replace(/([^:\/?&#=]+):\/\/([^\/:?#]+)(:\d+)?(\/[^?#]*)?(\?[^\/#]*)?(#[^\/?]*)?/g,function(t,o,r,i,a,s,u){i&&(i=i.substring(1));var d=n(t,o,r,i,a,s,u);if(!d)return e;if("string"==typeof d)return d;var c=d.protocol||o,l=d.host||r,f=d.port||i,p=d.path||a,g=d.query||s,m=d.fragment||u;return c+"://"+l+(f?":"+f:"")+(p||"")+(g||"")+(m||"")})},e.requireTrustBeforeJoin=function(){return!1},e.isWebRTC=window.RTCPeerConnection&&/^https\:$/.test(window.location.protocol),(e.isChrome||e.isSafari)&&(e.supportPRAnswer=!0),e.supportPRAnswer=!1,e.config({baseAcptOps:[102,104,105,106,107,300,302,303,304,301,204,206,400,401,1001,100201,100202,100203]}),e.config({clientType:"WEB",version:"2.1.3",userAgent:navigator.userAgent,acptOps:[100230,100205,1003,1004]}),module.exports=e;
},{"./components/Util":"Qsy+","zepto-webpack":"75TC","./_adapter/_Adapter.import":"bg1w","./components/Service":"rBvl","./components/event":"zP2G","./components/_Webrtc":"BwOA","./components/AddonsP2P":"4FmY","./components/mgr/outer":"2RU2","./components/pannelVideo":"Svh7","./components/CompositeCanvas":"5Z4V","../../pannel/src/components/DefaultTrack":"yEWu","../../pannel/src/components/MouseTrack":"LM64","../../pannel/src/components/KeyboardTrack":"RjIC","./components/PCStats":"gqHj","./components/electron":"8Qcp"}],"yUjP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("easemob-emedia"),t=e.util;exports.default=t;
},{"easemob-emedia":"xl1W"}],"thlH":[function(require,module,exports) {
function t(a){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(a)}var a=require("./utils").default,e=a.logger,n={rtFlag:1,success:function(t){},fail:function(t){}},d=function t(e){if(!(this instanceof t)){var d=function(t){a.extend(!0,this,t||{})};return a.extend(!0,d.prototype,n,e||{}),d}a.extend(!0,this,n,e||{})};exports.RouteTo=d;var s={imConnection:null,rtcHandler:null,events:{0:"onReqP2P",1:"onNewCfr",2:"onDelCfr",3:"onReqTkt",100:"onPing",101:"onPong",102:"onInitC",103:"onReqC",104:"onAcptC",105:"onTcklC",106:"onAnsC",107:"onTermC",202:"onInvite",300:"onEvEnter",301:"onEvExit",302:"onEvPub",303:"onEvUnpub",304:"onEvMems",204:"onEvClose",400:"onStreamControl",401:"onEvJoin",onServerError:"onServerError"},register:function(a){if("object"===t(a))for(var e in a)this.bind(e,a[e])},bind:function(t,a){var e;(e=this.events[t])?this[e]=a:this[e=this.events[t]="on_"+t]=a},jid:function(t){return/^.+#.+_.+@.+$/g.test(t)?t:this.imConnection.context.appKey+"_"+t+"@"+this.imConnection.domain},reqP2P:function(t,a,n,d,s,r,o){e.debug("req p2p ...");var i={data:{op:0,video:a,audio:n,peer:d,rec:s,recMerge:r}};i.streamType=a&&n?"VIDEO":"VOICE",this.rtcHandler.sendRtcMessage(t,i,o)},newCfr:function(t,a,n,d){e.debug("newCfr ...");var s={data:{op:1}};a&&(s.data.reqTkt=a),n&&(s.data.password=n),this.rtcHandler.sendRtcMessage(t,s,d)},enter:function(t,a,n,d,s,r,o){e.debug("enter ...");var i={data:{op:200}};a&&(i.data.WebRTCId=a),n&&(i.data.reqMembers=n),d&&(i.data.tkt=d),s&&(i.data.nonce=s),r&&(i.data.digest=r),this.rtcHandler.sendRtcMessage(t,i,o)},ping:function(t,a,n){e.debug("ping ...");var d={data:{op:100}};a&&(d.data.sessId=a),this.rtcHandler.sendRtcMessage(t,d,n)},streamControl:function(t,a,n,d,s,r){e.debug("streamControl ...");var o={data:{op:400}},i=0==d||3==d;0==d||1==d?emedia.enableAudioTracks(s,i):emedia.enableVideoTracks(s,i),a&&(o.data.sessId=a),n&&(o.data.rtcId=n),void 0!==d&&null!=d&&(o.data.controlType=d),this.rtcHandler.sendRtcMessage(t,o,r)},reqTkt:function(t,a,n,d,s){e.debug("reqTkt ...");var r={data:{op:3}};a&&(r.data.isCreate=a),n&&(r.data.confrId=n),"string"==typeof d&&(r.data.password=d),this.rtcHandler.sendRtcMessage(t,r,s)},invite:function(t,a,n,d,s){e.debug("reqTkt ...");var r={data:{op:202}};a&&(r.data.confrId=a),"string"==typeof n&&(r.data.password=n),d&&(r.data.gid=d),this.rtcHandler.sendRtcMessage(t,r,s)},initC:function(t,a,n,d,s,r,o,i,c,u,l,p,f){e.debug("initC ...");var g=t.to.split("_");g.splice(0,1),t.to=g.join("_").split("@")[0];var b={data:{op:102}};b.streamType=a||"VIDEO",n&&(b.data.WebRTCId=n),d&&(b.data.tkt=d),s&&(b.data.sessId=s),r&&(b.data.rtcId=r),o&&(b.data.pubS=o),i&&(b.data.subS=i),c&&(b.data.sdp=c),u&&(b.data.cands=u),l&&(b.data.rtcCfg=l),p&&(b.data.WebRTC=p),b.data.expr=emedia.supportPRAnswer?1:0,this.rtcHandler.sendRtcMessage(t,b,f)},tcklC:function(t,a,n,d,s,r){e.debug("tcklC ...");var o={data:{op:105}};a&&(o.data.sessId=a),n&&(o.data.rtcId=n),d&&(o.data.sdp=d),s&&(o.data.cands=s),this.rtcHandler.sendRtcMessage(t,o,r)},ansC:function(t,a,n,d,s,r,o,i){e.debug("ansC ...");var c={data:{op:106}};a&&(c.data.sessId=a),n&&(c.data.rtcId=n),d&&(c.data.sdp=d),s&&(c.data.cands=s),!1===o&&(c.data.enableVoice=o),!1===i&&(c.data.enableVideo=i),this.rtcHandler.sendRtcMessage(t,c,r)},acptC:function(t,a,n,d,s,r,o,i,c){e.debug("acptC ...");var u={data:{op:104}};a&&(u.data.sessId=a),n&&(u.data.rtcId=n),d&&(u.data.sdp=d),s&&(u.data.cands=s),r&&(u.data.ans=r),!1===i&&(u.data.enableVoice=i),!1===c&&(u.data.enableVideo=c),this.rtcHandler.sendRtcMessage(t,u,o)},getMems:function(t,a,n,d){e.debug("getMems ...");var s={data:{op:203}};a&&(s.data.WebRTCId=a),n&&(s.data.sessId=n),this.rtcHandler.sendRtcMessage(t,s,d)},subC:function(t,a,n,d,s){e.debug("subC ...");var r={data:{op:205}};a&&(r.data.sessId=a),n&&(r.data.rtcId=n),d&&(r.data.subS=d),this.rtcHandler.sendRtcMessage(t,r,s)},usubC:function(t,a,n,d){e.debug("usubC ...");var s={data:{op:206}};a&&(s.data.sessId=a),n&&(s.data.rtcId=n),this.rtcHandler.sendRtcMessage(t,s,d)},termC:function(t,a,n,d,s){e.debug("termC ...");var r={data:{op:107,reason:d}};a&&(r.data.sessId=a),n&&(r.data.rtcId=n),d&&(r.reason=d),this.rtcHandler.sendRtcMessage(t,r,s)},exit:function(t,a,n,d){e.debug("exit ...");var s={data:{op:201}};a&&(s.data.WebRTCId=a),n&&(s.data.sessId=n),this.rtcHandler.sendRtcMessage(t,s,d)},delCfr:function(t,a,n,d){e.debug("delCfr ...");var s={data:{op:2}};a&&(s.data.WebRTCId=a),n&&(s.data.admtok=n),this.rtcHandler.sendRtcMessage(t,s,d)}};exports.Api=function(t){var n=this;a.extend(!0,this,s,t||{}),this.rtcHandler.onRecvRtcMessage=function(t,a,d,s,r){var o;0!=a.result&&n.onServerError?n.onServerError.call(n,t,a,d,s,r):n.events[a.op]&&(o=n[n.events[a.op]])?o.call(n,t,a,d,s,r):e.info("can not handle(recvRtcMessage) the op: "+a.op,a)}};
},{"./utils":"yUjP"}],"7BK3":[function(require,module,exports) {
var e=require("./utils").default,t=e.logger,n=require("./api"),o=n.RouteTo,s="urn:xmpp:media-conference",d={_apiCallbacks:{},imConnection:null,_connectedSid:"",init:function(){var e=this;e.imConnection.registerConfrIQHandler=function(n,o,s){try{e.handleRtcMessage(n)}catch(d){t.error(d)}}},handleRtcMessage:function(n,s,d){var a=this;if(n){var r=WebIM.conn.context.root.lookup("easemob.pb.ConferenceBody").decode(n.payload),i=(n.id,n.from.name||"");i.lastIndexOf("/")>=0&&(i=i.substring(0,i.lastIndexOf("/")));var c=r.routeKey,p=r.sessionId;(a._fromSessionID||(a._fromSessionID={}))[i]=p;var f=e.parseJSON(r.content);f.confrId&&(this.confrId=f.confrId);var y=f,g=1==r.type?"VIDEO":"VOICE";""==g&&(g="VOICE"),y.streamType=g,102==y.op&&(a.singalStreamType=g);var l=f.tsxId;if(a.ctx=f.ctx,t.debug("Recv [op = "+y.op+"] [tsxId="+l+"]\r\n json :",n),""!=a._connectedSid||0!=y.result&&102!=y.op&&202!=y.op){if(a._connectedSid!=p){if(t.debug("Error recv [op = "+y.op+"] [tsxId="+l+"]. caused by _connectedSid != fromSessionId :",a._connectedSid,p),102==y.op&&p&&a._connectedSid){var m=new o({to:i,rtKey:c,sid:p,success:function(e){t.debug("iq to server success",e)},fail:function(e){t.debug("iq to server error",e),a.onError(e)}}),u={data:{op:107,sessId:y.sessId,rtcId:y.rtcId,reason:"busy"},reason:"busy"};a.sendRtcMessage(m,u)}return}}else a._connectedSid=p;if(107==y.op){a._connectedSid="",_fromSessionID={};var v=r.endReason;y.reason=null!=v&&{0:"hangup",1:"noresponse",2:"reject",3:"busy",4:"fail",5:"unsupported",6:"offline"}[v]}if(y.sdp&&("string"==typeof y.sdp&&(y.sdp=e.parseJSON(y.sdp)),y.sdp.type&&(y.sdp.type=y.sdp.type.toLowerCase())),y.cands){"string"==typeof y.cands&&(y.cands=e.parseJSON(y.cands));for(var I=0;I<y.cands.length;I++){if("string"==typeof y.cands[I])try{y.cands[I]=e.parseJSON(y.cands[I])}catch(S){y.cands[I]={candidate:y.cands[I]}}y.cands[I].sdpMLineIndex=void 0!==y.cands[I].sdpMLineIndex?y.cands[I].sdpMLineIndex:y.cands[I].mlineindex,y.cands[I].sdpMid=void 0!==y.cands[I].sdpMid?y.cands[I].sdpMid:y.cands[I].mid,delete y.cands[I].mlineindex,delete y.cands[I].mid}}if(y.rtcCfg&&"string"==typeof y.rtcCfg&&(y.rtcCfg=e.parseJSON(y.rtcCfg)),y.rtcCfg2&&"string"==typeof y.rtcCfg2&&(y.rtcCfg2=e.parseJSON(y.rtcCfg2)),y.WebRTC&&"string"==typeof y.WebRTC&&(y.WebRTC=e.parseJSON(y.WebRTC)),y.confrId&&(y.conferenceId=y.confrId),l&&a._apiCallbacks[l])try{a._apiCallbacks[l].callback&&a._apiCallbacks[l].callback(i,y)}catch(b){throw b}finally{delete a._apiCallbacks[l]}else a.onRecvRtcMessage(i,y,c,l,p);return!0}},onRecvRtcMessage:function(n,o,s,d,a){t.debug(" form : "+n+" \r\n json :"+e.stringifyJSON(rtcJSON))},convertRtcOptions:function(t){var n=t.data.sdp;n&&((n={type:n.type,sdp:n.sdp}).type=n.type.toUpperCase(),n=e.stringifyJSON(n),t.data.sdp=n);var o=t.data.cands;if(o){if(e.isArray(o));else{var s=[];s.push(o),o=s}for(var d in o){var a=o[d];if(void 0!==a.candidate&&void 0!==a.sdpMLineIndex&&void 0!==a.sdpMid){var r={type:"candidate",candidate:a.candidate,mlineindex:a.sdpMLineIndex,mid:a.sdpMid};o[d]=e.stringifyJSON(r)}}t.data.cands=o}var i=t.data.rtcCfg;i&&"string"!=typeof i&&(t.data.rtcCfg=e.stringifyJSON(i));var c=t.data.WebRTC;c&&"string"!=typeof c&&(t.data.WebRTC=e.stringifyJSON(c))},getShortId:function(e){var t,n;return(t=e.indexOf("_")+1)<1&&(t=0),(n=e.indexOf("@",-1))<0&&(n=e.length),e.substring(t,n)},sendRtcMessage:function(t,n,o){var s=this.imConnection,d=s.getUniqueId(),a=t.to&&t.to||s.domain;if(a.indexOf("@")>=0){var r=a.split("_");r.splice(0,1),a=r.join("_").split("@")[0],""==this._connectedSid&&102==n.data.op&&(this._connectedSid=i)}var i=t.sid||this._fromSessionID&&this._fromSessionID[a];i=i||((this._fromSessionID||(this._fromSessionID={}))[a]=s.getUniqueId("CONFR_")),(this._fromSessionID||(this._fromSessionID={}))[a]=i;var c=t.rtKey||t.rtkey;c||(c="");var p=t.rtflag;!isNaN(p)||(p=1),n.data||(n.data={}),n.data.tsxId=d,this.ctx&&(n.data.ctx=this.ctx),this.convertRtcOptions(n);var f=n.streamType||this.singalStreamType||"VIDEO";102==n.data.op&&(this.singalStreamType=f);var y=t.id||s.getUniqueId("CONFR_");o&&(this._apiCallbacks[d]={callback:o});var g={id:y,to:a,from:s.context.jid,type:"VIDEO"==f?1:0,rtflag:p,stream_type:f,sid:i,content:n.data,reason:n.reason,rtKey:c};if(0==n.data.op&&(g.rec=n.data.rec,g.recMerge=n.data.recMerge,this.rec=n.data.rec,this.recMerge=n.data.recMerge),202!=n.data.op&&this._sendMessage(g,WebIM.conn),107==n.data.op&&this._connectedSid&&(t.sid&&this._connectedSid!=t.sid||(this._connectedSid="",this._fromSessionID={})),202==n.data.op){var l=e.list("Invite",this.getShortId(a),"join conference:",n.data.confrId).join(" "),m={msg:l,id:y=s.getUniqueId("CONFR_INVITE"),to:a,from:s.context.jid,contents:[{contenttype:"TEXT",text:l}],gid:n.data.gid,password:n.data.password,exts:{key:"conferenceId",type:7,value:n.data.confrId}};return this._sendGroupInviteMsg(m,WebIM.conn)}},_sendGroupInviteMsg:function(e,t){var n=[],o=t.context.root.lookup("easemob.pb.MessageBody.Content").decode(n);o.type=0,o.text=e.msg;var s=t.context.root.lookup("easemob.pb.MessageBody"),d=s.decode(n);d.from={name:e.from.name},d.to={name:e.to},d.contents=[o];var a=t.context.root.lookup("easemob.pb.KeyValue"),r=a.decode(n),i=a.decode(n),c=a.decode(n);r.key="conferenceId",r.type=7,r.stringValue=e.exts.value,i.key="msg_extension",i.type=7,i.stringValue=JSON.stringify({inviter:e.from.name,group_id:e.gid}),c.key="password",c.type=7,c.stringValue=e.password,d.ext=[r,i,c],d.type=1,d=s.encode(d).finish();var p=t.context.root.lookup("easemob.pb.Meta").decode(n);p.id=e.id,p.from=e.from,p.to={appKey:t.appKey,name:e.to,domain:"easemob.com"},p.ns=1,p.type=1,p.payload=d;var f=t.context.root.lookup("easemob.pb.CommSyncUL"),y=f.decode(n);y.meta=p,y=f.encode(y).finish();var g=t.context.root.lookup("easemob.pb.MSync"),l=g.decode(n);l.version=t.version,l.encryptType=t.encryptType,l.command=0,l.guid=t.context.jid,l.payload=y,l=g.encode(l).finish(),t.sendMSync(l)},_sendMessage:function(e,t){var n,o=[],s=t.context.root.lookup("easemob.pb.ConferenceBody"),d=s.decode(o);e.content.video;0==e.content.op?(n={op:e.content.op,callVersion:"2.0.0",audio:e.content.audio,video:e.content.video,tsxId:String(e.content.tsxId),peer:e.content.peer+"/",push:0},e.rec&&(n.rec=1),e.recMerge&&(n.recMerge=1)):102==e.content.op?((n=e.content).tsxId=String(e.content.tsxId),this.rec&&(n.rec=1)):400==e.content.op?n=e.content:(n=e.content).tsxId=String(e.content.tsxId);var a=e.content.op;if(d.content=JSON.stringify(n),d.routeFlag=e.rtflag,d.operation=7,d.sessionId=String(e.sid),d.type=e.type,d.routeKey=e.rtKey,d.routeFlag=e.rtflag,d.peerName=e.from.name,107==a){d.endReason={success:0,ok:0,timeout:1,decline:2,busy:3,"failed-transport":4,unsupported:5,offline:6}[e.reason]}d=s.encode(d).finish();var r=t.context.root.lookup("easemob.pb.Meta").decode(o);r.id=String(e.id),r.ns=4,r.to={appKey:e.from.appKey,domain:e.from.domain,name:e.to},102==e.content.op&&(r.from=e.from),r.payload=d;var i=t.context.root.lookup("easemob.pb.CommSyncUL"),c=i.decode(o);c.meta=r,c=i.encode(c).finish();var p=t.context.root.lookup("easemob.pb.MSync"),f=p.decode(o);f.version=t.version,f.encryptType=t.encryptType,f.command=0,f.guid=t.context.jid,f.payload=c,f=p.encode(f).finish(),t.sendMSync(f)}},a=function(t){e.extend(!0,this,d,t||{}),this.init()};module.exports=a;
},{"./utils":"yUjP","./api":"thlH"}],"GTpD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e,t=require("easemob-emedia");t.Webrtc.prototype.AVPubstream=t.Service.prototype.AVPubstream,t.Webrtc.prototype._openCamera=function(){t.Service.prototype._openCamera.apply(this,arguments)},t.Webrtc.prototype.__getUserMedia=function(){t.Service.prototype.__getUserMedia.apply(this,arguments)},t.Webrtc.prototype.__controlStream=function(){t.Service.prototype.__controlStream.apply(this,arguments)},t.Webrtc.prototype.__sysGetUserMedia=function(){t.Service.prototype.__sysGetUserMedia.apply(this,arguments)},t.Webrtc.prototype._onStreamInactive=function(e,r){t.util.logger.warn("media stream inactive. it =",e.id)},t.Webrtc.prototype._onStreamActive=function(e,r){t.util.logger.warn("media stream active. it =",e.id)},t.Webrtc.prototype.createMedia=function(e,r){var o=this,i=new o.AVPubstream({constaints:e,aoff:0,voff:0});t.Service.prototype.openUserMedia.bind(this)(i).then(function(e,t){WebIM.__alreadyOpenMedias.push(t),r&&r(o,t)},function(e){t.util.logger.debug("[WebRTC-API] getUserMedia() error: ",e),o.onError(e)})},t.Webrtc.prototype.createMedia=e=function(r,o){var i=this,a=new MediaStream;function n(){0==--n.count&&(WebIM.__alreadyOpenMedias.push(a),o&&o(i,a))}function s(e){e&&e.getTracks().forEach(function(e){a.addTrack(e)})}var c=!r||r.audio,p=!r||r.video;if(!c&&!p)return n.count=0,n();if(c&&p)return n.count=2,e.call(this,{video:r.video,audio:!1},function(e,t){s(t),n()}),void e.call(this,{video:!1,audio:r.audio},function(e,t){s(t),n()});n.count=1;var u=new i.AVPubstream({constaints:r});t.Service.prototype.openUserMedia.bind(this)(u).then(function(e,t){s(t),n()},function(e){n(),t.util.logger.debug("[WebRTC-API] getUserMedia() error: ",e),"function"==typeof e.message?e.message=e.message():"string"==typeof e.message&&""!==e.message?e.message=e.message:e.message="open media error. "+e.name,e.message=e.message+" when get "+(p?"carma":"microphone"),i.onError(e)})},t.Webrtc.prototype.setLocalVideoSrcObject=function(e){this._localStream=e,this.onGotLocalStream(e,this.streamType),this.setLocalStream(e),t.util.logger.debug("[WebRTC-API] you can see yourself !")};var r=t.Webrtc.prototype.setRemoteDescription;t.Webrtc.prototype.setRemoteDescription=function(e){var t,o,i,a,n;if("VOICE"===this.streamType){t=/a=sendrecv|a=sendonly/g,o="a=inactive",i=e.sdp.indexOf("m=video"),a=e.sdp.indexOf("m=audio"),n=a>i?a:e.sdp.length,e.sdp=e.sdp.replace(t,function(e,t,r){return t>=i&&t<n?o:e})}return r.call(this,e)};var o=t.Webrtc;exports.default=o;
},{"easemob-emedia":"xl1W"}],"3mO+":[function(require,module,exports) {
var e=require("./utils").default,n=require("./api").RouteTo,t=e.logger,i=n({success:function(e){t.debug("iq to server success",e)},fail:function(e){t.debug("iq to server error",e)}}),s={_pingIntervalId:null,_p2pConfig:null,_rtcCfg:null,_rtcCfg2:null,_rtKey:null,_rtFlag:null,webRtc:null,api:null,callee:null,isCaller:!1,accepted:!1,setLocalSDP:!1,setRemoteSDP:!1,hangup:!1,init:function(){var e=this;e.api.onPing=function(){e._onPing.apply(e,arguments)},e.api.onTcklC=function(){e._onTcklC.apply(e,arguments)},e.api.onAcptC=function(){e._onAcptC.apply(e,arguments)},e.api.onAnsC=function(){e._onAnsC.apply(e,arguments)},e.api.onTermC=function(){e._onTermC.apply(e,arguments)},e.api.onEvJoin=function(){e._onEvJoin.apply(e,arguments)},e.api.onStreamControl=function(){e._onStreamControl.apply(e,arguments)},e.webRtc.onIceCandidate=function(){e._onIceCandidate.apply(e,arguments)},e.webRtc.onIceStateChange=function(){e._onIceStateChange.apply(e,arguments)}},_ping:function(){var e=this;e._pingIntervalId=window.setInterval(function(){var n=new i({to:e.callee,rtKey:e._rtKey});e.api.ping(n,e._sessId,function(e,n){t.debug("ping result",n)})},5e4)},_onPing:function(e,n,i,s,o){t.debug("_onPing from",o)},initC:function(e,n){this.sid=n,this.isCaller=!0,this.accepted=!1,this.setLocalSDP=!1,this.setRemoteSDP=!1,this.hangup=!1,this.streamType=e.audio&&e.video?"VIDEO":"VOICE",this.createLocalMedia(e)},createLocalMedia:function(e){var n=this;this.webRtc.createMedia(e,function(e,t){n.webRtc.createRtcPeerConnection(n._rtcCfg),e.setLocalVideoSrcObject(t),e.localStream=t,n.webRtc.createOffer(function(e){n._onGotWebRtcOffer(e)})})},_onGotWebRtcOffer:function(e){var n=new i({to:this.callee,rtKey:this._rtKey});this.api.initC(n,this.streamType,null,null,this._sessId,this._rtcId,null,null,e,null,this._rtcCfg2,null,function(e,n){t.debug("initc result",n)}),this.setLocalSDP=!0,this._ping()},_onAcptC:function(e,n){n.ans&&1==n.ans?(t.info("[WebRTC-API] _onAcptC : 104, ans = 1, it is a answer. will onAcceptCall"),this.onAcceptCall(e,n,!1!==n.enableVoice,!1!==n.enableVideo),this._onAnsC(e,n)):WebIM.WebRTC.supportPRAnswer?(t.info("[WebRTC-API] _onAcptC : recv pranswer. "),(n.sdp||n.cands)&&(n.sdp&&this.webRtc.setRemoteDescription(n.sdp),this.setRemoteSDP=!0,this._handRecvCandsOrSend(e,n),this.onAcceptCall(e,n,!1!==n.enableVoice,!1!==n.enableVideo))):(t.info("[WebRTC-API] _onAcptC : not supported pranswer. drop it. will onAcceptCall"),this.setRemoteSDP=!1,this._handRecvCandsOrSend(e,n),this.onAcceptCall(e,n,!1!==n.enableVoice,!1!==n.enableVideo))},_onEvJoin:function(e,n,i,s,o){t.debug("_onEvJoin from",o,e),this.onAcceptCall(e,n,!1!==n.enableVoice,!1!==n.enableVideo)},onAcceptCall:function(e,n,t,i){},__onVoiceOrVideo:function(e,n,t){!1===n.enableVoice?this.onOtherUserOpenVoice(e,!1):this.onOtherUserOpenVoice(e,!0),!1===n.enableVideo?this.onOtherUserOpenVideo(e,!1):this.onOtherUserOpenVideo(e,!0)},_onStreamControl:function(e,n,t,i,s){var o=n.controlType;0===o&&this.onOtherUserOpenVoice(e,!1),1===o&&this.onOtherUserOpenVoice(e,!0),2===o&&this.onOtherUserOpenVideo(e,!1),3===o&&this.onOtherUserOpenVideo(e,!0),this.onStreamControl(e,n,t,i,s)},onStreamControl:function(e,n,t,i,s){},onOtherUserOpenVoice:function(e,n){t.debug("from open:",n," voice .",e)},onOtherUserOpenVideo:function(e,n){t.debug("from open:",n," voideo .",e)},_onAnsC:function(e,n){t.info("[WebRTC-API] _onAnsC : recv answer. "),this.accepted=!0,n.sdp&&this.webRtc.setRemoteDescription(n.sdp),this.setRemoteSDP=!0,this._handRecvCandsOrSend(e,n),this.__onVoiceOrVideo(e,n)},_onInitC:function(e,n,i,s,o){var a=this;a.isCaller=!1,a.accepted=!1,a.setLocalSDP=!1,a.setRemoteSDP=!1,a.hangup=!1,a.callee=e,a._rtcCfg2=n.rtcCfg,a._rtKey=i,a._tsxId=s,a._fromSid=o,a._rtcId=n.rtcId,a._sessId=n.sessId,a.streamType=n.streamType,a.globalMediaConstaints=n.globalMediaConstaints,a.webRtc.createRtcPeerConnection(a._rtcCfg2),a.callerNotPranswer=0===n.expr,t.warn("caller not pranswer ",a.callerNotPranswer),n.sdp&&t.debug(n.sdp.sdp),n.sdp&&a.webRtc.setRemoteDescription(n.sdp).then(function(){a.setRemoteSDP=!0,a._handRecvCandsOrSend(e,n),WebIM.WebRTC.supportPRAnswer?a.webRtc.createPRAnswer(function(e){a._onGotWebRtcPRAnswer(e),setTimeout(function(){t.info("[WebRTC-API] onRinging : after send pranswer. ",a.callee),a.onRinging(a.callee,a.streamType)},500)}):(setTimeout(function(){t.info("[WebRTC-API] onRinging : After iniC, cause by: not supported pranswer. ",a.callee),a.onRinging(a.callee,a.streamType)},500),a._ping())})},_onGotWebRtcPRAnswer:function(e){var n=new i({to:this.callee,rtKey:this._rtKey});this.api.acptC(n,this._sessId,this._rtcId,e),this.setLocalSDP=!0,this._handRecvCandsOrSend(),this._ping()},onRinging:function(e,n){},accept:function(){var e=this;var n={audio:e.globalMediaConstaints&&e.globalMediaConstaints.audio||!0};"VIDEO"==e.streamType&&(n.video=e.globalMediaConstaints&&e.globalMediaConstaints.video||!0),e.webRtc.createMedia(n,function(n,s){n.setLocalVideoSrcObject(s),t.info("createAndSendAnswer : ...... "),e.webRtc.createAnswer(function(n){var s=new i({to:e.callee,rtKey:e._rtKey});WebIM.WebRTC.supportPRAnswer?e.webRtc.isConnected()||e.callerNotPranswer?(t.info("[WebRTC-API] ice connected or caller not pranswer, may send answer"),e.api.ansC(s,e._sessId,e._rtcId,n)):(t.info("[WebRTC-API] ice state not connected, send answer waiting."),e.webRtc._hookWhenICEReady=function(){t.info("[WebRTC-API] ice connected, send answer"),e.api.ansC(s,e._sessId,e._rtcId,n)}):e.api.acptC(s,e._sessId,e._rtcId,n,null,1),WebIM.WebRTC.supportPRAnswer||(e.setLocalSDP=!0),e._handRecvCandsOrSend(),e.accepted=!0})})},_handRecvCandsOrSend:function(e,n){var t=this;setTimeout(function(){t._onTcklC(e,n)},50),setTimeout(function(){t._onIceCandidate()},50)},_onTcklC:function(e,n){if(this.setRemoteSDP)t.info("[WebRTC-API] recv and add cands."),this._recvCands&&this._recvCands.length>0&&this.webRtc.addIceCandidate(this._recvCands),this._recvCands&&this._recvCands.length>0&&(this._recvCands=[]),n&&n.cands&&this.webRtc.addIceCandidate(n.cands);else if(n&&n.cands&&n.cands.length>0){for(var i=0;i<n.cands.length;i++)(this._recvCands||(this._recvCands=[])).push(n.cands[i]);t.debug("[_onTcklC] temporary memory[recv] ice candidate. util setRemoteSDP = true")}},_onIceStateChange:function(e){t.debug("[WebRTC-API] ice state is "+e),this.webRtc.isConnected()&&(this.webRtc._hookWhenICEReady&&this.webRtc._hookWhenICEReady(),this.webRtc._hookWhenICEReady=void 0),"closed"===e&&(this.setLocalSDP=!1,this.setRemoteSDP=!1),this.api.onIceConnectionStateChange(e)},_onIceCandidate:function(e){var n=this;if(n.setLocalSDP){var s=function(e){t.debug("send ice candidate...");var s=new i({to:n.callee,rtKey:n._rtKey});e&&n.api.tcklC(s,n._sessId,n._rtcId,null,e)};n._cands&&n._cands.length>0&&(s(n._cands),n._cands=[]),e&&s(e)}else e&&(n._cands||(n._cands=[])).push(e),t.debug("[_onIceCandidate] temporary memory[send] ice candidate. util setLocalSDP = true")},__termCall1:function(e){this._pingIntervalId&&window.clearInterval(this._pingIntervalId);var n,t=new i({to:this.callee,rtKey:this._rtKey});e||!this.isCaller&&!this.accepted&&(n="decline")||(n="success"),this.hangup||this.api.termC(t,this._sessId,this._rtcId,n),this.webRtc.close(),this.hangup=!0,this.setLocalSDP=!1,this.setRemoteSDP=!1,this.onTermCall(e)},termCall:function(e){try{this.__termCall1(e)}finally{if(WebIM.__alreadyOpenMedias&&WebIM.__alreadyOpenMedias.length>0){for(var n in WebIM.__alreadyOpenMedias){var t=WebIM.__alreadyOpenMedias[n];try{emedia.stopTracks(t)}catch(i){}}WebIM.__alreadyOpenMedias=[]}}},_onTermC:function(e,n){t.debug("[_onTermC] options.reason = "+n.reason);this.hangup=!0,this.setLocalSDP=!1,this.setRemoteSDP=!1,this.termCall(n.reason)},onTermCall:function(){}};module.exports=function(n){e.extend(!0,this,s,n||{}),this.init()};
},{"./utils":"yUjP","./api":"thlH"}],"J9kn":[function(require,module,exports) {
var t=require("./utils").default,e=require("./iq"),n=require("./api"),i=require("./webrtc").default,r=require("./p2p"),o=n.RouteTo,a=n.Api,s=t.logger,c={api:null,caller:"",connection:null,pattern:null,listener:{onAcceptCall:function(t,e){},onRinging:function(t){},onTermCall:function(){},onIceConnectionStateChange:function(t){}},mediaStreamConstaints:{audio:!0,video:!0},init:function(){var t=this;if(void 0===t.connection)throw"Caller need a instance of Easemob.im.Connection";t.api=t.api||new a({imConnection:t.connection,rtcHandler:new e({imConnection:t.connection})}),t.api.onInitC=function(){t._onInitC.apply(t,arguments)},t.api.onInvite=function(){t.listener.onInvite.apply(t,arguments)},t.api.onIceConnectionStateChange=function(e){t.listener.onIceConnectionStateChange.apply(t,arguments)}},createConference:function(t,e){var n=new o({rtKey:""});this.api.reqTkt(n,!0,void 0,t,function(t,n){n.ticket;n.conferenceId=n.confrId,e&&e(t,n)})},inviteConference:function(t,e,n,i,r){var a=new o({to:n,rtKey:"",rtflag:0});this.api.invite(a,t,e,i,function(t,e){r&&r(t,e)})},getConferenceTkt:function(t,e,n){var i=new o({rtKey:""});this.api.reqTkt(i,!1,t,e,function(t,e){n&&n(t,e)})},makeVideoCall:function(e,n,i,r){var o={};t.extend(o,this.mediaStreamConstaints),this.call(e,o,n,i,r)},makeVoiceCall:function(e,n,i,r){var o={};t.extend(o,this.mediaStreamConstaints),o.video=!1,this.call(e,o,n,i,r)},acceptCall:function(){this.pattern.accept()},endCall:function(t){this.caller="",this.pattern.termCall()},call:function(t,e,n,i,r){var a=this;this.callee=this.api.jid(t);var c=new o({rtKey:"",sid:n,to:t,success:function(t){s.debug("iq to server success",t)},fail:function(t){s.debug("iq to server error",t),a.onError(t)}});this.api.reqP2P(c,e.video?1:0,e.audio?1:0,this.api.jid(t),i,r,function(t,o){"0"!=o.online?(o.streamType=e.audio&&e.video?"VIDEO":"VOICE",a._onGotServerP2PConfig(t,o),a.pattern.initC(e,n,i,r)):a.listener.onError({message:"callee is not online!"})})},controlStream:function(t,e){var n=new o({to:e,rtKey:"",rtflag:0});this.api.streamControl(n,null,this.rtcId,t,this.localStream)},getServerRecordId:function(){var t=this.api.rtcHandler.confrId;return t||null},_onInitC:function(t,e,n,i,r){this.callee=t,this._rtcCfg=e.rtcCfg,this._WebRTCCfg=e.WebRTC,this.sessId=e.sessId,this.rtcId=e.rtcId,this.switchPattern("VIDEO"==e.streamType?"VIDEO":"VOICE"),e.globalMediaConstaints=this.mediaStreamConstaints,this.pattern._onInitC(t,e,n,i,r)},_onInvite:function(){},_onGotServerP2PConfig:function(t,e){0==e.result&&(this._p2pConfig=e,this._rtcCfg=e.rtcCfg,this._rtcCfg2=e.rtcCfg2,this.sessId=e.sessId,this.rtcId="RTCID"+e.sessId,this._rtKey=this._rtkey=e.rtKey||e.rtkey,this._rtFlag=this._rtflag=e.rtFlag||e.rtflag,this._WebRTCCfg=e.WebRTC,this.admtok=e.admtok,this.tkt=e.tkt,this.switchPattern(e.streamType))},switchPattern:function(t){var e=this;!e._WebRTCCfg&&(e.pattern=new r({callee:e.callee,_p2pConfig:e._p2pConfig,_rtcCfg:e._rtcCfg,_rtcCfg2:e._rtcCfg2,_rtKey:e._rtKey||e._rtkey,_rtFlag:e._rtFlag||e._rtflag,_sessId:e.sessId,_rtcId:e.rtcId,webRtc:new i({streamType:t,subArgs:{subSVideo:"VIDEO"===t,subSAudio:!0},onGotLocalStream:function(n,i){e.listener.onGotLocalStream(n,t),e.localStream=n},onGotRemoteStream:function(n,i){e.listener.onGotRemoteStream(n,t),e.remoteStream=n},onError:e.listener.onError}),api:e.api,onAcceptCall:e.listener&&e.listener.onAcceptCall||function(){},onRinging:e.listener&&e.listener.onRinging||function(){},onTermCall:e.listener&&e.listener.onTermCall||function(){},onOtherUserOpenVoice:e.listener&&e.listener.onOtherUserOpenVoice||function(){},onOtherUserOpenVideo:e.listener&&e.listener.onOtherUserOpenVideo||function(){}}))}};module.exports=function(e){t.extend(!0,this,c,e||{}),this.init()};
},{"./utils":"yUjP","./iq":"7BK3","./api":"thlH","./webrtc":"GTpD","./p2p":"3mO+"}],"JWwv":[function(require,module,exports) {
var define;
var e;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var t=require("./components/utils").default,n=require("./components/call"),b=require("easemob-emedia");window.WebIM="undefined"!=typeof WebIM?WebIM:{},WebIM.WebRTC=WebIM.WebRTC||{},WebIM.WebRTC.Call=n,WebIM.WebRTC.Util=t,WebIM.WebRTC.emedia=b,WebIM.__alreadyOpenMedias=[],"object"===("undefined"==typeof module?"undefined":o(module))&&"object"===o(module.exports)?module.exports=WebIM.WebRTC:"function"==typeof e&&e.amd&&e([],function(){return WebIM.WebRTC}),WebIM.WebRTC.supportPRAnswer=b.supportPRAnswer,console&&console.warn("Webrtc version","Git.e4f0006");
},{"./components/utils":"yUjP","./components/call":"J9kn","easemob-emedia":"xl1W"}],"Focm":[function(require,module,exports) {
module.exports=require("./src/entry");
},{"./src/entry":"JWwv"}]},{},["Focm"], "webrtc")
//# sourceMappingURL=/EMedia_x1v1.js.map